error-handler
>>> authenticate::skip= true  handler-key= :sign-in
>>> authenticate::authenticated-entity nil

>> authorize >

>> authorize::handler > #object[leihs.core.locale$wrap$fn__44344 0x4cd9b6e4 leihs.core.locale$wrap$fn__44344@4cd9b6e4]

>> authorize::request > {:cookies {}, :remote-addr 127.0.0.1, :start-time 491493265765125, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address your.lending.desk@example.com, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url nil, :sessions_force_uniqueness false, :email_signature Cheers,}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x169d1b71 HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x9872380 next.jdbc.result_set$as_unqualified_lower_maps@9872380]}}, :query-params-raw {}, :route-params nil, :headers {sec-fetch-site none, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0, sec-fetch-user ?1, connection keep-alive, upgrade-insecure-requests 1, accept text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8, accept-language de,en-US;q=0.7,en;q=0.3, sec-fetch-dest document, accept-encoding gzip, deflate, br, sec-fetch-mode navigate}, :async-channel #object[org.httpkit.server.AsyncChannel 0x269400f8 /127.0.0.1:3230<->/127.0.0.1:63886], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x5d479419 HikariDataSource (db-pool)]}, :content-length 0, :form-params {}, :websocket? false, :query-params {}, :content-type nil, :form-params-raw {}, :character-encoding utf8, :uri /sign-in, :server-name localhost, :handler-key :sign-in, :query-string nil, :body nil, :graphql-schema #CompiledSchema<>, :handler #object[compojure.core$routes$fn__27950 0x1a7fee3e compojure.core$routes$fn__27950@1a7fee3e], :multipart-params {}, :scheme :http, :request-method :get, :accept {:mime :html, :charset nil, :encoding nil, :language nil}}

>> authorize::handler-key >> :sign-in
2023-11-24T14:38:23.644Z NX-41294 DEBUG [leihs.procurement.authorization:135] - (skip? (:handler-key request)) => true
locale-wrap
wrap
2023-11-24T14:38:23.731Z NX-41294 DEBUG [leihs.procurement.authorization:150] - (authorize handler request) => {:status 200, :headers {"Content-Type" "text/html; charset=utf-8"}, :body "<!DOCTYPE html>\n<html><head><style>body { font-family: sans-serif; width: 400px; margin: 2rem auto; text-align: center; }\n             * { margin: 0.5rem; }\n             input { width: 15rem; }\n             .message { background-color: pink; padding: 1rem; }</style></head><body><h1>Leihs Simple Login</h1><p>For testing only</p><form action=\"/sign-in\" class=\"ui-form-signin\" method=\"POST\"><div><label>Username<input name=\"user\" type=\"text\"></label></div><div><label>Password<input name=\"password\" type=\"password\" value=\"\"></label></div><input name=\"csrf-token\" type=\"hidden\" value=\"23cf8ac9-7d12-48c8-9f18-ab8ce7611d71\"><div><button type=\"submit\">Continue</button></div></form></body></html>", :cookies {"leihs-anti-csrf-token" {:value "23cf8ac9-7d12-48c8-9f18-ab8ce7611d71", :http-only false, :path "/", :secure false}}}
error-handler
>>> authenticate::skip= nil  handler-key= :not-found
>>> authenticate::authenticated-entity nil
error-handler
>>> authenticate::skip= true  handler-key= :sign-in
>>> authenticate::authenticated-entity nil

>> authorize >

>> authorize::handler > #object[leihs.core.locale$wrap$fn__44344 0x4cd9b6e4 leihs.core.locale$wrap$fn__44344@4cd9b6e4]

>> authorize::request > {:cookies {leihs-anti-csrf-token {:value 23cf8ac9-7d12-48c8-9f18-ab8ce7611d71}}, :remote-addr 127.0.0.1, :start-time 491493478272583, :params {:return-to /favicon.ico}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address your.lending.desk@example.com, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url nil, :sessions_force_uniqueness false, :email_signature Cheers,}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x169d1b71 HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x9872380 next.jdbc.result_set$as_unqualified_lower_maps@9872380]}}, :query-params-raw {:return-to /favicon.ico}, :route-params nil, :headers {sec-fetch-site same-origin, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0, cookie leihs-anti-csrf-token=23cf8ac9-7d12-48c8-9f18-ab8ce7611d71, referer http://localhost:3230/sign-in, connection keep-alive, accept image/avif,image/webp,*/*, accept-language de,en-US;q=0.7,en;q=0.3, sec-fetch-dest image, accept-encoding gzip, deflate, br, sec-fetch-mode no-cors}, :async-channel #object[org.httpkit.server.AsyncChannel 0x77ecf50b /127.0.0.1:3230<->/127.0.0.1:63886], :server-port 3230, :params-raw {:return-to /favicon.ico}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x5d479419 HikariDataSource (db-pool)]}, :content-length 0, :form-params {}, :websocket? false, :query-params {:return-to /favicon.ico}, :content-type nil, :form-params-raw {}, :character-encoding utf8, :uri /sign-in, :server-name localhost, :handler-key :sign-in, :query-string return-to=%2Ffavicon.ico, :body nil, :graphql-schema #CompiledSchema<>, :handler #object[compojure.core$routes$fn__27950 0x1a7fee3e compojure.core$routes$fn__27950@1a7fee3e], :multipart-params {}, :scheme :http, :request-method :get, :accept {:mime :html, :charset nil, :encoding nil, :language nil}}

>> authorize::handler-key >> :sign-in
2023-11-24T14:38:23.833Z NX-41294 DEBUG [leihs.procurement.authorization:135] - (skip? (:handler-key request)) => true
locale-wrap
wrap
2023-11-24T14:38:23.845Z NX-41294 DEBUG [leihs.procurement.authorization:150] - (authorize handler request) => {:status 200, :headers {"Content-Type" "text/html; charset=utf-8"}, :body "<!DOCTYPE html>\n<html><head><style>body { font-family: sans-serif; width: 400px; margin: 2rem auto; text-align: center; }\n             * { margin: 0.5rem; }\n             input { width: 15rem; }\n             .message { background-color: pink; padding: 1rem; }</style></head><body><h1>Leihs Simple Login</h1><p>For testing only</p><form action=\"/sign-in\" class=\"ui-form-signin\" method=\"POST\"><div><label>Username<input name=\"user\" type=\"text\"></label></div><div><label>Password<input name=\"password\" type=\"password\" value=\"\"></label></div><input name=\"csrf-token\" type=\"hidden\" value=\"23cf8ac9-7d12-48c8-9f18-ab8ce7611d71\"><input name=\"return-to\" type=\"hidden\" value=\"/favicon.ico\"><div><button type=\"submit\">Continue</button></div></form></body></html>"}
error-handler
>>> authenticate::skip= true  handler-key= :sign-in
>>> authenticate::authenticated-entity nil

>> authorize >

>> authorize::handler > #object[leihs.core.locale$wrap$fn__44344 0x4cd9b6e4 leihs.core.locale$wrap$fn__44344@4cd9b6e4]

>> authorize::request > {:cookies {leihs-anti-csrf-token {:value 23cf8ac9-7d12-48c8-9f18-ab8ce7611d71}}, :remote-addr 127.0.0.1, :start-time 491493592892166, :params {:user jimmie@goyette.com, :password nil, :csrf-token 23cf8ac9-7d12-48c8-9f18-ab8ce7611d71}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address your.lending.desk@example.com, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url nil, :sessions_force_uniqueness false, :email_signature Cheers,}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.pool.HikariProxyConnection 0x4d0cb08 HikariProxyConnection@80792328 wrapping org.postgresql.jdbc.PgConnection@e173a9d], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x9872380 next.jdbc.result_set$as_unqualified_lower_maps@9872380]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0, content-type application/x-www-form-urlencoded, cookie leihs-anti-csrf-token=23cf8ac9-7d12-48c8-9f18-ab8ce7611d71, content-length 83, sec-fetch-user ?1, referer http://localhost:3230/sign-in, connection keep-alive, upgrade-insecure-requests 1, accept text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8, accept-language de,en-US;q=0.7,en;q=0.3, sec-fetch-dest document, accept-encoding gzip, deflate, br, sec-fetch-mode navigate}, :async-channel #object[org.httpkit.server.AsyncChannel 0x7412054b /127.0.0.1:3230<->/127.0.0.1:63886], :server-port 3230, :params-raw {:user jimmie@goyette.com, :password , :csrf-token 23cf8ac9-7d12-48c8-9f18-ab8ce7611d71}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x5d479419 HikariDataSource (db-pool)], :connection #object[com.zaxxer.hikari.pool.HikariProxyConnection 0x1ffab652 HikariProxyConnection@536524370 wrapping org.postgresql.jdbc.PgConnection@145536f7], :level 1, :rollback #object[clojure.lang.Atom 0x5c6b650b {:status :ready, :val false}]}, :content-length 83, :form-params {:user jimmie@goyette.com, :password nil, :csrf-token 23cf8ac9-7d12-48c8-9f18-ab8ce7611d71}, :websocket? false, :query-params {}, :content-type application/x-www-form-urlencoded, :form-params-raw {:user jimmie@goyette.com, :password , :csrf-token 23cf8ac9-7d12-48c8-9f18-ab8ce7611d71}, :character-encoding utf8, :uri /sign-in, :server-name localhost, :handler-key :sign-in, :query-string nil, :body #object[org.httpkit.BytesInputStream 0x33cf2506 BytesInputStream[len=83]], :graphql-schema #CompiledSchema<>, :handler #object[compojure.core$routes$fn__27950 0x1a7fee3e compojure.core$routes$fn__27950@1a7fee3e], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :html, :charset nil, :encoding nil, :language nil}}

>> authorize::handler-key >> :sign-in
2023-11-24T14:38:23.957Z NX-41294 DEBUG [leihs.procurement.authorization:135] - (skip? (:handler-key request)) => true
locale-wrap
wrap
2023-11-24T14:38:23.974Z NX-41294 DEBUG [leihs.procurement.authorization:150] - (authorize handler request) => {:status 200, :headers {"Content-Type" "text/html; charset=utf-8"}, :body "<!DOCTYPE html>\n<html><head><style>body { font-family: sans-serif; width: 400px; margin: 2rem auto; text-align: center; }\n             * { margin: 0.5rem; }\n             input { width: 15rem; }\n             .message { background-color: pink; padding: 1rem; }</style></head><body><h1>Leihs Simple Login</h1><p>For testing only</p><form action=\"/sign-in\" class=\"ui-form-signin\" method=\"POST\"><div><label>Username<input name=\"user\" type=\"text\" value=\"jimmie@goyette.com\"></label></div><div><label>Password<input name=\"password\" type=\"password\" value=\"\"></label></div><input name=\"csrf-token\" type=\"hidden\" value=\"23cf8ac9-7d12-48c8-9f18-ab8ce7611d71\"><div><button type=\"submit\">Continue</button></div></form></body></html>"}
error-handler
>>> authenticate::skip= true  handler-key= :sign-in
>>> authenticate::authenticated-entity nil

>> authorize >

>> authorize::handler > #object[leihs.core.locale$wrap$fn__44344 0x4cd9b6e4 leihs.core.locale$wrap$fn__44344@4cd9b6e4]

>> authorize::request > {:cookies {leihs-anti-csrf-token {:value 23cf8ac9-7d12-48c8-9f18-ab8ce7611d71}}, :remote-addr 127.0.0.1, :start-time 491493677891333, :params {:user jimmie@goyette.com, :password password, :csrf-token 23cf8ac9-7d12-48c8-9f18-ab8ce7611d71}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address your.lending.desk@example.com, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url nil, :sessions_force_uniqueness false, :email_signature Cheers,}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.pool.HikariProxyConnection 0x4268be03 HikariProxyConnection@1114160643 wrapping org.postgresql.jdbc.PgConnection@e173a9d], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x9872380 next.jdbc.result_set$as_unqualified_lower_maps@9872380]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0, content-type application/x-www-form-urlencoded, cookie leihs-anti-csrf-token=23cf8ac9-7d12-48c8-9f18-ab8ce7611d71, content-length 91, sec-fetch-user ?1, referer http://localhost:3230/sign-in, connection keep-alive, upgrade-insecure-requests 1, accept text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8, accept-language de,en-US;q=0.7,en;q=0.3, sec-fetch-dest document, accept-encoding gzip, deflate, br, sec-fetch-mode navigate}, :async-channel #object[org.httpkit.server.AsyncChannel 0x68f469a1 /127.0.0.1:3230<->/127.0.0.1:63886], :server-port 3230, :params-raw {:user jimmie@goyette.com, :password password, :csrf-token 23cf8ac9-7d12-48c8-9f18-ab8ce7611d71}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x5d479419 HikariDataSource (db-pool)], :connection #object[com.zaxxer.hikari.pool.HikariProxyConnection 0x56ad2511 HikariProxyConnection@1454187793 wrapping org.postgresql.jdbc.PgConnection@145536f7], :level 1, :rollback #object[clojure.lang.Atom 0x33c0c5f7 {:status :ready, :val false}]}, :content-length 91, :form-params {:user jimmie@goyette.com, :password password, :csrf-token 23cf8ac9-7d12-48c8-9f18-ab8ce7611d71}, :websocket? false, :query-params {}, :content-type application/x-www-form-urlencoded, :form-params-raw {:user jimmie@goyette.com, :password password, :csrf-token 23cf8ac9-7d12-48c8-9f18-ab8ce7611d71}, :character-encoding utf8, :uri /sign-in, :server-name localhost, :handler-key :sign-in, :query-string nil, :body #object[org.httpkit.BytesInputStream 0x34dffd2a BytesInputStream[len=91]], :graphql-schema #CompiledSchema<>, :handler #object[compojure.core$routes$fn__27950 0x1a7fee3e compojure.core$routes$fn__27950@1a7fee3e], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :html, :charset nil, :encoding nil, :language nil}}

>> authorize::handler-key >> :sign-in
2023-11-24T14:38:24.028Z NX-41294 DEBUG [leihs.procurement.authorization:135] - (skip? (:handler-key request)) => true
locale-wrap
wrap
2023-11-24T14:38:24.115Z NX-41294 DEBUG [leihs.procurement.authorization:150] - (authorize handler request) => {:status 302, :headers {"Location" "/procure"}, :body "", :cookies {"leihs-user-session" {:value "0cda068d-267d-4ee3-bd82-5ab346439db5", :http-only true, :max-age 307584000, :path "/", :secure false}, "leihs-user-locale" {:value nil, :path "/", :max-age 0}}}
error-handler
>>> authenticate::skip= nil  handler-key= :procurement
>>> authenticate::authenticated-entity {:email jimmie@goyette.com, :contracts_count 0, :lastname Admin, :org_id nil, :scope_read true, :is_admin false, :authentication-method :session, :login nil, :scope_system_admin_write false, :scope_write true, :firstname Procurement, :scope_admin_write false, :user_session_created_at #time/instant "2023-11-24T14:38:24.058972Z", :id #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a", :user_session_id #uuid "7f0d7e30-2b24-4101-98da-41e13bf86e3d", :scope_system_admin_read false, :access-rights (), :user_id #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a", :is_system_admin false, :external_sign_out_url nil, :language_locale nil, :inventory_pool_roles_count 0, :scope_admin_read false}

>> authorize >

>> authorize::handler > #object[leihs.core.locale$wrap$fn__44344 0x4cd9b6e4 leihs.core.locale$wrap$fn__44344@4cd9b6e4]

>> authorize::request > {:authenticated-entity {:email jimmie@goyette.com, :contracts_count 0, :lastname Admin, :org_id nil, :scope_read true, :is_admin false, :authentication-method :session, :login nil, :scope_system_admin_write false, :scope_write true, :firstname Procurement, :scope_admin_write false, :user_session_created_at #time/instant "2023-11-24T14:38:24.058972Z", :id #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a", :user_session_id #uuid "7f0d7e30-2b24-4101-98da-41e13bf86e3d", :scope_system_admin_read false, :access-rights (), :user_id #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a", :is_system_admin false, :external_sign_out_url nil, :language_locale nil, :inventory_pool_roles_count 0, :scope_admin_read false}, :cookies {leihs-anti-csrf-token {:value 23cf8ac9-7d12-48c8-9f18-ab8ce7611d71}, leihs-user-session {:value 0cda068d-267d-4ee3-bd82-5ab346439db5}}, :remote-addr 127.0.0.1, :start-time 491493784614000, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address your.lending.desk@example.com, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url nil, :sessions_force_uniqueness false, :email_signature Cheers,}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x169d1b71 HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x9872380 next.jdbc.result_set$as_unqualified_lower_maps@9872380]}}, :query-params-raw {}, :route-params nil, :headers {sec-fetch-site same-origin, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0, cookie leihs-anti-csrf-token=23cf8ac9-7d12-48c8-9f18-ab8ce7611d71; leihs-user-session=0cda068d-267d-4ee3-bd82-5ab346439db5, sec-fetch-user ?1, referer http://localhost:3230/sign-in, connection keep-alive, upgrade-insecure-requests 1, accept text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8, accept-language de,en-US;q=0.7,en;q=0.3, sec-fetch-dest document, accept-encoding gzip, deflate, br, sec-fetch-mode navigate}, :async-channel #object[org.httpkit.server.AsyncChannel 0x2090be8b /127.0.0.1:3230<->/127.0.0.1:63886], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x5d479419 HikariDataSource (db-pool)]}, :content-length 0, :form-params {}, :websocket? false, :query-params {}, :content-type nil, :form-params-raw {}, :character-encoding utf8, :uri /procure, :server-name localhost, :handler-key :procurement, :query-string nil, :body nil, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.backend.html$not_found_handler 0x59fa2dff leihs.procurement.backend.html$not_found_handler@59fa2dff], :multipart-params {}, :scheme :http, :request-method :get, :accept {:mime :html, :charset nil, :encoding nil, :language nil}}

>> authorize::handler-key >> :procurement
2023-11-24T14:38:24.156Z NX-41294 DEBUG [leihs.procurement.authorization:135] - (skip? (:handler-key request)) => nil
2023-11-24T14:38:24.158Z NX-41294 DEBUG [leihs.procurement.permissions.user:27] - (sql-format (sql/where (sql/from (sql/select [true :has_entry]) :procurement_admins) [:= :user_id [:cast (:user_id auth-entity) :uuid]])) => ["SELECT TRUE AS has_entry FROM procurement_admins WHERE user_id = CAST(? AS UUID)" #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"]
2023-11-24T14:38:24.161Z NX-41294 DEBUG [leihs.procurement.permissions.user:50] - query => ["SELECT TRUE AS has_entry FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = ?" #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"]
2023-11-24T14:38:24.165Z NX-41294 DEBUG [leihs.procurement.permissions.user:72] - query => ["SELECT TRUE AS has_entry FROM procurement_category_viewers WHERE user_id = ?" #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"]
2023-11-24T14:38:24.167Z NX-41294 DEBUG [leihs.procurement.permissions.user:84] - (sql-format (sql/where (sql/from (sql/select [true :has_entry]) :procurement_requesters_organizations) [:= :user_id [:cast (:user_id auth-entity) :uuid]])) => ["SELECT TRUE AS has_entry FROM procurement_requesters_organizations WHERE user_id = CAST(? AS UUID)" #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"]
2023-11-24T14:38:24.169Z NX-41294 DEBUG [leihs.procurement.authorization:136] - (->> [user-perms/admin? user-perms/inspector? user-perms/viewer? user-perms/requester?] (map (fn* [p1__39153#] (p1__39153# (:tx-next request) (:authenticated-entity request)))) (some true?)) => true
locale-wrap
wrap
2023-11-24T14:38:24.172Z NX-41294 DEBUG [leihs.procurement.authorization:150] - (authorize handler request) => {:status 404, :headers {"Content-Length" "2299", "Last-Modified" "Fri, 24 Nov 2023 11:34:31 GMT", "Content-Type" "text/html"}, :body #object[java.io.File 0x1752407e "/Users/mradl/repos/leihs/procure/server/resources/public/procure/client/index.html"]}
error-handler
error-handler
error-handler
>>> authenticate::skip= nil  handler-key= :not-found
>>> authenticate::authenticated-entity {:email jimmie@goyette.com, :contracts_count 0, :lastname Admin, :org_id nil, :scope_read true, :is_admin false, :authentication-method :session, :login nil, :scope_system_admin_write false, :scope_write true, :firstname Procurement, :scope_admin_write false, :user_session_created_at #time/instant "2023-11-24T14:38:24.058972Z", :id #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a", :user_session_id #uuid "7f0d7e30-2b24-4101-98da-41e13bf86e3d", :scope_system_admin_read false, :access-rights (), :user_id #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a", :is_system_admin false, :external_sign_out_url nil, :language_locale nil, :inventory_pool_roles_count 0, :scope_admin_read false}

>> authorize >

>> authorize::handler > #object[leihs.core.locale$wrap$fn__44344 0x4cd9b6e4 leihs.core.locale$wrap$fn__44344@4cd9b6e4]

>> authorize::request > {:authenticated-entity {:email jimmie@goyette.com, :contracts_count 0, :lastname Admin, :org_id nil, :scope_read true, :is_admin false, :authentication-method :session, :login nil, :scope_system_admin_write false, :scope_write true, :firstname Procurement, :scope_admin_write false, :user_session_created_at #time/instant "2023-11-24T14:38:24.058972Z", :id #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a", :user_session_id #uuid "7f0d7e30-2b24-4101-98da-41e13bf86e3d", :scope_system_admin_read false, :access-rights (), :user_id #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a", :is_system_admin false, :external_sign_out_url nil, :language_locale nil, :inventory_pool_roles_count 0, :scope_admin_read false}, :cookies {leihs-anti-csrf-token {:value 23cf8ac9-7d12-48c8-9f18-ab8ce7611d71}, leihs-user-session {:value 0cda068d-267d-4ee3-bd82-5ab346439db5}}, :remote-addr 127.0.0.1, :start-time 491494026777708, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address your.lending.desk@example.com, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url nil, :sessions_force_uniqueness false, :email_signature Cheers,}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x169d1b71 HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x9872380 next.jdbc.result_set$as_unqualified_lower_maps@9872380]}}, :query-params-raw {}, :route-params nil, :headers {sec-fetch-site same-origin, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0, cookie leihs-anti-csrf-token=23cf8ac9-7d12-48c8-9f18-ab8ce7611d71; leihs-user-session=0cda068d-267d-4ee3-bd82-5ab346439db5, referer http://localhost:3230/procure, connection keep-alive, accept image/avif,image/webp,*/*, accept-language de,en-US;q=0.7,en;q=0.3, sec-fetch-dest image, accept-encoding gzip, deflate, br, sec-fetch-mode no-cors}, :async-channel #object[org.httpkit.server.AsyncChannel 0x390da1df /127.0.0.1:3230<->/127.0.0.1:63887], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x5d479419 HikariDataSource (db-pool)]}, :content-length 0, :form-params {}, :websocket? false, :query-params {}, :content-type nil, :form-params-raw {}, :character-encoding utf8, :uri /procure/favicon.ico, :server-name localhost, :handler-key :not-found, :query-string nil, :body nil, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.backend.html$not_found_handler 0x59fa2dff leihs.procurement.backend.html$not_found_handler@59fa2dff], :multipart-params {}, :scheme :http, :request-method :get, :accept {:mime :html, :charset nil, :encoding nil, :language nil}}

>> authorize::handler-key >> :not-found
2023-11-24T14:38:24.381Z NX-41294 DEBUG [leihs.procurement.authorization:135] - (skip? (:handler-key request)) => nil
error-handler
2023-11-24T14:38:24.383Z NX-41294 DEBUG [leihs.procurement.permissions.user:27] - (sql-format (sql/where (sql/from (sql/select [true :has_entry]) :procurement_admins) [:= :user_id [:cast (:user_id auth-entity) :uuid]])) => ["SELECT TRUE AS has_entry FROM procurement_admins WHERE user_id = CAST(? AS UUID)" #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"]
2023-11-24T14:38:24.385Z NX-41294 DEBUG [leihs.procurement.permissions.user:50] - query => ["SELECT TRUE AS has_entry FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = ?" #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"]
2023-11-24T14:38:24.386Z NX-41294 DEBUG [leihs.procurement.permissions.user:72] - query => ["SELECT TRUE AS has_entry FROM procurement_category_viewers WHERE user_id = ?" #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"]
2023-11-24T14:38:24.386Z NX-41294 DEBUG [leihs.procurement.permissions.user:84] - (sql-format (sql/where (sql/from (sql/select [true :has_entry]) :procurement_requesters_organizations) [:= :user_id [:cast (:user_id auth-entity) :uuid]])) => ["SELECT TRUE AS has_entry FROM procurement_requesters_organizations WHERE user_id = CAST(? AS UUID)" #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"]
2023-11-24T14:38:24.387Z NX-41294 DEBUG [leihs.procurement.authorization:136] - (->> [user-perms/admin? user-perms/inspector? user-perms/viewer? user-perms/requester?] (map (fn* [p1__39153#] (p1__39153# (:tx-next request) (:authenticated-entity request)))) (some true?)) => true
locale-wrap
wrap
2023-11-24T14:38:24.388Z NX-41294 DEBUG [leihs.procurement.authorization:150] - (authorize handler request) => {:status 404, :headers {"Content-Length" "2299", "Last-Modified" "Fri, 24 Nov 2023 11:34:31 GMT", "Content-Type" "text/html"}, :body #object[java.io.File 0x1d991caf "/Users/mradl/repos/leihs/procure/server/resources/public/procure/client/index.html"]}
>>> authenticate::skip= nil  handler-key= :graphql
>>> authenticate::authenticated-entity {:email jimmie@goyette.com, :contracts_count 0, :lastname Admin, :org_id nil, :scope_read true, :is_admin false, :authentication-method :session, :login nil, :scope_system_admin_write false, :scope_write true, :firstname Procurement, :scope_admin_write false, :user_session_created_at #time/instant "2023-11-24T14:38:24.058972Z", :id #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a", :user_session_id #uuid "7f0d7e30-2b24-4101-98da-41e13bf86e3d", :scope_system_admin_read false, :access-rights (), :user_id #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a", :is_system_admin false, :external_sign_out_url nil, :language_locale nil, :inventory_pool_roles_count 0, :scope_admin_read false}

>> authorize >

>> authorize::handler > #object[leihs.core.locale$wrap$fn__44344 0x4cd9b6e4 leihs.core.locale$wrap$fn__44344@4cd9b6e4]

>> authorize::request > {:authenticated-entity {:email jimmie@goyette.com, :contracts_count 0, :lastname Admin, :org_id nil, :scope_read true, :is_admin false, :authentication-method :session, :login nil, :scope_system_admin_write false, :scope_write true, :firstname Procurement, :scope_admin_write false, :user_session_created_at #time/instant "2023-11-24T14:38:24.058972Z", :id #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a", :user_session_id #uuid "7f0d7e30-2b24-4101-98da-41e13bf86e3d", :scope_system_admin_read false, :access-rights (), :user_id #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a", :is_system_admin false, :external_sign_out_url nil, :language_locale nil, :inventory_pool_roles_count 0, :scope_admin_read false}, :cookies {leihs-anti-csrf-token {:value 23cf8ac9-7d12-48c8-9f18-ab8ce7611d71}, leihs-user-session {:value 0cda068d-267d-4ee3-bd82-5ab346439db5}}, :remote-addr 127.0.0.1, :start-time 491494038435375, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address your.lending.desk@example.com, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url nil, :sessions_force_uniqueness false, :email_signature Cheers,}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x169d1b71 HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x9872380 next.jdbc.result_set$as_unqualified_lower_maps@9872380]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0, content-type application/json, cookie leihs-anti-csrf-token=23cf8ac9-7d12-48c8-9f18-ab8ce7611d71; leihs-user-session=0cda068d-267d-4ee3-bd82-5ab346439db5, content-length 502, referer http://localhost:3230/procure, connection keep-alive, x-csrf-token 23cf8ac9-7d12-48c8-9f18-ab8ce7611d71, accept application/json, accept-language de,en-US;q=0.7,en;q=0.3, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors}, :async-channel #object[org.httpkit.server.AsyncChannel 0x709d6132 /127.0.0.1:3230<->/127.0.0.1:63886], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x5d479419 HikariDataSource (db-pool)]}, :content-length 502, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:operationName me, :variables {}, :query query me {
  current_user {
    navbarProps
    user {
      id
      firstname
      lastname
      permissions {
        isAdmin
        isRequester
        isInspectorForCategories {
          id
          __typename
        }
        isViewerForCategories {
          id
          __typename
        }
        __typename
      }
      __typename
    }
    __typename
  }
  settings {
    contact_url
    __typename
  }
}
}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0x76d5b192 leihs.procurement.graphql$handler@76d5b192], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>> authorize::handler-key >> :graphql
2023-11-24T14:38:24.432Z NX-41294 DEBUG [leihs.procurement.authorization:135] - (skip? (:handler-key request)) => nil
2023-11-24T14:38:24.432Z NX-41294 DEBUG [leihs.procurement.permissions.user:27] - (sql-format (sql/where (sql/from (sql/select [true :has_entry]) :procurement_admins) [:= :user_id [:cast (:user_id auth-entity) :uuid]])) => ["SELECT TRUE AS has_entry FROM procurement_admins WHERE user_id = CAST(? AS UUID)" #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"]
2023-11-24T14:38:24.434Z NX-41294 DEBUG [leihs.procurement.permissions.user:50] - query => ["SELECT TRUE AS has_entry FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = ?" #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"]
2023-11-24T14:38:24.434Z NX-41294 DEBUG [leihs.procurement.permissions.user:72] - query => ["SELECT TRUE AS has_entry FROM procurement_category_viewers WHERE user_id = ?" #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"]
2023-11-24T14:38:24.435Z NX-41294 DEBUG [leihs.procurement.permissions.user:84] - (sql-format (sql/where (sql/from (sql/select [true :has_entry]) :procurement_requesters_organizations) [:= :user_id [:cast (:user_id auth-entity) :uuid]])) => ["SELECT TRUE AS has_entry FROM procurement_requesters_organizations WHERE user_id = CAST(? AS UUID)" #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"]
2023-11-24T14:38:24.435Z NX-41294 DEBUG [leihs.procurement.authorization:136] - (->> [user-perms/admin? user-perms/inspector? user-perms/viewer? user-perms/requester?] (map (fn* [p1__39153#] (p1__39153# (:tx-next request) (:authenticated-entity request)))) (some true?)) => true
locale-wrap
wrap

>>>exec-query::variables {}
>>>1 #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"
2023-11-24T14:38:24.450Z NX-41294 DEBUG [leihs.procurement.resources.user:75] - id => #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"
>>>2 {:id #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a", :firstname Procurement, :lastname Admin}
>>oida>> #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"
2023-11-24T14:38:24.455Z NX-41294 DEBUG [leihs.procurement.resources.saved-filters:19] - (-> (sql/select :*) (sql/from :procurement_users_filters) (sql/where [:= :user_id [:cast user-id :uuid]]) sql-format) => ["SELECT * FROM procurement_users_filters WHERE user_id = CAST(? AS UUID)" #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"]
>>>3 nil
2023-11-24T14:38:24.486Z NX-41294 DEBUG [leihs.procurement.permissions.user:27] - (sql-format (sql/where (sql/from (sql/select [true :has_entry]) :procurement_admins) [:= :user_id [:cast (:user_id auth-entity) :uuid]])) => ["SELECT TRUE AS has_entry FROM procurement_admins WHERE user_id = CAST(? AS UUID)" #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"]
2023-11-24T14:38:24.487Z NX-41294 DEBUG [leihs.procurement.permissions.user:84] - (sql-format (sql/where (sql/from (sql/select [true :has_entry]) :procurement_requesters_organizations) [:= :user_id [:cast (:user_id auth-entity) :uuid]])) => ["SELECT TRUE AS has_entry FROM procurement_requesters_organizations WHERE user_id = CAST(? AS UUID)" #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"]

>>>pure-handler {:data #ordered/map ([:current_user #ordered/map ([:navbarProps {"csrfToken":{"value":"23cf8ac9-7d12-48c8-9f18-ab8ce7611d71","name":"csrf-token"},"config":{"appTitle":"leihs","appColor":"gray","me":{"user":{"id":"6bb5ae22-0b32-4322-be6f-3410ab7e399a","firstname":"Procurement","lastname":"Admin","login":null,"email":"jimmie@goyette.com"}},"subApps":{"borrow":false,"admin":false,"procure":false,"manage":[]},"locales":[{"name":"English (UK)","locale":"en-GB","active":true,"isDefault":true,"isSelected":true},{"name":"English (US)","locale":"en-US","active":true,"isDefault":false,"isSelected":false},{"name":"Deutsch","locale":"de-CH","active":true,"isDefault":false,"isSelected":false},{"name":"Züritüütsch","locale":"gsw-CH","active":true,"isDefault":false,"isSelected":false}]}}] [:user #ordered/map ([:id 6bb5ae22-0b32-4322-be6f-3410ab7e399a] [:firstname Procurement] [:lastname Admin] [:permissions #ordered/map ([:isAdmin true] [:isRequester false] [:isInspectorForCategories []] [:isViewerForCategories []] [:__typename :UserPermissions])] [:__typename :User])] [:__typename :CurrentUser])] [:settings #ordered/map ([:contact_url nil] [:__typename :ProcurementSettings])])}
2023-11-24T14:38:24.500Z NX-41294 DEBUG [leihs.procurement.graphql:71] - result => {:data #ordered/map ([:current_user #ordered/map ([:navbarProps "{\"csrfToken\":{\"value\":\"23cf8ac9-7d12-48c8-9f18-ab8ce7611d71\",\"name\":\"csrf-token\"},\"config\":{\"appTitle\":\"leihs\",\"appColor\":\"gray\",\"me\":{\"user\":{\"id\":\"6bb5ae22-0b32-4322-be6f-3410ab7e399a\",\"firstname\":\"Procurement\",\"lastname\":\"Admin\",\"login\":null,\"email\":\"jimmie@goyette.com\"}},\"subApps\":{\"borrow\":false,\"admin\":false,\"procure\":false,\"manage\":[]},\"locales\":[{\"name\":\"English (UK)\",\"locale\":\"en-GB\",\"active\":true,\"isDefault\":true,\"isSelected\":true},{\"name\":\"English (US)\",\"locale\":\"en-US\",\"active\":true,\"isDefault\":false,\"isSelected\":false},{\"name\":\"Deutsch\",\"locale\":\"de-CH\",\"active\":true,\"isDefault\":false,\"isSelected\":false},{\"name\":\"Züritüütsch\",\"locale\":\"gsw-CH\",\"active\":true,\"isDefault\":false,\"isSelected\":false}]}}"] [:user #ordered/map ([:id "6bb5ae22-0b32-4322-be6f-3410ab7e399a"] [:firstname "Procurement"] [:lastname "Admin"] [:permissions #ordered/map ([:isAdmin true] [:isRequester false] [:isInspectorForCategories []] [:isViewerForCategories []] [:__typename :UserPermissions])] [:__typename :User])] [:__typename :CurrentUser])] [:settings #ordered/map ([:contact_url nil] [:__typename :ProcurementSettings])])}
2023-11-24T14:38:24.501Z NX-41294 DEBUG [leihs.procurement.authorization:150] - (authorize handler request) => {:body {:data #ordered/map ([:current_user #ordered/map ([:navbarProps "{\"csrfToken\":{\"value\":\"23cf8ac9-7d12-48c8-9f18-ab8ce7611d71\",\"name\":\"csrf-token\"},\"config\":{\"appTitle\":\"leihs\",\"appColor\":\"gray\",\"me\":{\"user\":{\"id\":\"6bb5ae22-0b32-4322-be6f-3410ab7e399a\",\"firstname\":\"Procurement\",\"lastname\":\"Admin\",\"login\":null,\"email\":\"jimmie@goyette.com\"}},\"subApps\":{\"borrow\":false,\"admin\":false,\"procure\":false,\"manage\":[]},\"locales\":[{\"name\":\"English (UK)\",\"locale\":\"en-GB\",\"active\":true,\"isDefault\":true,\"isSelected\":true},{\"name\":\"English (US)\",\"locale\":\"en-US\",\"active\":true,\"isDefault\":false,\"isSelected\":false},{\"name\":\"Deutsch\",\"locale\":\"de-CH\",\"active\":true,\"isDefault\":false,\"isSelected\":false},{\"name\":\"Züritüütsch\",\"locale\":\"gsw-CH\",\"active\":true,\"isDefault\":false,\"isSelected\":false}]}}"] [:user #ordered/map ([:id "6bb5ae22-0b32-4322-be6f-3410ab7e399a"] [:firstname "Procurement"] [:lastname "Admin"] [:permissions #ordered/map ([:isAdmin true] [:isRequester false] [:isInspectorForCategories []] [:isViewerForCategories []] [:__typename :UserPermissions])] [:__typename :User])] [:__typename :CurrentUser])] [:settings #ordered/map ([:contact_url nil] [:__typename :ProcurementSettings])])}}
error-handlererror-handler

error-handler
>>> authenticate::skip= nil  handler-key= :graphql
>>> authenticate::authenticated-entity {:email jimmie@goyette.com, :contracts_count 0, :lastname Admin, :org_id nil, :scope_read true, :is_admin false, :authentication-method :session, :login nil, :scope_system_admin_write false, :scope_write true, :firstname Procurement, :scope_admin_write false, :user_session_created_at #time/instant "2023-11-24T14:38:24.058972Z", :id #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a", :user_session_id #uuid "7f0d7e30-2b24-4101-98da-41e13bf86e3d", :scope_system_admin_read false, :access-rights (), :user_id #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a", :is_system_admin false, :external_sign_out_url nil, :language_locale nil, :inventory_pool_roles_count 0, :scope_admin_read false}

>> authorize >

>> authorize::handler > #object[leihs.core.locale$wrap$fn__44344 0x4cd9b6e4 leihs.core.locale$wrap$fn__44344@4cd9b6e4]

>> authorize::request > {:authenticated-entity {:email jimmie@goyette.com, :contracts_count 0, :lastname Admin, :org_id nil, :scope_read true, :is_admin false, :authentication-method :session, :login nil, :scope_system_admin_write false, :scope_write true, :firstname Procurement, :scope_admin_write false, :user_session_created_at #time/instant "2023-11-24T14:38:24.058972Z", :id #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a", :user_session_id #uuid "7f0d7e30-2b24-4101-98da-41e13bf86e3d", :scope_system_admin_read false, :access-rights (), :user_id #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a", :is_system_admin false, :external_sign_out_url nil, :language_locale nil, :inventory_pool_roles_count 0, :scope_admin_read false}, :cookies {leihs-anti-csrf-token {:value 23cf8ac9-7d12-48c8-9f18-ab8ce7611d71}, leihs-user-session {:value 0cda068d-267d-4ee3-bd82-5ab346439db5}}, :remote-addr 127.0.0.1, :start-time 491494259985958, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address your.lending.desk@example.com, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url nil, :sessions_force_uniqueness false, :email_signature Cheers,}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x169d1b71 HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x9872380 next.jdbc.result_set$as_unqualified_lower_maps@9872380]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0, content-type application/json, cookie leihs-anti-csrf-token=23cf8ac9-7d12-48c8-9f18-ab8ce7611d71; leihs-user-session=0cda068d-267d-4ee3-bd82-5ab346439db5, content-length 502, referer http://localhost:3230/procure/requests, connection keep-alive, x-csrf-token 23cf8ac9-7d12-48c8-9f18-ab8ce7611d71, accept application/json, accept-language de,en-US;q=0.7,en;q=0.3, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors}, :async-channel #object[org.httpkit.server.AsyncChannel 0x1a55f994 /127.0.0.1:3230<->/127.0.0.1:63888], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x5d479419 HikariDataSource (db-pool)]}, :content-length 502, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:operationName me, :variables {}, :query query me {
  current_user {
    navbarProps
    user {
      id
      firstname
      lastname
      permissions {
        isAdmin
        isRequester
        isInspectorForCategories {
          id
          __typename
        }
        isViewerForCategories {
          id
          __typename
        }
        __typename
      }
      __typename
    }
    __typename
  }
  settings {
    contact_url
    __typename
  }
}
}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0x76d5b192 leihs.procurement.graphql$handler@76d5b192], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>> authorize::handler-key >> :graphql
2023-11-24T14:38:24.623Z NX-41294 DEBUG [leihs.procurement.authorization:135] - (skip? (:handler-key request)) => nil
2023-11-24T14:38:24.624Z NX-41294 DEBUG [leihs.procurement.permissions.user:27] - (sql-format (sql/where (sql/from (sql/select [true :has_entry]) :procurement_admins) [:= :user_id [:cast (:user_id auth-entity) :uuid]])) => ["SELECT TRUE AS has_entry FROM procurement_admins WHERE user_id = CAST(? AS UUID)" #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"]
2023-11-24T14:38:24.625Z NX-41294 DEBUG [leihs.procurement.permissions.user:50] - query => ["SELECT TRUE AS has_entry FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = ?" #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"]
2023-11-24T14:38:24.626Z NX-41294 DEBUG [leihs.procurement.permissions.user:72] - query => ["SELECT TRUE AS has_entry FROM procurement_category_viewers WHERE user_id = ?" #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"]
2023-11-24T14:38:24.626Z NX-41294 DEBUG [leihs.procurement.permissions.user:84] - (sql-format (sql/where (sql/from (sql/select [true :has_entry]) :procurement_requesters_organizations) [:= :user_id [:cast (:user_id auth-entity) :uuid]])) => ["SELECT TRUE AS has_entry FROM procurement_requesters_organizations WHERE user_id = CAST(? AS UUID)" #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"]
2023-11-24T14:38:24.627Z NX-41294 DEBUG [leihs.procurement.authorization:136] - (->> [user-perms/admin? user-perms/inspector? user-perms/viewer? user-perms/requester?] (map (fn* [p1__39153#] (p1__39153# (:tx-next request) (:authenticated-entity request)))) (some true?)) => true
locale-wrap
wrap

>>>exec-query::variables {}
>>>1 #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"
2023-11-24T14:38:24.633Z NX-41294 DEBUG [leihs.procurement.resources.user:75] - id => #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"
>>>2 {:id #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a", :firstname Procurement, :lastname Admin}
>>oida>> #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"
2023-11-24T14:38:24.634Z NX-41294 DEBUG [leihs.procurement.resources.saved-filters:19] - (-> (sql/select :*) (sql/from :procurement_users_filters) (sql/where [:= :user_id [:cast user-id :uuid]]) sql-format) => ["SELECT * FROM procurement_users_filters WHERE user_id = CAST(? AS UUID)" #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"]
>>>3 nil
>>> authenticate::skip= nil  handler-key= :graphql
>>> authenticate::authenticated-entity {:email jimmie@goyette.com, :contracts_count 0, :lastname Admin, :org_id nil, :scope_read true, :is_admin false, :authentication-method :session, :login nil, :scope_system_admin_write false, :scope_write true, :firstname Procurement, :scope_admin_write false, :user_session_created_at #time/instant "2023-11-24T14:38:24.058972Z", :id #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a", :user_session_id #uuid "7f0d7e30-2b24-4101-98da-41e13bf86e3d", :scope_system_admin_read false, :access-rights (), :user_id #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a", :is_system_admin false, :external_sign_out_url nil, :language_locale nil, :inventory_pool_roles_count 0, :scope_admin_read false}

>> authorize >

>> authorize::handler > #object[leihs.core.locale$wrap$fn__44344 0x4cd9b6e4 leihs.core.locale$wrap$fn__44344@4cd9b6e4]

>> authorize::request > {:authenticated-entity {:email jimmie@goyette.com, :contracts_count 0, :lastname Admin, :org_id nil, :scope_read true, :is_admin false, :authentication-method :session, :login nil, :scope_system_admin_write false, :scope_write true, :firstname Procurement, :scope_admin_write false, :user_session_created_at #time/instant "2023-11-24T14:38:24.058972Z", :id #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a", :user_session_id #uuid "7f0d7e30-2b24-4101-98da-41e13bf86e3d", :scope_system_admin_read false, :access-rights (), :user_id #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a", :is_system_admin false, :external_sign_out_url nil, :language_locale nil, :inventory_pool_roles_count 0, :scope_admin_read false}, :cookies {leihs-anti-csrf-token {:value 23cf8ac9-7d12-48c8-9f18-ab8ce7611d71}, leihs-user-session {:value 0cda068d-267d-4ee3-bd82-5ab346439db5}}, :remote-addr 127.0.0.1, :start-time 491494259246291, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address your.lending.desk@example.com, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url nil, :sessions_force_uniqueness false, :email_signature Cheers,}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x169d1b71 HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x9872380 next.jdbc.result_set$as_unqualified_lower_maps@9872380]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0, content-type application/json, cookie leihs-anti-csrf-token=23cf8ac9-7d12-48c8-9f18-ab8ce7611d71; leihs-user-session=0cda068d-267d-4ee3-bd82-5ab346439db5, content-length 3575, referer http://localhost:3230/procure/requests, connection keep-alive, x-csrf-token 23cf8ac9-7d12-48c8-9f18-ab8ce7611d71, accept application/json, accept-language de,en-US;q=0.7,en;q=0.3, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors}, :async-channel #object[org.httpkit.server.AsyncChannel 0x1d1f4470 /127.0.0.1:3230<->/127.0.0.1:63887], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x5d479419 HikariDataSource (db-pool)]}, :content-length 3575, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:operationName RequestsIndexFiltered, :variables {}, :query query RequestsIndexFiltered($budgetPeriods: [ID!], $categories: [ID!], $search: String, $state: [State!], $order_status: [OrderStatus], $organizations: [ID!], $priority: [Priority!], $inspector_priority: [InspectorPriority!], $onlyOwnRequests: Boolean) {
  dashboard(budget_period_id: $budgetPeriods, category_id: $categories, search: $search, state: $state, order_status: $order_status, organization_id: $organizations, priority: $priority, inspector_priority: $inspector_priority, requested_by_auth_user: $onlyOwnRequests) {
    cacheKey
    total_count
    budget_periods {
      id
      cacheKey
      name
      inspection_start_date
      end_date
      total_price_cents
      main_categories {
        id
        cacheKey
        name
        image_url
        total_price_cents
        categories {
          id
          cacheKey
          name
          total_price_cents
          requests {
            ...RequestFieldsForIndex
            total_price_cents
            actionPermissions {
              edit
              __typename
            }
            __typename
          }
          __typename
        }
        __typename
      }
      __typename
    }
    __typename
  }
}

fragment RequestFieldsForIndex on Request {
  id
  short_id
  user {
    value {
      id
      firstname
      lastname
      __typename
    }
    __typename
  }
  category {
    read
    write
    required
    value {
      id
      name
      main_category {
        id
        name
        __typename
      }
      __typename
    }
    __typename
  }
  budget_period {
    read
    write
    required
    value {
      name
      id
      __typename
    }
    __typename
  }
  article_name {
    value
    __typename
  }
  model {
    value {
      id
      product
      version
      __typename
    }
    __typename
  }
  receiver {
    value
    __typename
  }
  organization {
    value {
      id
      name
      shortname
      department {
        id
        name
        __typename
      }
      __typename
    }
    __typename
  }
  price_cents {
    value
    __typename
  }
  price_currency {
    value
    __typename
  }
  requested_quantity {
    read
    value
    __typename
  }
  approved_quantity {
    read
    value
    __typename
  }
  order_quantity {
    read
    value
    __typename
  }
  replacement {
    value
    __typename
  }
  priority {
    value
    __typename
  }
  state
  article_number {
    value
    __typename
  }
  supplier {
    value {
      name
      __typename
    }
    __typename
  }
  supplier_name {
    value
    __typename
  }
  receiver {
    value
    __typename
  }
  room {
    value {
      id
      name
      building {
        id
        name
        __typename
      }
      __typename
    }
    __typename
  }
  motivation {
    value
    __typename
  }
  inspection_comment {
    value
    __typename
  }
  inspector_priority {
    value
    __typename
  }
  accounting_type {
    value
    __typename
  }
  cost_center {
    value
    __typename
  }
  general_ledger_account {
    value
    __typename
  }
  procurement_account {
    value
    __typename
  }
  internal_order_number {
    value
    __typename
  }
  order_status {
    value
    __typename
  }
  order_comment {
    value
    __typename
  }
  __typename
}
}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0x76d5b192 leihs.procurement.graphql$handler@76d5b192], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}
2023-11-24T14:38:24.643Z NX-41294 DEBUG [leihs.procurement.permissions.user:27] - (sql-format (sql/where (sql/from (sql/select [true :has_entry]) :procurement_admins) [:= :user_id [:cast (:user_id auth-entity) :uuid]])) => ["SELECT TRUE AS has_entry FROM procurement_admins WHERE user_id = CAST(? AS UUID)" #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"]
>>> authenticate::skip=
>> authorize::handler-key >>nil   handler-key= :graphql:graphql

>>> authenticate::authenticated-entity {:email jimmie@goyette.com, :contracts_count 0, :lastname Admin, :org_id nil, :scope_read true, :is_admin false, :authentication-method :session, :login nil, :scope_system_admin_write false, :scope_write true, :firstname Procurement, :scope_admin_write false, :user_session_created_at #time/instant "2023-11-24T14:38:24.058972Z", :id #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a", :user_session_id #uuid "7f0d7e30-2b24-4101-98da-41e13bf86e3d", :scope_system_admin_read false, :access-rights (), :user_id #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a", :is_system_admin false, :external_sign_out_url nil, :language_locale nil, :inventory_pool_roles_count 0, :scope_admin_read false}
2023-11-24T14:38:24.648Z NX-41294 DEBUG [leihs.procurement.permissions.user:84] - (sql-format (sql/where (sql/from (sql/select [true :has_entry]) :procurement_requesters_organizations) [:= :user_id [:cast (:user_id auth-entity) :uuid]])) => ["SELECT TRUE AS has_entry FROM procurement_requesters_organizations WHERE user_id = CAST(? AS UUID)" #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"]

>> authorize >2023-11-24T14:38:24.647Z NX-41294 DEBUG [leihs.procurement.authorization:135] - (skip? (:handler-key request)) => nil


>> authorize::handler > #object[leihs.core.locale$wrap$fn__44344 0x4cd9b6e4 leihs.core.locale$wrap$fn__44344@4cd9b6e4]

>> authorize::request > {:authenticated-entity {:email jimmie@goyette.com, :contracts_count 0, :lastname Admin, :org_id nil, :scope_read true, :is_admin false, :authentication-method :session, :login nil, :scope_system_admin_write false, :scope_write true, :firstname Procurement, :scope_admin_write false, :user_session_created_at #time/instant "2023-11-24T14:38:24.058972Z", :id #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a", :user_session_id #uuid "7f0d7e30-2b24-4101-98da-41e13bf86e3d", :scope_system_admin_read false, :access-rights (), :user_id #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a", :is_system_admin false, :external_sign_out_url nil, :language_locale nil, :inventory_pool_roles_count 0, :scope_admin_read false}, :cookies {leihs-anti-csrf-token {:value 23cf8ac9-7d12-48c8-9f18-ab8ce7611d71}, leihs-user-session {:value 0cda068d-267d-4ee3-bd82-5ab346439db5}}, :remote-addr 127.0.0.1, :start-time 491494259330458, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address your.lending.desk@example.com, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url nil, :sessions_force_uniqueness false, :email_signature Cheers,}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x169d1b71 HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x9872380 next.jdbc.result_set$as_unqualified_lower_maps@9872380]}}, :query-params-raw {}, :route-params nil, :headers {2023-11-24T14:38:24.650Z NX-41294 DEBUG [leihs.procurement.permissions.user:27] - (sql-format (sql/where (sql/from (sql/select [true :has_entry]) :procurement_admins) [:= :user_id [:cast (:user_id auth-entity) :uuid]])) => ["SELECT TRUE AS has_entry FROM procurement_admins WHERE user_id = CAST(? AS UUID)" #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"]
origin
>>>pure-handler  {:data #ordered/map (http://localhost:3230, [sec-fetch-site same-origin, :current_userhost  localhost:3230, #ordered/map user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0, content-type application/json, cookie (leihs-anti-csrf-token=23cf8ac9-7d12-48c8-9f18-ab8ce7611d71; leihs-user-session=0cda068d-267d-4ee3-bd82-5ab346439db5, content-length 534, referer http://localhost:3230/procure/requests, connection [keep-alive, x-csrf-token 23cf8ac9-7d12-48c8-9f18-ab8ce7611d71, :navbarPropsaccept  application/json, accept-language {"csrfToken":{"value":"23cf8ac9-7d12-48c8-9f18-ab8ce7611d71","name":"csrf-token"},"config":{"appTitle":"leihs","appColor":"gray","me":{"user":{"id":"6bb5ae22-0b32-4322-be6f-3410ab7e399a","firstname":"Procurement","lastname":"Admin","login":null,"email":"jimmie@goyette.com"}},"subApps":{"borrow":false,"admin":false,"procure":false,"manage":[]},"locales":[{"name":"English (UK)","locale":"en-GB","active":true,"isDefault":true,"isSelected":true},{"name":"English (US)","locale":"en-US","active":true,"isDefault":false,"isSelected":false},{"name":"Deutsch","locale":"de-CH","active":true,"isDefault":false,"isSelected":false},{"name":"Züritüütsch","locale":"gsw-CH","active":true,"isDefault":false,"isSelected":false}]}}de,en-US;q=0.7,en;q=0.3],  sec-fetch-dest empty, accept-encoding [gzip, deflate, br, sec-fetch-mode cors}:user,  :async-channel #ordered/map ([:id 6bb5ae22-0b32-4322-be6f-3410ab7e399a] [#object[:firstnameorg.httpkit.server.AsyncChannel  Procurement] [:lastname Admin] [:permissions #ordered/map ([:isAdmin 0x357342fe /127.0.0.1:3230<->/127.0.0.1:63886true]],  :server-port 3230, [:params-raw :isRequester false]{ }, :tx {[:datasource :isInspectorForCategories #object[com.zaxxer.hikari.HikariDataSource []] [0x5d479419 :isViewerForCategoriesHikariDataSource (db-pool) ]}, :content-length 534, :form-params [{]}],  :websocket? false, :query-params {}, [:content-type application/json, :form-params-raw :__typename{ }, :character-encoding :UserPermissionsutf8], ):uri]  /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, [:body :__typename{ :operationName RequestFilters, :User:variables ]{)}],  :query query RequestFilters {
  budget_periods {
    id
    name
    inspection_start_date
    end_date
    __typename
  }
  main_categories {
    id
    name
    categories {
      id
      name
      __typename
    }
    __typename
  }
  organizations(root_only: true) {
    ...OrgProps
    organizations {
      ...OrgProps
      __typename
    }
    __typename
  }
}

fragment OrgProps on Organization {
  id
  name
  shortname
  __typename
}
}, :graphql-schema #CompiledSchema<>, [:handler :__typename#object[ leihs.procurement.graphql$handler:CurrentUser ]0x76d5b192 )leihs.procurement.graphql$handler@76d5b192]] , :multipart-params {}, [:scheme :http, :request-method :settings:post , :accept #ordered/map {:mime :json, :charset nil, :encoding nil, :language nil}}(
2023-11-24T14:38:24.653Z NX-41294 DEBUG [leihs.procurement.permissions.user:50] - query => ["SELECT TRUE AS has_entry FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = ?" #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"]

>> authorize::handler-key >> :graphql
[:contact_url nil] [:__typename :ProcurementSettings])])}
2023-11-24T14:38:24.659Z NX-41294 DEBUG [leihs.procurement.graphql:71] - result => {:data #ordered/map ([:current_user #ordered/map ([:navbarProps "{\"csrfToken\":{\"value\":\"23cf8ac9-7d12-48c8-9f18-ab8ce7611d71\",\"name\":\"csrf-token\"},\"config\":{\"appTitle\":\"leihs\",\"appColor\":\"gray\",\"me\":{\"user\":{\"id\":\"6bb5ae22-0b32-4322-be6f-3410ab7e399a\",\"firstname\":\"Procurement\",\"lastname\":\"Admin\",\"login\":null,\"email\":\"jimmie@goyette.com\"}},\"subApps\":{\"borrow\":false,\"admin\":false,\"procure\":false,\"manage\":[]},\"locales\":[{\"name\":\"English (UK)\",\"locale\":\"en-GB\",\"active\":true,\"isDefault\":true,\"isSelected\":true},{\"name\":\"English (US)\",\"locale\":\"en-US\",\"active\":true,\"isDefault\":false,\"isSelected\":false},{\"name\":\"Deutsch\",\"locale\":\"de-CH\",\"active\":true,\"isDefault\":false,\"isSelected\":false},{\"name\":\"Züritüütsch\",\"locale\":\"gsw-CH\",\"active\":true,\"isDefault\":false,\"isSelected\":false}]}}"] [:user #ordered/map ([:id "6bb5ae22-0b32-4322-be6f-3410ab7e399a"] [:firstname "Procurement"] [:lastname "Admin"] [:permissions #ordered/map ([:isAdmin true] [:isRequester false] [:isInspectorForCategories []] [:isViewerForCategories []] [:__typename :UserPermissions])] [:__typename :User])] [:__typename :CurrentUser])] [:settings #ordered/map ([:contact_url nil] [:__typename :ProcurementSettings])])}
2023-11-24T14:38:24.659Z NX-41294 DEBUG [leihs.procurement.permissions.user:72] - query => ["SELECT TRUE AS has_entry FROM procurement_category_viewers WHERE user_id = ?" #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"]
2023-11-24T14:38:24.659Z NX-41294 DEBUG [leihs.procurement.authorization:135] - (skip? (:handler-key request)) => nil
2023-11-24T14:38:24.660Z NX-41294 DEBUG [leihs.procurement.authorization:150] - (authorize handler request) => {:body {:data #ordered/map ([:current_user #ordered/map ([:navbarProps "{\"csrfToken\":{\"value\":\"23cf8ac9-7d12-48c8-9f18-ab8ce7611d71\",\"name\":\"csrf-token\"},\"config\":{\"appTitle\":\"leihs\",\"appColor\":\"gray\",\"me\":{\"user\":{\"id\":\"6bb5ae22-0b32-4322-be6f-3410ab7e399a\",\"firstname\":\"Procurement\",\"lastname\":\"Admin\",\"login\":null,\"email\":\"jimmie@goyette.com\"}},\"subApps\":{\"borrow\":false,\"admin\":false,\"procure\":false,\"manage\":[]},\"locales\":[{\"name\":\"English (UK)\",\"locale\":\"en-GB\",\"active\":true,\"isDefault\":true,\"isSelected\":true},{\"name\":\"English (US)\",\"locale\":\"en-US\",\"active\":true,\"isDefault\":false,\"isSelected\":false},{\"name\":\"Deutsch\",\"locale\":\"de-CH\",\"active\":true,\"isDefault\":false,\"isSelected\":false},{\"name\":\"Züritüütsch\",\"locale\":\"gsw-CH\",\"active\":true,\"isDefault\":false,\"isSelected\":false}]}}"] [:user #ordered/map ([:id "6bb5ae22-0b32-4322-be6f-3410ab7e399a"] [:firstname "Procurement"] [:lastname "Admin"] [:permissions #ordered/map ([:isAdmin true] [:isRequester false] [:isInspectorForCategories []] [:isViewerForCategories []] [:__typename :UserPermissions])] [:__typename :User])] [:__typename :CurrentUser])] [:settings #ordered/map ([:contact_url nil] [:__typename :ProcurementSettings])])}}
2023-11-24T14:38:24.663Z NX-41294 DEBUG [leihs.procurement.permissions.user:84] - (sql-format (sql/where (sql/from (sql/select [true :has_entry]) :procurement_requesters_organizations) [:= :user_id [:cast (:user_id auth-entity) :uuid]])) => ["SELECT TRUE AS has_entry FROM procurement_requesters_organizations WHERE user_id = CAST(? AS UUID)" #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"]
2023-11-24T14:38:24.664Z NX-41294 DEBUG [leihs.procurement.permissions.user:27] - (sql-format (sql/where (sql/from (sql/select [true :has_entry]) :procurement_admins) [:= :user_id [:cast (:user_id auth-entity) :uuid]])) => ["SELECT TRUE AS has_entry FROM procurement_admins WHERE user_id = CAST(? AS UUID)" #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"]
2023-11-24T14:38:24.665Z NX-41294 DEBUG [leihs.procurement.authorization:136] - (->> [user-perms/admin? user-perms/inspector? user-perms/viewer? user-perms/requester?] (map (fn* [p1__39153#] (p1__39153# (:tx-next request) (:authenticated-entity request)))) (some true?)) => true
locale-wrap
2023-11-24T14:38:24.666Z NX-41294 DEBUG [leihs.procurement.permissions.user:50] - query => ["SELECT TRUE AS has_entry FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = ?" #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"]
2023-11-24T14:38:24.666Z NX-41294 DEBUG [leihs.procurement.permissions.user:72] - query => ["SELECT TRUE AS has_entry FROM procurement_category_viewers WHERE user_id = ?" #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"]
2023-11-24T14:38:24.667Z NX-41294 DEBUG [leihs.procurement.permissions.user:84] - (sql-format (sql/where (sql/from (sql/select [true :has_entry]) :procurement_requesters_organizations) [:= :user_id [:cast (:user_id auth-entity) :uuid]])) => ["SELECT TRUE AS has_entry FROM procurement_requesters_organizations WHERE user_id = CAST(? AS UUID)" #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"]
2023-11-24T14:38:24.667Z NX-41294 DEBUG [leihs.procurement.authorization:136] - (->> [user-perms/admin? user-perms/inspector? user-perms/viewer? user-perms/requester?] (map (fn* [p1__39153#] (p1__39153# (:tx-next request) (:authenticated-entity request)))) (some true?)) => true
locale-wrap
wrap
wrap

>>>exec-query::variables {}

>>>exec-query::variables {}
>>>get-dashboard
2023-11-24T14:38:24.690Z NX-41294 DEBUG [leihs.procurement.dashboard:40] - args => {}
2023-11-24T14:38:24.691Z NX-41294 DEBUG [leihs.procurement.dashboard:41] - value => nil
2023-11-24T14:38:24.715Z NX-41294 DEBUG [leihs.procurement.resources.requests:110] - arguments => {}
2023-11-24T14:38:24.715Z NX-41294 DEBUG [leihs.procurement.resources.requests:111] - value => nil
2023-11-24T14:38:24.716Z NX-41294 DEBUG [leihs.procurement.permissions.user:72] - query => ["SELECT TRUE AS has_entry FROM procurement_category_viewers WHERE user_id = ?" #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"]
2023-11-24T14:38:24.717Z NX-41294 DEBUG [leihs.procurement.permissions.user:50] - query => ["SELECT TRUE AS has_entry FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = ?" #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"]
2023-11-24T14:38:24.717Z NX-41294 DEBUG [leihs.procurement.permissions.user:27] - (sql-format (sql/where (sql/from (sql/select [true :has_entry]) :procurement_admins) [:= :user_id [:cast (:user_id auth-entity) :uuid]])) => ["SELECT TRUE AS has_entry FROM procurement_admins WHERE user_id = CAST(? AS UUID)" #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"]
2023-11-24T14:38:24.718Z NX-41294 DEBUG [leihs.procurement.permissions.user:92] - (->> [viewer? inspector? admin?] (map (fn* [p1__39094#] (p1__39094# tx auth-entity))) (some true?)) => true

>>a  {:NEW [:= :procurement_requests.approved_quantity nil], :APPROVED [:>= :procurement_requests.approved_quantity :procurement_requests.requested_quantity], :PARTIALLY_APPROVED [:and [:< :procurement_requests.approved_quantity :procurement_requests.requested_quantity] [:> :procurement_requests.approved_quantity 0]], :DENIED [:= :procurement_requests.approved_quantity 0]}

2023-11-24T14:38:24.721Z NX-41294 DEBUG [leihs.procurement.resources.requests:117] - (requests-query-map <> arguments value) => {:select (nil [(:case [:= :procurement_requests.approved_quantity nil] "NEW" [:>= :procurement_requests.approved_quantity :procurement_requests.requested_quantity] "APPROVED" [:and [:< :procurement_requests.approved_quantity :procurement_requests.requested_quantity] [:> :procurement_requests.approved_quantity 0]] "PARTIALLY_APPROVED" [:= :procurement_requests.approved_quantity 0] "DENIED") :state] [#sql/call [:row_to_json :procurement_budget_periods_2] :budget_period] nil [#sql/call [:row_to_json :models] :model] nil [#sql/call [:row_to_json :procurement_templates] :template] nil [#sql/call [:row_to_json :suppliers] :supplier] [#sql/call [:row_to_json :users] :user]), :from [:procurement_requests], :left-join (:models [:= :models.id :procurement_requests.model_id] :procurement_templates [:= :procurement_templates.id :procurement_requests.template_id] :suppliers [:= :suppliers.id :procurement_requests.supplier_id] :users [:= :users.id :procurement_requests.user_id]), :order-by [nil], :join [:procurement_budget_periods [:= :procurement_budget_periods.id :procurement_requests.budget_period_id] [{:select [:* [:end_date :is_past]], :from [:procurement_budget_periods]} :procurement_budget_periods_2] [:= :procurement_budget_periods_2.id :procurement_requests.budget_period_id] :procurement_categories [:= :procurement_categories.id :procurement_requests.category_id] :procurement_main_categories [:= :procurement_main_categories.id :procurement_categories.main_category_id] :procurement_organizations [:= :procurement_organizations.id :procurement_requests.organization_id] [:procurement_organizations :procurement_departments] [:= :procurement_departments.id :procurement_organizations.parent_id] :rooms [:= :rooms.id :procurement_requests.room_id] :buildings [:= :buildings.id :rooms.building_id]]}

>>>pure-handler {:data #ordered/map ([:budget_periods [nil]] [:main_categories [nil]] [:organizations [nil]]), :errors ({:message Non-nullable field was null., :locations [{:line 3, :column 5}], :path [:budget_periods 0 :id]} {:message Non-nullable field was null., :locations [{:line 4, :column 5}], :path [:budget_periods 0 :name]} {:message Non-nullable field was null., :locations [{:line 5, :column 5}], :path [:budget_periods 0 :inspection_start_date]} {:message Non-nullable field was null., :locations [{:line 6, :column 5}], :path [:budget_periods 0 :end_date]} {:message Non-nullable field was null., :locations [{:line 10, :column 5}], :path [:main_categories 0 :id]} {:message Non-nullable field was null., :locations [{:line 11, :column 5}], :path [:main_categories 0 :name]} {:message Non-nullable field was null., :locations [{:line 30, :column 3}], :path [:organizations 0 :id]} {:message Non-nullable field was null., :locations [{:line 31, :column 3}], :path [:organizations 0 :name]} {:message Non-nullable field was null., :locations [{:line 30, :column 3}], :path [:organizations 0 :organizations 0 :id]} {:message Non-nullable field was null., :locations [{:line 31, :column 3}], :path [:organizations 0 :organizations 0 :name]} {:message Non-nullable field was null., :locations [{:line 30, :column 3}], :path [:organizations 0 :organizations 1 :id]} {:message Non-nullable field was null., :locations [{:line 31, :column 3}], :path [:organizations 0 :organizations 1 :name]})}
2023-11-24T14:38:24.724Z NX-41294 DEBUG [leihs.procurement.permissions.user:27] - (sql-format (sql/where (sql/from (sql/select [true :has_entry]) :procurement_admins) [:= :user_id [:cast (:user_id auth-entity) :uuid]])) => ["SELECT TRUE AS has_entry FROM procurement_admins WHERE user_id = CAST(? AS UUID)" #uuid "6bb5ae22-0b32-4322-be6f-3410ab7e399a"]
2023-11-24T14:38:24.726Z NX-41294 DEBUG [leihs.procurement.graphql:71] - result => {:data #ordered/map ([:budget_periods [nil]] [:main_categories [nil]] [:organizations [nil]]), :errors ({:message "Non-nullable field was null.", :locations [{:line 3, :column 5}], :path [:budget_periods 0 :id]} {:message "Non-nullable field was null.", :locations [{:line 4, :column 5}], :path [:budget_periods 0 :name]} {:message "Non-nullable field was null.", :locations [{:line 5, :column 5}], :path [:budget_periods 0 :inspection_start_date]} {:message "Non-nullable field was null.", :locations [{:line 6, :column 5}], :path [:budget_periods 0 :end_date]} {:message "Non-nullable field was null.", :locations [{:line 10, :column 5}], :path [:main_categories 0 :id]} {:message "Non-nullable field was null.", :locations [{:line 11, :column 5}], :path [:main_categories 0 :name]} {:message "Non-nullable field was null.", :locations [{:line 30, :column 3}], :path [:organizations 0 :id]} {:message "Non-nullable field was null.", :locations [{:line 31, :column 3}], :path [:organizations 0 :name]} {:message "Non-nullable field was null.", :locations [{:line 30, :column 3}], :path [:organizations 0 :organizations 0 :id]} {:message "Non-nullable field was null.", :locations [{:line 31, :column 3}], :path [:organizations 0 :organizations 0 :name]} {:message "Non-nullable field was null.", :locations [{:line 30, :column 3}], :path [:organizations 0 :organizations 1 :id]} {:message "Non-nullable field was null.", :locations [{:line 31, :column 3}], :path [:organizations 0 :organizations 1 :name]})}
2023-11-24T14:38:24.726Z NX-41294 DEBUG [leihs.procurement.resources.requests:118] - (requests-perms/apply-scope tx <> auth-entity) => {:select (nil [(:case [:= :procurement_requests.approved_quantity nil] "NEW" [:>= :procurement_requests.approved_quantity :procurement_requests.requested_quantity] "APPROVED" [:and [:< :procurement_requests.approved_quantity :procurement_requests.requested_quantity] [:> :procurement_requests.approved_quantity 0]] "PARTIALLY_APPROVED" [:= :procurement_requests.approved_quantity 0] "DENIED") :state] [#sql/call [:row_to_json :procurement_budget_periods_2] :budget_period] nil [#sql/call [:row_to_json :models] :model] nil [#sql/call [:row_to_json :procurement_templates] :template] nil [#sql/call [:row_to_json :suppliers] :supplier] [#sql/call [:row_to_json :users] :user]), :from [:procurement_requests], :left-join (:models [:= :models.id :procurement_requests.model_id] :procurement_templates [:= :procurement_templates.id :procurement_requests.template_id] :suppliers [:= :suppliers.id :procurement_requests.supplier_id] :users [:= :users.id :procurement_requests.user_id]), :order-by [nil], :join [:procurement_budget_periods [:= :procurement_budget_periods.id :procurement_requests.budget_period_id] [{:select [:* [:end_date :is_past]], :from [:procurement_budget_periods]} :procurement_budget_periods_2] [:= :procurement_budget_periods_2.id :procurement_requests.budget_period_id] :procurement_categories [:= :procurement_categories.id :procurement_requests.category_id] :procurement_main_categories [:= :procurement_main_categories.id :procurement_categories.main_category_id] :procurement_organizations [:= :procurement_organizations.id :procurement_requests.organization_id] [:procurement_organizations :procurement_departments] [:= :procurement_departments.id :procurement_organizations.parent_id] :rooms [:= :rooms.id :procurement_requests.room_id] :buildings [:= :buildings.id :rooms.building_id]]}
2023-11-24T14:38:24.728Z NX-41294 DEBUG [leihs.procurement.graphql:72] - {:data #ordered/map ([:budget_periods [nil]] [:main_categories [nil]] [:organizations [nil]]), :errors ({:message "Non-nullable field was null.", :locations [{:line 3, :column 5}], :path [:budget_periods 0 :id]} {:message "Non-nullable field was null.", :locations [{:line 4, :column 5}], :path [:budget_periods 0 :name]} {:message "Non-nullable field was null.", :locations [{:line 5, :column 5}], :path [:budget_periods 0 :inspection_start_date]} {:message "Non-nullable field was null.", :locations [{:line 6, :column 5}], :path [:budget_periods 0 :end_date]} {:message "Non-nullable field was null.", :locations [{:line 10, :column 5}], :path [:main_categories 0 :id]} {:message "Non-nullable field was null.", :locations [{:line 11, :column 5}], :path [:main_categories 0 :name]} {:message "Non-nullable field was null.", :locations [{:line 30, :column 3}], :path [:organizations 0 :id]} {:message "Non-nullable field was null.", :locations [{:line 31, :column 3}], :path [:organizations 0 :name]} {:message "Non-nullable field was null.", :locations [{:line 30, :column 3}], :path [:organizations 0 :organizations 0 :id]} {:message "Non-nullable field was null.", :locations [{:line 31, :column 3}], :path [:organizations 0 :organizations 0 :name]} {:message "Non-nullable field was null.", :locations [{:line 30, :column 3}], :path [:organizations 0 :organizations 1 :id]} {:message "Non-nullable field was null.", :locations [{:line 31, :column 3}], :path [:organizations 0 :organizations 1 :name]})}
2023-11-24T14:38:24.733Z NX-41294 DEBUG [leihs.procurement.authorization:150] - (authorize handler request) => {:body {:data #ordered/map ([:budget_periods [nil]] [:main_categories [nil]] [:organizations [nil]]), :errors ({:message "Non-nullable field was null.", :locations [{:line 3, :column 5}], :path [:budget_periods 0 :id]} {:message "Non-nullable field was null.", :locations [{:line 4, :column 5}], :path [:budget_periods 0 :name]} {:message "Non-nullable field was null.", :locations [{:line 5, :column 5}], :path [:budget_periods 0 :inspection_start_date]} {:message "Non-nullable field was null.", :locations [{:line 6, :column 5}], :path [:budget_periods 0 :end_date]} {:message "Non-nullable field was null.", :locations [{:line 10, :column 5}], :path [:main_categories 0 :id]} {:message "Non-nullable field was null.", :locations [{:line 11, :column 5}], :path [:main_categories 0 :name]} {:message "Non-nullable field was null.", :locations [{:line 30, :column 3}], :path [:organizations 0 :id]} {:message "Non-nullable field was null.", :locations [{:line 31, :column 3}], :path [:organizations 0 :name]} {:message "Non-nullable field was null.", :locations [{:line 30, :column 3}], :path [:organizations 0 :organizations 0 :id]} {:message "Non-nullable field was null.", :locations [{:line 31, :column 3}], :path [:organizations 0 :organizations 0 :name]} {:message "Non-nullable field was null.", :locations [{:line 30, :column 3}], :path [:organizations 0 :organizations 1 :id]} {:message "Non-nullable field was null.", :locations [{:line 31, :column 3}], :path [:organizations 0 :organizations 1 :name]})}, :graphql-error true}
2023-11-24T14:38:24.733Z NX-41294 ERROR [leihs.procurement.resources.requests:119] -
                                                     java.lang.Thread.run              Thread.java:  829
                       java.util.concurrent.ThreadPoolExecutor$Worker.run  ThreadPoolExecutor.java:  628
                        java.util.concurrent.ThreadPoolExecutor.runWorker  ThreadPoolExecutor.java: 1128
                                      java.util.concurrent.FutureTask.run          FutureTask.java:  264
                                                                      ...
                                      clojure.core/binding-conveyor-fn/fn                 core.clj: 2034
                        com.walmartlabs.lacinia.executor/execute-query/fn             executor.clj:  421
                                                                      ...
                                                clojure.core/bound-fn*/fn                 core.clj: 2007
                                                       clojure.core/apply                 core.clj:  671
                                                                      ...
                                              clojure.core/with-bindings*                 core.clj: 1977 (repeats 2 times)
                                                       clojure.core/apply                 core.clj:  667
                                                                      ...
                        com.walmartlabs.lacinia.executor/execute-query/fn             executor.clj:  400
               com.walmartlabs.lacinia.executor/execute-nested-selections             executor.clj:  197
                             com.walmartlabs.lacinia.internal-utils/keepv       internal_utils.clj:   45
                                                      clojure.core/reduce                 core.clj: 6830
                                              clojure.core.protocols/fn/G            protocols.clj:   13
                                                clojure.core.protocols/fn            protocols.clj:   75
                                        clojure.core.protocols/seq-reduce            protocols.clj:   31
                                              clojure.core.protocols/fn/G            protocols.clj:   19
                                                clojure.core.protocols/fn            protocols.clj:  136
                                                                      ...
                          com.walmartlabs.lacinia.internal-utils/keepv/fn       internal_utils.clj:   46
            com.walmartlabs.lacinia.executor/execute-nested-selections/fn             executor.clj:  197
                         com.walmartlabs.lacinia.executor/apply-selection             executor.clj:  173
                   com.walmartlabs.lacinia.executor/apply-field-selection             executor.clj:  140
                      com.walmartlabs.lacinia.executor/resolve-and-select             executor.clj:  353
               com.walmartlabs.lacinia.executor/invoke-resolver-for-field             executor.clj:   86
com.walmartlabs.lacinia.schema/wrap-resolver-to-ensure-resolver-result/fn               schema.clj:  986
           leihs.procurement.graphql.resolver/wrap-resolver-with-error/fn             resolver.clj:   16
                                leihs.procurement.dashboard/get-dashboard            dashboard.clj:   57
                        leihs.procurement.resources.requests/get-requests             requests.clj:  119
                     leihs.procurement.resources.requests/get-requests/fn             requests.clj:  119
                                                         honey.sql/format                 sql.cljc: 1913
                                                         honey.sql/format                 sql.cljc: 1951
                                                                      ...
                                                     honey.sql/format-dsl                 sql.cljc: 1429
                                                     honey.sql/format-dsl                 sql.cljc: 1439
                                                      clojure.core/reduce                 core.clj: 6829
                                                                      ...
                                                  honey.sql/format-dsl/fn                 sql.cljc: 1445
                                                                      ...
                                                 honey.sql/format-selects                 sql.cljc:  656
                                          honey.sql/format-selects-common                 sql.cljc:  646
                                                     honey.sql/reduce-sql                 sql.cljc:  557
                                                      clojure.core/reduce                 core.clj: 6830
                                              clojure.core.protocols/fn/G            protocols.clj:   13
                                                clojure.core.protocols/fn            protocols.clj:   75
                                        clojure.core.protocols/seq-reduce            protocols.clj:   24
                                                         clojure.core/seq                 core.clj:  139
                                                                      ...
                                                      clojure.core/map/fn                 core.clj: 2757
                                       honey.sql/format-selects-common/fn                 sql.cljc:  646
                                                                      ...
                                          honey.sql/format-selectable-dsl                 sql.cljc:  538
                                          honey.sql/format-selectable-dsl                 sql.cljc:  543
                                          honey.sql/format-item-selection                 sql.cljc:  513
                                                                      ...
                                                     honey.sql/format-dsl                 sql.cljc: 1429
                                                     honey.sql/format-dsl                 sql.cljc: 1453
clojure.lang.ExceptionInfo: These SQL clauses are unknown or have nil values: :name, :args
    args: (:procurement_budget_periods_2)
    name: :row_to_json

2023-11-24T14:38:24.777Z NX-41294 WARN [leihs.procurement.graphql.resolver:326] - These SQL clauses are unknown or have nil values: :name, :args
2023-11-24T14:38:24.779Z NX-41294 DEBUG [leihs.procurement.graphql.resolver:326] - #error {
 :cause These SQL clauses are unknown or have nil values: :name, :args
 :data #sql/call [:row_to_json :procurement_budget_periods_2]
 :via
 [{:type clojure.lang.ExceptionInfo
   :message These SQL clauses are unknown or have nil values: :name, :args
   :data #sql/call [:row_to_json :procurement_budget_periods_2]
   :at [honey.sql$format_dsl invokeStatic sql.cljc 1453]}]
 :trace
 [[honey.sql$format_dsl invokeStatic sql.cljc 1453]
  [honey.sql$format_dsl doInvoke sql.cljc 1429]
  [clojure.lang.RestFn invoke RestFn.java 423]
  [honey.sql$format_item_selection invokeStatic sql.cljc 513]
  [honey.sql$format_item_selection invoke sql.cljc 503]
  [honey.sql$format_selectable_dsl invokeStatic sql.cljc 543]
  [honey.sql$format_selectable_dsl doInvoke sql.cljc 538]
  [clojure.lang.RestFn invoke RestFn.java 423]
  [honey.sql$format_selects_common$fn__8450 invoke sql.cljc 646]
  [clojure.core$map$fn__5884 invoke core.clj 2757]
  [clojure.lang.LazySeq sval LazySeq.java 42]
  [clojure.lang.LazySeq seq LazySeq.java 51]
  [clojure.lang.RT seq RT.java 535]
  [clojure.core$seq__5419 invokeStatic core.clj 139]
  [clojure.core.protocols$seq_reduce invokeStatic protocols.clj 24]
  [clojure.core.protocols$fn__8168 invokeStatic protocols.clj 75]
  [clojure.core.protocols$fn__8168 invoke protocols.clj 75]
  [clojure.core.protocols$fn__8110$G__8105__8123 invoke protocols.clj 13]
  [clojure.core$reduce invokeStatic core.clj 6830]
  [clojure.core$reduce invoke core.clj 6812]
  [honey.sql$reduce_sql invokeStatic sql.cljc 557]
  [honey.sql$reduce_sql invoke sql.cljc 556]
  [honey.sql$format_selects_common invokeStatic sql.cljc 646]
  [honey.sql$format_selects_common invoke sql.cljc 644]
  [honey.sql$format_selects invokeStatic sql.cljc 656]
  [honey.sql$format_selects invoke sql.cljc 655]
  [clojure.lang.Var invoke Var.java 388]
  [honey.sql$format_dsl$fn__8909 invoke sql.cljc 1445]
  [clojure.lang.PersistentVector reduce PersistentVector.java 343]
  [clojure.core$reduce invokeStatic core.clj 6829]
  [clojure.core$reduce invoke core.clj 6812]
  [honey.sql$format_dsl invokeStatic sql.cljc 1439]
  [honey.sql$format_dsl doInvoke sql.cljc 1429]
  [clojure.lang.RestFn invoke RestFn.java 423]
  [clojure.lang.Var invoke Var.java 388]
  [honey.sql$format invokeStatic sql.cljc 1951]
  [honey.sql$format invoke sql.cljc 1898]
  [honey.sql$format invokeStatic sql.cljc 1913]
  [honey.sql$format invoke sql.cljc 1898]
  [leihs.procurement.resources.requests$get_requests$fn__44209 invoke requests.clj 119]
  [leihs.procurement.resources.requests$get_requests invokeStatic requests.clj 119]
  [leihs.procurement.resources.requests$get_requests invoke requests.clj 106]
  [leihs.procurement.dashboard$get_dashboard invokeStatic dashboard.clj 57]
  [leihs.procurement.dashboard$get_dashboard invoke dashboard.clj 36]
  [leihs.procurement.graphql.resolver$wrap_resolver_with_error$fn__44464 invoke resolver.clj 16]
  [com.walmartlabs.lacinia.schema$wrap_resolver_to_ensure_resolver_result$fn__14023 invoke schema.clj 986]
  [com.walmartlabs.lacinia.executor$invoke_resolver_for_field invokeStatic executor.clj 86]
  [com.walmartlabs.lacinia.executor$invoke_resolver_for_field invoke executor.clj 68]
  [com.walmartlabs.lacinia.executor$resolve_and_select invokeStatic executor.clj 353]
  [com.walmartlabs.lacinia.executor$resolve_and_select invoke executor.clj 234]
  [com.walmartlabs.lacinia.executor$apply_field_selection invokeStatic executor.clj 140]
  [com.walmartlabs.lacinia.executor$apply_field_selection invoke executor.clj 135]
  [com.walmartlabs.lacinia.executor$apply_selection invokeStatic executor.clj 173]
  [com.walmartlabs.lacinia.executor$apply_selection invoke executor.clj 165]
  [com.walmartlabs.lacinia.executor$execute_nested_selections$fn__17481 invoke executor.clj 197]
  [com.walmartlabs.lacinia.internal_utils$keepv$fn__12187 invoke internal_utils.clj 46]
  [clojure.lang.ArrayChunk reduce ArrayChunk.java 58]
  [clojure.core.protocols$fn__8176 invokeStatic protocols.clj 136]
  [clojure.core.protocols$fn__8176 invoke protocols.clj 124]
  [clojure.core.protocols$fn__8136$G__8131__8145 invoke protocols.clj 19]
  [clojure.core.protocols$seq_reduce invokeStatic protocols.clj 31]
  [clojure.core.protocols$fn__8168 invokeStatic protocols.clj 75]
  [clojure.core.protocols$fn__8168 invoke protocols.clj 75]
  [clojure.core.protocols$fn__8110$G__8105__8123 invoke protocols.clj 13]
  [clojure.core$reduce invokeStatic core.clj 6830]
  [clojure.core$reduce invoke core.clj 6812]
  [com.walmartlabs.lacinia.internal_utils$keepv invokeStatic internal_utils.clj 45]
  [com.walmartlabs.lacinia.internal_utils$keepv invoke internal_utils.clj 41]
  [com.walmartlabs.lacinia.executor$execute_nested_selections invokeStatic executor.clj 197]
  [com.walmartlabs.lacinia.executor$execute_nested_selections invoke executor.clj 190]
  [com.walmartlabs.lacinia.executor$execute_query$fn__17519 invoke executor.clj 400]
  [clojure.lang.AFn applyToHelper AFn.java 152]
  [clojure.lang.AFn applyTo AFn.java 144]
  [clojure.core$apply invokeStatic core.clj 667]
  [clojure.core$with_bindings_STAR_ invokeStatic core.clj 1977]
  [clojure.core$with_bindings_STAR_ doInvoke core.clj 1977]
  [clojure.lang.RestFn invoke RestFn.java 425]
  [clojure.lang.AFn applyToHelper AFn.java 156]
  [clojure.lang.RestFn applyTo RestFn.java 132]
  [clojure.core$apply invokeStatic core.clj 671]
  [clojure.core$bound_fn_STAR_$fn__5767 doInvoke core.clj 2007]
  [clojure.lang.RestFn invoke RestFn.java 397]
  [com.walmartlabs.lacinia.executor$execute_query$fn__17524 invoke executor.clj 421]
  [clojure.core$binding_conveyor_fn$fn__5772 invoke core.clj 2034]
  [clojure.lang.AFn call AFn.java 18]
  [java.util.concurrent.FutureTask run FutureTask.java 264]
  [java.util.concurrent.ThreadPoolExecutor runWorker ThreadPoolExecutor.java 1128]
  [java.util.concurrent.ThreadPoolExecutor$Worker run ThreadPoolExecutor.java 628]
  [java.lang.Thread run Thread.java 829]]}

>>>pure-handler {:data #ordered/map ([:dashboard nil]), :errors ({:message These SQL clauses are unknown or have nil values: :name, :args, :locations [{:line 2, :column 3}], :path [:dashboard], :extensions {:exception ExceptionInfo, :arguments {:inspector_priority $inspector_priority, :organization_id $organizations, :requested_by_auth_user $onlyOwnRequests, :state $state, :order_status $order_status, :search $search, :priority $priority, :budget_period_id $budgetPeriods, :category_id $categories}}})}
2023-11-24T14:38:24.789Z NX-41294 DEBUG [leihs.procurement.graphql:71] - result => {:data #ordered/map ([:dashboard nil]), :errors ({:message "These SQL clauses are unknown or have nil values: :name, :args", :locations [{:line 2, :column 3}], :path [:dashboard], :extensions {:exception "ExceptionInfo", :arguments {:inspector_priority $inspector_priority, :organization_id $organizations, :requested_by_auth_user $onlyOwnRequests, :state $state, :order_status $order_status, :search $search, :priority $priority, :budget_period_id $budgetPeriods, :category_id $categories}}})}
2023-11-24T14:38:24.790Z NX-41294 DEBUG [leihs.procurement.graphql:72] - {:data #ordered/map ([:dashboard nil]), :errors ({:message "These SQL clauses are unknown or have nil values: :name, :args", :locations [{:line 2, :column 3}], :path [:dashboard], :extensions {:exception "ExceptionInfo", :arguments {:inspector_priority $inspector_priority, :organization_id $organizations, :requested_by_auth_user $onlyOwnRequests, :state $state, :order_status $order_status, :search $search, :priority $priority, :budget_period_id $budgetPeriods, :category_id $categories}}})}
2023-11-24T14:38:24.790Z NX-41294 DEBUG [leihs.procurement.authorization:150] - (authorize handler request) => {:body {:data #ordered/map ([:dashboard nil]), :errors ({:message "These SQL clauses are unknown or have nil values: :name, :args", :locations [{:line 2, :column 3}], :path [:dashboard], :extensions {:exception "ExceptionInfo", :arguments {:inspector_priority $inspector_priority, :organization_id $organizations, :requested_by_auth_user $onlyOwnRequests, :state $state, :order_status $order_status, :search $search, :priority $priority, :budget_period_id $budgetPeriods, :category_id $categories}}})}, :graphql-error true}


