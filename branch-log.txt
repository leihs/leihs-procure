2023-11-23T10:26:00.573Z NX-41294 INFO [leihs.core.http-server:84] - stopping running http-server
2023-11-23T10:26:00.777Z NX-41294 INFO [leihs.core.http-server:88] - stopped http-server
➜  server git:(mr/next-dev) ✗ runbet
>> Running: ./bin/dev-run-backend --db-port 5415 --db-name leihs_test
# java_leihs-procure-server env check via asdf v0.13.1
# java_leihs-procure-server env skipped update; touch .tool-versions or remove /var/folders/jl/49spzkdd2v3cdz37fgmp0ddr6cj76v/T/asdf_cache_java_leihs-procure-server to force update
# clojure_leihs-procure-server env check via asdf v0.13.1
# clojure_leihs-procure-server env skipped update; touch .tool-versions or remove /var/folders/jl/49spzkdd2v3cdz37fgmp0ddr6cj76v/T/asdf_cache_clojure_leihs-procure-server to force update
Warning: environ value /Users/mradl/.asdf/installs/java/zulu-11.60.19 for key :java-home has been overwritten with /Users/mradl/.asdf/installs/java/zulu-11.60.19/zulu-11.jdk/Contents/Home
2023-11-23T10:26:13.932Z NX-41294 WARN [leihs.core.release:13] - Failed to read releases.yml, returning bogus value
2023-11-23T10:26:14.467Z NX-41294 INFO [leihs.core.logging:28] - initializing logging  {:min-level [[#{"leihs.procurement.permissions.*" "leihs.procurement.authorization.*"} :debug] [#{"com.zaxxer.hikari.*" "leihs.*"} :debug] [#{"*"} :debug]], :log-level :debug}
2023-11-23T10:26:14.475Z NX-41294 INFO [leihs.core.logging:30] - initialized logging  {:min-level [[#{"leihs.procurement.permissions.*" "leihs.procurement.authorization.*"} :debug] [#{"com.zaxxer.hikari.*" "leihs.*"} :debug] [#{"*"} :debug]], :ns-filter #{"*"}, :middleware [], :timestamp-opts {:pattern :iso8601, :locale :jvm-default, :timezone :utc}, :output-fn #object[taoensso.timbre$default_output_fn 0x4140a0b7 "taoensso.timbre$default_output_fn@4140a0b7"], :appenders {:println {:enabled? true, :fn #object[taoensso.timbre.appenders.core$println_appender$fn__3459 0x10dbb66d "taoensso.timbre.appenders.core$println_appender$fn__3459@10dbb66d"]}}, :_init-config {:loaded-from-source :default, :compile-time-config {:min-level nil, :ns-pattern "*"}}, :log-level :debug}
2023-11-23T10:26:14.478Z NX-41294 INFO [leihs.procurement.main:50] - main ("--dev-mode" "true" "--repl" "true" "run" "--db-port" "5415" "--db-name" "leihs_test")
2023-11-23T10:26:14.501Z NX-41294 INFO [leihs.core.repl:62] - init {:dev-mode true, :repl true, :repl-bind "localhost", :repl-port 47655, :repl-port-file ".nrepl-port"}
2023-11-23T10:26:14.503Z NX-41294 INFO [leihs.core.repl:70] - starting nREPL server  47655 localhost
2023-11-23T10:26:14.526Z NX-41294 INFO [leihs.core.repl:75] - started nREPL server
2023-11-23T10:26:14.529Z NX-41294 INFO [leihs.procurement.run:326] - Invoking run with options:  {:db-host localhost, :db-max-pool-size 16, :db-min-pool-size 2, :db-name leihs_test, :db-password leihs, :db-port 5415, :db-user leihs, :dev-mode true, :http-host localhost, :http-max-threads 8, :http-min-threads 1, :http-port 3230, :http-queue-capacity 640, :http-thread-keep-alive-seconds 10, :http-worker-prefix leihs-service-http-worker-, :pid-file nil, :repl true, :repl-bind localhost, :repl-port 47655, :repl-port-file .nrepl-port}
2023-11-23T10:26:14.530Z NX-41294 INFO [leihs.core.shutdown:20] - PID 16317
2023-11-23T10:26:14.553Z NX-41294 INFO [leihs.core.shutdown:29] - Registering SIGTERM handler for shutdown.
2023-11-23T10:26:14.613Z NX-41294 INFO [leihs.core.graphql:17] - Initialized graphQL schema.
2023-11-23T10:26:14.614Z NX-41294 INFO [leihs.core.db:220] - Initializing db  {:db-name "leihs_test", :db-port 5415, :db-host "localhost", :db-user "leihs", :db-password "leihs", :db-min-pool-size 2, :db-max-pool-size 16}
2023-11-23T10:26:14.619Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1100] - db-pool - configuration:
2023-11-23T10:26:14.635Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - allowPoolSuspension.............false
2023-11-23T10:26:14.635Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - autoCommit......................true
2023-11-23T10:26:14.635Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - catalog.........................none
2023-11-23T10:26:14.636Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - connectionInitSql...............none
2023-11-23T10:26:14.636Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - connectionTestQuery.............none
2023-11-23T10:26:14.637Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - connectionTimeout...............30000
2023-11-23T10:26:14.637Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - dataSource......................none
2023-11-23T10:26:14.639Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - dataSourceClassName............."org.postgresql.ds.PGSimpleDataSource"
2023-11-23T10:26:14.639Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - dataSourceJNDI..................none
2023-11-23T10:26:14.640Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - dataSourceProperties............{password=<masked>, databaseName=leihs_test, serverName=localhost, portNumber=5415}
2023-11-23T10:26:14.640Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - driverClassName.................none
2023-11-23T10:26:14.640Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - exceptionOverrideClassName......none
2023-11-23T10:26:14.640Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - healthCheckProperties...........{}
2023-11-23T10:26:14.640Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - healthCheckRegistry.............com.codahale.metrics.health.HealthCheckRegistry@62fb2f00
2023-11-23T10:26:14.641Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - idleTimeout.....................60000
2023-11-23T10:26:14.641Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - initializationFailTimeout.......1
2023-11-23T10:26:14.641Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - isolateInternalQueries..........false
2023-11-23T10:26:14.641Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - jdbcUrl.........................none
2023-11-23T10:26:14.641Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - keepaliveTime...................0
2023-11-23T10:26:14.641Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - leakDetectionThreshold..........0
2023-11-23T10:26:14.642Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - maxLifetime.....................3600000
2023-11-23T10:26:14.642Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - maximumPoolSize.................16
2023-11-23T10:26:14.642Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - metricRegistry..................com.codahale.metrics.MetricRegistry@15610569
2023-11-23T10:26:14.642Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - metricsTrackerFactory...........none
2023-11-23T10:26:14.642Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - minimumIdle.....................2
2023-11-23T10:26:14.642Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - password........................<masked>
2023-11-23T10:26:14.643Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - poolName........................"db-pool"
2023-11-23T10:26:14.643Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - readOnly........................false
2023-11-23T10:26:14.643Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - registerMbeans..................false
2023-11-23T10:26:14.643Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - scheduledExecutor...............none
2023-11-23T10:26:14.643Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - schema..........................none
2023-11-23T10:26:14.643Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - threadFactory...................internal
2023-11-23T10:26:14.644Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - transactionIsolation............default
2023-11-23T10:26:14.644Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - username........................"leihs"
2023-11-23T10:26:14.644Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - validationTimeout...............5000
2023-11-23T10:26:14.646Z NX-41294 INFO [com.zaxxer.hikari.HikariDataSource:80] - db-pool - Starting...
2023-11-23T10:26:14.707Z NX-41294 INFO [com.zaxxer.hikari.pool.HikariPool:565] - db-pool - Added connection org.postgresql.jdbc.PgConnection@33c3a483
2023-11-23T10:26:14.713Z NX-41294 INFO [com.zaxxer.hikari.HikariDataSource:82] - db-pool - Start completed.
2023-11-23T10:26:14.713Z NX-41294 INFO [leihs.core.db:222] - Initialized db  {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x162ebe97 "HikariDataSource (db-pool)"]}
2023-11-23T10:26:14.714Z NX-41294 INFO [leihs.core.db:223] - Initializing ds-next  {:db-name "leihs_test", :db-port 5415, :db-host "localhost", :db-user "leihs", :db-password "leihs", :db-min-pool-size 2, :db-max-pool-size 16}
2023-11-23T10:26:14.725Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1100] - HikariPool-1 - configuration:
2023-11-23T10:26:14.726Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - allowPoolSuspension.............false
2023-11-23T10:26:14.726Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - autoCommit......................true
2023-11-23T10:26:14.726Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - catalog.........................none
2023-11-23T10:26:14.726Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - connectionInitSql...............none
2023-11-23T10:26:14.726Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - connectionTestQuery.............none
2023-11-23T10:26:14.727Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - connectionTimeout...............30000
2023-11-23T10:26:14.727Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - dataSource......................none
2023-11-23T10:26:14.727Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - dataSourceClassName.............none
2023-11-23T10:26:14.727Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - dataSourceJNDI..................none
2023-11-23T10:26:14.727Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - dataSourceProperties............{password=<masked>}
2023-11-23T10:26:14.727Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - driverClassName.................none
2023-11-23T10:26:14.728Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - exceptionOverrideClassName......none
2023-11-23T10:26:14.728Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - healthCheckProperties...........{}
2023-11-23T10:26:14.728Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - healthCheckRegistry.............none
2023-11-23T10:26:14.728Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - idleTimeout.....................60000
2023-11-23T10:26:14.729Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - initializationFailTimeout.......1
2023-11-23T10:26:14.730Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - isolateInternalQueries..........false
2023-11-23T10:26:14.730Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - jdbcUrl.........................jdbc:postgresql://localhost:5415/leihs_test
2023-11-23T10:26:14.730Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - keepaliveTime...................0
2023-11-23T10:26:14.730Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - leakDetectionThreshold..........0
2023-11-23T10:26:14.730Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - maxLifetime.....................3600000
2023-11-23T10:26:14.730Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - maximumPoolSize.................16
2023-11-23T10:26:14.730Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - metricRegistry..................none
2023-11-23T10:26:14.731Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - metricsTrackerFactory...........none
2023-11-23T10:26:14.731Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - minimumIdle.....................2
2023-11-23T10:26:14.731Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - password........................<masked>
2023-11-23T10:26:14.731Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - poolName........................"HikariPool-1"
2023-11-23T10:26:14.731Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - readOnly........................false
2023-11-23T10:26:14.732Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - registerMbeans..................false
2023-11-23T10:26:14.732Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - scheduledExecutor...............none
2023-11-23T10:26:14.732Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - schema..........................none
2023-11-23T10:26:14.732Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - threadFactory...................internal
2023-11-23T10:26:14.732Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - transactionIsolation............default
2023-11-23T10:26:14.732Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - username........................"leihs"
2023-11-23T10:26:14.733Z NX-41294 DEBUG [com.zaxxer.hikari.HikariConfig:1132] - validationTimeout...............5000
2023-11-23T10:26:14.733Z NX-41294 INFO [com.zaxxer.hikari.HikariDataSource:110] - HikariPool-1 - Starting...
2023-11-23T10:26:14.734Z NX-41294 DEBUG [com.zaxxer.hikari.util.DriverDataSource:107] - Loaded driver with class name org.postgresql.Driver for jdbcUrl=jdbc:postgresql://localhost:5415/leihs_test
2023-11-23T10:26:14.746Z NX-41294 INFO [com.zaxxer.hikari.pool.HikariPool:565] - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@1d3079fc
2023-11-23T10:26:14.747Z NX-41294 INFO [com.zaxxer.hikari.HikariDataSource:123] - HikariPool-1 - Start completed.
2023-11-23T10:26:14.752Z NX-41294 INFO [leihs.core.db:225] - Initialized ds-next  #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x60c0b1cb "HikariDataSource (HikariPool-1)"], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x56d4aa90 "next.jdbc.result_set$as_unqualified_lower_maps@56d4aa90"]}}
2023-11-23T10:26:14.760Z NX-41294 INFO [leihs.core.http-server:101] - starting http-server  {:port 3230, :ip "localhost", :pool {:queue #object[java.util.concurrent.ArrayBlockingQueue 0x27f70b49 "[]"], :pool #object[java.util.concurrent.ThreadPoolExecutor 0x38fbe4a7 "java.util.concurrent.ThreadPoolExecutor@38fbe4a7[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]"]}}
2023-11-23T10:26:14.771Z NX-41294 INFO [leihs.core.http-server:104] - started http-server
2023-11-23T10:26:14.818Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:414] - db-pool - Before cleanup stats (total=1, active=0, idle=1, waiting=0)
2023-11-23T10:26:14.819Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:414] - db-pool - After cleanup  stats (total=1, active=0, idle=1, waiting=0)
2023-11-23T10:26:14.836Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:738] - db-pool - Added connection org.postgresql.jdbc.PgConnection@2c35c444
2023-11-23T10:26:14.849Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:414] - db-pool - After adding stats (total=2, active=0, idle=2, waiting=0)
2023-11-23T10:26:14.850Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:414] - HikariPool-1 - Before cleanup stats (total=1, active=0, idle=1, waiting=0)
2023-11-23T10:26:14.850Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:414] - HikariPool-1 - After cleanup  stats (total=1, active=0, idle=1, waiting=0)
2023-11-23T10:26:14.862Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:738] - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@3e6b8d4d
2023-11-23T10:26:14.875Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:414] - HikariPool-1 - After adding stats (total=2, active=0, idle=2, waiting=0)
2023-11-23T10:26:44.822Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:414] - db-pool - Before cleanup stats (total=2, active=0, idle=2, waiting=0)
2023-11-23T10:26:44.823Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:414] - db-pool - After cleanup  stats (total=2, active=0, idle=2, waiting=0)
2023-11-23T10:26:44.823Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:521] - db-pool - Fill pool skipped, pool has sufficient level or currently being filled (queueDepth=0).
2023-11-23T10:26:44.856Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:414] - HikariPool-1 - Before cleanup stats (total=2, active=0, idle=2, waiting=0)
2023-11-23T10:26:44.856Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:414] - HikariPool-1 - After cleanup  stats (total=2, active=0, idle=2, waiting=0)
2023-11-23T10:26:44.856Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:521] - HikariPool-1 - Fill pool skipped, pool has sufficient level or currently being filled (queueDepth=0).
>>wrap-authenticate::handler #object[leihs.procurement.authorization$wrap_authorize$fn__39139 0x4c2b46cb leihs.procurement.authorization$wrap_authorize$fn__39139@4c2b46cb]
>>wrap-authenticate::request {:cookies {}, :remote-addr 127.0.0.1, :start-time 392713238217458, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address your.lending.desk@example.com, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url nil, :sessions_force_uniqueness false, :email_signature Cheers,}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x60c0b1cb HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x56d4aa90 next.jdbc.result_set$as_unqualified_lower_maps@56d4aa90]}}, :query-params-raw {}, :route-params nil, :headers {sec-fetch-site none, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0, sec-fetch-user ?1, connection keep-alive, upgrade-insecure-requests 1, accept text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8, accept-language de,en-US;q=0.7,en;q=0.3, sec-fetch-dest document, accept-encoding gzip, deflate, br, sec-fetch-mode navigate}, :async-channel #object[org.httpkit.server.AsyncChannel 0x71572111 /127.0.0.1:3230<->/127.0.0.1:64747], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x162ebe97 HikariDataSource (db-pool)]}, :content-length 0, :form-params {}, :websocket? false, :query-params {}, :content-type nil, :form-params-raw {}, :character-encoding utf8, :uri /sign-in, :server-name localhost, :handler-key :sign-in, :query-string nil, :body nil, :graphql-schema #CompiledSchema<>, :handler #object[compojure.core$routes$fn__27950 0x73ae245d compojure.core$routes$fn__27950@73ae245d], :multipart-params {}, :scheme :http, :request-method :get, :accept {:mime :html, :charset nil, :encoding nil, :language nil}}
>>>a true
>>>b nil

>>1 authorize

>>1 handler #object[leihs.core.locale$wrap$fn__44238 0x46e66fe3 leihs.core.locale$wrap$fn__44238@46e66fe3]

>>1 request {:cookies {}, :remote-addr 127.0.0.1, :start-time 392713238217458, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address your.lending.desk@example.com, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url nil, :sessions_force_uniqueness false, :email_signature Cheers,}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x60c0b1cb HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x56d4aa90 next.jdbc.result_set$as_unqualified_lower_maps@56d4aa90]}}, :query-params-raw {}, :route-params nil, :headers {sec-fetch-site none, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0, sec-fetch-user ?1, connection keep-alive, upgrade-insecure-requests 1, accept text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8, accept-language de,en-US;q=0.7,en;q=0.3, sec-fetch-dest document, accept-encoding gzip, deflate, br, sec-fetch-mode navigate}, :async-channel #object[org.httpkit.server.AsyncChannel 0x71572111 /127.0.0.1:3230<->/127.0.0.1:64747], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x162ebe97 HikariDataSource (db-pool)]}, :content-length 0, :form-params {}, :websocket? false, :query-params {}, :content-type nil, :form-params-raw {}, :character-encoding utf8, :uri /sign-in, :server-name localhost, :handler-key :sign-in, :query-string nil, :body nil, :graphql-schema #CompiledSchema<>, :handler #object[compojure.core$routes$fn__27950 0x73ae245d compojure.core$routes$fn__27950@73ae245d], :multipart-params {}, :scheme :http, :request-method :get, :accept {:mime :html, :charset nil, :encoding nil, :language nil}}

>>1 (:handler-key request) :sign-in
>myprint>  authEnt? nil
>myprint>  txn {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x162ebe97 HikariDataSource (db-pool)]}
>myprint>  admin false

>2> [SELECT TRUE AS has_entry FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id IS NULL]

>myprint>  inspector false

>2> [SELECT TRUE AS has_entry FROM procurement_category_viewers WHERE user_id IS NULL]

>myprint>  viewer false
>myprint>  requester false
2023-11-23T10:27:10.487Z NX-41294 DEBUG [leihs.procurement.authorization:134] - (skip? (:handler-key request)) => true
2023-11-23T10:27:10.519Z NX-41294 DEBUG [pg-types.sql-parameter:326] - calling convert-parameter with:  [:text  #object[com.zaxxer.hikari.pool.HikariProxyPreparedStatement 0x79fc4654 HikariProxyPreparedStatement@2046576212 wrapping SELECT * FROM users  WHERE (users.org_id IS NULL OR users.login IS NULL OR lower(users.email) = ?)] 1]  type:  java.lang.String
2023-11-23T10:27:10.520Z NX-41294 DEBUG [pg-types.sql-parameter:326] - converted-parameter:
2023-11-23T10:27:10.528Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#uuid "d532bee5-b9e3-44d4-bf73-a2c8f920a8bf" #object[org.postgresql.jdbc.PgResultSetMetaData 0x539a5b97 org.postgresql.jdbc.PgResultSetMetaData@539a5b97] 1]
2023-11-23T10:27:10.544Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:uuid #uuid "d532bee5-b9e3-44d4-bf73-a2c8f920a8bf"]
2023-11-23T10:27:10.544Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  #uuid "d532bee5-b9e3-44d4-bf73-a2c8f920a8bf"
2023-11-23T10:27:10.545Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [Dawna #object[org.postgresql.jdbc.PgResultSetMetaData 0x539a5b97 org.postgresql.jdbc.PgResultSetMetaData@539a5b97] 3]
2023-11-23T10:27:10.545Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:text Dawna]
2023-11-23T10:27:10.545Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  Dawna
2023-11-23T10:27:10.545Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [Kemmer #object[org.postgresql.jdbc.PgResultSetMetaData 0x539a5b97 org.postgresql.jdbc.PgResultSetMetaData@539a5b97] 4]
2023-11-23T10:27:10.545Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:varchar Kemmer]
2023-11-23T10:27:10.546Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  Kemmer
2023-11-23T10:27:10.546Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [amelia@rosenbaum.name #object[org.postgresql.jdbc.PgResultSetMetaData 0x539a5b97 org.postgresql.jdbc.PgResultSetMetaData@539a5b97] 7]
2023-11-23T10:27:10.546Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:varchar amelia@rosenbaum.name]
2023-11-23T10:27:10.546Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  amelia@rosenbaum.name
2023-11-23T10:27:10.547Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#inst "2023-11-23T10:27:09.984114000-00:00" #object[org.postgresql.jdbc.PgResultSetMetaData 0x539a5b97 org.postgresql.jdbc.PgResultSetMetaData@539a5b97] 15]
2023-11-23T10:27:10.547Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:timestamptz #inst "2023-11-23T10:27:09.984114000-00:00"]
2023-11-23T10:27:10.549Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  #time/instant "2023-11-23T10:27:09.984114Z"
2023-11-23T10:27:10.549Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#inst "2023-11-23T10:27:09.984114000-00:00" #object[org.postgresql.jdbc.PgResultSetMetaData 0x539a5b97 org.postgresql.jdbc.PgResultSetMetaData@539a5b97] 16]
2023-11-23T10:27:10.550Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:timestamptz #inst "2023-11-23T10:27:09.984114000-00:00"]
2023-11-23T10:27:10.550Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  #time/instant "2023-11-23T10:27:09.984114Z"
2023-11-23T10:27:10.550Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [Dawna Kemmer amelia@rosenbaum.name    Kemmer Dawna #object[org.postgresql.jdbc.PgResultSetMetaData 0x539a5b97 org.postgresql.jdbc.PgResultSetMetaData@539a5b97] 25]
2023-11-23T10:27:10.550Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:text Dawna Kemmer amelia@rosenbaum.name    Kemmer Dawna]
2023-11-23T10:27:10.551Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  Dawna Kemmer amelia@rosenbaum.name    Kemmer Dawna
2023-11-23T10:27:10.551Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [local #object[org.postgresql.jdbc.PgResultSetMetaData 0x539a5b97 org.postgresql.jdbc.PgResultSetMetaData@539a5b97] 32]
2023-11-23T10:27:10.551Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:text local]
2023-11-23T10:27:10.551Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  local
2023-11-23T10:27:10.551Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#uuid "87e52826-a564-402c-9270-982277676945" #object[org.postgresql.jdbc.PgResultSetMetaData 0x539a5b97 org.postgresql.jdbc.PgResultSetMetaData@539a5b97] 1]
2023-11-23T10:27:10.552Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:uuid #uuid "87e52826-a564-402c-9270-982277676945"]
2023-11-23T10:27:10.552Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  #uuid "87e52826-a564-402c-9270-982277676945"
2023-11-23T10:27:10.552Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [Procurement #object[org.postgresql.jdbc.PgResultSetMetaData 0x539a5b97 org.postgresql.jdbc.PgResultSetMetaData@539a5b97] 3]
2023-11-23T10:27:10.552Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:text Procurement]
2023-11-23T10:27:10.552Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  Procurement
2023-11-23T10:27:10.553Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [Admin #object[org.postgresql.jdbc.PgResultSetMetaData 0x539a5b97 org.postgresql.jdbc.PgResultSetMetaData@539a5b97] 4]
2023-11-23T10:27:10.553Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:varchar Admin]
2023-11-23T10:27:10.553Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  Admin
2023-11-23T10:27:10.553Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [jimmie@goyette.com #object[org.postgresql.jdbc.PgResultSetMetaData 0x539a5b97 org.postgresql.jdbc.PgResultSetMetaData@539a5b97] 7]
2023-11-23T10:27:10.554Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:varchar jimmie@goyette.com]
2023-11-23T10:27:10.554Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  jimmie@goyette.com
2023-11-23T10:27:10.554Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#inst "2023-11-23T10:27:10.079341000-00:00" #object[org.postgresql.jdbc.PgResultSetMetaData 0x539a5b97 org.postgresql.jdbc.PgResultSetMetaData@539a5b97] 15]
2023-11-23T10:27:10.554Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:timestamptz #inst "2023-11-23T10:27:10.079341000-00:00"]
2023-11-23T10:27:10.554Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  #time/instant "2023-11-23T10:27:10.079341Z"
2023-11-23T10:27:10.554Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#inst "2023-11-23T10:27:10.079341000-00:00" #object[org.postgresql.jdbc.PgResultSetMetaData 0x539a5b97 org.postgresql.jdbc.PgResultSetMetaData@539a5b97] 16]
2023-11-23T10:27:10.555Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:timestamptz #inst "2023-11-23T10:27:10.079341000-00:00"]
2023-11-23T10:27:10.555Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  #time/instant "2023-11-23T10:27:10.079341Z"
2023-11-23T10:27:10.555Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [Procurement Admin jimmie@goyette.com    Admin Procurement #object[org.postgresql.jdbc.PgResultSetMetaData 0x539a5b97 org.postgresql.jdbc.PgResultSetMetaData@539a5b97] 25]
2023-11-23T10:27:10.555Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:text Procurement Admin jimmie@goyette.com    Admin Procurement]
2023-11-23T10:27:10.556Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  Procurement Admin jimmie@goyette.com    Admin Procurement
2023-11-23T10:27:10.556Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [local #object[org.postgresql.jdbc.PgResultSetMetaData 0x539a5b97 org.postgresql.jdbc.PgResultSetMetaData@539a5b97] 32]
2023-11-23T10:27:10.557Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:text local]
2023-11-23T10:27:10.557Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  local
2023-11-23T10:27:10.557Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#uuid "6c6010ff-5045-4ee8-b0d6-4062e8ab4f6b" #object[org.postgresql.jdbc.PgResultSetMetaData 0x539a5b97 org.postgresql.jdbc.PgResultSetMetaData@539a5b97] 1]
2023-11-23T10:27:10.557Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:uuid #uuid "6c6010ff-5045-4ee8-b0d6-4062e8ab4f6b"]
2023-11-23T10:27:10.557Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  #uuid "6c6010ff-5045-4ee8-b0d6-4062e8ab4f6b"
2023-11-23T10:27:10.557Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [Lynsey #object[org.postgresql.jdbc.PgResultSetMetaData 0x539a5b97 org.postgresql.jdbc.PgResultSetMetaData@539a5b97] 3]
2023-11-23T10:27:10.558Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:text Lynsey]
2023-11-23T10:27:10.558Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  Lynsey
2023-11-23T10:27:10.558Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [Kertzmann #object[org.postgresql.jdbc.PgResultSetMetaData 0x539a5b97 org.postgresql.jdbc.PgResultSetMetaData@539a5b97] 4]
2023-11-23T10:27:10.558Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:varchar Kertzmann]
2023-11-23T10:27:10.558Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  Kertzmann
2023-11-23T10:27:10.558Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [chanda@ortiz.net #object[org.postgresql.jdbc.PgResultSetMetaData 0x539a5b97 org.postgresql.jdbc.PgResultSetMetaData@539a5b97] 7]
2023-11-23T10:27:10.559Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:varchar chanda@ortiz.net]
2023-11-23T10:27:10.559Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  chanda@ortiz.net
2023-11-23T10:27:10.559Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#inst "2023-11-23T10:27:10.105740000-00:00" #object[org.postgresql.jdbc.PgResultSetMetaData 0x539a5b97 org.postgresql.jdbc.PgResultSetMetaData@539a5b97] 15]
2023-11-23T10:27:10.559Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:timestamptz #inst "2023-11-23T10:27:10.105740000-00:00"]
2023-11-23T10:27:10.560Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  #time/instant "2023-11-23T10:27:10.105740Z"
2023-11-23T10:27:10.560Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#inst "2023-11-23T10:27:10.105740000-00:00" #object[org.postgresql.jdbc.PgResultSetMetaData 0x539a5b97 org.postgresql.jdbc.PgResultSetMetaData@539a5b97] 16]
2023-11-23T10:27:10.560Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:timestamptz #inst "2023-11-23T10:27:10.105740000-00:00"]
2023-11-23T10:27:10.560Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  #time/instant "2023-11-23T10:27:10.105740Z"
2023-11-23T10:27:10.561Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [Lynsey Kertzmann chanda@ortiz.net    Kertzmann Lynsey #object[org.postgresql.jdbc.PgResultSetMetaData 0x539a5b97 org.postgresql.jdbc.PgResultSetMetaData@539a5b97] 25]
2023-11-23T10:27:10.561Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:text Lynsey Kertzmann chanda@ortiz.net    Kertzmann Lynsey]
2023-11-23T10:27:10.561Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  Lynsey Kertzmann chanda@ortiz.net    Kertzmann Lynsey
2023-11-23T10:27:10.561Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [local #object[org.postgresql.jdbc.PgResultSetMetaData 0x539a5b97 org.postgresql.jdbc.PgResultSetMetaData@539a5b97] 32]
2023-11-23T10:27:10.562Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:text local]
2023-11-23T10:27:10.562Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  local
2023-11-23T10:27:10.567Z NX-41294 DEBUG [pg-types.sql-parameter:326] - calling convert-parameter with:  [:text password #object[com.zaxxer.hikari.pool.HikariProxyPreparedStatement 0x57afa3c9 HikariProxyPreparedStatement@1471128521 wrapping SELECT authentication_systems.id, authentication_systems.type, authentication_systems.name, authentication_systems.description, authentication_systems.external_sign_in_url FROM authentication_systems, users  WHERE ((EXISTS (SELECT TRUE FROM authentication_systems_users WHERE (authentication_systems_users.user_id = users.id AND authentication_systems.id = authentication_systems_users.authentication_system_id AND (authentication_systems.type <> ? OR users.password_sign_in_enabled = TRUE) AND users.account_enabled = TRUE)) OR EXISTS (SELECT TRUE FROM authentication_systems asxs INNER JOIN authentication_systems_groups ON (asxs.id = authentication_systems_groups.authentication_system_id) INNER JOIN groups_users ON (authentication_systems_groups.group_id = groups_users.group_id AND authentication_systems_groups.group_id = groups_users.group_id AND groups_users.user_id = users.id) WHERE (asxs.id = authentication_systems.id AND users.account_enabled = TRUE))) AND authentication_systems.enabled = TRUE AND users.id = ?) ORDER BY authentication_systems.priority DESC, authentication_systems.id] 1]  type:  java.lang.String
2023-11-23T10:27:10.568Z NX-41294 DEBUG [pg-types.sql-parameter:326] - converted-parameter:  password
2023-11-23T10:27:10.569Z NX-41294 DEBUG [pg-types.sql-parameter:326] - calling convert-parameter with:  [:uuid #uuid "d532bee5-b9e3-44d4-bf73-a2c8f920a8bf" #object[com.zaxxer.hikari.pool.HikariProxyPreparedStatement 0x57afa3c9 HikariProxyPreparedStatement@1471128521 wrapping SELECT authentication_systems.id, authentication_systems.type, authentication_systems.name, authentication_systems.description, authentication_systems.external_sign_in_url FROM authentication_systems, users  WHERE ((EXISTS (SELECT TRUE FROM authentication_systems_users WHERE (authentication_systems_users.user_id = users.id AND authentication_systems.id = authentication_systems_users.authentication_system_id AND (authentication_systems.type <> 'password' OR users.password_sign_in_enabled = TRUE) AND users.account_enabled = TRUE)) OR EXISTS (SELECT TRUE FROM authentication_systems asxs INNER JOIN authentication_systems_groups ON (asxs.id = authentication_systems_groups.authentication_system_id) INNER JOIN groups_users ON (authentication_systems_groups.group_id = groups_users.group_id AND authentication_systems_groups.group_id = groups_users.group_id AND groups_users.user_id = users.id) WHERE (asxs.id = authentication_systems.id AND users.account_enabled = TRUE))) AND authentication_systems.enabled = TRUE AND users.id = ?) ORDER BY authentication_systems.priority DESC, authentication_systems.id] 2]  type:  java.util.UUID
2023-11-23T10:27:10.570Z NX-41294 DEBUG [pg-types.sql-parameter:326] - converted-parameter:  #uuid "d532bee5-b9e3-44d4-bf73-a2c8f920a8bf"
2023-11-23T10:27:10.579Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [password #object[org.postgresql.jdbc.PgResultSetMetaData 0x776ef048 org.postgresql.jdbc.PgResultSetMetaData@776ef048] 1]
2023-11-23T10:27:10.582Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:varchar password]
2023-11-23T10:27:10.583Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  password
2023-11-23T10:27:10.583Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [password #object[org.postgresql.jdbc.PgResultSetMetaData 0x776ef048 org.postgresql.jdbc.PgResultSetMetaData@776ef048] 2]
2023-11-23T10:27:10.583Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:varchar password]
2023-11-23T10:27:10.583Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  password
2023-11-23T10:27:10.583Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [leihs password #object[org.postgresql.jdbc.PgResultSetMetaData 0x776ef048 org.postgresql.jdbc.PgResultSetMetaData@776ef048] 3]
2023-11-23T10:27:10.584Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:varchar leihs password]
2023-11-23T10:27:10.584Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  leihs password
2023-11-23T10:27:10.586Z NX-41294 DEBUG [leihs.core.sign-in.back:153] - user {:system_admin_protected true, :address nil, :email "amelia@rosenbaum.name", :pool_protected false, :last_sign_in_at nil, :img32_url nil, :account_enabled true, :lastname "Kemmer", :phone nil, :img_digest nil, :org_id nil, :extended_info nil, :secondary_email nil, :city nil, :settings nil, :is_admin true, :organization "local", :login nil, :searchable "Dawna Kemmer amelia@rosenbaum.name    Kemmer Dawna", :updated_at #time/instant "2023-11-23T10:27:09.984114Z", :firstname "Dawna", :zip nil, :id #uuid "d532bee5-b9e3-44d4-bf73-a2c8f920a8bf", :url nil, :password_sign_in_enabled true, :account_disabled_at nil, :is_system_admin true, :badge_id nil, :language_locale nil, :img256_url nil, :country nil, :delegator_user_id nil, :created_at #time/instant "2023-11-23T10:27:09.984114Z", :admin_protected true} user-auth-systems ({:id "password", :type "password", :name "leihs password", :description nil, :external_sign_in_url nil}) sign-up-auth-systems ()
2023-11-23T10:27:10.592Z NX-41294 DEBUG [leihs.core.sign-in.back:82] - sign-in-page-params {:navbar {:csrfToken {:value "21950efb-b661-4ea6-8ec7-e870b8cf0f3e", :name "csrf-token"}, :config {:appTitle "leihs", :appColor "gray", :me nil, :subApps {}, :locales ({:name "English (UK)", :locale "en-GB", :active true, :isDefault true, :isSelected true} {:name "English (US)", :locale "en-US", :active true, :isDefault false, :isSelected false} {:name "Deutsch", :locale "de-CH", :active true, :isDefault false, :isSelected false} {:name "Züritüütsch", :locale "gsw-CH", :active true, :isDefault false, :isSelected false})}}, :authFlow {:user nil, :showPasswordSection false, :passwordButtonText "password_create_button_text", :passwordLink "/forgot-password", :returnTo nil}, :csrfToken {:value "21950efb-b661-4ea6-8ec7-e870b8cf0f3e", :name "csrf-token"}}
>>wrap-authenticate::handler #object[leihs.procurement.authorization$wrap_authorize$fn__39139 0x4c2b46cb leihs.procurement.authorization$wrap_authorize$fn__39139@4c2b46cb]
>>wrap-authenticate::request {:cookies {leihs-anti-csrf-token {:value 21950efb-b661-4ea6-8ec7-e870b8cf0f3e}}, :remote-addr 127.0.0.1, :start-time 392713558562375, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address your.lending.desk@example.com, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url nil, :sessions_force_uniqueness false, :email_signature Cheers,}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x60c0b1cb HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x56d4aa90 next.jdbc.result_set$as_unqualified_lower_maps@56d4aa90]}}, :query-params-raw {}, :route-params nil, :headers {sec-fetch-site same-origin, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0, cookie leihs-anti-csrf-token=21950efb-b661-4ea6-8ec7-e870b8cf0f3e, referer http://localhost:3230/sign-in, connection keep-alive, accept image/avif,image/webp,*/*, accept-language de,en-US;q=0.7,en;q=0.3, sec-fetch-dest image, accept-encoding gzip, deflate, br, sec-fetch-mode no-cors}, :async-channel #object[org.httpkit.server.AsyncChannel 0x7a3af682 /127.0.0.1:3230<->/127.0.0.1:64747], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x162ebe97 HikariDataSource (db-pool)]}, :content-length 0, :form-params {}, :websocket? false, :query-params {}, :content-type nil, :form-params-raw {}, :character-encoding utf8, :uri /favicon.ico, :server-name localhost, :handler-key :not-found, :query-string nil, :body nil, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.backend.html$not_found_handler 0x1b437e5 leihs.procurement.backend.html$not_found_handler@1b437e5], :multipart-params {}, :scheme :http, :request-method :get, :accept {:mime :html, :charset nil, :encoding nil, :language nil}}
>>>a nil
>>>b nil
>>wrap-authenticate::handler #object[leihs.procurement.authorization$wrap_authorize$fn__39139 0x4c2b46cb leihs.procurement.authorization$wrap_authorize$fn__39139@4c2b46cb]
>>wrap-authenticate::request {:cookies {leihs-anti-csrf-token {:value 21950efb-b661-4ea6-8ec7-e870b8cf0f3e}}, :remote-addr 127.0.0.1, :start-time 392713600576833, :params {:return-to /favicon.ico}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address your.lending.desk@example.com, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url nil, :sessions_force_uniqueness false, :email_signature Cheers,}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x60c0b1cb HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x56d4aa90 next.jdbc.result_set$as_unqualified_lower_maps@56d4aa90]}}, :query-params-raw {:return-to /favicon.ico}, :route-params nil, :headers {sec-fetch-site same-origin, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0, cookie leihs-anti-csrf-token=21950efb-b661-4ea6-8ec7-e870b8cf0f3e, referer http://localhost:3230/sign-in, connection keep-alive, accept image/avif,image/webp,*/*, accept-language de,en-US;q=0.7,en;q=0.3, sec-fetch-dest image, accept-encoding gzip, deflate, br, sec-fetch-mode no-cors}, :async-channel #object[org.httpkit.server.AsyncChannel 0x67931408 /127.0.0.1:3230<->/127.0.0.1:64747], :server-port 3230, :params-raw {:return-to /favicon.ico}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x162ebe97 HikariDataSource (db-pool)]}, :content-length 0, :form-params {}, :websocket? false, :query-params {:return-to /favicon.ico}, :content-type nil, :form-params-raw {}, :character-encoding utf8, :uri /sign-in, :server-name localhost, :handler-key :sign-in, :query-string return-to=%2Ffavicon.ico, :body nil, :graphql-schema #CompiledSchema<>, :handler #object[compojure.core$routes$fn__27950 0x73ae245d compojure.core$routes$fn__27950@73ae245d], :multipart-params {}, :scheme :http, :request-method :get, :accept {:mime :html, :charset nil, :encoding nil, :language nil}}
>>>a true
>>>b nil

>>1 authorize

>>1 handler #object[leihs.core.locale$wrap$fn__44238 0x46e66fe3 leihs.core.locale$wrap$fn__44238@46e66fe3]

>>1 request {:cookies {leihs-anti-csrf-token {:value 21950efb-b661-4ea6-8ec7-e870b8cf0f3e}}, :remote-addr 127.0.0.1, :start-time 392713600576833, :params {:return-to /favicon.ico}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address your.lending.desk@example.com, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url nil, :sessions_force_uniqueness false, :email_signature Cheers,}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x60c0b1cb HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x56d4aa90 next.jdbc.result_set$as_unqualified_lower_maps@56d4aa90]}}, :query-params-raw {:return-to /favicon.ico}, :route-params nil, :headers {sec-fetch-site same-origin, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0, cookie leihs-anti-csrf-token=21950efb-b661-4ea6-8ec7-e870b8cf0f3e, referer http://localhost:3230/sign-in, connection keep-alive, accept image/avif,image/webp,*/*, accept-language de,en-US;q=0.7,en;q=0.3, sec-fetch-dest image, accept-encoding gzip, deflate, br, sec-fetch-mode no-cors}, :async-channel #object[org.httpkit.server.AsyncChannel 0x67931408 /127.0.0.1:3230<->/127.0.0.1:64747], :server-port 3230, :params-raw {:return-to /favicon.ico}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x162ebe97 HikariDataSource (db-pool)]}, :content-length 0, :form-params {}, :websocket? false, :query-params {:return-to /favicon.ico}, :content-type nil, :form-params-raw {}, :character-encoding utf8, :uri /sign-in, :server-name localhost, :handler-key :sign-in, :query-string return-to=%2Ffavicon.ico, :body nil, :graphql-schema #CompiledSchema<>, :handler #object[compojure.core$routes$fn__27950 0x73ae245d compojure.core$routes$fn__27950@73ae245d], :multipart-params {}, :scheme :http, :request-method :get, :accept {:mime :html, :charset nil, :encoding nil, :language nil}}

>>1 (:handler-key request) :sign-in
>myprint>  authEnt? nil
>myprint>  txn {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x162ebe97 HikariDataSource (db-pool)]}
>myprint>  admin false

>2> [SELECT TRUE AS has_entry FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id IS NULL]

>myprint>  inspector false

>2> [SELECT TRUE AS has_entry FROM procurement_category_viewers WHERE user_id IS NULL]

>myprint>  viewer false
>myprint>  requester false
2023-11-23T10:27:10.801Z NX-41294 DEBUG [leihs.procurement.authorization:134] - (skip? (:handler-key request)) => true
2023-11-23T10:27:10.803Z NX-41294 DEBUG [pg-types.sql-parameter:326] - calling convert-parameter with:  [:text  #object[com.zaxxer.hikari.pool.HikariProxyPreparedStatement 0x4d991b5e HikariProxyPreparedStatement@1301879646 wrapping SELECT * FROM users  WHERE (users.org_id IS NULL OR users.login IS NULL OR lower(users.email) = ?)] 1]  type:  java.lang.String
2023-11-23T10:27:10.804Z NX-41294 DEBUG [pg-types.sql-parameter:326] - converted-parameter:
2023-11-23T10:27:10.805Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#uuid "d532bee5-b9e3-44d4-bf73-a2c8f920a8bf" #object[org.postgresql.jdbc.PgResultSetMetaData 0x16c76167 org.postgresql.jdbc.PgResultSetMetaData@16c76167] 1]
2023-11-23T10:27:10.805Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:uuid #uuid "d532bee5-b9e3-44d4-bf73-a2c8f920a8bf"]
2023-11-23T10:27:10.805Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  #uuid "d532bee5-b9e3-44d4-bf73-a2c8f920a8bf"
2023-11-23T10:27:10.806Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [Dawna #object[org.postgresql.jdbc.PgResultSetMetaData 0x16c76167 org.postgresql.jdbc.PgResultSetMetaData@16c76167] 3]
2023-11-23T10:27:10.806Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:text Dawna]
2023-11-23T10:27:10.806Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  Dawna
2023-11-23T10:27:10.806Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [Kemmer #object[org.postgresql.jdbc.PgResultSetMetaData 0x16c76167 org.postgresql.jdbc.PgResultSetMetaData@16c76167] 4]
2023-11-23T10:27:10.806Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:varchar Kemmer]
2023-11-23T10:27:10.807Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  Kemmer
2023-11-23T10:27:10.807Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [amelia@rosenbaum.name #object[org.postgresql.jdbc.PgResultSetMetaData 0x16c76167 org.postgresql.jdbc.PgResultSetMetaData@16c76167] 7]
2023-11-23T10:27:10.807Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:varchar amelia@rosenbaum.name]
2023-11-23T10:27:10.807Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  amelia@rosenbaum.name
2023-11-23T10:27:10.807Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#inst "2023-11-23T10:27:09.984114000-00:00" #object[org.postgresql.jdbc.PgResultSetMetaData 0x16c76167 org.postgresql.jdbc.PgResultSetMetaData@16c76167] 15]
2023-11-23T10:27:10.808Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:timestamptz #inst "2023-11-23T10:27:09.984114000-00:00"]
2023-11-23T10:27:10.808Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  #time/instant "2023-11-23T10:27:09.984114Z"
2023-11-23T10:27:10.808Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#inst "2023-11-23T10:27:09.984114000-00:00" #object[org.postgresql.jdbc.PgResultSetMetaData 0x16c76167 org.postgresql.jdbc.PgResultSetMetaData@16c76167] 16]
2023-11-23T10:27:10.808Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:timestamptz #inst "2023-11-23T10:27:09.984114000-00:00"]
2023-11-23T10:27:10.808Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  #time/instant "2023-11-23T10:27:09.984114Z"
2023-11-23T10:27:10.809Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [Dawna Kemmer amelia@rosenbaum.name    Kemmer Dawna #object[org.postgresql.jdbc.PgResultSetMetaData 0x16c76167 org.postgresql.jdbc.PgResultSetMetaData@16c76167] 25]
2023-11-23T10:27:10.809Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:text Dawna Kemmer amelia@rosenbaum.name    Kemmer Dawna]
2023-11-23T10:27:10.809Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  Dawna Kemmer amelia@rosenbaum.name    Kemmer Dawna
2023-11-23T10:27:10.810Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [local #object[org.postgresql.jdbc.PgResultSetMetaData 0x16c76167 org.postgresql.jdbc.PgResultSetMetaData@16c76167] 32]
2023-11-23T10:27:10.810Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:text local]
2023-11-23T10:27:10.810Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  local
2023-11-23T10:27:10.810Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#uuid "87e52826-a564-402c-9270-982277676945" #object[org.postgresql.jdbc.PgResultSetMetaData 0x16c76167 org.postgresql.jdbc.PgResultSetMetaData@16c76167] 1]
2023-11-23T10:27:10.810Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:uuid #uuid "87e52826-a564-402c-9270-982277676945"]
2023-11-23T10:27:10.811Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  #uuid "87e52826-a564-402c-9270-982277676945"
2023-11-23T10:27:10.811Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [Procurement #object[org.postgresql.jdbc.PgResultSetMetaData 0x16c76167 org.postgresql.jdbc.PgResultSetMetaData@16c76167] 3]
2023-11-23T10:27:10.811Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:text Procurement]
2023-11-23T10:27:10.811Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  Procurement
2023-11-23T10:27:10.811Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [Admin #object[org.postgresql.jdbc.PgResultSetMetaData 0x16c76167 org.postgresql.jdbc.PgResultSetMetaData@16c76167] 4]
2023-11-23T10:27:10.812Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:varchar Admin]
2023-11-23T10:27:10.812Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  Admin
2023-11-23T10:27:10.812Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [jimmie@goyette.com #object[org.postgresql.jdbc.PgResultSetMetaData 0x16c76167 org.postgresql.jdbc.PgResultSetMetaData@16c76167] 7]
2023-11-23T10:27:10.812Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:varchar jimmie@goyette.com]
2023-11-23T10:27:10.813Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  jimmie@goyette.com
2023-11-23T10:27:10.813Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#inst "2023-11-23T10:27:10.079341000-00:00" #object[org.postgresql.jdbc.PgResultSetMetaData 0x16c76167 org.postgresql.jdbc.PgResultSetMetaData@16c76167] 15]
2023-11-23T10:27:10.813Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:timestamptz #inst "2023-11-23T10:27:10.079341000-00:00"]
2023-11-23T10:27:10.816Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  #time/instant "2023-11-23T10:27:10.079341Z"
2023-11-23T10:27:10.816Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#inst "2023-11-23T10:27:10.079341000-00:00" #object[org.postgresql.jdbc.PgResultSetMetaData 0x16c76167 org.postgresql.jdbc.PgResultSetMetaData@16c76167] 16]
2023-11-23T10:27:10.816Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:timestamptz #inst "2023-11-23T10:27:10.079341000-00:00"]
2023-11-23T10:27:10.817Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  #time/instant "2023-11-23T10:27:10.079341Z"
2023-11-23T10:27:10.817Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [Procurement Admin jimmie@goyette.com    Admin Procurement #object[org.postgresql.jdbc.PgResultSetMetaData 0x16c76167 org.postgresql.jdbc.PgResultSetMetaData@16c76167] 25]
2023-11-23T10:27:10.817Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:text Procurement Admin jimmie@goyette.com    Admin Procurement]
2023-11-23T10:27:10.817Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  Procurement Admin jimmie@goyette.com    Admin Procurement
2023-11-23T10:27:10.818Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [local #object[org.postgresql.jdbc.PgResultSetMetaData 0x16c76167 org.postgresql.jdbc.PgResultSetMetaData@16c76167] 32]
2023-11-23T10:27:10.818Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:text local]
2023-11-23T10:27:10.818Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  local
2023-11-23T10:27:10.818Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#uuid "6c6010ff-5045-4ee8-b0d6-4062e8ab4f6b" #object[org.postgresql.jdbc.PgResultSetMetaData 0x16c76167 org.postgresql.jdbc.PgResultSetMetaData@16c76167] 1]
2023-11-23T10:27:10.818Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:uuid #uuid "6c6010ff-5045-4ee8-b0d6-4062e8ab4f6b"]
2023-11-23T10:27:10.819Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  #uuid "6c6010ff-5045-4ee8-b0d6-4062e8ab4f6b"
2023-11-23T10:27:10.819Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [Lynsey #object[org.postgresql.jdbc.PgResultSetMetaData 0x16c76167 org.postgresql.jdbc.PgResultSetMetaData@16c76167] 3]
2023-11-23T10:27:10.819Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:text Lynsey]
2023-11-23T10:27:10.819Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  Lynsey
2023-11-23T10:27:10.820Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [Kertzmann #object[org.postgresql.jdbc.PgResultSetMetaData 0x16c76167 org.postgresql.jdbc.PgResultSetMetaData@16c76167] 4]
2023-11-23T10:27:10.820Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:varchar Kertzmann]
2023-11-23T10:27:10.820Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  Kertzmann
2023-11-23T10:27:10.820Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [chanda@ortiz.net #object[org.postgresql.jdbc.PgResultSetMetaData 0x16c76167 org.postgresql.jdbc.PgResultSetMetaData@16c76167] 7]
2023-11-23T10:27:10.821Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:varchar chanda@ortiz.net]
2023-11-23T10:27:10.821Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  chanda@ortiz.net
2023-11-23T10:27:10.821Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#inst "2023-11-23T10:27:10.105740000-00:00" #object[org.postgresql.jdbc.PgResultSetMetaData 0x16c76167 org.postgresql.jdbc.PgResultSetMetaData@16c76167] 15]
2023-11-23T10:27:10.821Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:timestamptz #inst "2023-11-23T10:27:10.105740000-00:00"]
2023-11-23T10:27:10.821Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  #time/instant "2023-11-23T10:27:10.105740Z"
2023-11-23T10:27:10.822Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#inst "2023-11-23T10:27:10.105740000-00:00" #object[org.postgresql.jdbc.PgResultSetMetaData 0x16c76167 org.postgresql.jdbc.PgResultSetMetaData@16c76167] 16]
2023-11-23T10:27:10.822Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:timestamptz #inst "2023-11-23T10:27:10.105740000-00:00"]
2023-11-23T10:27:10.822Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  #time/instant "2023-11-23T10:27:10.105740Z"
2023-11-23T10:27:10.822Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [Lynsey Kertzmann chanda@ortiz.net    Kertzmann Lynsey #object[org.postgresql.jdbc.PgResultSetMetaData 0x16c76167 org.postgresql.jdbc.PgResultSetMetaData@16c76167] 25]
2023-11-23T10:27:10.822Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:text Lynsey Kertzmann chanda@ortiz.net    Kertzmann Lynsey]
2023-11-23T10:27:10.822Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  Lynsey Kertzmann chanda@ortiz.net    Kertzmann Lynsey
2023-11-23T10:27:10.823Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [local #object[org.postgresql.jdbc.PgResultSetMetaData 0x16c76167 org.postgresql.jdbc.PgResultSetMetaData@16c76167] 32]
2023-11-23T10:27:10.823Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:text local]
2023-11-23T10:27:10.823Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  local
2023-11-23T10:27:10.825Z NX-41294 DEBUG [pg-types.sql-parameter:326] - calling convert-parameter with:  [:text password #object[com.zaxxer.hikari.pool.HikariProxyPreparedStatement 0x69243921 HikariProxyPreparedStatement@1763981601 wrapping SELECT authentication_systems.id, authentication_systems.type, authentication_systems.name, authentication_systems.description, authentication_systems.external_sign_in_url FROM authentication_systems, users  WHERE ((EXISTS (SELECT TRUE FROM authentication_systems_users WHERE (authentication_systems_users.user_id = users.id AND authentication_systems.id = authentication_systems_users.authentication_system_id AND (authentication_systems.type <> ? OR users.password_sign_in_enabled = TRUE) AND users.account_enabled = TRUE)) OR EXISTS (SELECT TRUE FROM authentication_systems asxs INNER JOIN authentication_systems_groups ON (asxs.id = authentication_systems_groups.authentication_system_id) INNER JOIN groups_users ON (authentication_systems_groups.group_id = groups_users.group_id AND authentication_systems_groups.group_id = groups_users.group_id AND groups_users.user_id = users.id) WHERE (asxs.id = authentication_systems.id AND users.account_enabled = TRUE))) AND authentication_systems.enabled = TRUE AND users.id = ?) ORDER BY authentication_systems.priority DESC, authentication_systems.id] 1]  type:  java.lang.String
2023-11-23T10:27:10.826Z NX-41294 DEBUG [pg-types.sql-parameter:326] - converted-parameter:  password
2023-11-23T10:27:10.827Z NX-41294 DEBUG [pg-types.sql-parameter:326] - calling convert-parameter with:  [:uuid #uuid "d532bee5-b9e3-44d4-bf73-a2c8f920a8bf" #object[com.zaxxer.hikari.pool.HikariProxyPreparedStatement 0x69243921 HikariProxyPreparedStatement@1763981601 wrapping SELECT authentication_systems.id, authentication_systems.type, authentication_systems.name, authentication_systems.description, authentication_systems.external_sign_in_url FROM authentication_systems, users  WHERE ((EXISTS (SELECT TRUE FROM authentication_systems_users WHERE (authentication_systems_users.user_id = users.id AND authentication_systems.id = authentication_systems_users.authentication_system_id AND (authentication_systems.type <> 'password' OR users.password_sign_in_enabled = TRUE) AND users.account_enabled = TRUE)) OR EXISTS (SELECT TRUE FROM authentication_systems asxs INNER JOIN authentication_systems_groups ON (asxs.id = authentication_systems_groups.authentication_system_id) INNER JOIN groups_users ON (authentication_systems_groups.group_id = groups_users.group_id AND authentication_systems_groups.group_id = groups_users.group_id AND groups_users.user_id = users.id) WHERE (asxs.id = authentication_systems.id AND users.account_enabled = TRUE))) AND authentication_systems.enabled = TRUE AND users.id = ?) ORDER BY authentication_systems.priority DESC, authentication_systems.id] 2]  type:  java.util.UUID
2023-11-23T10:27:10.827Z NX-41294 DEBUG [pg-types.sql-parameter:326] - converted-parameter:  #uuid "d532bee5-b9e3-44d4-bf73-a2c8f920a8bf"
2023-11-23T10:27:10.829Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [password #object[org.postgresql.jdbc.PgResultSetMetaData 0x28f468a6 org.postgresql.jdbc.PgResultSetMetaData@28f468a6] 1]
2023-11-23T10:27:10.829Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:varchar password]
2023-11-23T10:27:10.829Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  password
2023-11-23T10:27:10.829Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [password #object[org.postgresql.jdbc.PgResultSetMetaData 0x28f468a6 org.postgresql.jdbc.PgResultSetMetaData@28f468a6] 2]
2023-11-23T10:27:10.829Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:varchar password]
2023-11-23T10:27:10.829Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  password
2023-11-23T10:27:10.829Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [leihs password #object[org.postgresql.jdbc.PgResultSetMetaData 0x28f468a6 org.postgresql.jdbc.PgResultSetMetaData@28f468a6] 3]
2023-11-23T10:27:10.830Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:varchar leihs password]
2023-11-23T10:27:10.830Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  leihs password
2023-11-23T10:27:10.832Z NX-41294 DEBUG [leihs.core.sign-in.back:153] - user {:system_admin_protected true, :address nil, :email "amelia@rosenbaum.name", :pool_protected false, :last_sign_in_at nil, :img32_url nil, :account_enabled true, :lastname "Kemmer", :phone nil, :img_digest nil, :org_id nil, :extended_info nil, :secondary_email nil, :city nil, :settings nil, :is_admin true, :organization "local", :login nil, :searchable "Dawna Kemmer amelia@rosenbaum.name    Kemmer Dawna", :updated_at #time/instant "2023-11-23T10:27:09.984114Z", :firstname "Dawna", :zip nil, :id #uuid "d532bee5-b9e3-44d4-bf73-a2c8f920a8bf", :url nil, :password_sign_in_enabled true, :account_disabled_at nil, :is_system_admin true, :badge_id nil, :language_locale nil, :img256_url nil, :country nil, :delegator_user_id nil, :created_at #time/instant "2023-11-23T10:27:09.984114Z", :admin_protected true} user-auth-systems ({:id "password", :type "password", :name "leihs password", :description nil, :external_sign_in_url nil}) sign-up-auth-systems ()
2023-11-23T10:27:10.835Z NX-41294 DEBUG [leihs.core.sign-in.back:82] - sign-in-page-params {:navbar {:csrfToken {:value "21950efb-b661-4ea6-8ec7-e870b8cf0f3e", :name "csrf-token"}, :config {:appTitle "leihs", :appColor "gray", :me nil, :subApps {}, :locales ({:name "English (UK)", :locale "en-GB", :active true, :isDefault true, :isSelected true} {:name "English (US)", :locale "en-US", :active true, :isDefault false, :isSelected false} {:name "Deutsch", :locale "de-CH", :active true, :isDefault false, :isSelected false} {:name "Züritüütsch", :locale "gsw-CH", :active true, :isDefault false, :isSelected false})}}, :authFlow {:user nil, :showPasswordSection false, :passwordButtonText "password_create_button_text", :passwordLink "/forgot-password", :returnTo "/favicon.ico"}, :csrfToken {:value "21950efb-b661-4ea6-8ec7-e870b8cf0f3e", :name "csrf-token"}}
>>wrap-authenticate::handler #object[leihs.procurement.authorization$wrap_authorize$fn__39139 0x4c2b46cb leihs.procurement.authorization$wrap_authorize$fn__39139@4c2b46cb]
>>wrap-authenticate::request {:cookies {leihs-anti-csrf-token {:value 21950efb-b661-4ea6-8ec7-e870b8cf0f3e}}, :remote-addr 127.0.0.1, :start-time 392713925064583, :params {:user jimmie@goyette.com, :password nil, :csrf-token 21950efb-b661-4ea6-8ec7-e870b8cf0f3e}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address your.lending.desk@example.com, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url nil, :sessions_force_uniqueness false, :email_signature Cheers,}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.pool.HikariProxyConnection 0x7d242e29 HikariProxyConnection@2099523113 wrapping org.postgresql.jdbc.PgConnection@1d3079fc], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x56d4aa90 next.jdbc.result_set$as_unqualified_lower_maps@56d4aa90]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0, content-type application/x-www-form-urlencoded, cookie leihs-anti-csrf-token=21950efb-b661-4ea6-8ec7-e870b8cf0f3e, content-length 83, sec-fetch-user ?1, referer http://localhost:3230/sign-in, connection keep-alive, upgrade-insecure-requests 1, accept text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8, accept-language de,en-US;q=0.7,en;q=0.3, sec-fetch-dest document, accept-encoding gzip, deflate, br, sec-fetch-mode navigate}, :async-channel #object[org.httpkit.server.AsyncChannel 0x4db66338 /127.0.0.1:3230<->/127.0.0.1:64747], :server-port 3230, :params-raw {:user jimmie@goyette.com, :password , :csrf-token 21950efb-b661-4ea6-8ec7-e870b8cf0f3e}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x162ebe97 HikariDataSource (db-pool)], :connection #object[com.zaxxer.hikari.pool.HikariProxyConnection 0xbb18006 HikariProxyConnection@196182022 wrapping org.postgresql.jdbc.PgConnection@33c3a483], :level 1, :rollback #object[clojure.lang.Atom 0x48b97d9e {:status :ready, :val false}]}, :content-length 83, :form-params {:user jimmie@goyette.com, :password nil, :csrf-token 21950efb-b661-4ea6-8ec7-e870b8cf0f3e}, :websocket? false, :query-params {}, :content-type application/x-www-form-urlencoded, :form-params-raw {:user jimmie@goyette.com, :password , :csrf-token 21950efb-b661-4ea6-8ec7-e870b8cf0f3e}, :character-encoding utf8, :uri /sign-in, :server-name localhost, :handler-key :sign-in, :query-string nil, :body #object[org.httpkit.BytesInputStream 0x1f351e24 BytesInputStream[len=83]], :graphql-schema #CompiledSchema<>, :handler #object[compojure.core$routes$fn__27950 0x73ae245d compojure.core$routes$fn__27950@73ae245d], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :html, :charset nil, :encoding nil, :language nil}}
>>>a true
>>>b nil

>>1 authorize

>>1 handler #object[leihs.core.locale$wrap$fn__44238 0x46e66fe3 leihs.core.locale$wrap$fn__44238@46e66fe3]

>>1 request {:cookies {leihs-anti-csrf-token {:value 21950efb-b661-4ea6-8ec7-e870b8cf0f3e}}, :remote-addr 127.0.0.1, :start-time 392713925064583, :params {:user jimmie@goyette.com, :password nil, :csrf-token 21950efb-b661-4ea6-8ec7-e870b8cf0f3e}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address your.lending.desk@example.com, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url nil, :sessions_force_uniqueness false, :email_signature Cheers,}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.pool.HikariProxyConnection 0x7d242e29 HikariProxyConnection@2099523113 wrapping org.postgresql.jdbc.PgConnection@1d3079fc], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x56d4aa90 next.jdbc.result_set$as_unqualified_lower_maps@56d4aa90]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0, content-type application/x-www-form-urlencoded, cookie leihs-anti-csrf-token=21950efb-b661-4ea6-8ec7-e870b8cf0f3e, content-length 83, sec-fetch-user ?1, referer http://localhost:3230/sign-in, connection keep-alive, upgrade-insecure-requests 1, accept text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8, accept-language de,en-US;q=0.7,en;q=0.3, sec-fetch-dest document, accept-encoding gzip, deflate, br, sec-fetch-mode navigate}, :async-channel #object[org.httpkit.server.AsyncChannel 0x4db66338 /127.0.0.1:3230<->/127.0.0.1:64747], :server-port 3230, :params-raw {:user jimmie@goyette.com, :password , :csrf-token 21950efb-b661-4ea6-8ec7-e870b8cf0f3e}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x162ebe97 HikariDataSource (db-pool)], :connection #object[com.zaxxer.hikari.pool.HikariProxyConnection 0xbb18006 HikariProxyConnection@196182022 wrapping org.postgresql.jdbc.PgConnection@33c3a483], :level 1, :rollback #object[clojure.lang.Atom 0x48b97d9e {:status :ready, :val false}]}, :content-length 83, :form-params {:user jimmie@goyette.com, :password nil, :csrf-token 21950efb-b661-4ea6-8ec7-e870b8cf0f3e}, :websocket? false, :query-params {}, :content-type application/x-www-form-urlencoded, :form-params-raw {:user jimmie@goyette.com, :password , :csrf-token 21950efb-b661-4ea6-8ec7-e870b8cf0f3e}, :character-encoding utf8, :uri /sign-in, :server-name localhost, :handler-key :sign-in, :query-string nil, :body #object[org.httpkit.BytesInputStream 0x1f351e24 BytesInputStream[len=83]], :graphql-schema #CompiledSchema<>, :handler #object[compojure.core$routes$fn__27950 0x73ae245d compojure.core$routes$fn__27950@73ae245d], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :html, :charset nil, :encoding nil, :language nil}}

>>1 (:handler-key request) :sign-in
>myprint>  authEnt? nil
>myprint>  txn {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x162ebe97 HikariDataSource (db-pool)], :connection #object[com.zaxxer.hikari.pool.HikariProxyConnection 0xbb18006 HikariProxyConnection@196182022 wrapping org.postgresql.jdbc.PgConnection@33c3a483], :level 1, :rollback #object[clojure.lang.Atom 0x48b97d9e {:status :ready, :val false}]}
>myprint>  admin false

>2> [SELECT TRUE AS has_entry FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id IS NULL]

>myprint>  inspector false

>2> [SELECT TRUE AS has_entry FROM procurement_category_viewers WHERE user_id IS NULL]

>myprint>  viewer false
>myprint>  requester false
2023-11-23T10:27:11.134Z NX-41294 DEBUG [leihs.procurement.authorization:134] - (skip? (:handler-key request)) => true
2023-11-23T10:27:11.136Z NX-41294 DEBUG [pg-types.sql-parameter:326] - calling convert-parameter with:  [:text jimmie@goyette.com #object[com.zaxxer.hikari.pool.HikariProxyPreparedStatement 0x45d1ff24 HikariProxyPreparedStatement@1171390244 wrapping SELECT * FROM users  WHERE (users.org_id = ? OR users.login = ? OR lower(users.email) = ?)] 1]  type:  java.lang.String
2023-11-23T10:27:11.137Z NX-41294 DEBUG [pg-types.sql-parameter:326] - converted-parameter:  jimmie@goyette.com
2023-11-23T10:27:11.137Z NX-41294 DEBUG [pg-types.sql-parameter:326] - calling convert-parameter with:  [:text jimmie@goyette.com #object[com.zaxxer.hikari.pool.HikariProxyPreparedStatement 0x45d1ff24 HikariProxyPreparedStatement@1171390244 wrapping SELECT * FROM users  WHERE (users.org_id = 'jimmie@goyette.com' OR users.login = ? OR lower(users.email) = ?)] 2]  type:  java.lang.String
2023-11-23T10:27:11.137Z NX-41294 DEBUG [pg-types.sql-parameter:326] - converted-parameter:  jimmie@goyette.com
2023-11-23T10:27:11.138Z NX-41294 DEBUG [pg-types.sql-parameter:326] - calling convert-parameter with:  [:text jimmie@goyette.com #object[com.zaxxer.hikari.pool.HikariProxyPreparedStatement 0x45d1ff24 HikariProxyPreparedStatement@1171390244 wrapping SELECT * FROM users  WHERE (users.org_id = 'jimmie@goyette.com' OR users.login = 'jimmie@goyette.com' OR lower(users.email) = ?)] 3]  type:  java.lang.String
2023-11-23T10:27:11.138Z NX-41294 DEBUG [pg-types.sql-parameter:326] - converted-parameter:  jimmie@goyette.com
2023-11-23T10:27:11.139Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#uuid "87e52826-a564-402c-9270-982277676945" #object[org.postgresql.jdbc.PgResultSetMetaData 0x3574d794 org.postgresql.jdbc.PgResultSetMetaData@3574d794] 1]
2023-11-23T10:27:11.139Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:uuid #uuid "87e52826-a564-402c-9270-982277676945"]
2023-11-23T10:27:11.139Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  #uuid "87e52826-a564-402c-9270-982277676945"
2023-11-23T10:27:11.140Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [Procurement #object[org.postgresql.jdbc.PgResultSetMetaData 0x3574d794 org.postgresql.jdbc.PgResultSetMetaData@3574d794] 3]
2023-11-23T10:27:11.140Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:text Procurement]
2023-11-23T10:27:11.140Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  Procurement
2023-11-23T10:27:11.140Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [Admin #object[org.postgresql.jdbc.PgResultSetMetaData 0x3574d794 org.postgresql.jdbc.PgResultSetMetaData@3574d794] 4]
2023-11-23T10:27:11.140Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:varchar Admin]
2023-11-23T10:27:11.141Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  Admin
2023-11-23T10:27:11.141Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [jimmie@goyette.com #object[org.postgresql.jdbc.PgResultSetMetaData 0x3574d794 org.postgresql.jdbc.PgResultSetMetaData@3574d794] 7]
2023-11-23T10:27:11.141Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:varchar jimmie@goyette.com]
2023-11-23T10:27:11.141Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  jimmie@goyette.com
2023-11-23T10:27:11.142Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#inst "2023-11-23T10:27:10.079341000-00:00" #object[org.postgresql.jdbc.PgResultSetMetaData 0x3574d794 org.postgresql.jdbc.PgResultSetMetaData@3574d794] 15]
2023-11-23T10:27:11.142Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:timestamptz #inst "2023-11-23T10:27:10.079341000-00:00"]
2023-11-23T10:27:11.142Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  #time/instant "2023-11-23T10:27:10.079341Z"
2023-11-23T10:27:11.142Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#inst "2023-11-23T10:27:10.079341000-00:00" #object[org.postgresql.jdbc.PgResultSetMetaData 0x3574d794 org.postgresql.jdbc.PgResultSetMetaData@3574d794] 16]
2023-11-23T10:27:11.142Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:timestamptz #inst "2023-11-23T10:27:10.079341000-00:00"]
2023-11-23T10:27:11.143Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  #time/instant "2023-11-23T10:27:10.079341Z"
2023-11-23T10:27:11.143Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [Procurement Admin jimmie@goyette.com    Admin Procurement #object[org.postgresql.jdbc.PgResultSetMetaData 0x3574d794 org.postgresql.jdbc.PgResultSetMetaData@3574d794] 25]
2023-11-23T10:27:11.143Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:text Procurement Admin jimmie@goyette.com    Admin Procurement]
2023-11-23T10:27:11.144Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  Procurement Admin jimmie@goyette.com    Admin Procurement
2023-11-23T10:27:11.144Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [local #object[org.postgresql.jdbc.PgResultSetMetaData 0x3574d794 org.postgresql.jdbc.PgResultSetMetaData@3574d794] 32]
2023-11-23T10:27:11.144Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:text local]
2023-11-23T10:27:11.144Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  local
2023-11-23T10:27:11.145Z NX-41294 DEBUG [pg-types.sql-parameter:326] - calling convert-parameter with:  [:text password #object[com.zaxxer.hikari.pool.HikariProxyPreparedStatement 0x4b8e05b1 HikariProxyPreparedStatement@1267598769 wrapping SELECT authentication_systems.id, authentication_systems.type, authentication_systems.name, authentication_systems.description, authentication_systems.external_sign_in_url FROM authentication_systems, users  WHERE ((EXISTS (SELECT TRUE FROM authentication_systems_users WHERE (authentication_systems_users.user_id = users.id AND authentication_systems.id = authentication_systems_users.authentication_system_id AND (authentication_systems.type <> ? OR users.password_sign_in_enabled = TRUE) AND users.account_enabled = TRUE)) OR EXISTS (SELECT TRUE FROM authentication_systems asxs INNER JOIN authentication_systems_groups ON (asxs.id = authentication_systems_groups.authentication_system_id) INNER JOIN groups_users ON (authentication_systems_groups.group_id = groups_users.group_id AND authentication_systems_groups.group_id = groups_users.group_id AND groups_users.user_id = users.id) WHERE (asxs.id = authentication_systems.id AND users.account_enabled = TRUE))) AND authentication_systems.enabled = TRUE AND users.id = ?) ORDER BY authentication_systems.priority DESC, authentication_systems.id] 1]  type:  java.lang.String
2023-11-23T10:27:11.146Z NX-41294 DEBUG [pg-types.sql-parameter:326] - converted-parameter:  password
2023-11-23T10:27:11.147Z NX-41294 DEBUG [pg-types.sql-parameter:326] - calling convert-parameter with:  [:uuid #uuid "87e52826-a564-402c-9270-982277676945" #object[com.zaxxer.hikari.pool.HikariProxyPreparedStatement 0x4b8e05b1 HikariProxyPreparedStatement@1267598769 wrapping SELECT authentication_systems.id, authentication_systems.type, authentication_systems.name, authentication_systems.description, authentication_systems.external_sign_in_url FROM authentication_systems, users  WHERE ((EXISTS (SELECT TRUE FROM authentication_systems_users WHERE (authentication_systems_users.user_id = users.id AND authentication_systems.id = authentication_systems_users.authentication_system_id AND (authentication_systems.type <> 'password' OR users.password_sign_in_enabled = TRUE) AND users.account_enabled = TRUE)) OR EXISTS (SELECT TRUE FROM authentication_systems asxs INNER JOIN authentication_systems_groups ON (asxs.id = authentication_systems_groups.authentication_system_id) INNER JOIN groups_users ON (authentication_systems_groups.group_id = groups_users.group_id AND authentication_systems_groups.group_id = groups_users.group_id AND groups_users.user_id = users.id) WHERE (asxs.id = authentication_systems.id AND users.account_enabled = TRUE))) AND authentication_systems.enabled = TRUE AND users.id = ?) ORDER BY authentication_systems.priority DESC, authentication_systems.id] 2]  type:  java.util.UUID
2023-11-23T10:27:11.148Z NX-41294 DEBUG [pg-types.sql-parameter:326] - converted-parameter:  #uuid "87e52826-a564-402c-9270-982277676945"
2023-11-23T10:27:11.150Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [password #object[org.postgresql.jdbc.PgResultSetMetaData 0x37e18823 org.postgresql.jdbc.PgResultSetMetaData@37e18823] 1]
2023-11-23T10:27:11.151Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:varchar password]
2023-11-23T10:27:11.151Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  password
2023-11-23T10:27:11.151Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [password #object[org.postgresql.jdbc.PgResultSetMetaData 0x37e18823 org.postgresql.jdbc.PgResultSetMetaData@37e18823] 2]
2023-11-23T10:27:11.151Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:varchar password]
2023-11-23T10:27:11.151Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  password
2023-11-23T10:27:11.151Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [leihs password #object[org.postgresql.jdbc.PgResultSetMetaData 0x37e18823 org.postgresql.jdbc.PgResultSetMetaData@37e18823] 3]
2023-11-23T10:27:11.151Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:varchar leihs password]
2023-11-23T10:27:11.151Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  leihs password
2023-11-23T10:27:11.152Z NX-41294 DEBUG [pg-types.sql-parameter:326] - calling convert-parameter with:  [:text jimmie@goyette.com #object[com.zaxxer.hikari.pool.HikariProxyPreparedStatement 0x2a61694b HikariProxyPreparedStatement@711027019 wrapping SELECT * FROM authentication_systems  WHERE (authentication_systems.sign_up_email_match IS NOT NULL AND ? ~* authentication_systems.sign_up_email_match)] 1]  type:  java.lang.String
2023-11-23T10:27:11.152Z NX-41294 DEBUG [pg-types.sql-parameter:326] - converted-parameter:  jimmie@goyette.com
2023-11-23T10:27:11.154Z NX-41294 DEBUG [leihs.core.sign-in.back:153] - user {:system_admin_protected false, :address nil, :email "jimmie@goyette.com", :pool_protected false, :last_sign_in_at nil, :img32_url nil, :account_enabled true, :lastname "Admin", :phone nil, :img_digest nil, :org_id nil, :extended_info nil, :secondary_email nil, :city nil, :settings nil, :is_admin false, :organization "local", :login nil, :searchable "Procurement Admin jimmie@goyette.com    Admin Procurement", :updated_at #time/instant "2023-11-23T10:27:10.079341Z", :firstname "Procurement", :zip nil, :id #uuid "87e52826-a564-402c-9270-982277676945", :url nil, :password_sign_in_enabled true, :account_disabled_at nil, :is_system_admin false, :badge_id nil, :language_locale nil, :img256_url nil, :country nil, :delegator_user_id nil, :created_at #time/instant "2023-11-23T10:27:10.079341Z", :admin_protected false} user-auth-systems ({:id "password", :type "password", :name "leihs password", :description nil, :external_sign_in_url nil}) sign-up-auth-systems ()
2023-11-23T10:27:11.157Z NX-41294 DEBUG [pg-types.sql-parameter:326] - calling convert-parameter with:  [:text password #object[com.zaxxer.hikari.pool.HikariProxyPreparedStatement 0x4f3e3129 HikariProxyPreparedStatement@1329475881 wrapping SELECT * FROM authentication_systems  WHERE type = ?] 1]  type:  java.lang.String
2023-11-23T10:27:11.157Z NX-41294 DEBUG [pg-types.sql-parameter:326] - converted-parameter:  password
2023-11-23T10:27:11.158Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [password #object[org.postgresql.jdbc.PgResultSetMetaData 0x503f6d85 org.postgresql.jdbc.PgResultSetMetaData@503f6d85] 1]
2023-11-23T10:27:11.161Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:varchar password]
2023-11-23T10:27:11.161Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  password
2023-11-23T10:27:11.162Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [leihs password #object[org.postgresql.jdbc.PgResultSetMetaData 0x503f6d85 org.postgresql.jdbc.PgResultSetMetaData@503f6d85] 2]
2023-11-23T10:27:11.162Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:varchar leihs password]
2023-11-23T10:27:11.162Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  leihs password
2023-11-23T10:27:11.162Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [password #object[org.postgresql.jdbc.PgResultSetMetaData 0x503f6d85 org.postgresql.jdbc.PgResultSetMetaData@503f6d85] 4]
2023-11-23T10:27:11.162Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:varchar password]
2023-11-23T10:27:11.162Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  password
2023-11-23T10:27:11.162Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [0 #object[org.postgresql.jdbc.PgResultSetMetaData 0x503f6d85 org.postgresql.jdbc.PgResultSetMetaData@503f6d85] 6]
2023-11-23T10:27:11.163Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:int4 0]
2023-11-23T10:27:11.163Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  0
2023-11-23T10:27:11.164Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#inst "2020-11-05T12:50:39.546594000-00:00" #object[org.postgresql.jdbc.PgResultSetMetaData 0x503f6d85 org.postgresql.jdbc.PgResultSetMetaData@503f6d85] 15]
2023-11-23T10:27:11.164Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:timestamptz #inst "2020-11-05T12:50:39.546594000-00:00"]
2023-11-23T10:27:11.164Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  #time/instant "2020-11-05T12:50:39.546594Z"
2023-11-23T10:27:11.164Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#inst "2020-11-05T12:50:39.546594000-00:00" #object[org.postgresql.jdbc.PgResultSetMetaData 0x503f6d85 org.postgresql.jdbc.PgResultSetMetaData@503f6d85] 16]
2023-11-23T10:27:11.164Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:timestamptz #inst "2020-11-05T12:50:39.546594000-00:00"]
2023-11-23T10:27:11.165Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  #time/instant "2020-11-05T12:50:39.546594Z"
2023-11-23T10:27:11.167Z NX-41294 DEBUG [leihs.core.sign-in.back:82] - sign-in-page-params {:navbar {:csrfToken {:value "21950efb-b661-4ea6-8ec7-e870b8cf0f3e", :name "csrf-token"}, :config {:appTitle "leihs", :appColor "gray", :me nil, :subApps {}, :locales ({:name "English (UK)", :locale "en-GB", :active true, :isDefault true, :isSelected true} {:name "English (US)", :locale "en-US", :active true, :isDefault false, :isSelected false} {:name "Deutsch", :locale "de-CH", :active true, :isDefault false, :isSelected false} {:name "Züritüütsch", :locale "gsw-CH", :active true, :isDefault false, :isSelected false})}}, :authFlow {:user "jimmie@goyette.com", :showPasswordSection true, :passwordButtonText "password_forgot_button_text", :passwordLink "/forgot-password", :returnTo nil}, :csrfToken {:value "21950efb-b661-4ea6-8ec7-e870b8cf0f3e", :name "csrf-token"}, :authSystems ({:id "password", :type "password", :name "leihs password", :description nil, :external_sign_in_url nil})}
>>wrap-authenticate::handler #object[leihs.procurement.authorization$wrap_authorize$fn__39139 0x4c2b46cb leihs.procurement.authorization$wrap_authorize$fn__39139@4c2b46cb]
>>wrap-authenticate::request {:cookies {leihs-anti-csrf-token {:value 21950efb-b661-4ea6-8ec7-e870b8cf0f3e}}, :remote-addr 127.0.0.1, :start-time 392714152591125, :params {:user jimmie@goyette.com, :password password, :csrf-token 21950efb-b661-4ea6-8ec7-e870b8cf0f3e}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address your.lending.desk@example.com, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url nil, :sessions_force_uniqueness false, :email_signature Cheers,}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.pool.HikariProxyConnection 0x4847284b HikariProxyConnection@1212622923 wrapping org.postgresql.jdbc.PgConnection@1d3079fc], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x56d4aa90 next.jdbc.result_set$as_unqualified_lower_maps@56d4aa90]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0, content-type application/x-www-form-urlencoded, cookie leihs-anti-csrf-token=21950efb-b661-4ea6-8ec7-e870b8cf0f3e, content-length 91, sec-fetch-user ?1, referer http://localhost:3230/sign-in, connection keep-alive, upgrade-insecure-requests 1, accept text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8, accept-language de,en-US;q=0.7,en;q=0.3, sec-fetch-dest document, accept-encoding gzip, deflate, br, sec-fetch-mode navigate}, :async-channel #object[org.httpkit.server.AsyncChannel 0xe448f2c /127.0.0.1:3230<->/127.0.0.1:64747], :server-port 3230, :params-raw {:user jimmie@goyette.com, :password password, :csrf-token 21950efb-b661-4ea6-8ec7-e870b8cf0f3e}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x162ebe97 HikariDataSource (db-pool)], :connection #object[com.zaxxer.hikari.pool.HikariProxyConnection 0x398bd249 HikariProxyConnection@965464649 wrapping org.postgresql.jdbc.PgConnection@33c3a483], :level 1, :rollback #object[clojure.lang.Atom 0x5d48054f {:status :ready, :val false}]}, :content-length 91, :form-params {:user jimmie@goyette.com, :password password, :csrf-token 21950efb-b661-4ea6-8ec7-e870b8cf0f3e}, :websocket? false, :query-params {}, :content-type application/x-www-form-urlencoded, :form-params-raw {:user jimmie@goyette.com, :password password, :csrf-token 21950efb-b661-4ea6-8ec7-e870b8cf0f3e}, :character-encoding utf8, :uri /sign-in, :server-name localhost, :handler-key :sign-in, :query-string nil, :body #object[org.httpkit.BytesInputStream 0x2cbc7bdd BytesInputStream[len=91]], :graphql-schema #CompiledSchema<>, :handler #object[compojure.core$routes$fn__27950 0x73ae245d compojure.core$routes$fn__27950@73ae245d], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :html, :charset nil, :encoding nil, :language nil}}
>>>a true
>>>b nil

>>1 authorize

>>1 handler #object[leihs.core.locale$wrap$fn__44238 0x46e66fe3 leihs.core.locale$wrap$fn__44238@46e66fe3]

>>1 request {:cookies {leihs-anti-csrf-token {:value 21950efb-b661-4ea6-8ec7-e870b8cf0f3e}}, :remote-addr 127.0.0.1, :start-time 392714152591125, :params {:user jimmie@goyette.com, :password password, :csrf-token 21950efb-b661-4ea6-8ec7-e870b8cf0f3e}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address your.lending.desk@example.com, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url nil, :sessions_force_uniqueness false, :email_signature Cheers,}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.pool.HikariProxyConnection 0x4847284b HikariProxyConnection@1212622923 wrapping org.postgresql.jdbc.PgConnection@1d3079fc], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x56d4aa90 next.jdbc.result_set$as_unqualified_lower_maps@56d4aa90]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0, content-type application/x-www-form-urlencoded, cookie leihs-anti-csrf-token=21950efb-b661-4ea6-8ec7-e870b8cf0f3e, content-length 91, sec-fetch-user ?1, referer http://localhost:3230/sign-in, connection keep-alive, upgrade-insecure-requests 1, accept text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8, accept-language de,en-US;q=0.7,en;q=0.3, sec-fetch-dest document, accept-encoding gzip, deflate, br, sec-fetch-mode navigate}, :async-channel #object[org.httpkit.server.AsyncChannel 0xe448f2c /127.0.0.1:3230<->/127.0.0.1:64747], :server-port 3230, :params-raw {:user jimmie@goyette.com, :password password, :csrf-token 21950efb-b661-4ea6-8ec7-e870b8cf0f3e}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x162ebe97 HikariDataSource (db-pool)], :connection #object[com.zaxxer.hikari.pool.HikariProxyConnection 0x398bd249 HikariProxyConnection@965464649 wrapping org.postgresql.jdbc.PgConnection@33c3a483], :level 1, :rollback #object[clojure.lang.Atom 0x5d48054f {:status :ready, :val false}]}, :content-length 91, :form-params {:user jimmie@goyette.com, :password password, :csrf-token 21950efb-b661-4ea6-8ec7-e870b8cf0f3e}, :websocket? false, :query-params {}, :content-type application/x-www-form-urlencoded, :form-params-raw {:user jimmie@goyette.com, :password password, :csrf-token 21950efb-b661-4ea6-8ec7-e870b8cf0f3e}, :character-encoding utf8, :uri /sign-in, :server-name localhost, :handler-key :sign-in, :query-string nil, :body #object[org.httpkit.BytesInputStream 0x2cbc7bdd BytesInputStream[len=91]], :graphql-schema #CompiledSchema<>, :handler #object[compojure.core$routes$fn__27950 0x73ae245d compojure.core$routes$fn__27950@73ae245d], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :html, :charset nil, :encoding nil, :language nil}}

>>1 (:handler-key request) :sign-in
>myprint>  authEnt? nil
>myprint>  txn {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x162ebe97 HikariDataSource (db-pool)], :connection #object[com.zaxxer.hikari.pool.HikariProxyConnection 0x398bd249 HikariProxyConnection@965464649 wrapping org.postgresql.jdbc.PgConnection@33c3a483], :level 1, :rollback #object[clojure.lang.Atom 0x5d48054f {:status :ready, :val false}]}
>myprint>  admin false

>2> [SELECT TRUE AS has_entry FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id IS NULL]

>myprint>  inspector false

>2> [SELECT TRUE AS has_entry FROM procurement_category_viewers WHERE user_id IS NULL]

>myprint>  viewer false
>myprint>  requester false
2023-11-23T10:27:11.351Z NX-41294 DEBUG [leihs.procurement.authorization:134] - (skip? (:handler-key request)) => true
2023-11-23T10:27:11.386Z NX-41294 DEBUG [pg-types.sql-parameter:326] - calling convert-parameter with:  [:uuid #uuid "87e52826-a564-402c-9270-982277676945" #object[com.zaxxer.hikari.pool.HikariProxyPreparedStatement 0x7795058f HikariProxyPreparedStatement@2006254991 wrapping INSERT INTO user_sessions ( user_id, token_hash, authentication_system_id, meta_data ) VALUES ( ?, ?, ?, ? )
RETURNING *] 1]  type:  java.util.UUID
2023-11-23T10:27:11.387Z NX-41294 DEBUG [pg-types.sql-parameter:326] - converted-parameter:  #uuid "87e52826-a564-402c-9270-982277676945"
2023-11-23T10:27:11.388Z NX-41294 DEBUG [pg-types.sql-parameter:326] - calling convert-parameter with:  [:text b2c40e0a82396896c980a3524245ec3fd28b1f7cf9496706c8912f7289b0b033 #object[com.zaxxer.hikari.pool.HikariProxyPreparedStatement 0x7795058f HikariProxyPreparedStatement@2006254991 wrapping INSERT INTO user_sessions ( user_id, token_hash, authentication_system_id, meta_data ) VALUES ( '87e52826-a564-402c-9270-982277676945'::uuid, ?, ?, ? )
RETURNING *] 2]  type:  java.lang.String
2023-11-23T10:27:11.388Z NX-41294 DEBUG [pg-types.sql-parameter:326] - converted-parameter:  b2c40e0a82396896c980a3524245ec3fd28b1f7cf9496706c8912f7289b0b033
2023-11-23T10:27:11.389Z NX-41294 DEBUG [pg-types.sql-parameter:326] - calling convert-parameter with:  [:text password #object[com.zaxxer.hikari.pool.HikariProxyPreparedStatement 0x7795058f HikariProxyPreparedStatement@2006254991 wrapping INSERT INTO user_sessions ( user_id, token_hash, authentication_system_id, meta_data ) VALUES ( '87e52826-a564-402c-9270-982277676945'::uuid, 'b2c40e0a82396896c980a3524245ec3fd28b1f7cf9496706c8912f7289b0b033', ?, ? )
RETURNING *] 3]  type:  java.lang.String
2023-11-23T10:27:11.389Z NX-41294 DEBUG [pg-types.sql-parameter:326] - converted-parameter:  password
2023-11-23T10:27:11.391Z NX-41294 DEBUG [pg-types.sql-parameter:326] - calling convert-parameter with:  [:jsonb {:user_agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0, :remote_addr 127.0.0.1} #object[com.zaxxer.hikari.pool.HikariProxyPreparedStatement 0x7795058f HikariProxyPreparedStatement@2006254991 wrapping INSERT INTO user_sessions ( user_id, token_hash, authentication_system_id, meta_data ) VALUES ( '87e52826-a564-402c-9270-982277676945'::uuid, 'b2c40e0a82396896c980a3524245ec3fd28b1f7cf9496706c8912f7289b0b033', 'password', ? )
RETURNING *] 4]  type:  clojure.lang.PersistentArrayMap
2023-11-23T10:27:11.393Z NX-41294 DEBUG [pg-types.sql-parameter:326] - converted-parameter:  #object[org.postgresql.util.PGobject 0x5e07c1e5 {"user_agent":"Mozilla\/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko\/20100101 Firefox\/115.0","remote_addr":"127.0.0.1"}]
2023-11-23T10:27:11.411Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#uuid "89ec3c83-297d-4359-9b5b-de8603c74dac" #object[org.postgresql.jdbc.PgResultSetMetaData 0x1e401d7f org.postgresql.jdbc.PgResultSetMetaData@1e401d7f] 1]
2023-11-23T10:27:11.414Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:uuid #uuid "89ec3c83-297d-4359-9b5b-de8603c74dac"]
2023-11-23T10:27:11.414Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  #uuid "89ec3c83-297d-4359-9b5b-de8603c74dac"
2023-11-23T10:27:11.414Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [b2c40e0a82396896c980a3524245ec3fd28b1f7cf9496706c8912f7289b0b033 #object[org.postgresql.jdbc.PgResultSetMetaData 0x1e401d7f org.postgresql.jdbc.PgResultSetMetaData@1e401d7f] 2]
2023-11-23T10:27:11.414Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:text b2c40e0a82396896c980a3524245ec3fd28b1f7cf9496706c8912f7289b0b033]
2023-11-23T10:27:11.414Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  b2c40e0a82396896c980a3524245ec3fd28b1f7cf9496706c8912f7289b0b033
2023-11-23T10:27:11.415Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#uuid "87e52826-a564-402c-9270-982277676945" #object[org.postgresql.jdbc.PgResultSetMetaData 0x1e401d7f org.postgresql.jdbc.PgResultSetMetaData@1e401d7f] 3]
2023-11-23T10:27:11.415Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:uuid #uuid "87e52826-a564-402c-9270-982277676945"]
2023-11-23T10:27:11.416Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  #uuid "87e52826-a564-402c-9270-982277676945"
2023-11-23T10:27:11.416Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#inst "2023-11-23T10:27:11.393420000-00:00" #object[org.postgresql.jdbc.PgResultSetMetaData 0x1e401d7f org.postgresql.jdbc.PgResultSetMetaData@1e401d7f] 5]
2023-11-23T10:27:11.416Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:timestamptz #inst "2023-11-23T10:27:11.393420000-00:00"]
2023-11-23T10:27:11.416Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  #time/instant "2023-11-23T10:27:11.393420Z"
2023-11-23T10:27:11.418Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#object[org.postgresql.util.PGobject 0xeda0dbe {"user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0", "remote_addr": "127.0.0.1"}] #object[org.postgresql.jdbc.PgResultSetMetaData 0x1e401d7f org.postgresql.jdbc.PgResultSetMetaData@1e401d7f] 6]
2023-11-23T10:27:11.419Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:jsonb #object[org.postgresql.util.PGobject 0xeda0dbe {"user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0", "remote_addr": "127.0.0.1"}]]
2023-11-23T10:27:11.419Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  {:user_agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0, :remote_addr 127.0.0.1}
2023-11-23T10:27:11.419Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [password #object[org.postgresql.jdbc.PgResultSetMetaData 0x1e401d7f org.postgresql.jdbc.PgResultSetMetaData@1e401d7f] 7]
2023-11-23T10:27:11.419Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:text password]
2023-11-23T10:27:11.420Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  password
2023-11-23T10:27:11.474Z NX-41294 DEBUG [pg-types.sql-parameter:326] - calling convert-parameter with:  [:int4 0 #object[com.zaxxer.hikari.pool.HikariProxyPreparedStatement 0x53578a17 HikariProxyPreparedStatement@1398245911 wrapping SELECT users.email, users.firstname, users.id, users.is_admin, users.language_locale, users.lastname, users.login, users.org_id, users.is_system_admin, users.id AS user_id, (SELECT count(*) FROM contracts WHERE contracts.user_id = users.id) AS contracts_count, (SELECT count(*) FROM access_rights WHERE access_rights.user_id = users.id) AS inventory_pool_roles_count, user_sessions.id AS user_session_id, user_sessions.created_at AS user_session_created_at, authentication_systems.external_sign_out_url AS external_sign_out_url FROM users INNER JOIN user_sessions ON users.id = user_id INNER JOIN authentication_systems ON authentication_systems.id = user_sessions.authentication_system_id INNER JOIN system_and_security_settings ON system_and_security_settings.id = ? WHERE (user_sessions.token_hash = encode(digest(?, ?), ?) AND now() < user_sessions.created_at + system_and_security_settings.sessions_max_lifetime_secs * interval '1 second' AND account_enabled = TRUE)] 1]  type:  java.lang.Long
2023-11-23T10:27:11.474Z NX-41294 DEBUG [pg-types.sql-parameter:326] - converted-parameter:  0
2023-11-23T10:27:11.475Z NX-41294 DEBUG [pg-types.sql-parameter:326] - calling convert-parameter with:  [:text d30d6a7b-8840-4d86-94ef-3e71f2430949 #object[com.zaxxer.hikari.pool.HikariProxyPreparedStatement 0x53578a17 HikariProxyPreparedStatement@1398245911 wrapping SELECT users.email, users.firstname, users.id, users.is_admin, users.language_locale, users.lastname, users.login, users.org_id, users.is_system_admin, users.id AS user_id, (SELECT count(*) FROM contracts WHERE contracts.user_id = users.id) AS contracts_count, (SELECT count(*) FROM access_rights WHERE access_rights.user_id = users.id) AS inventory_pool_roles_count, user_sessions.id AS user_session_id, user_sessions.created_at AS user_session_created_at, authentication_systems.external_sign_out_url AS external_sign_out_url FROM users INNER JOIN user_sessions ON users.id = user_id INNER JOIN authentication_systems ON authentication_systems.id = user_sessions.authentication_system_id INNER JOIN system_and_security_settings ON system_and_security_settings.id = 0 WHERE (user_sessions.token_hash = encode(digest(?, ?), ?) AND now() < user_sessions.created_at + system_and_security_settings.sessions_max_lifetime_secs * interval '1 second' AND account_enabled = TRUE)] 2]  type:  java.lang.String
2023-11-23T10:27:11.475Z NX-41294 DEBUG [pg-types.sql-parameter:326] - converted-parameter:  d30d6a7b-8840-4d86-94ef-3e71f2430949
2023-11-23T10:27:11.476Z NX-41294 DEBUG [pg-types.sql-parameter:326] - calling convert-parameter with:  [:text sha256 #object[com.zaxxer.hikari.pool.HikariProxyPreparedStatement 0x53578a17 HikariProxyPreparedStatement@1398245911 wrapping SELECT users.email, users.firstname, users.id, users.is_admin, users.language_locale, users.lastname, users.login, users.org_id, users.is_system_admin, users.id AS user_id, (SELECT count(*) FROM contracts WHERE contracts.user_id = users.id) AS contracts_count, (SELECT count(*) FROM access_rights WHERE access_rights.user_id = users.id) AS inventory_pool_roles_count, user_sessions.id AS user_session_id, user_sessions.created_at AS user_session_created_at, authentication_systems.external_sign_out_url AS external_sign_out_url FROM users INNER JOIN user_sessions ON users.id = user_id INNER JOIN authentication_systems ON authentication_systems.id = user_sessions.authentication_system_id INNER JOIN system_and_security_settings ON system_and_security_settings.id = 0 WHERE (user_sessions.token_hash = encode(digest('d30d6a7b-8840-4d86-94ef-3e71f2430949', ?), ?) AND now() < user_sessions.created_at + system_and_security_settings.sessions_max_lifetime_secs * interval '1 second' AND account_enabled = TRUE)] 3]  type:  java.lang.String
2023-11-23T10:27:11.477Z NX-41294 DEBUG [pg-types.sql-parameter:326] - converted-parameter:  sha256
2023-11-23T10:27:11.479Z NX-41294 DEBUG [pg-types.sql-parameter:326] - calling convert-parameter with:  [:text hex #object[com.zaxxer.hikari.pool.HikariProxyPreparedStatement 0x53578a17 HikariProxyPreparedStatement@1398245911 wrapping SELECT users.email, users.firstname, users.id, users.is_admin, users.language_locale, users.lastname, users.login, users.org_id, users.is_system_admin, users.id AS user_id, (SELECT count(*) FROM contracts WHERE contracts.user_id = users.id) AS contracts_count, (SELECT count(*) FROM access_rights WHERE access_rights.user_id = users.id) AS inventory_pool_roles_count, user_sessions.id AS user_session_id, user_sessions.created_at AS user_session_created_at, authentication_systems.external_sign_out_url AS external_sign_out_url FROM users INNER JOIN user_sessions ON users.id = user_id INNER JOIN authentication_systems ON authentication_systems.id = user_sessions.authentication_system_id INNER JOIN system_and_security_settings ON system_and_security_settings.id = 0 WHERE (user_sessions.token_hash = encode(digest('d30d6a7b-8840-4d86-94ef-3e71f2430949', 'sha256'), ?) AND now() < user_sessions.created_at + system_and_security_settings.sessions_max_lifetime_secs * interval '1 second' AND account_enabled = TRUE)] 4]  type:  java.lang.String
2023-11-23T10:27:11.479Z NX-41294 DEBUG [pg-types.sql-parameter:326] - converted-parameter:  hex
2023-11-23T10:27:11.491Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [jimmie@goyette.com #object[org.postgresql.jdbc.PgResultSetMetaData 0x78ba27d1 org.postgresql.jdbc.PgResultSetMetaData@78ba27d1] 1]
2023-11-23T10:27:11.491Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:varchar jimmie@goyette.com]
2023-11-23T10:27:11.491Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  jimmie@goyette.com
2023-11-23T10:27:11.491Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [Procurement #object[org.postgresql.jdbc.PgResultSetMetaData 0x78ba27d1 org.postgresql.jdbc.PgResultSetMetaData@78ba27d1] 2]
2023-11-23T10:27:11.491Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:text Procurement]
2023-11-23T10:27:11.492Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  Procurement
2023-11-23T10:27:11.492Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#uuid "87e52826-a564-402c-9270-982277676945" #object[org.postgresql.jdbc.PgResultSetMetaData 0x78ba27d1 org.postgresql.jdbc.PgResultSetMetaData@78ba27d1] 3]
2023-11-23T10:27:11.492Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:uuid #uuid "87e52826-a564-402c-9270-982277676945"]
2023-11-23T10:27:11.492Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  #uuid "87e52826-a564-402c-9270-982277676945"
2023-11-23T10:27:11.493Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [Admin #object[org.postgresql.jdbc.PgResultSetMetaData 0x78ba27d1 org.postgresql.jdbc.PgResultSetMetaData@78ba27d1] 6]
2023-11-23T10:27:11.493Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:varchar Admin]
2023-11-23T10:27:11.493Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  Admin
2023-11-23T10:27:11.493Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#uuid "87e52826-a564-402c-9270-982277676945" #object[org.postgresql.jdbc.PgResultSetMetaData 0x78ba27d1 org.postgresql.jdbc.PgResultSetMetaData@78ba27d1] 10]
2023-11-23T10:27:11.493Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:uuid #uuid "87e52826-a564-402c-9270-982277676945"]
2023-11-23T10:27:11.494Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  #uuid "87e52826-a564-402c-9270-982277676945"
2023-11-23T10:27:11.494Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [0 #object[org.postgresql.jdbc.PgResultSetMetaData 0x78ba27d1 org.postgresql.jdbc.PgResultSetMetaData@78ba27d1] 11]
2023-11-23T10:27:11.494Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:int8 0]
2023-11-23T10:27:11.495Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  0
2023-11-23T10:27:11.495Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [0 #object[org.postgresql.jdbc.PgResultSetMetaData 0x78ba27d1 org.postgresql.jdbc.PgResultSetMetaData@78ba27d1] 12]
2023-11-23T10:27:11.495Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:int8 0]
2023-11-23T10:27:11.495Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  0
2023-11-23T10:27:11.495Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#uuid "89ec3c83-297d-4359-9b5b-de8603c74dac" #object[org.postgresql.jdbc.PgResultSetMetaData 0x78ba27d1 org.postgresql.jdbc.PgResultSetMetaData@78ba27d1] 13]
2023-11-23T10:27:11.495Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:uuid #uuid "89ec3c83-297d-4359-9b5b-de8603c74dac"]
2023-11-23T10:27:11.495Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  #uuid "89ec3c83-297d-4359-9b5b-de8603c74dac"
2023-11-23T10:27:11.496Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#inst "2023-11-23T10:27:11.393420000-00:00" #object[org.postgresql.jdbc.PgResultSetMetaData 0x78ba27d1 org.postgresql.jdbc.PgResultSetMetaData@78ba27d1] 14]
2023-11-23T10:27:11.496Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:timestamptz #inst "2023-11-23T10:27:11.393420000-00:00"]
2023-11-23T10:27:11.496Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  #time/instant "2023-11-23T10:27:11.393420Z"
2023-11-23T10:27:11.498Z NX-41294 DEBUG [pg-types.sql-parameter:326] - calling convert-parameter with:  [:uuid #uuid "87e52826-a564-402c-9270-982277676945" #object[com.zaxxer.hikari.pool.HikariProxyPreparedStatement 0x46c84fca HikariProxyPreparedStatement@1187532746 wrapping SELECT role, inventory_pool_id FROM access_rights  WHERE user_id = ?] 1]  type:  java.util.UUID
2023-11-23T10:27:11.498Z NX-41294 DEBUG [pg-types.sql-parameter:326] - converted-parameter:  #uuid "87e52826-a564-402c-9270-982277676945"
>>wrap-authenticate::handler #object[leihs.procurement.authorization$wrap_authorize$fn__39139 0x4c2b46cb leihs.procurement.authorization$wrap_authorize$fn__39139@4c2b46cb]
>>wrap-authenticate::request {:authenticated-entity {:email jimmie@goyette.com, :contracts_count 0, :lastname Admin, :org_id nil, :scope_read true, :is_admin false, :authentication-method :session, :login nil, :scope_system_admin_write false, :scope_write true, :firstname Procurement, :scope_admin_write false, :user_session_created_at #time/instant "2023-11-23T10:27:11.393420Z", :id #uuid "87e52826-a564-402c-9270-982277676945", :user_session_id #uuid "89ec3c83-297d-4359-9b5b-de8603c74dac", :scope_system_admin_read false, :access-rights (), :user_id #uuid "87e52826-a564-402c-9270-982277676945", :is_system_admin false, :external_sign_out_url nil, :language_locale nil, :inventory_pool_roles_count 0, :scope_admin_read false}, :cookies {leihs-anti-csrf-token {:value 21950efb-b661-4ea6-8ec7-e870b8cf0f3e}, leihs-user-session {:value d30d6a7b-8840-4d86-94ef-3e71f2430949}}, :remote-addr 127.0.0.1, :start-time 392714284654041, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address your.lending.desk@example.com, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url nil, :sessions_force_uniqueness false, :email_signature Cheers,}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x60c0b1cb HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x56d4aa90 next.jdbc.result_set$as_unqualified_lower_maps@56d4aa90]}}, :query-params-raw {}, :route-params nil, :headers {sec-fetch-site same-origin, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0, cookie leihs-anti-csrf-token=21950efb-b661-4ea6-8ec7-e870b8cf0f3e; leihs-user-session=d30d6a7b-8840-4d86-94ef-3e71f2430949, sec-fetch-user ?1, referer http://localhost:3230/sign-in, connection keep-alive, upgrade-insecure-requests 1, accept text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8, accept-language de,en-US;q=0.7,en;q=0.3, sec-fetch-dest document, accept-encoding gzip, deflate, br, sec-fetch-mode navigate}, :async-channel #object[org.httpkit.server.AsyncChannel 0x5c0f1a86 /127.0.0.1:3230<->/127.0.0.1:64747], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x162ebe97 HikariDataSource (db-pool)]}, :content-length 0, :form-params {}, :websocket? false, :query-params {}, :content-type nil, :form-params-raw {}, :character-encoding utf8, :uri /procure, :server-name localhost, :handler-key :procurement, :query-string nil, :body nil, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.backend.html$not_found_handler 0x1b437e5 leihs.procurement.backend.html$not_found_handler@1b437e5], :multipart-params {}, :scheme :http, :request-method :get, :accept {:mime :html, :charset nil, :encoding nil, :language nil}}
>>>a nil
>>>b {:email jimmie@goyette.com, :contracts_count 0, :lastname Admin, :org_id nil, :scope_read true, :is_admin false, :authentication-method :session, :login nil, :scope_system_admin_write false, :scope_write true, :firstname Procurement, :scope_admin_write false, :user_session_created_at #time/instant "2023-11-23T10:27:11.393420Z", :id #uuid "87e52826-a564-402c-9270-982277676945", :user_session_id #uuid "89ec3c83-297d-4359-9b5b-de8603c74dac", :scope_system_admin_read false, :access-rights (), :user_id #uuid "87e52826-a564-402c-9270-982277676945", :is_system_admin false, :external_sign_out_url nil, :language_locale nil, :inventory_pool_roles_count 0, :scope_admin_read false}

>>1 authorize

>>1 handler #object[leihs.core.locale$wrap$fn__44238 0x46e66fe3 leihs.core.locale$wrap$fn__44238@46e66fe3]

>>1 request {:authenticated-entity {:email jimmie@goyette.com, :contracts_count 0, :lastname Admin, :org_id nil, :scope_read true, :is_admin false, :authentication-method :session, :login nil, :scope_system_admin_write false, :scope_write true, :firstname Procurement, :scope_admin_write false, :user_session_created_at #time/instant "2023-11-23T10:27:11.393420Z", :id #uuid "87e52826-a564-402c-9270-982277676945", :user_session_id #uuid "89ec3c83-297d-4359-9b5b-de8603c74dac", :scope_system_admin_read false, :access-rights (), :user_id #uuid "87e52826-a564-402c-9270-982277676945", :is_system_admin false, :external_sign_out_url nil, :language_locale nil, :inventory_pool_roles_count 0, :scope_admin_read false}, :cookies {leihs-anti-csrf-token {:value 21950efb-b661-4ea6-8ec7-e870b8cf0f3e}, leihs-user-session {:value d30d6a7b-8840-4d86-94ef-3e71f2430949}}, :remote-addr 127.0.0.1, :start-time 392714284654041, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address your.lending.desk@example.com, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url nil, :sessions_force_uniqueness false, :email_signature Cheers,}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x60c0b1cb HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x56d4aa90 next.jdbc.result_set$as_unqualified_lower_maps@56d4aa90]}}, :query-params-raw {}, :route-params nil, :headers {sec-fetch-site same-origin, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0, cookie leihs-anti-csrf-token=21950efb-b661-4ea6-8ec7-e870b8cf0f3e; leihs-user-session=d30d6a7b-8840-4d86-94ef-3e71f2430949, sec-fetch-user ?1, referer http://localhost:3230/sign-in, connection keep-alive, upgrade-insecure-requests 1, accept text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8, accept-language de,en-US;q=0.7,en;q=0.3, sec-fetch-dest document, accept-encoding gzip, deflate, br, sec-fetch-mode navigate}, :async-channel #object[org.httpkit.server.AsyncChannel 0x5c0f1a86 /127.0.0.1:3230<->/127.0.0.1:64747], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x162ebe97 HikariDataSource (db-pool)]}, :content-length 0, :form-params {}, :websocket? false, :query-params {}, :content-type nil, :form-params-raw {}, :character-encoding utf8, :uri /procure, :server-name localhost, :handler-key :procurement, :query-string nil, :body nil, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.backend.html$not_found_handler 0x1b437e5 leihs.procurement.backend.html$not_found_handler@1b437e5], :multipart-params {}, :scheme :http, :request-method :get, :accept {:mime :html, :charset nil, :encoding nil, :language nil}}

>>1 (:handler-key request) :procurement
>myprint>  authEnt? {:email jimmie@goyette.com, :contracts_count 0, :lastname Admin, :org_id nil, :scope_read true, :is_admin false, :authentication-method :session, :login nil, :scope_system_admin_write false, :scope_write true, :firstname Procurement, :scope_admin_write false, :user_session_created_at #time/instant "2023-11-23T10:27:11.393420Z", :id #uuid "87e52826-a564-402c-9270-982277676945", :user_session_id #uuid "89ec3c83-297d-4359-9b5b-de8603c74dac", :scope_system_admin_read false, :access-rights (), :user_id #uuid "87e52826-a564-402c-9270-982277676945", :is_system_admin false, :external_sign_out_url nil, :language_locale nil, :inventory_pool_roles_count 0, :scope_admin_read false}
>myprint>  txn {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x162ebe97 HikariDataSource (db-pool)]}
>myprint>  admin true

>2> [SELECT TRUE AS has_entry FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = ? #uuid "87e52826-a564-402c-9270-982277676945"]

>myprint>  inspector false

>2> [SELECT TRUE AS has_entry FROM procurement_category_viewers WHERE user_id = ? #uuid "87e52826-a564-402c-9270-982277676945"]

>myprint>  viewer false
>myprint>  requester false
2023-11-23T10:27:11.512Z NX-41294 DEBUG [leihs.procurement.authorization:134] - (skip? (:handler-key request)) => nil

>2> [SELECT TRUE AS has_entry FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = ? #uuid "87e52826-a564-402c-9270-982277676945"]


>2> [SELECT TRUE AS has_entry FROM procurement_category_viewers WHERE user_id = ? #uuid "87e52826-a564-402c-9270-982277676945"]

2023-11-23T10:27:11.519Z NX-41294 DEBUG [leihs.procurement.authorization:135] - (->> [user-perms/admin? user-perms/inspector? user-perms/viewer? user-perms/requester?] (map (fn* [p1__39120#] (p1__39120# (:tx-next request) (:authenticated-entity request)))) (some true?)) => true
2023-11-23T10:27:11.842Z NX-41294 DEBUG [pg-types.sql-parameter:326] - calling convert-parameter with:  [:int4 0 #object[com.zaxxer.hikari.pool.HikariProxyPreparedStatement 0x1ce41e45 HikariProxyPreparedStatement@484712005 wrapping SELECT users.email, users.firstname, users.id, users.is_admin, users.language_locale, users.lastname, users.login, users.org_id, users.is_system_admin, users.id AS user_id, (SELECT count(*) FROM contracts WHERE contracts.user_id = users.id) AS contracts_count, (SELECT count(*) FROM access_rights WHERE access_rights.user_id = users.id) AS inventory_pool_roles_count, user_sessions.id AS user_session_id, user_sessions.created_at AS user_session_created_at, authentication_systems.external_sign_out_url AS external_sign_out_url FROM users INNER JOIN user_sessions ON users.id = user_id INNER JOIN authentication_systems ON authentication_systems.id = user_sessions.authentication_system_id INNER JOIN system_and_security_settings ON system_and_security_settings.id = ? WHERE (user_sessions.token_hash = encode(digest(?, ?), ?) AND now() < user_sessions.created_at + system_and_security_settings.sessions_max_lifetime_secs * interval '1 second' AND account_enabled = TRUE)] 1]  type:  java.lang.Long
2023-11-23T10:27:11.843Z NX-41294 DEBUG [pg-types.sql-parameter:326] - converted-parameter:  0
2023-11-23T10:27:11.844Z NX-41294 DEBUG [pg-types.sql-parameter:326] - calling convert-parameter with:  [:text d30d6a7b-8840-4d86-94ef-3e71f2430949 #object[com.zaxxer.hikari.pool.HikariProxyPreparedStatement 0x1ce41e45 HikariProxyPreparedStatement@484712005 wrapping SELECT users.email, users.firstname, users.id, users.is_admin, users.language_locale, users.lastname, users.login, users.org_id, users.is_system_admin, users.id AS user_id, (SELECT count(*) FROM contracts WHERE contracts.user_id = users.id) AS contracts_count, (SELECT count(*) FROM access_rights WHERE access_rights.user_id = users.id) AS inventory_pool_roles_count, user_sessions.id AS user_session_id, user_sessions.created_at AS user_session_created_at, authentication_systems.external_sign_out_url AS external_sign_out_url FROM users INNER JOIN user_sessions ON users.id = user_id INNER JOIN authentication_systems ON authentication_systems.id = user_sessions.authentication_system_id INNER JOIN system_and_security_settings ON system_and_security_settings.id = 0 WHERE (user_sessions.token_hash = encode(digest(?, ?), ?) AND now() < user_sessions.created_at + system_and_security_settings.sessions_max_lifetime_secs * interval '1 second' AND account_enabled = TRUE)] 2]  type:  java.lang.String
2023-11-23T10:27:11.845Z NX-41294 DEBUG [pg-types.sql-parameter:326] - converted-parameter:  d30d6a7b-8840-4d86-94ef-3e71f2430949
2023-11-23T10:27:11.846Z NX-41294 DEBUG [pg-types.sql-parameter:326] - calling convert-parameter with:  [:text sha256 #object[com.zaxxer.hikari.pool.HikariProxyPreparedStatement 0x1ce41e45 HikariProxyPreparedStatement@484712005 wrapping SELECT users.email, users.firstname, users.id, users.is_admin, users.language_locale, users.lastname, users.login, users.org_id, users.is_system_admin, users.id AS user_id, (SELECT count(*) FROM contracts WHERE contracts.user_id = users.id) AS contracts_count, (SELECT count(*) FROM access_rights WHERE access_rights.user_id = users.id) AS inventory_pool_roles_count, user_sessions.id AS user_session_id, user_sessions.created_at AS user_session_created_at, authentication_systems.external_sign_out_url AS external_sign_out_url FROM users INNER JOIN user_sessions ON users.id = user_id INNER JOIN authentication_systems ON authentication_systems.id = user_sessions.authentication_system_id INNER JOIN system_and_security_settings ON system_and_security_settings.id = 0 WHERE (user_sessions.token_hash = encode(digest('d30d6a7b-8840-4d86-94ef-3e71f2430949', ?), ?) AND now() < user_sessions.created_at + system_and_security_settings.sessions_max_lifetime_secs * interval '1 second' AND account_enabled = TRUE)] 3]  type:  java.lang.String
2023-11-23T10:27:11.847Z NX-41294 DEBUG [pg-types.sql-parameter:326] - converted-parameter:  sha256
2023-11-23T10:27:11.847Z NX-41294 DEBUG [pg-types.sql-parameter:326] - calling convert-parameter with:  [:text hex #object[com.zaxxer.hikari.pool.HikariProxyPreparedStatement 0x1ce41e45 HikariProxyPreparedStatement@484712005 wrapping SELECT users.email, users.firstname, users.id, users.is_admin, users.language_locale, users.lastname, users.login, users.org_id, users.is_system_admin, users.id AS user_id, (SELECT count(*) FROM contracts WHERE contracts.user_id = users.id) AS contracts_count, (SELECT count(*) FROM access_rights WHERE access_rights.user_id = users.id) AS inventory_pool_roles_count, user_sessions.id AS user_session_id, user_sessions.created_at AS user_session_created_at, authentication_systems.external_sign_out_url AS external_sign_out_url FROM users INNER JOIN user_sessions ON users.id = user_id INNER JOIN authentication_systems ON authentication_systems.id = user_sessions.authentication_system_id INNER JOIN system_and_security_settings ON system_and_security_settings.id = 0 WHERE (user_sessions.token_hash = encode(digest('d30d6a7b-8840-4d86-94ef-3e71f2430949', 'sha256'), ?) AND now() < user_sessions.created_at + system_and_security_settings.sessions_max_lifetime_secs * interval '1 second' AND account_enabled = TRUE)] 4]  type:  java.lang.String
2023-11-23T10:27:11.849Z NX-41294 DEBUG [pg-types.sql-parameter:326] - converted-parameter:  hex
2023-11-23T10:27:11.852Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [jimmie@goyette.com #object[org.postgresql.jdbc.PgResultSetMetaData 0x6e78208b org.postgresql.jdbc.PgResultSetMetaData@6e78208b] 1]
2023-11-23T10:27:11.852Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:varchar jimmie@goyette.com]
2023-11-23T10:27:11.852Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  jimmie@goyette.com
2023-11-23T10:27:11.853Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [Procurement #object[org.postgresql.jdbc.PgResultSetMetaData 0x6e78208b org.postgresql.jdbc.PgResultSetMetaData@6e78208b] 2]
2023-11-23T10:27:11.853Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:text Procurement]
2023-11-23T10:27:11.853Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  Procurement
2023-11-23T10:27:11.853Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#uuid "87e52826-a564-402c-9270-982277676945" #object[org.postgresql.jdbc.PgResultSetMetaData 0x6e78208b org.postgresql.jdbc.PgResultSetMetaData@6e78208b] 3]
2023-11-23T10:27:11.853Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:uuid #uuid "87e52826-a564-402c-9270-982277676945"]
2023-11-23T10:27:11.854Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  #uuid "87e52826-a564-402c-9270-982277676945"
2023-11-23T10:27:11.854Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [Admin #object[org.postgresql.jdbc.PgResultSetMetaData 0x6e78208b org.postgresql.jdbc.PgResultSetMetaData@6e78208b] 6]
2023-11-23T10:27:11.854Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:varchar Admin]
2023-11-23T10:27:11.854Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  Admin
2023-11-23T10:27:11.854Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#uuid "87e52826-a564-402c-9270-982277676945" #object[org.postgresql.jdbc.PgResultSetMetaData 0x6e78208b org.postgresql.jdbc.PgResultSetMetaData@6e78208b] 10]
2023-11-23T10:27:11.855Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:uuid #uuid "87e52826-a564-402c-9270-982277676945"]
2023-11-23T10:27:11.855Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  #uuid "87e52826-a564-402c-9270-982277676945"
2023-11-23T10:27:11.855Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [0 #object[org.postgresql.jdbc.PgResultSetMetaData 0x6e78208b org.postgresql.jdbc.PgResultSetMetaData@6e78208b] 11]
2023-11-23T10:27:11.855Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:int8 0]
2023-11-23T10:27:11.855Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  0
2023-11-23T10:27:11.855Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [0 #object[org.postgresql.jdbc.PgResultSetMetaData 0x6e78208b org.postgresql.jdbc.PgResultSetMetaData@6e78208b] 12]
2023-11-23T10:27:11.855Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:int8 0]
2023-11-23T10:27:11.856Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  0
2023-11-23T10:27:11.856Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#uuid "89ec3c83-297d-4359-9b5b-de8603c74dac" #object[org.postgresql.jdbc.PgResultSetMetaData 0x6e78208b org.postgresql.jdbc.PgResultSetMetaData@6e78208b] 13]
2023-11-23T10:27:11.856Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:uuid #uuid "89ec3c83-297d-4359-9b5b-de8603c74dac"]
2023-11-23T10:27:11.856Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  #uuid "89ec3c83-297d-4359-9b5b-de8603c74dac"
2023-11-23T10:27:11.857Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#inst "2023-11-23T10:27:11.393420000-00:00" #object[org.postgresql.jdbc.PgResultSetMetaData 0x6e78208b org.postgresql.jdbc.PgResultSetMetaData@6e78208b] 14]
2023-11-23T10:27:11.857Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:timestamptz #inst "2023-11-23T10:27:11.393420000-00:00"]
2023-11-23T10:27:11.858Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  #time/instant "2023-11-23T10:27:11.393420Z"
2023-11-23T10:27:11.859Z NX-41294 DEBUG [pg-types.sql-parameter:326] - calling convert-parameter with:  [:uuid #uuid "87e52826-a564-402c-9270-982277676945" #object[com.zaxxer.hikari.pool.HikariProxyPreparedStatement 0x3013a43e HikariProxyPreparedStatement@806593598 wrapping SELECT role, inventory_pool_id FROM access_rights  WHERE user_id = ?] 1]  type:  java.util.UUID
2023-11-23T10:27:11.859Z NX-41294 DEBUG [pg-types.sql-parameter:326] - converted-parameter:  #uuid "87e52826-a564-402c-9270-982277676945"
>>wrap-authenticate::handler #object[leihs.procurement.authorization$wrap_authorize$fn__39139 0x4c2b46cb leihs.procurement.authorization$wrap_authorize$fn__39139@4c2b46cb]
>>wrap-authenticate::request {:authenticated-entity {:email jimmie@goyette.com, :contracts_count 0, :lastname Admin, :org_id nil, :scope_read true, :is_admin false, :authentication-method :session, :login nil, :scope_system_admin_write false, :scope_write true, :firstname Procurement, :scope_admin_write false, :user_session_created_at #time/instant "2023-11-23T10:27:11.393420Z", :id #uuid "87e52826-a564-402c-9270-982277676945", :user_session_id #uuid "89ec3c83-297d-4359-9b5b-de8603c74dac", :scope_system_admin_read false, :access-rights (), :user_id #uuid "87e52826-a564-402c-9270-982277676945", :is_system_admin false, :external_sign_out_url nil, :language_locale nil, :inventory_pool_roles_count 0, :scope_admin_read false}, :cookies {leihs-anti-csrf-token {:value 21950efb-b661-4ea6-8ec7-e870b8cf0f3e}, leihs-user-session {:value d30d6a7b-8840-4d86-94ef-3e71f2430949}}, :remote-addr 127.0.0.1, :start-time 392714655922750, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address your.lending.desk@example.com, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url nil, :sessions_force_uniqueness false, :email_signature Cheers,}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x60c0b1cb HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x56d4aa90 next.jdbc.result_set$as_unqualified_lower_maps@56d4aa90]}}, :query-params-raw {}, :route-params nil, :headers {sec-fetch-site same-origin, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0, cookie leihs-anti-csrf-token=21950efb-b661-4ea6-8ec7-e870b8cf0f3e; leihs-user-session=d30d6a7b-8840-4d86-94ef-3e71f2430949, referer http://localhost:3230/procure, connection keep-alive, accept image/avif,image/webp,*/*, accept-language de,en-US;q=0.7,en;q=0.3, sec-fetch-dest image, accept-encoding gzip, deflate, br, sec-fetch-mode no-cors}, :async-channel #object[org.httpkit.server.AsyncChannel 0x66620589 /127.0.0.1:3230<->/127.0.0.1:64753], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x162ebe97 HikariDataSource (db-pool)]}, :content-length 0, :form-params {}, :websocket? false, :query-params {}, :content-type nil, :form-params-raw {}, :character-encoding utf8, :uri /procure/favicon.ico, :server-name localhost, :handler-key :not-found, :query-string nil, :body nil, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.backend.html$not_found_handler 0x1b437e5 leihs.procurement.backend.html$not_found_handler@1b437e5], :multipart-params {}, :scheme :http, :request-method :get, :accept {:mime :html, :charset nil, :encoding nil, :language nil}}
>>>a nil
>>>b {:email jimmie@goyette.com, :contracts_count 0, :lastname Admin, :org_id nil, :scope_read true, :is_admin false, :authentication-method :session, :login nil, :scope_system_admin_write false, :scope_write true, :firstname Procurement, :scope_admin_write false, :user_session_created_at #time/instant "2023-11-23T10:27:11.393420Z", :id #uuid "87e52826-a564-402c-9270-982277676945", :user_session_id #uuid "89ec3c83-297d-4359-9b5b-de8603c74dac", :scope_system_admin_read false, :access-rights (), :user_id #uuid "87e52826-a564-402c-9270-982277676945", :is_system_admin false, :external_sign_out_url nil, :language_locale nil, :inventory_pool_roles_count 0, :scope_admin_read false}

>>1 authorize

>>1 handler #object[leihs.core.locale$wrap$fn__44238 0x46e66fe3 leihs.core.locale$wrap$fn__44238@46e66fe3]

>>1 request {:authenticated-entity {:email jimmie@goyette.com, :contracts_count 0, :lastname Admin, :org_id nil, :scope_read true, :is_admin false, :authentication-method :session, :login nil, :scope_system_admin_write false, :scope_write true, :firstname Procurement, :scope_admin_write false, :user_session_created_at #time/instant "2023-11-23T10:27:11.393420Z", :id #uuid "87e52826-a564-402c-9270-982277676945", :user_session_id #uuid "89ec3c83-297d-4359-9b5b-de8603c74dac", :scope_system_admin_read false, :access-rights (), :user_id #uuid "87e52826-a564-402c-9270-982277676945", :is_system_admin false, :external_sign_out_url nil, :language_locale nil, :inventory_pool_roles_count 0, :scope_admin_read false}, :cookies {leihs-anti-csrf-token {:value 21950efb-b661-4ea6-8ec7-e870b8cf0f3e}, leihs-user-session {:value d30d6a7b-8840-4d86-94ef-3e71f2430949}}, :remote-addr 127.0.0.1, :start-time 392714655922750, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address your.lending.desk@example.com, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url nil, :sessions_force_uniqueness false, :email_signature Cheers,}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x60c0b1cb HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x56d4aa90 next.jdbc.result_set$as_unqualified_lower_maps@56d4aa90]}}, :query-params-raw {}, :route-params nil, :headers {sec-fetch-site same-origin, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0, cookie leihs-anti-csrf-token=21950efb-b661-4ea6-8ec7-e870b8cf0f3e; leihs-user-session=d30d6a7b-8840-4d86-94ef-3e71f2430949, referer http://localhost:3230/procure, connection keep-alive, accept image/avif,image/webp,*/*, accept-language de,en-US;q=0.7,en;q=0.3, sec-fetch-dest image, accept-encoding gzip, deflate, br, sec-fetch-mode no-cors}, :async-channel #object[org.httpkit.server.AsyncChannel 0x66620589 /127.0.0.1:3230<->/127.0.0.1:64753], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x162ebe97 HikariDataSource (db-pool)]}, :content-length 0, :form-params {}, :websocket? false, :query-params {}, :content-type nil, :form-params-raw {}, :character-encoding utf8, :uri /procure/favicon.ico, :server-name localhost, :handler-key :not-found, :query-string nil, :body nil, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.backend.html$not_found_handler 0x1b437e5 leihs.procurement.backend.html$not_found_handler@1b437e5], :multipart-params {}, :scheme :http, :request-method :get, :accept {:mime :html, :charset nil, :encoding nil, :language nil}}

>>1 (:handler-key request) :not-found
>myprint>  authEnt? {:email jimmie@goyette.com, :contracts_count 0, :lastname Admin, :org_id nil, :scope_read true, :is_admin false, :authentication-method :session, :login nil, :scope_system_admin_write false, :scope_write true, :firstname Procurement, :scope_admin_write false, :user_session_created_at #time/instant "2023-11-23T10:27:11.393420Z", :id #uuid "87e52826-a564-402c-9270-982277676945", :user_session_id #uuid "89ec3c83-297d-4359-9b5b-de8603c74dac", :scope_system_admin_read false, :access-rights (), :user_id #uuid "87e52826-a564-402c-9270-982277676945", :is_system_admin false, :external_sign_out_url nil, :language_locale nil, :inventory_pool_roles_count 0, :scope_admin_read false}
>myprint>  txn {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x162ebe97 HikariDataSource (db-pool)]}
>myprint>  admin true

>2> [SELECT TRUE AS has_entry FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = ? #uuid "87e52826-a564-402c-9270-982277676945"]

>myprint>  inspector false

>2> [SELECT TRUE AS has_entry FROM procurement_category_viewers WHERE user_id = ? #uuid "87e52826-a564-402c-9270-982277676945"]

>myprint>  viewer false
>myprint>  requester false
2023-11-23T10:27:11.875Z NX-41294 DEBUG [leihs.procurement.authorization:134] - (skip? (:handler-key request)) => nil

>2> [SELECT TRUE AS has_entry FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = ? #uuid "87e52826-a564-402c-9270-982277676945"]


>2> [SELECT TRUE AS has_entry FROM procurement_category_viewers WHERE user_id = ? #uuid "87e52826-a564-402c-9270-982277676945"]

2023-11-23T10:27:11.876Z NX-41294 DEBUG [leihs.procurement.authorization:135] - (->> [user-perms/admin? user-perms/inspector? user-perms/viewer? user-perms/requester?] (map (fn* [p1__39120#] (p1__39120# (:tx-next request) (:authenticated-entity request)))) (some true?)) => true
2023-11-23T10:27:11.913Z NX-41294 DEBUG [pg-types.sql-parameter:326] - calling convert-parameter with:  [:int4 0 #object[com.zaxxer.hikari.pool.HikariProxyPreparedStatement 0x6ec5cc5f HikariProxyPreparedStatement@1858456671 wrapping SELECT users.email, users.firstname, users.id, users.is_admin, users.language_locale, users.lastname, users.login, users.org_id, users.is_system_admin, users.id AS user_id, (SELECT count(*) FROM contracts WHERE contracts.user_id = users.id) AS contracts_count, (SELECT count(*) FROM access_rights WHERE access_rights.user_id = users.id) AS inventory_pool_roles_count, user_sessions.id AS user_session_id, user_sessions.created_at AS user_session_created_at, authentication_systems.external_sign_out_url AS external_sign_out_url FROM users INNER JOIN user_sessions ON users.id = user_id INNER JOIN authentication_systems ON authentication_systems.id = user_sessions.authentication_system_id INNER JOIN system_and_security_settings ON system_and_security_settings.id = ? WHERE (user_sessions.token_hash = encode(digest(?, ?), ?) AND now() < user_sessions.created_at + system_and_security_settings.sessions_max_lifetime_secs * interval '1 second' AND account_enabled = TRUE)] 1]  type:  java.lang.Long
2023-11-23T10:27:11.913Z NX-41294 DEBUG [pg-types.sql-parameter:326] - converted-parameter:  0
2023-11-23T10:27:11.914Z NX-41294 DEBUG [pg-types.sql-parameter:326] - calling convert-parameter with:  [:text d30d6a7b-8840-4d86-94ef-3e71f2430949 #object[com.zaxxer.hikari.pool.HikariProxyPreparedStatement 0x6ec5cc5f HikariProxyPreparedStatement@1858456671 wrapping SELECT users.email, users.firstname, users.id, users.is_admin, users.language_locale, users.lastname, users.login, users.org_id, users.is_system_admin, users.id AS user_id, (SELECT count(*) FROM contracts WHERE contracts.user_id = users.id) AS contracts_count, (SELECT count(*) FROM access_rights WHERE access_rights.user_id = users.id) AS inventory_pool_roles_count, user_sessions.id AS user_session_id, user_sessions.created_at AS user_session_created_at, authentication_systems.external_sign_out_url AS external_sign_out_url FROM users INNER JOIN user_sessions ON users.id = user_id INNER JOIN authentication_systems ON authentication_systems.id = user_sessions.authentication_system_id INNER JOIN system_and_security_settings ON system_and_security_settings.id = 0 WHERE (user_sessions.token_hash = encode(digest(?, ?), ?) AND now() < user_sessions.created_at + system_and_security_settings.sessions_max_lifetime_secs * interval '1 second' AND account_enabled = TRUE)] 2]  type:  java.lang.String
2023-11-23T10:27:11.919Z NX-41294 DEBUG [pg-types.sql-parameter:326] - converted-parameter:  d30d6a7b-8840-4d86-94ef-3e71f2430949
2023-11-23T10:27:11.921Z NX-41294 DEBUG [pg-types.sql-parameter:326] - calling convert-parameter with:  [:text sha256 #object[com.zaxxer.hikari.pool.HikariProxyPreparedStatement 0x6ec5cc5f HikariProxyPreparedStatement@1858456671 wrapping SELECT users.email, users.firstname, users.id, users.is_admin, users.language_locale, users.lastname, users.login, users.org_id, users.is_system_admin, users.id AS user_id, (SELECT count(*) FROM contracts WHERE contracts.user_id = users.id) AS contracts_count, (SELECT count(*) FROM access_rights WHERE access_rights.user_id = users.id) AS inventory_pool_roles_count, user_sessions.id AS user_session_id, user_sessions.created_at AS user_session_created_at, authentication_systems.external_sign_out_url AS external_sign_out_url FROM users INNER JOIN user_sessions ON users.id = user_id INNER JOIN authentication_systems ON authentication_systems.id = user_sessions.authentication_system_id INNER JOIN system_and_security_settings ON system_and_security_settings.id = 0 WHERE (user_sessions.token_hash = encode(digest('d30d6a7b-8840-4d86-94ef-3e71f2430949', ?), ?) AND now() < user_sessions.created_at + system_and_security_settings.sessions_max_lifetime_secs * interval '1 second' AND account_enabled = TRUE)] 3]  type:  java.lang.String
2023-11-23T10:27:11.921Z NX-41294 DEBUG [pg-types.sql-parameter:326] - converted-parameter:  sha256
2023-11-23T10:27:11.922Z NX-41294 DEBUG [pg-types.sql-parameter:326] - calling convert-parameter with:  [:text hex #object[com.zaxxer.hikari.pool.HikariProxyPreparedStatement 0x6ec5cc5f HikariProxyPreparedStatement@1858456671 wrapping SELECT users.email, users.firstname, users.id, users.is_admin, users.language_locale, users.lastname, users.login, users.org_id, users.is_system_admin, users.id AS user_id, (SELECT count(*) FROM contracts WHERE contracts.user_id = users.id) AS contracts_count, (SELECT count(*) FROM access_rights WHERE access_rights.user_id = users.id) AS inventory_pool_roles_count, user_sessions.id AS user_session_id, user_sessions.created_at AS user_session_created_at, authentication_systems.external_sign_out_url AS external_sign_out_url FROM users INNER JOIN user_sessions ON users.id = user_id INNER JOIN authentication_systems ON authentication_systems.id = user_sessions.authentication_system_id INNER JOIN system_and_security_settings ON system_and_security_settings.id = 0 WHERE (user_sessions.token_hash = encode(digest('d30d6a7b-8840-4d86-94ef-3e71f2430949', 'sha256'), ?) AND now() < user_sessions.created_at + system_and_security_settings.sessions_max_lifetime_secs * interval '1 second' AND account_enabled = TRUE)] 4]  type:  java.lang.String
2023-11-23T10:27:11.923Z NX-41294 DEBUG [pg-types.sql-parameter:326] - converted-parameter:  hex
2023-11-23T10:27:11.925Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [jimmie@goyette.com #object[org.postgresql.jdbc.PgResultSetMetaData 0x4cadbd4a org.postgresql.jdbc.PgResultSetMetaData@4cadbd4a] 1]
2023-11-23T10:27:11.925Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:varchar jimmie@goyette.com]
2023-11-23T10:27:11.925Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  jimmie@goyette.com
2023-11-23T10:27:11.925Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [Procurement #object[org.postgresql.jdbc.PgResultSetMetaData 0x4cadbd4a org.postgresql.jdbc.PgResultSetMetaData@4cadbd4a] 2]
2023-11-23T10:27:11.926Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:text Procurement]
2023-11-23T10:27:11.926Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  Procurement
2023-11-23T10:27:11.926Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#uuid "87e52826-a564-402c-9270-982277676945" #object[org.postgresql.jdbc.PgResultSetMetaData 0x4cadbd4a org.postgresql.jdbc.PgResultSetMetaData@4cadbd4a] 3]
2023-11-23T10:27:11.926Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:uuid #uuid "87e52826-a564-402c-9270-982277676945"]
2023-11-23T10:27:11.926Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  #uuid "87e52826-a564-402c-9270-982277676945"
2023-11-23T10:27:11.927Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [Admin #object[org.postgresql.jdbc.PgResultSetMetaData 0x4cadbd4a org.postgresql.jdbc.PgResultSetMetaData@4cadbd4a] 6]
2023-11-23T10:27:11.927Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:varchar Admin]
2023-11-23T10:27:11.927Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  Admin
2023-11-23T10:27:11.927Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#uuid "87e52826-a564-402c-9270-982277676945" #object[org.postgresql.jdbc.PgResultSetMetaData 0x4cadbd4a org.postgresql.jdbc.PgResultSetMetaData@4cadbd4a] 10]
2023-11-23T10:27:11.927Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:uuid #uuid "87e52826-a564-402c-9270-982277676945"]
2023-11-23T10:27:11.927Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  #uuid "87e52826-a564-402c-9270-982277676945"
2023-11-23T10:27:11.928Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [0 #object[org.postgresql.jdbc.PgResultSetMetaData 0x4cadbd4a org.postgresql.jdbc.PgResultSetMetaData@4cadbd4a] 11]
2023-11-23T10:27:11.928Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:int8 0]
2023-11-23T10:27:11.928Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  0
2023-11-23T10:27:11.929Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [0 #object[org.postgresql.jdbc.PgResultSetMetaData 0x4cadbd4a org.postgresql.jdbc.PgResultSetMetaData@4cadbd4a] 12]
2023-11-23T10:27:11.929Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:int8 0]
2023-11-23T10:27:11.929Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  0
2023-11-23T10:27:11.929Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#uuid "89ec3c83-297d-4359-9b5b-de8603c74dac" #object[org.postgresql.jdbc.PgResultSetMetaData 0x4cadbd4a org.postgresql.jdbc.PgResultSetMetaData@4cadbd4a] 13]
2023-11-23T10:27:11.930Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:uuid #uuid "89ec3c83-297d-4359-9b5b-de8603c74dac"]
2023-11-23T10:27:11.930Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  #uuid "89ec3c83-297d-4359-9b5b-de8603c74dac"
2023-11-23T10:27:11.930Z NX-41294 DEBUG [pg-types.read-column:326] - dispatch-to-convert-column [#inst "2023-11-23T10:27:11.393420000-00:00" #object[org.postgresql.jdbc.PgResultSetMetaData 0x4cadbd4a org.postgresql.jdbc.PgResultSetMetaData@4cadbd4a] 14]
2023-11-23T10:27:11.930Z NX-41294 DEBUG [pg-types.read-column:326] - calling convert-column with:  [:timestamptz #inst "2023-11-23T10:27:11.393420000-00:00"]
2023-11-23T10:27:11.930Z NX-41294 DEBUG [pg-types.read-column:326] - converted-column:  #time/instant "2023-11-23T10:27:11.393420Z"
2023-11-23T10:27:11.934Z NX-41294 DEBUG [pg-types.sql-parameter:326] - calling convert-parameter with:  [:uuid #uuid "87e52826-a564-402c-9270-982277676945" #object[com.zaxxer.hikari.pool.HikariProxyPreparedStatement 0x2eb719d2 HikariProxyPreparedStatement@783751634 wrapping SELECT role, inventory_pool_id FROM access_rights  WHERE user_id = ?] 1]  type:  java.util.UUID
2023-11-23T10:27:11.934Z NX-41294 DEBUG [pg-types.sql-parameter:326] - converted-parameter:  #uuid "87e52826-a564-402c-9270-982277676945"
>>wrap-authenticate::handler #object[leihs.procurement.authorization$wrap_authorize$fn__39139 0x4c2b46cb leihs.procurement.authorization$wrap_authorize$fn__39139@4c2b46cb]
>>wrap-authenticate::request {:authenticated-entity {:email jimmie@goyette.com, :contracts_count 0, :lastname Admin, :org_id nil, :scope_read true, :is_admin false, :authentication-method :session, :login nil, :scope_system_admin_write false, :scope_write true, :firstname Procurement, :scope_admin_write false, :user_session_created_at #time/instant "2023-11-23T10:27:11.393420Z", :id #uuid "87e52826-a564-402c-9270-982277676945", :user_session_id #uuid "89ec3c83-297d-4359-9b5b-de8603c74dac", :scope_system_admin_read false, :access-rights (), :user_id #uuid "87e52826-a564-402c-9270-982277676945", :is_system_admin false, :external_sign_out_url nil, :language_locale nil, :inventory_pool_roles_count 0, :scope_admin_read false}, :cookies {leihs-anti-csrf-token {:value 21950efb-b661-4ea6-8ec7-e870b8cf0f3e}, leihs-user-session {:value d30d6a7b-8840-4d86-94ef-3e71f2430949}}, :remote-addr 127.0.0.1, :start-time 392714684985416, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address your.lending.desk@example.com, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url nil, :sessions_force_uniqueness false, :email_signature Cheers,}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x60c0b1cb HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x56d4aa90 next.jdbc.result_set$as_unqualified_lower_maps@56d4aa90]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0, content-type application/json, cookie leihs-anti-csrf-token=21950efb-b661-4ea6-8ec7-e870b8cf0f3e; leihs-user-session=d30d6a7b-8840-4d86-94ef-3e71f2430949, content-length 502, referer http://localhost:3230/procure, connection keep-alive, x-csrf-token 21950efb-b661-4ea6-8ec7-e870b8cf0f3e, accept application/json, accept-language de,en-US;q=0.7,en;q=0.3, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors}, :async-channel #object[org.httpkit.server.AsyncChannel 0x14b1d057 /127.0.0.1:3230<->/127.0.0.1:64747], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x162ebe97 HikariDataSource (db-pool)]}, :content-length 502, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:operationName me, :variables {}, :query query me {
  current_user {
    navbarProps
    user {
      id
      firstname
      lastname
      permissions {
        isAdmin
        isRequester
        isInspectorForCategories {
          id
          __typename
        }
        isViewerForCategories {
          id
          __typename
        }
        __typename
      }
      __typename
    }
    __typename
  }
  settings {
    contact_url
    __typename
  }
}
}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0x7640f117 leihs.procurement.graphql$handler@7640f117], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}
>>>a nil
>>>b {:email jimmie@goyette.com, :contracts_count 0, :lastname Admin, :org_id nil, :scope_read true, :is_admin false, :authentication-method :session, :login nil, :scope_system_admin_write false, :scope_write true, :firstname Procurement, :scope_admin_write false, :user_session_created_at #time/instant "2023-11-23T10:27:11.393420Z", :id #uuid "87e52826-a564-402c-9270-982277676945", :user_session_id #uuid "89ec3c83-297d-4359-9b5b-de8603c74dac", :scope_system_admin_read false, :access-rights (), :user_id #uuid "87e52826-a564-402c-9270-982277676945", :is_system_admin false, :external_sign_out_url nil, :language_locale nil, :inventory_pool_roles_count 0, :scope_admin_read false}

>>1 authorize

>>1 handler #object[leihs.core.locale$wrap$fn__44238 0x46e66fe3 leihs.core.locale$wrap$fn__44238@46e66fe3]

>>1 request {:authenticated-entity {:email jimmie@goyette.com, :contracts_count 0, :lastname Admin, :org_id nil, :scope_read true, :is_admin false, :authentication-method :session, :login nil, :scope_system_admin_write false, :scope_write true, :firstname Procurement, :scope_admin_write false, :user_session_created_at #time/instant "2023-11-23T10:27:11.393420Z", :id #uuid "87e52826-a564-402c-9270-982277676945", :user_session_id #uuid "89ec3c83-297d-4359-9b5b-de8603c74dac", :scope_system_admin_read false, :access-rights (), :user_id #uuid "87e52826-a564-402c-9270-982277676945", :is_system_admin false, :external_sign_out_url nil, :language_locale nil, :inventory_pool_roles_count 0, :scope_admin_read false}, :cookies {leihs-anti-csrf-token {:value 21950efb-b661-4ea6-8ec7-e870b8cf0f3e}, leihs-user-session {:value d30d6a7b-8840-4d86-94ef-3e71f2430949}}, :remote-addr 127.0.0.1, :start-time 392714684985416, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address your.lending.desk@example.com, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url nil, :sessions_force_uniqueness false, :email_signature Cheers,}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x60c0b1cb HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x56d4aa90 next.jdbc.result_set$as_unqualified_lower_maps@56d4aa90]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0, content-type application/json, cookie leihs-anti-csrf-token=21950efb-b661-4ea6-8ec7-e870b8cf0f3e; leihs-user-session=d30d6a7b-8840-4d86-94ef-3e71f2430949, content-length 502, referer http://localhost:3230/procure, connection keep-alive, x-csrf-token 21950efb-b661-4ea6-8ec7-e870b8cf0f3e, accept application/json, accept-language de,en-US;q=0.7,en;q=0.3, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors}, :async-channel #object[org.httpkit.server.AsyncChannel 0x14b1d057 /127.0.0.1:3230<->/127.0.0.1:64747], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x162ebe97 HikariDataSource (db-pool)]}, :content-length 502, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:operationName me, :variables {}, :query query me {
  current_user {
    navbarProps
    user {
      id
      firstname
      lastname
      permissions {
        isAdmin
        isRequester
        isInspectorForCategories {
          id
          __typename
        }
        isViewerForCategories {
          id
          __typename
        }
        __typename
      }
      __typename
    }
    __typename
  }
  settings {
    contact_url
    __typename
  }
}
}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0x7640f117 leihs.procurement.graphql$handler@7640f117], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>>1 (:handler-key request) :graphql
>myprint>  authEnt? {:email jimmie@goyette.com, :contracts_count 0, :lastname Admin, :org_id nil, :scope_read true, :is_admin false, :authentication-method :session, :login nil, :scope_system_admin_write false, :scope_write true, :firstname Procurement, :scope_admin_write false, :user_session_created_at #time/instant "2023-11-23T10:27:11.393420Z", :id #uuid "87e52826-a564-402c-9270-982277676945", :user_session_id #uuid "89ec3c83-297d-4359-9b5b-de8603c74dac", :scope_system_admin_read false, :access-rights (), :user_id #uuid "87e52826-a564-402c-9270-982277676945", :is_system_admin false, :external_sign_out_url nil, :language_locale nil, :inventory_pool_roles_count 0, :scope_admin_read false}
>myprint>  txn {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x162ebe97 HikariDataSource (db-pool)]}
>myprint>  admin true

>2> [SELECT TRUE AS has_entry FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = ? #uuid "87e52826-a564-402c-9270-982277676945"]

>myprint>  inspector false

>2> [SELECT TRUE AS has_entry FROM procurement_category_viewers WHERE user_id = ? #uuid "87e52826-a564-402c-9270-982277676945"]

>myprint>  viewer false
>myprint>  requester false
2023-11-23T10:27:11.950Z NX-41294 DEBUG [leihs.procurement.authorization:134] - (skip? (:handler-key request)) => nil

>2> [SELECT TRUE AS has_entry FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = ? #uuid "87e52826-a564-402c-9270-982277676945"]


>2> [SELECT TRUE AS has_entry FROM procurement_category_viewers WHERE user_id = ? #uuid "87e52826-a564-402c-9270-982277676945"]

2023-11-23T10:27:11.952Z NX-41294 DEBUG [leihs.procurement.authorization:135] - (->> [user-perms/admin? user-perms/inspector? user-perms/viewer? user-perms/requester?] (map (fn* [p1__39120#] (p1__39120# (:tx-next request) (:authenticated-entity request)))) (some true?)) => true
>>>graphql
>>>graphql-query query me {
  current_user {
    navbarProps
    user {
      id
      firstname
      lastname
      permissions {
        isAdmin
        isRequester
        isInspectorForCategories {
          id
          __typename
        }
        isViewerForCategories {
          id
          __typename
        }
        __typename
      }
      __typename
    }
    __typename
  }
  settings {
    contact_url
    __typename
  }
}

>myprint>  mutation? false
2023-11-23T10:27:14.825Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:414] - db-pool - Before cleanup stats (total=2, active=0, idle=2, waiting=0)
2023-11-23T10:27:14.831Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:414] - db-pool - After cleanup  stats (total=2, active=0, idle=2, waiting=0)
2023-11-23T10:27:14.831Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:521] - db-pool - Fill pool skipped, pool has sufficient level or currently being filled (queueDepth=0).
2023-11-23T10:27:14.861Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:414] - HikariPool-1 - Before cleanup stats (total=2, active=0, idle=2, waiting=0)
2023-11-23T10:27:14.862Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:414] - HikariPool-1 - After cleanup  stats (total=2, active=0, idle=2, waiting=0)
2023-11-23T10:27:14.862Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:521] - HikariPool-1 - Fill pool skipped, pool has sufficient level or currently being filled (queueDepth=0).
2023-11-23T10:27:44.835Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:414] - db-pool - Before cleanup stats (total=2, active=0, idle=2, waiting=0)
2023-11-23T10:27:44.836Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:414] - db-pool - After cleanup  stats (total=2, active=0, idle=2, waiting=0)
2023-11-23T10:27:44.836Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:521] - db-pool - Fill pool skipped, pool has sufficient level or currently being filled (queueDepth=0).
2023-11-23T10:27:44.866Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:414] - HikariPool-1 - Before cleanup stats (total=2, active=0, idle=2, waiting=0)
2023-11-23T10:27:44.867Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:414] - HikariPool-1 - After cleanup  stats (total=2, active=0, idle=2, waiting=0)
2023-11-23T10:27:44.867Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:521] - HikariPool-1 - Fill pool skipped, pool has sufficient level or currently being filled (queueDepth=0).
2023-11-23T10:28:14.838Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:414] - db-pool - Before cleanup stats (total=2, active=0, idle=2, waiting=0)
2023-11-23T10:28:14.843Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:414] - db-pool - After cleanup  stats (total=2, active=0, idle=2, waiting=0)
2023-11-23T10:28:14.844Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:521] - db-pool - Fill pool skipped, pool has sufficient level or currently being filled (queueDepth=0).
2023-11-23T10:28:14.869Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:414] - HikariPool-1 - Before cleanup stats (total=2, active=0, idle=2, waiting=0)
2023-11-23T10:28:14.869Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:414] - HikariPool-1 - After cleanup  stats (total=2, active=0, idle=2, waiting=0)
2023-11-23T10:28:14.869Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:521] - HikariPool-1 - Fill pool skipped, pool has sufficient level or currently being filled (queueDepth=0).
2023-11-23T10:28:44.846Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:414] - db-pool - Before cleanup stats (total=2, active=0, idle=2, waiting=0)
2023-11-23T10:28:44.846Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:414] - db-pool - After cleanup  stats (total=2, active=0, idle=2, waiting=0)
2023-11-23T10:28:44.846Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:521] - db-pool - Fill pool skipped, pool has sufficient level or currently being filled (queueDepth=0).
2023-11-23T10:28:44.873Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:414] - HikariPool-1 - Before cleanup stats (total=2, active=0, idle=2, waiting=0)
2023-11-23T10:28:44.874Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:414] - HikariPool-1 - After cleanup  stats (total=2, active=0, idle=2, waiting=0)
2023-11-23T10:28:44.874Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:521] - HikariPool-1 - Fill pool skipped, pool has sufficient level or currently being filled (queueDepth=0).
2023-11-23T10:29:14.847Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:414] - db-pool - Before cleanup stats (total=2, active=0, idle=2, waiting=0)
2023-11-23T10:29:14.881Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:414] - db-pool - After cleanup  stats (total=2, active=0, idle=2, waiting=0)
2023-11-23T10:29:14.877Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:414] - HikariPool-1 - Before cleanup stats (total=2, active=0, idle=2, waiting=0)
2023-11-23T10:29:14.882Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:414] - HikariPool-1 - After cleanup  stats (total=2, active=0, idle=2, waiting=0)
2023-11-23T10:29:14.882Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:521] - db-pool - Fill pool skipped, pool has sufficient level or currently being filled (queueDepth=0).
2023-11-23T10:29:14.882Z NX-41294 DEBUG [com.zaxxer.hikari.pool.HikariPool:521] - HikariPool-1 - Fill pool skipped, pool has sufficient level or currently being filled (queueDepth=0).


