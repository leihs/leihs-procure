context:
  task_defaults:
    include:
      - cider-ci/uberjar_task-component.yml
      - cider-ci/docker_container-partial.yml

    scripts:
      test:
        timeout: 10 minutes
        start_when:
          container is running: { script_key: start-container }

    environment_variables:
      CI: 'true'

    git_options:
      submodules:
        include_match: ^.*$

  tasks:
    'Test':
      scripts:
        test:
          body: |
            docker exec -i "$RUNNER_PROCURE_CONTAINER_NAME" bash -c \
              'cd client && npm test'

    'Lint':
      scripts:
        test:
          body: |
            docker exec -i "$RUNNER_PROCURE_CONTAINER_NAME" bash -c \
              'cd client && \
              npm run ci:lint'
