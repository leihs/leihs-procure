# java_leihs-procure-server env check via asdf v0.13.1
# java_leihs-procure-server env skipped update; touch .tool-versions or remove /var/folders/jl/49spzkdd2v3cdz37fgmp0ddr6cj76v/T/asdf_cache_java_leihs-procure-server to force update
# clojure_leihs-procure-server env check via asdf v0.13.1
# clojure_leihs-procure-server env skipped update; touch .tool-versions or remove /var/folders/jl/49spzkdd2v3cdz37fgmp0ddr6cj76v/T/asdf_cache_clojure_leihs-procure-server to force update
Warning: environ value /Users/mradl/.asdf/installs/java/zulu-11.60.19 for key :java-home has been overwritten with /Users/mradl/.asdf/installs/java/zulu-11.60.19/zulu-11.jdk/Contents/Home
>oo >tocheck users3 sql-order-users, sqlmap= {:select [:users.id :users.firstname :users.lastname], :from [:users]}
>oo >tocheck users3 sql-order-users, sqlmap= {:select [:users.*], :from [:users], :where [:in :users.id {:select [:procurement_admins.user_id], :from [:procurement_admins]}]}
>o> conc concat(lower(coalesce(procurement_requests.article_name, '')), lower(coalesce(models.product, '')), lower(coalesce(models.version, '')))
2023-12-11T15:36:13.982Z NX-41294 DEBUG [leihs.procurement.resources.request:209] - (-> (sql/select [[:raw (str "DISTINCT ON (procurement_requests.id, " conc ") procurement_requests.*")]]) (sql/from :procurement_requests) (sql/left-join :models [:= :models.id :procurement_requests.model_id]) (sql/order-by :procurement_requests.id [[:raw conc]])) => {:select [[[:raw "DISTINCT ON (procurement_requests.id, concat(lower(coalesce(procurement_requests.article_name, '')), lower(coalesce(models.product, '')), lower(coalesce(models.version, '')))) procurement_requests.*"]]], :from [:procurement_requests], :left-join [:models [:= :models.id :procurement_requests.model_id]], :order-by [:procurement_requests.id [[:raw "concat(lower(coalesce(procurement_requests.article_name, '')), lower(coalesce(models.product, '')), lower(coalesce(models.version, '')))"]]]}
>o> templates::templates-base-query ERROR?
2023-12-11T15:36:14.047Z NX-41294 DEBUG [leihs.procurement.resources.templates:27] - (-> (sql/select :procurement_templates.*) (sql/from :procurement_templates) (sql/left-join :models [:= :models.id :procurement_templates.model_id]) (sql/order-by [[:concat (->> [:procurement_templates.article_name :models.product :models.version] (map (fn* [p1__44644#] (->> [:lower [:coalesce p1__44644# ""]]))))]])) => {:select [:procurement_templates.*], :from [:procurement_templates], :left-join [:models [:= :models.id :procurement_templates.model_id]], :order-by [[[:concat ([:lower [:coalesce :procurement_templates.article_name ""]] [:lower [:coalesce :models.product ""]] [:lower [:coalesce :models.version ""]])]]]}
2023-12-11T15:36:14.316Z NX-41294 WARN [leihs.core.release:13] - Failed to read releases.yml, returning bogus value 
2023-12-11T15:36:14.871Z NX-41294 INFO [leihs.core.logging:37] - initializing logging  {:min-level [[#{"leihs.procurement" "leihs.procurement.resources.*" "leihs.procurement.permissions.*" "leihs.procurement.authorization" "leihs.procurement.*"} :debug] [#{"com.zaxxer.hikari.*" "leihs.*"} :info] [#{"*"} :warn]], :log-level nil}
2023-12-11T15:36:14.874Z NX-41294 INFO [leihs.core.logging:39] - initialized logging  {:min-level [[#{"leihs.procurement" "leihs.procurement.resources.*" "leihs.procurement.permissions.*" "leihs.procurement.authorization" "leihs.procurement.*"} :debug] [#{"com.zaxxer.hikari.*" "leihs.*"} :info] [#{"*"} :warn]], :ns-filter #{"*"}, :middleware [], :timestamp-opts {:pattern :iso8601, :locale :jvm-default, :timezone :utc}, :output-fn #object[taoensso.timbre$default_output_fn 0x4f82ab25 "taoensso.timbre$default_output_fn@4f82ab25"], :appenders {:println {:enabled? true, :fn #object[taoensso.timbre.appenders.core$println_appender$fn__3459 0x166040b8 "taoensso.timbre.appenders.core$println_appender$fn__3459@166040b8"]}}, :_init-config {:loaded-from-source :default, :compile-time-config {:min-level nil, :ns-pattern "*"}}, :log-level nil}
2023-12-11T15:36:14.876Z NX-41294 INFO [leihs.procurement.main:50] - main ("--dev-mode" "true" "--repl" "true" "run")
2023-12-11T15:36:14.887Z NX-41294 INFO [leihs.core.repl:62] - init {:dev-mode true, :repl true, :repl-bind "localhost", :repl-port 26017, :repl-port-file ".nrepl-port"}
2023-12-11T15:36:14.889Z NX-41294 INFO [leihs.core.repl:70] - starting nREPL server  26017 localhost
2023-12-11T15:36:14.906Z NX-41294 INFO [leihs.core.repl:75] - started nREPL server 
2023-12-11T15:36:14.912Z NX-41294 INFO [leihs.procurement.run:326] - Invoking run with options:  {:db-host localhost, :db-max-pool-size 16, :db-min-pool-size 2, :db-name leihs_test, :db-password leihs, :db-port 5415, :db-user leihs, :dev-mode true, :http-host localhost, :http-max-threads 8, :http-min-threads 1, :http-port 3230, :http-queue-capacity 640, :http-thread-keep-alive-seconds 10, :http-worker-prefix leihs-service-http-worker-, :pid-file nil, :repl true, :repl-bind localhost, :repl-port 26017, :repl-port-file .nrepl-port}
2023-12-11T15:36:14.913Z NX-41294 INFO [leihs.core.shutdown:20] - PID 33765
2023-12-11T15:36:14.925Z NX-41294 INFO [leihs.core.shutdown:29] - Registering SIGTERM handler for shutdown.
2023-12-11T15:36:14.992Z NX-41294 INFO [leihs.core.graphql:17] - Initialized graphQL schema.
2023-12-11T15:36:14.994Z NX-41294 INFO [leihs.core.db:220] - Initializing db  {:db-name "leihs_test", :db-port 5415, :db-host "localhost", :db-user "leihs", :db-password "leihs", :db-min-pool-size 2, :db-max-pool-size 16}
2023-12-11T15:36:15.000Z NX-41294 INFO [com.zaxxer.hikari.HikariDataSource:80] - db-pool - Starting...
2023-12-11T15:36:15.069Z NX-41294 INFO [com.zaxxer.hikari.pool.HikariPool:565] - db-pool - Added connection org.postgresql.jdbc.PgConnection@4d8a58d5
2023-12-11T15:36:15.075Z NX-41294 INFO [com.zaxxer.hikari.HikariDataSource:82] - db-pool - Start completed.
2023-12-11T15:36:15.075Z NX-41294 INFO [leihs.core.db:222] - Initialized db  {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x29d7116a "HikariDataSource (db-pool)"]}
2023-12-11T15:36:15.076Z NX-41294 INFO [leihs.core.db:223] - Initializing ds-next  {:db-name "leihs_test", :db-port 5415, :db-host "localhost", :db-user "leihs", :db-password "leihs", :db-min-pool-size 2, :db-max-pool-size 16}
2023-12-11T15:36:15.090Z NX-41294 INFO [com.zaxxer.hikari.HikariDataSource:110] - HikariPool-1 - Starting...
2023-12-11T15:36:15.100Z NX-41294 INFO [com.zaxxer.hikari.pool.HikariPool:565] - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@2ed68bea
2023-12-11T15:36:15.101Z NX-41294 INFO [com.zaxxer.hikari.HikariDataSource:123] - HikariPool-1 - Start completed.
2023-12-11T15:36:15.107Z NX-41294 INFO [leihs.core.db:225] - Initialized ds-next  #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e "HikariDataSource (HikariPool-1)"], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 "next.jdbc.result_set$as_unqualified_lower_maps@4c80b126"]}}
2023-12-11T15:36:15.115Z NX-41294 INFO [leihs.core.http-server:101] - starting http-server  {:port 3230, :ip "localhost", :pool {:queue #object[java.util.concurrent.ArrayBlockingQueue 0x7b064068 "[]"], :pool #object[java.util.concurrent.ThreadPoolExecutor 0x48793671 "java.util.concurrent.ThreadPoolExecutor@48793671[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]"]}}
2023-12-11T15:36:15.126Z NX-41294 INFO [leihs.core.http-server:104] - started http-server 
>>> authenticate::skip= nil  handler-key= :not-found
>>> authenticate::authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}

>> authorize >

>> authorize::handler > #object[leihs.core.locale$wrap$fn__44947 0x75cb2fad leihs.core.locale$wrap$fn__44947@75cb2fad]

>> authorize::request > {:authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 90abade9-82d6-4fb6-9898-f7566773263f}, leihs-user-session {:value 3d37de50-dd5a-42c5-bca6-445a84997cf0}}, :remote-addr 127.0.0.1, :start-time 20604184156083, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}, :query-params-raw {}, :route-params nil, :headers {sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, cookie leihs-anti-csrf-token=90abade9-82d6-4fb6-9898-f7566773263f; leihs-user-session=3d37de50-dd5a-42c5-bca6-445a84997cf0, sec-fetch-user ?1, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/admin/categories/f68856713bf356f28e92b5112d0f703f, connection keep-alive, upgrade-insecure-requests 1, pragma no-cache, accept text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest document, accept-encoding gzip, deflate, br, sec-fetch-mode navigate, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x3a913d70 /127.0.0.1:3230<->/127.0.0.1:65348], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x29d7116a HikariDataSource (db-pool)]}, :content-length 0, :form-params {}, :websocket? false, :query-params {}, :content-type nil, :form-params-raw {}, :character-encoding utf8, :uri /procure/admin/categories/f68856713bf356f28e92b5112d0f703f, :server-name localhost, :handler-key :not-found, :query-string nil, :body nil, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.backend.html$not_found_handler 0x44a7638f leihs.procurement.backend.html$not_found_handler@44a7638f], :multipart-params {}, :scheme :http, :request-method :get, :accept {:mime :html, :charset nil, :encoding nil, :language nil}}

>> authorize::handler-key >> :not-found
>myprint>  authEnt? {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>myprint>  txn #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.483Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.490Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>myprint>  admin true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.491Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> inspector? {:result false}
>myprint>  inspector false
>o> viewer? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.496Z NX-41294 DEBUG [leihs.procurement.permissions.user:83] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> viewer? {:result false}
>myprint>  viewer false
>o> requester?? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.497Z NX-41294 DEBUG [leihs.procurement.permissions.user:167] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> requester?? {:exists false}
>myprint>  requester false
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.499Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.499Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.500Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> inspector? {:result false}
>o> viewer? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.501Z NX-41294 DEBUG [leihs.procurement.permissions.user:83] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> viewer? {:result false}
>o> requester?? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.502Z NX-41294 DEBUG [leihs.procurement.permissions.user:167] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> requester?? {:exists false}

> 1 anti-csrf-token >  90abade9-82d6-4fb6-9898-f7566773263f

> 1 anti-csrf-token class >  java.lang.String

> 2 anti-csrf-token-new >  nil
>>> authenticate::skip= nil  handler-key= :graphql
>>> authenticate::authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}

>> authorize >

>> authorize::handler > #object[leihs.core.locale$wrap$fn__44947 0x75cb2fad leihs.core.locale$wrap$fn__44947@75cb2fad]

>> authorize::request > {:authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 90abade9-82d6-4fb6-9898-f7566773263f}, leihs-user-session {:value 3d37de50-dd5a-42c5-bca6-445a84997cf0}}, :remote-addr 127.0.0.1, :start-time 20604500129125, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type application/json, cookie leihs-anti-csrf-token=90abade9-82d6-4fb6-9898-f7566773263f; leihs-user-session=3d37de50-dd5a-42c5-bca6-445a84997cf0, content-length 502, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/admin/categories/f68856713bf356f28e92b5112d0f703f, connection keep-alive, pragma no-cache, x-csrf-token 90abade9-82d6-4fb6-9898-f7566773263f, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x1aa55cf8 /127.0.0.1:3230<->/127.0.0.1:65348], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x29d7116a HikariDataSource (db-pool)]}, :content-length 502, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:operationName me, :variables {}, :query query me {
  current_user {
    navbarProps
    user {
      id
      firstname
      lastname
      permissions {
        isAdmin
        isRequester
        isInspectorForCategories {
          id
          __typename
        }
        isViewerForCategories {
          id
          __typename
        }
        __typename
      }
      __typename
    }
    __typename
  }
  settings {
    contact_url
    __typename
  }
}
}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0x46dd5e9 leihs.procurement.graphql$handler@46dd5e9], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>> authorize::handler-key >> :graphql
>myprint>  authEnt? {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>myprint>  txn #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.743Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.744Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>myprint>  admin true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.744Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> inspector? {:result false}
>myprint>  inspector false
>o> viewer? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.745Z NX-41294 DEBUG [leihs.procurement.permissions.user:83] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> viewer? {:result false}
>myprint>  viewer false
>o> requester?? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.746Z NX-41294 DEBUG [leihs.procurement.permissions.user:167] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> requester?? {:exists false}
>myprint>  requester false
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.747Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.748Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.748Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> inspector? {:result false}
>o> viewer? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.749Z NX-41294 DEBUG [leihs.procurement.permissions.user:83] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> viewer? {:result false}
>o> requester?? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.749Z NX-41294 DEBUG [leihs.procurement.permissions.user:167] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> requester?? {:exists false}

> 1 anti-csrf-token >  90abade9-82d6-4fb6-9898-f7566773263f

> 1 anti-csrf-token class >  java.lang.String

> 2 anti-csrf-token-new >  nil
pure-handler >> 2
2023-12-11T15:36:17.755Z NX-41294 DEBUG [leihs.procurement.graphql:46] - graphql query query me {
  current_user {
    navbarProps
    user {
      id
      firstname
      lastname
      permissions {
        isAdmin
        isRequester
        isInspectorForCategories {
          id
          __typename
        }
        isViewerForCategories {
          id
          __typename
        }
        __typename
      }
      __typename
    }
    __typename
  }
  settings {
    contact_url
    __typename
  }
}
 with variables {}
>oo> vars from graphQL-Requst nil nil nil {}
>>>1 #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"
>oo >tocheck user2
2023-12-11T15:36:17.765Z NX-41294 DEBUG [leihs.procurement.resources.user:86] - id => #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"
>o> >tocheck>
2023-12-11T15:36:17.766Z NX-41294 DEBUG [leihs.procurement.resources.user:?] - (sql-format (sql/where user-base-query [:= :id [:cast id :uuid]])) => ["SELECT id, firstname, lastname FROM users WHERE id = CAST(? AS UUID)" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>>>2 {:id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :firstname Manuel, :lastname Radl}
>>oida>> #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"
2023-12-11T15:36:17.770Z NX-41294 DEBUG [leihs.procurement.resources.saved-filters:19] - (-> (sql/select :*) (sql/from :procurement_users_filters) (sql/where [:= :user_id [:cast user-id :uuid]]) sql-format) => ["SELECT * FROM procurement_users_filters WHERE user_id = CAST(? AS UUID)" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>>>3 nil
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.797Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.798Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> requester?? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.799Z NX-41294 DEBUG [leihs.procurement.permissions.user:167] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> requester?? {:exists false}

>request-grapql _> request {:leihs-user-language {:name Deutsch, :locale de-CH, :default true, :active true}, :authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 90abade9-82d6-4fb6-9898-f7566773263f}, leihs-user-session {:value 3d37de50-dd5a-42c5-bca6-445a84997cf0}}, :remote-addr 127.0.0.1, :start-time 20604500129125, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type application/json, cookie leihs-anti-csrf-token=90abade9-82d6-4fb6-9898-f7566773263f; leihs-user-session=3d37de50-dd5a-42c5-bca6-445a84997cf0, content-length 502, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/admin/categories/f68856713bf356f28e92b5112d0f703f, connection keep-alive, pragma no-cache, x-csrf-token 90abade9-82d6-4fb6-9898-f7566773263f, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x1aa55cf8 /127.0.0.1:3230<->/127.0.0.1:65348], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x29d7116a HikariDataSource (db-pool)]}, :content-length 502, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:operationName me, :variables {}, :query query me {
  current_user {
    navbarProps
    user {
      id
      firstname
      lastname
      permissions {
        isAdmin
        isRequester
        isInspectorForCategories {
          id
          __typename
        }
        isViewerForCategories {
          id
          __typename
        }
        __typename
      }
      __typename
    }
    __typename
  }
  settings {
    contact_url
    __typename
  }
}
}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0x46dd5e9 leihs.procurement.graphql$handler@46dd5e9], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>request-c-grapql _> request (json) {"leihs-user-language":{"name":"Deutsch","locale":"de-CH","default":true,"active":true},"authenticated-entity":{"email":"manuel.radl@zhdk.ch","contracts_count":1,"lastname":"Radl","org_id":"271682","scope_read":true,"is_admin":true,"authentication-method":"session","login":"mradl","scope_system_admin_write":true,"scope_write":true,"firstname":"Manuel","scope_admin_write":true,"user_session_created_at":"2023-12-11T13:47:06.369416Z","id":"a786135f-c159-4618-9dd3-0012ebb3d500","user_session_id":"eaf44d43-6c37-4367-8386-da902cc69e3e","scope_system_admin_read":true,"access-rights":[{"role":"customer","inventory_pool_id":"3977012c-ce0e-501f-889b-8715fdb5d83b"},{"role":"customer","inventory_pool_id":"5863967f-9804-4909-a9b7-92254616d6b2"},{"role":"customer","inventory_pool_id":"5dd25b58-fa56-5095-bd97-2696d92c2fb1"},{"role":"customer","inventory_pool_id":"77e88ec8-9ff6-5435-818e-dc902fc631a6"},{"role":"inventory_manager","inventory_pool_id":"8bd16d45-056d-5590-bc7f-12849f034351"},{"role":"inventory_manager","inventory_pool_id":"a02b8163-9a16-5066-b48e-9eb74cf8b791"},{"role":"inventory_manager","inventory_pool_id":"b534b07c-d9bf-4572-840c-0a630b8cd8ed"},{"role":"customer","inventory_pool_id":"fc5a841e-36c6-5dc3-8207-1306c1fb89bf"},{"role":"customer","inventory_pool_id":"ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}],"user_id":"a786135f-c159-4618-9dd3-0012ebb3d500","is_system_admin":true,"external_sign_out_url":null,"language_locale":"de-CH","inventory_pool_roles_count":9,"scope_admin_read":true},"cookies":{"leihs-anti-csrf-token":{"value":"90abade9-82d6-4fb6-9898-f7566773263f"},"leihs-user-session":{"value":"3d37de50-dd5a-42c5-bca6-445a84997cf0"}},"remote-addr":"127.0.0.1","start-time":20604500129125,"params":{},"settings":{"email_sending_enabled":false,"sessions_max_lifetime_secs":432000,"smtp_default_from_address":"noreply@zhdk.ch","public_image_caching_enabled":true,"sessions_force_secure":false,"deliver_received_order_notifications":false,"external_base_url":"http:\/\/localhost:3200","sessions_force_uniqueness":false,"email_signature":"Das ZHdK-Ausleihe-Team"},"query-params-raw":{},"route-params":null,"headers":{"origin":"http:\/\/localhost:3230","sec-fetch-site":"same-origin","sec-ch-ua-mobile":"?0","host":"localhost:3230","user-agent":"Mozilla\/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit\/537.36 (KHTML, like Gecko) Chrome\/119.0.0.0 Safari\/537.36","content-type":"application\/json","cookie":"leihs-anti-csrf-token=90abade9-82d6-4fb6-9898-f7566773263f; leihs-user-session=3d37de50-dd5a-42c5-bca6-445a84997cf0","content-length":"502","sec-ch-ua":"\"Google Chrome\";v=\"119\", \"Chromium\";v=\"119\", \"Not?A_Brand\";v=\"24\"","sec-ch-ua-platform":"\"macOS\"","referer":"http:\/\/localhost:3230\/procure\/admin\/categories\/f68856713bf356f28e92b5112d0f703f","connection":"keep-alive","pragma":"no-cache","x-csrf-token":"90abade9-82d6-4fb6-9898-f7566773263f","accept":"application\/json","accept-language":"de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7","sec-fetch-dest":"empty","accept-encoding":"gzip, deflate, br","sec-fetch-mode":"cors","cache-control":"no-cache"},"server-port":3230,"params-raw":{},"content-length":502,"form-params":{},"websocket?":false,"query-params":{},"content-type":"application\/json","form-params-raw":{},"character-encoding":"utf8","uri":"\/procure\/graphql","server-name":"localhost","handler-key":"graphql","query-string":null,"body":{"operationName":"me","variables":{},"query":"query me {\n  current_user {\n    navbarProps\n    user {\n      id\n      firstname\n      lastname\n      permissions {\n        isAdmin\n        isRequester\n        isInspectorForCategories {\n          id\n          __typename\n        }\n        isViewerForCategories {\n          id\n          __typename\n        }\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  settings {\n    contact_url\n    __typename\n  }\n}\n"},"multipart-params":{},"scheme":"http","request-method":"post","accept":{"mime":"json","charset":null,"encoding":null,"language":null}}

>request-grapql _> result => {:data #ordered/map ([:current_user #ordered/map ([:navbarProps {"csrfToken":{"value":"90abade9-82d6-4fb6-9898-f7566773263f","name":"csrf-token"},"config":{"appTitle":"leihs","appColor":"gray","me":{"user":{"id":"a786135f-c159-4618-9dd3-0012ebb3d500","firstname":"Manuel","lastname":"Radl","login":"mradl","email":"manuel.radl@zhdk.ch"}},"subApps":{"borrow":true,"admin":true,"procure":false,"manage":[{"name":"Ausleihe Toni-Areal","href":"/manage/8bd16d45-056d-5590-bc7f-12849f034351/daily"},{"name":"AVS-Museum/Ausstellungen","href":"/manage/b534b07c-d9bf-4572-840c-0a630b8cd8ed/daily"},{"name":"Kostüm- und Kleinrequisitenfundus DDK","href":"/manage/a02b8163-9a16-5066-b48e-9eb74cf8b791/daily"}]},"locales":[{"name":"Deutsch","locale":"de-CH","active":true,"isDefault":true,"isSelected":true},{"name":"English","locale":"en-GB","active":true,"isDefault":false,"isSelected":false},{"name":"Castellano","locale":"es","active":true,"isDefault":false,"isSelected":false},{"name":"Züritüütsch","locale":"gsw-CH","active":true,"isDefault":false,"isSelected":false}]}}] [:user #ordered/map ([:id a786135f-c159-4618-9dd3-0012ebb3d500] [:firstname Manuel] [:lastname Radl] [:permissions #ordered/map ([:isAdmin true] [:isRequester false] [:isInspectorForCategories []] [:isViewerForCategories []] [:__typename :UserPermissions])] [:__typename :User])] [:__typename :CurrentUser])] [:settings #ordered/map ([:contact_url https://intern.zhdk.ch/index.php?id=leihs_bedarfsermittlung] [:__typename :ProcurementSettings])])}
2023-12-11T15:36:17.815Z NX-41294 DEBUG [leihs.procurement.graphql:86] - result => {:data #ordered/map ([:current_user #ordered/map ([:navbarProps "{\"csrfToken\":{\"value\":\"90abade9-82d6-4fb6-9898-f7566773263f\",\"name\":\"csrf-token\"},\"config\":{\"appTitle\":\"leihs\",\"appColor\":\"gray\",\"me\":{\"user\":{\"id\":\"a786135f-c159-4618-9dd3-0012ebb3d500\",\"firstname\":\"Manuel\",\"lastname\":\"Radl\",\"login\":\"mradl\",\"email\":\"manuel.radl@zhdk.ch\"}},\"subApps\":{\"borrow\":true,\"admin\":true,\"procure\":false,\"manage\":[{\"name\":\"Ausleihe Toni-Areal\",\"href\":\"/manage/8bd16d45-056d-5590-bc7f-12849f034351/daily\"},{\"name\":\"AVS-Museum/Ausstellungen\",\"href\":\"/manage/b534b07c-d9bf-4572-840c-0a630b8cd8ed/daily\"},{\"name\":\"Kostüm- und Kleinrequisitenfundus DDK\",\"href\":\"/manage/a02b8163-9a16-5066-b48e-9eb74cf8b791/daily\"}]},\"locales\":[{\"name\":\"Deutsch\",\"locale\":\"de-CH\",\"active\":true,\"isDefault\":true,\"isSelected\":true},{\"name\":\"English\",\"locale\":\"en-GB\",\"active\":true,\"isDefault\":false,\"isSelected\":false},{\"name\":\"Castellano\",\"locale\":\"es\",\"active\":true,\"isDefault\":false,\"isSelected\":false},{\"name\":\"Züritüütsch\",\"locale\":\"gsw-CH\",\"active\":true,\"isDefault\":false,\"isSelected\":false}]}}"] [:user #ordered/map ([:id "a786135f-c159-4618-9dd3-0012ebb3d500"] [:firstname "Manuel"] [:lastname "Radl"] [:permissions #ordered/map ([:isAdmin true] [:isRequester false] [:isInspectorForCategories []] [:isViewerForCategories []] [:__typename :UserPermissions])] [:__typename :User])] [:__typename :CurrentUser])] [:settings #ordered/map ([:contact_url "https://intern.zhdk.ch/index.php?id=leihs_bedarfsermittlung"] [:__typename :ProcurementSettings])])}
>>> authenticate::skip= nil  handler-key= :graphql
>>> authenticate::authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}

>> authorize >

>> authorize::handler > #object[leihs.core.locale$wrap$fn__44947 0x75cb2fad leihs.core.locale$wrap$fn__44947@75cb2fad]

>> authorize::request > {:authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 90abade9-82d6-4fb6-9898-f7566773263f}, leihs-user-session {:value 3d37de50-dd5a-42c5-bca6-445a84997cf0}}, :remote-addr 127.0.0.1, :start-time 20604640149083, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type application/json, cookie leihs-anti-csrf-token=90abade9-82d6-4fb6-9898-f7566773263f; leihs-user-session=3d37de50-dd5a-42c5-bca6-445a84997cf0, content-length 255, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/admin/categories/f68856713bf356f28e92b5112d0f703f, connection keep-alive, pragma no-cache, x-csrf-token 90abade9-82d6-4fb6-9898-f7566773263f, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x1c7a2657 /127.0.0.1:3230<->/127.0.0.1:65348], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x29d7116a HikariDataSource (db-pool)]}, :content-length 255, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:operationName MainCategoriesIndex, :variables {}, :query query MainCategoriesIndex {
  main_categories {
    id
    name
    image_url
    categories {
      id
      name
      can_delete
      __typename
    }
    __typename
  }
}
}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0x46dd5e9 leihs.procurement.graphql$handler@46dd5e9], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>> authorize::handler-key >> :graphql
>myprint>  authEnt? {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>myprint>  txn #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.848Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.849Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>myprint>  admin true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.850Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> inspector? {:result false}
>myprint>  inspector false
>o> viewer? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.850Z NX-41294 DEBUG [leihs.procurement.permissions.user:83] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> viewer? {:result false}
>myprint>  viewer false
>o> requester?? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.851Z NX-41294 DEBUG [leihs.procurement.permissions.user:167] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> requester?? {:exists false}
>myprint>  requester false
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.852Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.852Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.853Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> inspector? {:result false}
>o> viewer? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.854Z NX-41294 DEBUG [leihs.procurement.permissions.user:83] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> viewer? {:result false}
>o> requester?? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.854Z NX-41294 DEBUG [leihs.procurement.permissions.user:167] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> requester?? {:exists false}

> 1 anti-csrf-token >  90abade9-82d6-4fb6-9898-f7566773263f

> 1 anti-csrf-token class >  java.lang.String

> 2 anti-csrf-token-new >  nil
pure-handler >> 2
2023-12-11T15:36:17.857Z NX-41294 DEBUG [leihs.procurement.graphql:46] - graphql query query MainCategoriesIndex {
  main_categories {
    id
    name
    image_url
    categories {
      id
      name
      can_delete
      __typename
    }
    __typename
  }
}
 with variables {}
>oo> vars from graphQL-Requst nil nil nil {}
>debug 2
>debug 3
2023-12-11T15:36:17.861Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format main-categories-base-query) => ["SELECT procurement_main_categories.* FROM procurement_main_categories ORDER BY procurement_main_categories.name ASC"]
>debug 4
>debug 5 {:id #uuid "519f7a95-9ca7-5256-bf63-142cfc23dc62", :name Audio- und Videotechnik}
>debug 5a id #uuid "519f7a95-9ca7-5256-bf63-142cfc23dc62"
2023-12-11T15:36:17.864Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "519f7a95-9ca7-5256-bf63-142cfc23dc62"]
>debug 5b {:main_category_id #uuid "519f7a95-9ca7-5256-bf63-142cfc23dc62", :content iVBORw0KGgoAAAANSUhEUgAAAHAAAACACAYAAADTcu1SAAAABHNCSVQICAgI
fAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAAA9tJREFUeJzt3U1rVFcAgOE3
Y6maVJeK/gIpbWmtJtaPneCqiOBfKLTgv3EtVPAPCEKroGsVEYpYu5LSYpd+
tDXtKtPFyQRTJ7lzzz0fOZn3gbNy7szNeefeTO7FOSBJkiRJkiRJkiRJkiRJ
kqTdYCHi8V8AF4AV4BhwBDgQ8Vy1jYG/gD+AX4AHwI/AT+v/tqvsB64QftDx
Lh8/A98B+5LM3A5wGfid+hNbevwGXEowfyl8TDg7/AusAreAz7o2WgJuUH8i
a4/rwGLXZGX0JfBqyn6tAstbbXQYeDxlo3kdj9bnpLQTTI83GfembXQYeLbN
RvM6ngGHOqc8na54Y+Cf/2+0hEfeduMRZU6ns8SbjE38ndc9vu+a/YFOAq97
7M+GyxE/zLyOi90dovSNtxFwP/P5p0Ls+BXY292jl2X6x9sIeKXSRLQ8vu1u
MrPYeGMIl8Dm4QpL6vGUNJcPl4E3A/aD4ztgMlodnVdDOqwwLN54RLgwrThD
5m4FuAMcHLIDo/UnUpxTA7YbHA/gA8ItIcWJmbtJvAMpdmBEuJ+nOEd7Pj5p
PAifotZo72bsTrEG7JnxsV8Bt0kYD0K4cconnEOzvPlPE+7nJY0H4RSqvLLF
g/AhRvmcJpw2P8r1Ah6B+WSPBwbM5QwF4oEBczhL+J2XPR4YMLWzwA8Uigd+
iElpcuQtlXxRj8A0zlEhHhgwhXOE02bxeOCVmBTeUikeGLB5nkIbZ8DGGbBx
BmycARtnwMYZsHEGbJwBG2fAxhmwcQZsnAEbZ8DGGbBxBmycARtnwMYZsHEG
bJwBG2fA4V7VfHEDDneeihENONxjKkY0YBrVIhownSoRDZhW8YgGTK9oRAPm
USyiAfMpEtGAeWWPaMD8skYc4X/wHGJtxsdlizgiLMGmOH/2eGyWiCPC+nmK
86Ln45NHHBG+sV5xYuYuacQRYeVKxbkfuV3SiJ9T/+v7Wx2fRMz3u44DLwfu
AwuEZUdrT0Zr4wlpvqp6UMTJnxFXE+zIvLnK+hEwUJLT6T7CmrG139WtjOfA
h1EzvbXYI3HDpYIT0Pr4uqtGpJiIm1xP8MPt9nGtI8JQfSNuskhYZrT2JO3U
8ZCw1mJufSK+x0WQp4/SiyDPEvG9RZAnDuGR+O54SNl4E10R72638SJhwd/a
k1d7XKPMaXMrW0V8S1hzt9NFwpqxtSey9HhOvk+bfR0DbgGrwN/ATXpeBdpL
WDP2KfUnNvd4AnxD+r/zsuh7KWgB+JSwcuUpwjvjKGEhw9bu7q8R7ue9INxV
uE/44vLJm1SSJEmSJEmSJEmSJEmSJEkq5j8E8YerHU6LEAAAAABJRU5ErkJg
gg==
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 1081, :content_type image/png, :filename video.png, :id #uuid "ee215167-b2c3-5fcc-90c3-098ad20d16ea", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.014, :System:Directory /tmp/tmp.qSpfBizLgM, :System:FileSize 1081 bytes, :PNG:ImageHeight 128, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 112x128, :PNG:ColorType RGB with Alpha, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 112, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/video.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName video.png, :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-11T15:36:17.868Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "519f7a95-9ca7-5256-bf63-142cfc23dc62"]
>debug 4
>debug 5 {:id #uuid "1a047acd-dc98-52c2-99d3-dc6332adc1e0", :name Bauliche Anpassungen und Mobiliar}
>debug 5a id #uuid "1a047acd-dc98-52c2-99d3-dc6332adc1e0"
2023-12-11T15:36:17.869Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "1a047acd-dc98-52c2-99d3-dc6332adc1e0"]
>debug 5b {:main_category_id #uuid "1a047acd-dc98-52c2-99d3-dc6332adc1e0", :content iVBORw0KGgoAAAANSUhEUgAAAGQAAACACAYAAAD9N8zAAAAABHNCSVQICAgI
fAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAABiNJREFUeJztnXmoVVUUh7+r
PvVpZebLHDJDsGywMiuLioSIIsMsMiqpoIIgqEwKLYUiqCAaoD+KlCQblKKR
BopSG0xJyyJKmp2liTSnJn32x763nqd97rD2uffu897vgwXCO2etvffv3Lv3
XnudKwghhBBCCCGEEEIIIYQQQgghhBBCCCFyTqHZDciAfsCw4r/XA781sS1d
lm7AFcAKYE/ClgNTCH/Y7gB+9/ivZKuAwwJj54r+wJtUHpjXcJ8eC0Or8F/O
5hrj5o6RwFdUPzBfACMMcY6uIYbPXrJ0Lm+MB36l9sH5GTitxlgSpALXAH9j
H6A/cXNOtUiQFLoD9xM2OB3tLtyCoBISxMO+wCtkJ0bJngP6VIgtQRIMBz4j
ezFK9hEwpEz8pglSzce30ZyC20uMrmOMscUYY+oYw0RsgkwBFgMDGxBrKLAE
mNSAWLmjG3An9q+Ir4tmubcdmM7eO/suPYf0AZ7F3vmFwAFFWxTgZy7Qs9im
LivIEPz5qGrtUaClg7+ewJwAf+8CbXRRQY4HNmDr8G5gKv4EYgG4CfdVZPH9
LXCR8d7cCnIBsANbZ7cCE6qIcR6wzRgjJCuQK0EKwAzsHV1DbcvhY4C1AfE6
tSC9gHnYO7kU/3K4BXi4aC2evx8ELAuI2ykFORB4H3sHnwJ6e/wOYO+VVWnF
laQ38HRA/E4lyFHA99g7dxv+yfsI3AScvP4bYJTn+gIwK6AdnUKQc3Bn3JZO
7cStdix+twBnp9w7GdvRbK4FKQA34Janlg5tBE5I8XtjlX53F6/1fbpOBDYZ
25Y7QVqAR7B35mNcnimJddM3m/924B05GPgkoJ25EKQ/8Bb2jjwP9PX4bcPt
oq1+38EtAJL0BV4M8Bu1ICOBL7F3Iu00L3RRULLvgCM9/rsB92TgPypBxmMr
QNiDO+++PMXvBNzOPKuB2gqcmxLrSuCvjOI0VZCrsacafgJO9fgsADdjz0eV
s93ANPyT/enALxnEaIog3YH7DI0t2efAoR6/vXCp8KyFSNpj+Cf7Ebjqw1wJ
ElqA8Dqwn8fvQMJ29LXae7gsQpJ+wBsBflcCrRVHMSOGE1aA8CDQw+N3NC55
2CgxSrYad/6RpAfwUIDf5cDg8kMZzsnAj8YG7gKuTfE7EXuqPAvbhkvX+7iu
2HaL3/XUsZDiMuAPY8M2A2d6fJbS8fWYvGu1duAW/JP9Wbh0jMXvDjIupMii
AOFwj9/ewBMBfutlj+MWFklG4U9mVmszyOB9nNAChEX40+GDaPwZRS32Af6z
lwGEZQzm4Re7KgbjJiZr8Nn4D4yOA9YF+G2UrcWdOCbpiVsyW/0uwVB3NgZ7
AUI7rsjA9/G8EPtZejNsO3C+px+hG9fV+Fd2XiYFDNo2/AUIBWBmHQasEdYO
3Ir/AZuIEy3Lsdpr0KZjV30N/gKEVmB+Ewc0K3sS/zHysdi/gttJSeP0wq0u
rI1diismSDKEsHkoNluGW5AkGQR8GOB3Dh3SOPUqQBiLfR6K2dbh3+y1AgsC
/C6meGYTIsZM/N+tk3Fn4s0evHrZDtwCJUkBuD3A70KwTeBpBQihDcqbzcL/
QF6CrZBiC9RevLYJfwFCH+CZCAap0TYff2Z3HPBDjb7mgDtXXlnlDStxxQFJ
huJeE2v24DTLluN/Re4Q4NMqfaygg7DDqKzmC/gLEE6iviU1ebENuIVMkn2A
lyvcuxGPoONIz+bejb8A4VLqX3SWJ9uJW9Ak6Q7cW+Ye3xQAuHf8Ol5c7oX7
qREMQKx2fcqYXcX/CykuTrn2X6bhyjRXUf4nKV6NoOOxWrkz9TNwafzNpAtn
QoLYBClLbK9Fd3kkSGRIkMiQIJEhQSJDgkSGBIkMX0lnrJSOli0UyMnDlydB
BlA8LzDQhvsxzOjJxVPTlZAgkSFBIkOCRIYEiQwJEhkSJDIkSGRIkMiQIJEh
QSJDgkSGBIkMCRIZEiQyJEhkSJDIkCCRIUEiI0SQnZm1ovOx3XpjiCBvB9zb
2WnK2LTQ2J/j2z+grW0NbOcimljN0xd4APeO4a46W6gg9W7fRtxra5X+00oh
hBBCCCGEEEIIIYQQQgghhBBCCCGEEA3kH1vl9UN9mBbVAAAAAElFTkSuQmCC
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 1665, :content_type image/png, :filename bauprojekte.png, :id #uuid "8e07c37e-d244-514d-bfa9-306158056160", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.013, :System:Directory /tmp/tmp.qSpfBizLgM, :System:FileSize 1665 bytes, :PNG:ImageHeight 128, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 100x128, :PNG:ColorType RGB with Alpha, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 100, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/bauprojekte.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName bauprojekte.png, :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-11T15:36:17.873Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "1a047acd-dc98-52c2-99d3-dc6332adc1e0"]
>debug 4
>debug 5 {:id #uuid "dda588f4-660c-573c-a2ff-944ae93ad42e", :name Beleuchtungstechnik}
>debug 5a id #uuid "dda588f4-660c-573c-a2ff-944ae93ad42e"
2023-12-11T15:36:17.875Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "dda588f4-660c-573c-a2ff-944ae93ad42e"]
>debug 5b {:main_category_id #uuid "dda588f4-660c-573c-a2ff-944ae93ad42e", :content iVBORw0KGgoAAAANSUhEUgAAAJsAAACACAYAAAAccBvUAAAACXBIWXMAAAQK
AAAECgFCV1GHAAA59GlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFj
a2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQi
Pz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0
az0iQWRvYmUgWE1QIENvcmUgNS42LWMxMTEgNzkuMTU4MzI1LCAyMDE1LzA5
LzEwLTAxOjEwOjIwICAgICAgICAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9
Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMi
PgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAg
ICAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8i
CiAgICAgICAgICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxl
bWVudHMvMS4xLyIKICAgICAgICAgICAgeG1sbnM6cGhvdG9zaG9wPSJodHRw
Oi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIgogICAgICAgICAgICB4
bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIK
ICAgICAgICAgICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20v
eGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgICAgICAgICAgeG1s
bnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAg
ICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8x
LjAvIj4KICAgICAgICAgPHhtcDpDcmVhdG9yVG9vbD5BZG9iZSBQaG90b3No
b3AgQ0MgMjAxNSAoTWFjaW50b3NoKTwveG1wOkNyZWF0b3JUb29sPgogICAg
ICAgICA8eG1wOkNyZWF0ZURhdGU+MjAxNi0wNy0xNFQxNTo0NTo0MSswMjow
MDwveG1wOkNyZWF0ZURhdGU+CiAgICAgICAgIDx4bXA6TW9kaWZ5RGF0ZT4y
MDE2LTA3LTE0VDE1OjQ5OjAyKzAyOjAwPC94bXA6TW9kaWZ5RGF0ZT4KICAg
ICAgICAgPHhtcDpNZXRhZGF0YURhdGU+MjAxNi0wNy0xNFQxNTo0OTowMisw
MjowMDwveG1wOk1ldGFkYXRhRGF0ZT4KICAgICAgICAgPGRjOmZvcm1hdD5p
bWFnZS9wbmc8L2RjOmZvcm1hdD4KICAgICAgICAgPHBob3Rvc2hvcDpDb2xv
ck1vZGU+MzwvcGhvdG9zaG9wOkNvbG9yTW9kZT4KICAgICAgICAgPHhtcE1N
Okluc3RhbmNlSUQ+eG1wLmlpZDozMTMzODRjNi0zYzM5LTQzNjgtODE5OS01
OWJhZDM3ODBkNGQ8L3htcE1NOkluc3RhbmNlSUQ+CiAgICAgICAgIDx4bXBN
TTpEb2N1bWVudElEPmFkb2JlOmRvY2lkOnBob3Rvc2hvcDoxYTU3ZjVjYy04
YTU4LTExNzktOGVmNS04OTFkYzJiZDEwY2Y8L3htcE1NOkRvY3VtZW50SUQ+
CiAgICAgICAgIDx4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ+eG1wLmRpZDpk
OWQ5MWY5NC0yNjQ0LTQ4NTItODAwYS0yZTA2OTBlN2VjMzM8L3htcE1NOk9y
aWdpbmFsRG9jdW1lbnRJRD4KICAgICAgICAgPHhtcE1NOkhpc3Rvcnk+CiAg
ICAgICAgICAgIDxyZGY6U2VxPgogICAgICAgICAgICAgICA8cmRmOmxpIHJk
ZjpwYXJzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgICAgICAgPHN0
RXZ0OmFjdGlvbj5jcmVhdGVkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAg
ICAgICAgIDxzdEV2dDppbnN0YW5jZUlEPnhtcC5paWQ6ZDlkOTFmOTQtMjY0
NC00ODUyLTgwMGEtMmUwNjkwZTdlYzMzPC9zdEV2dDppbnN0YW5jZUlEPgog
ICAgICAgICAgICAgICAgICA8c3RFdnQ6d2hlbj4yMDE2LTA3LTE0VDE1OjQ1
OjQxKzAyOjAwPC9zdEV2dDp3aGVuPgogICAgICAgICAgICAgICAgICA8c3RF
dnQ6c29mdHdhcmVBZ2VudD5BZG9iZSBQaG90b3Nob3AgQ0MgMjAxNSAoTWFj
aW50b3NoKTwvc3RFdnQ6c29mdHdhcmVBZ2VudD4KICAgICAgICAgICAgICAg
PC9yZGY6bGk+CiAgICAgICAgICAgICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlw
ZT0iUmVzb3VyY2UiPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6YWN0aW9u
PnNhdmVkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAgICAgICAgIDxzdEV2
dDppbnN0YW5jZUlEPnhtcC5paWQ6MzEzMzg0YzYtM2MzOS00MzY4LTgxOTkt
NTliYWQzNzgwZDRkPC9zdEV2dDppbnN0YW5jZUlEPgogICAgICAgICAgICAg
ICAgICA8c3RFdnQ6d2hlbj4yMDE2LTA3LTE0VDE1OjQ5OjAyKzAyOjAwPC9z
dEV2dDp3aGVuPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6c29mdHdhcmVB
Z2VudD5BZG9iZSBQaG90b3Nob3AgQ0MgMjAxNSAoTWFjaW50b3NoKTwvc3RF
dnQ6c29mdHdhcmVBZ2VudD4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OmNo
YW5nZWQ+Lzwvc3RFdnQ6Y2hhbmdlZD4KICAgICAgICAgICAgICAgPC9yZGY6
bGk+CiAgICAgICAgICAgIDwvcmRmOlNlcT4KICAgICAgICAgPC94bXBNTTpI
aXN0b3J5PgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9y
aWVudGF0aW9uPgogICAgICAgICA8dGlmZjpYUmVzb2x1dGlvbj4yNjI2MzYv
MTAwMDA8L3RpZmY6WFJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOllSZXNv
bHV0aW9uPjI2MjYzNi8xMDAwMDwvdGlmZjpZUmVzb2x1dGlvbj4KICAgICAg
ICAgPHRpZmY6UmVzb2x1dGlvblVuaXQ+MjwvdGlmZjpSZXNvbHV0aW9uVW5p
dD4KICAgICAgICAgPGV4aWY6Q29sb3JTcGFjZT42NTUzNTwvZXhpZjpDb2xv
clNwYWNlPgogICAgICAgICA8ZXhpZjpQaXhlbFhEaW1lbnNpb24+MTU1PC9l
eGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGlt
ZW5zaW9uPjEyODwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgIDwvcmRm
OkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAo8P3hwYWNrZXQgZW5kPSJ3
Ij8+W7LKAQAAACBjSFJNAAB6JQAAgIMAAPn/AACA6AAAUggAARVYAAA6lwAA
F2/XWh+QAAAJGElEQVR42uyda4hVVRTHf75GxJEhmxlFHEFHApEmicgnGppI
iJWSOlghGvghS8QQRpRQVOjlo4JUUkILH6SJiUJJfagsUjH9oCgOpuAjx5Ss
NEdzpg/toZA7M2fte869Z+2zPmyQ8c7Ze/33b+7Za+2916K5uRlr/zWgGpgO
zANWAB8Ce4AfgLPAn66ddT/b4z6zwv3OdKDatMyhrcFFJVALbAR+Bppjaj+7
Z9YClQZbBmEDOgDjgVXAcaApRsBaa02ur1Wu7w4GW9iQdQdeBk4XAK722mk3
lu4GW1iQVQFvAtdTANn97bobW5XBphuyx4HtwN0UQnZ/u+vG+rjBpguyB4CP
FADWWvsIeMBgSz9ozwCXFIPW0i4Bzxhs6YSswr2GmgNr24EKgy09oNUCVwME
raVdBWoNtuLHy9YVaMJvAPVux+Bz135wP7tRoDGs0x6f0wpaR2BTgsHXd4HJ
LmxSEmE8Je6zk93vJhUs3gR0NNgKB1on4OMYJ/B3YD3wLNAzxnH2dM9c7/qI
a7wfA50MtuRB6xyjI3ASmAv0KMC4e7i+TsboOHQ22JKbsC7Azhgm6jNgbBHt
GOvGkK8dO4EuBlsyk7Qjz8k5DoxKkT2j3JjysWmHwRb/xDyfpyc5P43rHLf+
nJ+nR/u8wRbfhPQCrvn+5QO9FdjYO49v7mtAL4MtnonY5TkJSxV62ks9bd1l
sOUv/jQP4f8G5igOVs9xNkjtnmaw+YteDjQIBb8FPB3AFtzTzhaJ7Q1AucHm
J7g0ntaYJm8zJm+1URp/M9jkQg/2eI0sDPBs3kIPHQYbbDKR3xYK/LXmPcN2
9oC/FmrxtsEmiz1dFp7j71ugsb0AHAJuAueAw8A+4D3guSRCEEBf4f2Jy2nd
O00jbBPT6IUBD0cczyngnTgvsXh45RMNtmjCfioQ9asCjustj0ssW4CamPr/
StD3pwZbtGM5jWmMLQGT8thSWh/lXFyM326NcR6XChW2uQJBrxTy1INbrO8C
7nkC910+W2fu1MsVQX9zDba2BZV4Xm8UaYwDXJR/ObDZjTnqja4LwGN59P2G
xEM32NoW85zg+HZ1isbdwQVhP4hw+eYy8GAeGZaiHjc/Z7C1/ZqKenv925Sf
Jn4K+DGJc2jAtwIHpaPBllvEPoJXxAYlt79mA3+1YsN0z+duEOjUx2DLLeIw
gYiLFO0CPNnKpvpFz+ctEug0zGDLLeJUgYgzlG07LW7Fjr4ez5oh0GmqwZZb
xAUCEUcozA33Rw47Jnk8a4RApwUGW24R12hdi0S0L5fD8HrCa9s1BltuETcL
RCxRCNv7OexY7fGcEoFOmw223CKuFojYWyFsuTbyH/a8HBNVp9UGW24R6wQi
1miD7b4jSoeAFzyfUSPQqc5gyy3ibIGI40JOB9qOTuMEOs022PI/VTErw7DN
Eug0yWDLLeJQSSafDMMmyeA01GBr/fhzVBF/yWLhCrcF9otAp74GW+tinhUI
OSSDsA0R6HPWTn20LaYkbenKDMK2UpIW1WBrW8zJAjF/A8oyBFqZszmqPpMN
tvYFleS5WJIh2JYI852UGWzti3pQIOqvQGkGQCt1tkbV5aDdroom7GvSm0sZ
gG29UJPXDLbof8XSIhpTAgZtikeRjlKDLZl90pYUDFUBglblUbqyLrX2pHiN
Iv12+x7oFhBo3ZxNQXyrpT0/W53HReD92tK1t3Eheb+H/XWptivlHtgVD8G3
qS658++Vxm0edl9Ju2eeduEneKY7WKcYNp/ib/eACam3TYH4yzxzayxXCNpy
T1uXqbBPyWvlgOckzFME2jxPGw9oWTZomYgKl5TFJ039Ewrse8IzHf0FTZWW
Nb1iRnpkz26pt16ZYrsqPevaNwIjVS0TlK1pZnq+ar5M46vGLRG+9LRppro1
aYYW0YsVpWUIzvnRClsHYKvn+m10iuwY7blO26r1SLzWWFRXlzZUOlEX07Cg
dg7PRc9UqV3VxhAVBz/LgXqNBWE9yz3Wp702VbCwuUl7yLMW6agijnmUZ03R
h9Tv+QawaT3GIyRypBjrHrfePOIR4hgTxEmWQI7jLNMQOvAM3SwLYY5Cgq0r
cNrDWehewDF293AKTmt2CIKEzU3m2DTHqzzjg2ODOnkc2DHqLR6VlysKFOqQ
VkbeEtwx98Bgq/DwTucXYFzzPbzPCoMt/cC9JJzYYwUY0zHhmF4K8qZYoJl+
vhFO7iMJjucR4Vi+CTVDU6h3LQcBd9KQVVuYBf0OMCjYO7ABX+79RDDJDUnc
ynK3pBoE4/gk6Jv9AcM2vNilrj1KkA832PQCd1Qw0SsS6H+FoP+jwecsCRw2
iWe6L4H+92XdA80SbN2Am1G3rxLoP+r21M2QUkdkEjY34ZJDlpUx9lspORQZ
+jxkBba1gkmfEGO/EwT9rjXYwoDtRUlhMaA2piYp/PaiwRYGbDWeN5gK2WoM
Nv2gDfTYlyxGOwYMNNj0glbtkbWxmO06UG2w6QOtBDiuCLSWdlxj4d6swzZV
IWgtbarBpgu2vYph22uw6YKtXjFs9QabLthuKYbtlsGmC7ZTimE7ZbDpgm27
Yti2G2y6YHtFMWyvGGy6YOsCnFAI2okQioZkcQdhBNCkCLQmYITtIBhsBpvB
Zq9Rg80cBHMQLPRhoQ+DzYK6FtS17SrbrjLY2oftjGLYzhhsumDbrRi23Qab
LtimKIZtisGmL852RCFoRyzOphO4/sBVRaBdBfrbDoJe4AYo2Uk4AQywq3z6
gXtVAWyv2iXlMGA7qQC2kwZbGOs2LWu2/gabbtjGK4JtvMGmG7YximAbY7Dp
hq1MyQHKJqDMYLMLy3Yx2WBLJPNksZplngwEtq7A4RSDdjikmqKZhs0B109Y
aaVQrQHol4U5yAxsDrhyYBVwOwWQ3XZjKc+K/pmC7X/QVQFLgR3AT4I6Cfm0
m66vHa7vqqzpnknYcsBXCpxPELTzQGnWdTbY/gNuYoKwTTSNDbb7gduWAGjb
TFuDrTUH4miMoB3NmgNgsMmA6wF8EQNoXwA9TFODrT3gOgMb8wBtI9DZtDTY
JNA96kIV9yIAds999lHTzmDLB7qBLja2FTjkKrFcd//e6v5voGnVfvtnAC9c
0Cv54m27AAAAAElFTkSuQmCC
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 17298, :content_type image/png, :filename bulb12323.png, :id #uuid "8debe2ef-4a7e-58a1-bf4c-1622dead4579", :metadata {:XMP-tiff:ResolutionUnit inches, :PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 1034, :XMP-exif:ExifImageHeight 128, :XMP-xmpMM:HistoryInstanceID [xmp.iid:d9d91f94-2644-4852-800a-2e0690e7ec33 xmp.iid:313384c6-3c39-4368-8199-59bad3780d4d], :XMP-xmpMM:DocumentID adobe:docid:photoshop:1a57f5cc-8a58-1179-8ef5-891dc2bd10cf, :XMP-xmpMM:InstanceID xmp.iid:313384c6-3c39-4368-8199-59bad3780d4d, :PNG:GreenX 0.21, :ExifTool:ExifToolVersion 10.4, :XMP-exif:ColorSpace Uncalibrated, :XMP-xmp:CreateDate 2016:07:14 15:45:41+02:00, :Composite:Megapixels 0.02, :XMP-tiff:Orientation Horizontal (normal), :PNG:WhitePointY 0.32899, :XMP-x:XMPToolkit Adobe XMP Core 5.6-c111 79.158325, 2015/09/10-01:10:20        , :System:Directory /tmp/tmp.qSpfBizLgM, :XMP-tiff:XResolution 26.2636, :XMP-photoshop:ColorMode RGB, :XMP-exif:ExifImageWidth 155, :XMP-xmpMM:HistoryAction [created saved], :System:FileSize 17 kB, :PNG:ImageHeight 128, :XMP-xmpMM:HistoryWhen [2016:07:14 15:45:41+02:00 2016:07:14 15:49:02+02:00], :File:FileTypeExtension png, :XMP-xmp:MetadataDate 2016:07:14 15:49:02+02:00, :XMP-xmp:CreatorTool Adobe Photoshop CC 2015 (Macintosh), :File:FileType PNG, :PNG:BitDepth 8, :XMP-xmpMM:HistorySoftwareAgent [Adobe Photoshop CC 2015 (Macintosh) Adobe Photoshop CC 2015 (Macintosh)], :Composite:ImageSize 155x128, :XMP-xmp:ModifyDate 2016:07:14 15:49:02+02:00, :PNG:ColorType RGB with Alpha, :PNG:WhitePointX 0.31269, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 155, :File:MIMEType image/png, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :PNG:BlueY 0.05999, :XMP-xmpMM:HistoryChanged /, :SourceFile /tmp/tmp.qSpfBizLgM/bulb12323.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG:RedX 0.63999, :PNG:GreenY 0.71, :PNG:BlueX 0.14999, :PNG:RedY 0.33, :PNG-pHYs:PixelsPerUnitX 1034, :System:FileName bulb12323.png, :XMP-tiff:YResolution 26.2636, :PNG-pHYs:PixelUnits meters, :XMP-xmpMM:OriginalDocumentID xmp.did:d9d91f94-2644-4852-800a-2e0690e7ec33, :PNG:Filter Adaptive, :XMP-dc:Format image/png}}
2023-12-11T15:36:17.877Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "dda588f4-660c-573c-a2ff-944ae93ad42e"]
>debug 4
>debug 5 {:id #uuid "2b07eb8a-4174-5257-83eb-920d536cc44a", :name Betriebseinrichtungen und Fahrzeuge}
>debug 5a id #uuid "2b07eb8a-4174-5257-83eb-920d536cc44a"
2023-12-11T15:36:17.878Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "2b07eb8a-4174-5257-83eb-920d536cc44a"]
>debug 5b {:main_category_id #uuid "2b07eb8a-4174-5257-83eb-920d536cc44a", :content iVBORw0KGgoAAAANSUhEUgAAAGwAAACACAYAAADu4Iw0AAAABHNCSVQICAgI
fAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAABE1JREFUeJzt3U+PFEUcxvHv
7AoriPEkckFI1JGErBtfAQgniJD4JtCIWRKPxkO/CfTgichJEz0QzoYEr7Ig
ARJOIokHCBDQXcLCjofaCaRpuqu6q7q6ap5P8ktIhqmpp5+dfzs7MyAiIiIi
IiIiIiIiIiIiIiIiIiIikrd9wHlgDZjM+KwB54BxpyMa0D7gPvEP1NDmHjCe
73BgQzkDLMbexABtA/aMYu+iwhrweuxNDNTqEAubxN7AkM3F3oC4UWGJUWGJ
UWGJUWGJUWGJUWGJUWGJUWGJUWGJUWGJCVXYCPgE+AG4Caxj/zKC9OwgcIn4
rx/lOl59M4BAuY83xQDCzMJ4UQwgyKxMZ8UAQszSdFIMIMCsTWvFADY/i9NK
4XABF4E9DmvHPiBDH2eFw+IXgTcd1499QIY+TgqHhduURaCQOY21wmHRtmUR
KGROY6VwWLBLWQQKmdM0KhwW61oWgULmNLUKh4V8lEWgkDnNK33rsIivsggY
NJepdNhhAZ9lETBoLvOSeeCq5Zl9l0XAoLnMS45ZnjFEWXgOl91U/YnAZxYH
9XfgCPDI4v+KR1WFfdRwHpUVUdUb+v4BdtWcZy/wV5DdGJW302KUCxsBT4DX
HM7jmwqrUb5J3EZ9WRJZuRybsnQNiKh8DXsWZRdirVzY0yi7EGsqLDFVj/h0
HzVgevdKYlRYYlRYYlRYYlRYYlRYYlRYYlRYYlRYYlRYYlRYYlRYYlRYYlRY
YlRYYlRYYlRYYlRYYlRYYqaFvfh9Xb5dAk4A7wNbgQXgA+Bz4HKAy+tb7/lC
fV/XE+Ak9dfiOWAZtw/AHMrEysf5QGGO1AQpO+o5VB9lxcoX5GsLTzqEmVoO
sI9QEzOf95/sP2j3YGYOuOJ5LyEmZr7Hc8BKiwuv8z2w0eJ8G8B3nvcSQsx8
KwCHgP/w9xP4XocNjT3uI9TEyvcvcODFhX4FbtP9JnJLh0ALHS+7j+kz3zqm
k18wTxsqjYDtmC8Orfrb+42GC9kaMFAfb4eKnW+EOfbbqTj+VXeeE2AVeLz5
77KHDZt6127vlfY2nP6gw9q2YuebYI79KhXHv82jnVsNpx9qsebU4YbT/+6w
tq3s8p2l/mq9QrsfBJtP4Pmx495tDDpfmwu+0HD6EvBVi3VPAfsb/s9vLdZ1
lV2+dzDv1Gx6dHPUYc1PLdd820uCelnm+7nhwqcbWKb+WjwPfE1zmAnwU4Ac
r5JdviWaH/5O5wrwBea53sLmfAh8if2nxj0DFkMGKsky32nLzfiY06HDVMgu
3w7geg9hrgFv9BGoJMt8Y+BuwDB3MK/expJlvo8JE+rO5tqxZZlvDNxo2KDr
zUTMa1ZZlvl28Py1orZBNjB3wDHus5pkm28J8zzG5rnHdNYxz0P6fOjeVtR8
IT+scidwHPOts4vAbuCtzdMeYH7R+Sfm1zHnMLfpKck9n4iIiIiIiIiIiIiI
iEjv/gec0agwRiP7+AAAAABJRU5ErkJggg==
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 1195, :content_type image/png, :filename fahrzeuge.png, :id #uuid "3d6cbe63-c327-5c6b-b7fa-48e6c52f2cdc", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:01+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.014, :System:Directory /tmp/tmp.qSpfBizLgM, :System:FileSize 1195 bytes, :PNG:ImageHeight 128, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 108x128, :PNG:ColorType RGB with Alpha, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 108, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:01+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/fahrzeuge.png, :System:FileAccessDate 2018:11:14 17:31:01+00:00, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName fahrzeuge.png, :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-11T15:36:17.879Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "2b07eb8a-4174-5257-83eb-920d536cc44a"]
>debug 4
>debug 5 {:id #uuid "f6827594-33a6-5760-ac41-f94ceefacfab", :name Bühnentechnik}
>debug 5a id #uuid "f6827594-33a6-5760-ac41-f94ceefacfab"
2023-12-11T15:36:17.880Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "f6827594-33a6-5760-ac41-f94ceefacfab"]
>debug 5b {:main_category_id #uuid "f6827594-33a6-5760-ac41-f94ceefacfab", :content iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAA3NCSVQICAjb
4U/gAAAACXBIWXMAAAG7AAABuwE67OPiAAAAGXRFWHRTb2Z0d2FyZQB3d3cu
aW5rc2NhcGUub3Jnm+48GgAAAM9QTFRF////AAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAA+q0M9gAAAER0Uk5TAAQGBwgJCwwQFBUbISIvMDIzNDU3ODtBREpP
UlNVVldpcXN7gIqTl6Chpqytv8PExsrS1uDj5Obo6evs7fLz9ff4/P3Djn9u
AAABnElEQVRYw+3XxXbDMBQE0AkzM3McZuY4/v9v6sKFKLEUPWXV085acxe2
9WQhNjR4mRcBACjOuUuGMfD7hnFwAYDrIFgyhCFKEgCSwiViIAUAqX/glwNx
AIi/AQQBIPgG4AEAjzpwMTfTRRlYmMBCGRiYwEAZqJlATRlImEBCFTjaTMB2
VAQ0fEZTBMJfQFgNmOA7EyWg/AOUVYAR7jKiA7fIPRC5kQENTDQqMHOzgHtG
Aw4hPCR0oAB6Fk/J6vLAtQCLFK6ywDEDy2SOcsAyCk6iSxmg6wU33u5LYJOH
MPmNEFjX3XgRd33NB5oOSMTR5AK7igxQ2QmeQd//qu7vix/iriTul3YvX2NL
1G/JfEhVfr8q9SXqOV4/p8vthVPEuh85ye7GVcCqH1jJz4OeFdCjDJTgcz+o
U0Za+xlok2bi2ffY951pU7n5CDSJY33vZPvOPfVgeZhrUfLJVGaBMhlosECD
DHRYoEMGxiwwJgNbFtjSfzDs9327wh8K8yE4/ybAnFIOPsC7fE/Z1zjlXr45
1/9JmgXSE871/wOnFjUuRak9PwAAAABJRU5ErkJggg==
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 841, :content_type image/png, :filename curtain-2.png, :id #uuid "9a8cba78-10ab-585b-a4c2-9d8e7f0818ee", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 443, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.004, :System:Directory /tmp/tmp.qSpfBizLgM, :PNG:Palette (Binary data 207 bytes, use -b option to extract), :System:FileSize 841 bytes, :PNG:ImageHeight 64, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 64x64, :PNG:ColorType Palette, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 64, :PNG:Software www.inkscape.org, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/curtain-2.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitX 443, :System:FileName curtain-2.png, :PNG:Transparency (Binary data 68 bytes, use -b option to extract), :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-11T15:36:17.880Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "f6827594-33a6-5760-ac41-f94ceefacfab"]
>debug 4
>debug 5 {:id #uuid "517b82ae-2b7e-4822-9aeb-0d4753dec821", :name Darlehen}
>debug 5a id #uuid "517b82ae-2b7e-4822-9aeb-0d4753dec821"
2023-12-11T15:36:17.881Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "517b82ae-2b7e-4822-9aeb-0d4753dec821"]
>debug 5b nil
2023-12-11T15:36:17.882Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "517b82ae-2b7e-4822-9aeb-0d4753dec821"]
>debug 4
>debug 5 {:id #uuid "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da", :name Fotografie}
>debug 5a id #uuid "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da"
2023-12-11T15:36:17.882Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da"]
>debug 5b {:main_category_id #uuid "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da", :content iVBORw0KGgoAAAANSUhEUgAAAGAAAACACAYAAAD03Gy6AAAABHNCSVQICAgI
fAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAABvdJREFUeJztnWuIVVUUx3/3
OpPaQ6d8ZKI9TM0sKyGnB72ozNKIisjqY0RQQVBQH0PqS4UZmSFB+EkqKMqi
l2JPCCwRGaWyzDzO5GPyEfmYcXzM9GHNhUHHe/a6d92zz51ZP9gg45q9197/
c+7es/ba+4LjOI7jOI7jOI7jOI7jOI7jOAOdQsr/jwbmA7OBK4DxwNBaO1Xn
HAV2Ai3AKuB9YI+2kpHAIqAT6PFSVTkMvN47pkFcA7TmwPGBVlqB5rTBnwN0
5MDZgVo6e8e4X67FP3KyEmFWadBLk3ATsBGYcCp1HFNagRnA/iG9P3gFWek4
2TASOA1YVQDGAG348jJrDgMTisBD+ODHYBgwvwjcEduTQczsAjIhTIztSY5o
B9YDXYrfGYGsIocr20oAjhB/aZaHchx4BmhQDmKJc4Dlyja7yEHH81KeVg/5
yRSBFZp2C73/GOy0ApOQt6BaLgE2hRoXDRocCKzBZvABfkcR/XQBhE7j+g6F
GroAkXEBIuMCRMYFiIwLEBkXIDIuQGRcgMi4AJFxAYQh6SYqgiOqLoAw1bCu
kcB5ocYugNBMQNJUIE+iHNfYcfi8lFZgmmbg+uF+lBtc9bQfkADfAeuAzcAu
4CDi/xnAWOBi4CrgZmB6BW10Ae8CPyNZCyEUkLyqOZTJeitH7CevXDkAvAnM
JD2T+0QmAy8ie7yx+1GuRHegv3IUWAiMUg56f5wOPAfsz0G/6kKADchZBGsm
IPn6sfuXawHeQ57YWlEEXspBP3MpwGKyWxY/nlGf6kaAt9BPstXyhJHvdS/A
F9iHAkJZGOjjgBVgBzYrnUppBH7qx69BI8B9VQ9h9VwGHGMQCvAD2X/un4ql
RBoHTSiiDfgmxaYZuDSwvrnAl4G2teZCYAthq7B24KsUmweQ8EgQoWqtCKjr
x8C6EvIXif2CMN//JX3RkATW1WM5CGciZ4xD+AjoNmzbgg8D7ZqQ2JQJlgJc
Tfhy8mvDdq1YrbANfdBSsRTgcoXtOsN2rWgDdgfamsWqLAWYHGh3EJnI8kYP
8GegbWhfU7EUYHygXSk+n0d2BdqF9jUVSwFCbwPpMGzTmtC8/iarBi0FCD1r
nLflZ19CFxHDrBq0HIzQIz7B9+ZEINQ3syW0pQChm9jjqPwoaK0JPS8dfAQp
DUsB9gXaNWCbCGVFI+F+7bVq1FKA7Qrb6wzbtWIm4fOYpq9lsRTgL4XtXYbt
WjFXYfuHVaOWAmxU2M4DzjZsu1oKwCMK+xarhi0FWI/k84QwDHjMsO1quROY
orBfY9m4ZTj6e0V9/yC3jMSmCKwl3O/tpG8kJaH1Wf9R9LnCdgySOhibR5FI
biifYhxKsXwDLlLU14P8QXObXVfUTAL+68evcuWmgHoTRX2mAoDE+jUd2o0I
lzVnIZOpxtfNhM2bSWidtYjLLFbajwZWojhVYsBw5IHSxvUXU4OdPOs3oIgs
STVPVunpyuJNaAK+rcC/XYTnrSaKes0FALi7gg72ICujWxXtaJkO/Fahb08p
2kkU9dZEgALwWYUd7QZeQzb5rWgAnqXyq5k3oAsgJoq6ayIASGRRu8LoW3Yg
B960NxH2pQH5/oNfq/DjOPoDfImi/poJAPCgov5Tlb1I9vTthInRiAT7Xsbm
Gv4FFfQ7Ca1fkxn3CXBvBc4sQq6DtOAo8AsyYe9EzpD1IB9X5yKH9GZQ3VvT
l9VImEJ7n1wCXBBqXMs3AORjQHWVY07KJuQu0EpIQtvJYn/2GPAw6XmleaIN
udI5dJOpYrLaIO8E7kEOyeWdrcAtyPxRc7LMUDiEiLA8wza1rAWuR7e5VDW1
ngNOpAA8j0xssT/n+5Z3sJu8E0W7mQtQ4gbkSYs98HuQ5bIliaL9aAKALB8X
IsvLrAe+G1iGBAOtSRR+RBWgxFTkG+e6Ff5UUz4GrqxhfxKFL7kQoMQU4A1k
+Wc96PuAJYQfoaqGROFXrgQoMRTJnHgbSRmvdNC39NYxD/nWoqxIQn3Ma4pg
F7K/XNpjHovcAzQN+RN/HBLXH4ospQ8jgb92pPObkCyNPJ5DOIk8vgH1TkLg
uOY5VXxQ4AJERiNAlpNYvaM6wBE6B7Qjmx1OeSahW6mpjBdk1o36pAHlXngB
uedS82QvQ7YIE/J32j0Wjchf1i8ANyp+70gB2AacXwuvnFS2FjHMdXfUtBSp
j12qgcrKAhKO/Rv/TuGs6QQmFpENiaWRnRmMLAH2lk56jEQSav17hbNhG5K/
dKDvD5upPHfSS3jpoMyJnDkuQs0HP/Ur5Gchr0hsZwdaSVCcRRuBbJb721B9
6QBeRY5EnUTacctRSHr3bGRHajweFU3jCHKUtQU5evUBhndLOI7jOI7jOI7j
OI7jOI7jOI5Tf/wPcYhVe1hRfeIAAAAASUVORK5CYII=
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 1877, :content_type image/png, :filename fotografie.png, :id #uuid "07a33b4c-d274-54e5-a2ce-11f26d57be05", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.012, :System:Directory /tmp/tmp.qSpfBizLgM, :System:FileSize 1877 bytes, :PNG:ImageHeight 128, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 96x128, :PNG:ColorType RGB with Alpha, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 96, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/fotografie.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName fotografie.png, :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-11T15:36:17.883Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da"]
>debug 4
>debug 5 {:id #uuid "2ea39047-e663-50d5-9080-838b75883704", :name IT & Elektronik}
>debug 5a id #uuid "2ea39047-e663-50d5-9080-838b75883704"
2023-12-11T15:36:17.884Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "2ea39047-e663-50d5-9080-838b75883704"]
>debug 5b {:main_category_id #uuid "2ea39047-e663-50d5-9080-838b75883704", :content iVBORw0KGgoAAAANSUhEUgAAAHgAAACACAYAAADApa2mAAAABHNCSVQICAgI
fAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAr5JREFUeJzt3b9qU2Ech/En
0UVbFAernQRHQZy8AtFNdJQWCgq6633oUCzeRi3qoHgBDiIugosglNY6Vq1L
/zicgC2kiel5k5N8fT7wLm15c/g9bU/+kQOSJEmSJEmSJEmSJEmSJEmSpG6m
gQfAK2AN2AH2XAfWTmc2L4H7wNSRJj1iLWAB+E7zA5y0tQHMDz7y0WkDz2h+
UJO+ljqzHCstjFtyPR1s/MO3QPNDSVtzAxU4RKvAHtPAF+Bsgb301wZwEdiq
s0mJ//VzGHcYzgF36m5SIvDtAnuou7GY7Rq9zyXL+BfezQywQu/ZrTZ2dPv0
exLDuIc7T+/Zbde9gRJ3svZGcBvJhjq/sXtArbIMHM7A4QwczsDhDBzOwOEM
HM7A4QwczsDhDBzOwOEMHM7A4QwczsDhDBzOwOEMHM7A4QwczsDhDBzOwOEM
HM7A4QwczsDhDBzOwOEMHM7A4QwczsDhDBzOwOEMHM7A4QwczsDhDBzOwOFK
BN7t8/2ZAreRarbP93dGchR99Ps44RWqT1XVQbPAC4b8ccLH624AfKD3b+JN
YL3A7fyP3tfdoMS/6OUCe6i72rMt8VnOU1QX5fBcW9Y3qoty/K6zSYm/4F/A
owL76KCH1Ixb2hLNX2soZS0OOPuRaFNdsavp4Uz6WmTMn5+Yozp/ND2oSVvr
FLhO0qicBO5RPQZepbp6SNMDHLe13ZnNc+AucOJIk5YkSWOpRXXCV6ixfryl
+gwczsDhkgNforqP8S/rckPHOHTJgY8N6WcnSgvYwqfJUm21gbdNH4WG5nWL
6lz1Dphu+GBU1g/gahv4BNzAN8YlWQOuA5/3f/EM8ITqLThNv5TmOtr6CTzu
tAS6v+nuNHALuAZcAS4Ap8i+xz2JdoFN4CvwEXhD9fr7ZpMHJUmSJEmSJEmS
JEmSJEmSJEml/QGym5SaY0sX5gAAAABJRU5ErkJggg==
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 796, :content_type image/png, :filename laptop.png, :id #uuid "1464e46c-e726-54a9-a42b-f937a0342d22", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:01+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.015, :System:Directory /tmp/tmp.qSpfBizLgM, :System:FileSize 796 bytes, :PNG:ImageHeight 128, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 120x128, :PNG:ColorType RGB with Alpha, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 120, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:01+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/laptop.png, :System:FileAccessDate 2018:11:14 17:31:01+00:00, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName laptop.png, :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-11T15:36:17.885Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "2ea39047-e663-50d5-9080-838b75883704"]
>debug 4
>debug 5 {:id #uuid "f6885671-3bf3-56f2-8e92-b5112d0f703f", :name Musikinstrumente}
>debug 5a id #uuid "f6885671-3bf3-56f2-8e92-b5112d0f703f"
2023-12-11T15:36:17.886Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "f6885671-3bf3-56f2-8e92-b5112d0f703f"]
>debug 5b {:main_category_id #uuid "f6885671-3bf3-56f2-8e92-b5112d0f703f", :content iVBORw0KGgoAAAANSUhEUgAAAI4AAACACAYAAADd91F4AAAACXBIWXMAAAsT
AAALEwEAmpwYAAA59GlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFj
a2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQi
Pz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0
az0iQWRvYmUgWE1QIENvcmUgNS42LWMxMTEgNzkuMTU4MzI1LCAyMDE1LzA5
LzEwLTAxOjEwOjIwICAgICAgICAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9
Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMi
PgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAg
ICAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8i
CiAgICAgICAgICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxl
bWVudHMvMS4xLyIKICAgICAgICAgICAgeG1sbnM6cGhvdG9zaG9wPSJodHRw
Oi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIgogICAgICAgICAgICB4
bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIK
ICAgICAgICAgICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20v
eGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgICAgICAgICAgeG1s
bnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAg
ICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8x
LjAvIj4KICAgICAgICAgPHhtcDpDcmVhdG9yVG9vbD5BZG9iZSBQaG90b3No
b3AgQ0MgMjAxNSAoTWFjaW50b3NoKTwveG1wOkNyZWF0b3JUb29sPgogICAg
ICAgICA8eG1wOkNyZWF0ZURhdGU+MjAxNi0wNy0xNFQxNTo0NjoxMSswMjow
MDwveG1wOkNyZWF0ZURhdGU+CiAgICAgICAgIDx4bXA6TW9kaWZ5RGF0ZT4y
MDE2LTA3LTE0VDE1OjQ5OjI4KzAyOjAwPC94bXA6TW9kaWZ5RGF0ZT4KICAg
ICAgICAgPHhtcDpNZXRhZGF0YURhdGU+MjAxNi0wNy0xNFQxNTo0OToyOCsw
MjowMDwveG1wOk1ldGFkYXRhRGF0ZT4KICAgICAgICAgPGRjOmZvcm1hdD5p
bWFnZS9wbmc8L2RjOmZvcm1hdD4KICAgICAgICAgPHBob3Rvc2hvcDpDb2xv
ck1vZGU+MzwvcGhvdG9zaG9wOkNvbG9yTW9kZT4KICAgICAgICAgPHhtcE1N
Okluc3RhbmNlSUQ+eG1wLmlpZDo2YzA4N2NiZS0xZjhlLTQ4YmUtYTU1YS00
ZmRmYzVkOTI2OWE8L3htcE1NOkluc3RhbmNlSUQ+CiAgICAgICAgIDx4bXBN
TTpEb2N1bWVudElEPmFkb2JlOmRvY2lkOnBob3Rvc2hvcDoyZTNiY2U2NC04
YTU4LTExNzktOGVmNS04OTFkYzJiZDEwY2Y8L3htcE1NOkRvY3VtZW50SUQ+
CiAgICAgICAgIDx4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ+eG1wLmRpZDo1
MzMwNmRlYi01NjAzLTQyZTEtOTBiMy04Nzc0MmQ2ODdhMDc8L3htcE1NOk9y
aWdpbmFsRG9jdW1lbnRJRD4KICAgICAgICAgPHhtcE1NOkhpc3Rvcnk+CiAg
ICAgICAgICAgIDxyZGY6U2VxPgogICAgICAgICAgICAgICA8cmRmOmxpIHJk
ZjpwYXJzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgICAgICAgPHN0
RXZ0OmFjdGlvbj5jcmVhdGVkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAg
ICAgICAgIDxzdEV2dDppbnN0YW5jZUlEPnhtcC5paWQ6NTMzMDZkZWItNTYw
My00MmUxLTkwYjMtODc3NDJkNjg3YTA3PC9zdEV2dDppbnN0YW5jZUlEPgog
ICAgICAgICAgICAgICAgICA8c3RFdnQ6d2hlbj4yMDE2LTA3LTE0VDE1OjQ2
OjExKzAyOjAwPC9zdEV2dDp3aGVuPgogICAgICAgICAgICAgICAgICA8c3RF
dnQ6c29mdHdhcmVBZ2VudD5BZG9iZSBQaG90b3Nob3AgQ0MgMjAxNSAoTWFj
aW50b3NoKTwvc3RFdnQ6c29mdHdhcmVBZ2VudD4KICAgICAgICAgICAgICAg
PC9yZGY6bGk+CiAgICAgICAgICAgICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlw
ZT0iUmVzb3VyY2UiPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6YWN0aW9u
PnNhdmVkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAgICAgICAgIDxzdEV2
dDppbnN0YW5jZUlEPnhtcC5paWQ6NmMwODdjYmUtMWY4ZS00OGJlLWE1NWEt
NGZkZmM1ZDkyNjlhPC9zdEV2dDppbnN0YW5jZUlEPgogICAgICAgICAgICAg
ICAgICA8c3RFdnQ6d2hlbj4yMDE2LTA3LTE0VDE1OjQ5OjI4KzAyOjAwPC9z
dEV2dDp3aGVuPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6c29mdHdhcmVB
Z2VudD5BZG9iZSBQaG90b3Nob3AgQ0MgMjAxNSAoTWFjaW50b3NoKTwvc3RF
dnQ6c29mdHdhcmVBZ2VudD4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OmNo
YW5nZWQ+Lzwvc3RFdnQ6Y2hhbmdlZD4KICAgICAgICAgICAgICAgPC9yZGY6
bGk+CiAgICAgICAgICAgIDwvcmRmOlNlcT4KICAgICAgICAgPC94bXBNTTpI
aXN0b3J5PgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9y
aWVudGF0aW9uPgogICAgICAgICA8dGlmZjpYUmVzb2x1dGlvbj43MjAwMDAv
MTAwMDA8L3RpZmY6WFJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOllSZXNv
bHV0aW9uPjcyMDAwMC8xMDAwMDwvdGlmZjpZUmVzb2x1dGlvbj4KICAgICAg
ICAgPHRpZmY6UmVzb2x1dGlvblVuaXQ+MjwvdGlmZjpSZXNvbHV0aW9uVW5p
dD4KICAgICAgICAgPGV4aWY6Q29sb3JTcGFjZT42NTUzNTwvZXhpZjpDb2xv
clNwYWNlPgogICAgICAgICA8ZXhpZjpQaXhlbFhEaW1lbnNpb24+MTQyPC9l
eGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGlt
ZW5zaW9uPjEyODwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgIDwvcmRm
OkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAo8P3hwYWNrZXQgZW5kPSJ3
Ij8+x0kGyQAAACBjSFJNAAB6JQAAgIMAAPn/AACA6AAAUggAARVYAAA6lwAA
F2/XWh+QAAAERklEQVR42uzdy4tOcRzH8ffIfUoYK7nGnlIuJZRSYutW4h+Q
+4KVUoSlUiSXWSgSFsrGJSJ2bpH7NSk7uYWZ8Vich9Bg5jyX8z3nvL/1qWma
xfk9vZrzPef5nt+hUqlgTG/jh2CEY4RjhGOEY4xwjHCMcIxwjHCMEY6JBMdq
SPUBpgHbgdtAJ9BR/Xkz0PrjD4VjDQQWAPuA10DlH7kHjBNOeasNWAGcAD78
B0t3eAYLpzw1AVgPXAK6eonlz2wSTjn6lbs1QvkzN4VT3n6llnwRTrn7ldQR
jv2KcOxXhCOc5vUrwrFfEU6Z4GTerwjHfkU4BYMTul8Rjv2KcHIKJ5f9inCy
Ow1tBO4UGYpw6lsjSYacKmWLcNLXAOB6GdEIp7ZaV1Y0wqmtbghHOGnqq3CE
k6YqwhGOcIQjHOEIRzjCEY5whCMc4QhHOMIRjnCEIxzhlAbOV+EIp6d5CxwB
FgNDhCOcf+UFsBuYC/TrzfqEUz4414EtwGSgJe36hFN8OB3AWWAVMKZe6xNO
MeG8A44Cy4ChjVifcIoD5xWwB5gH9G/0+oSTbzi3gK3AlP/0K8IpOZxO4AKw
Bhif5fqEEx/Oe+A4sBwYHmV9wokJ5zWwF5hP8qRouPUJJw6cO8A2YCrJViih
1yec7OB0kWxOsB6YSLwSTiA4H4GTwEpgBLFLOBnDeQPsBxYCg8hPCScjODuA
GUH6FeHkCE7eSzjCEY5whCMc4QhHOMIRjnCEIxzhCEc4whGOcIQjHOEIRzjC
EY5whCMc4QhHOMIpM5xWYA7Ju7PagavAS+DTL8f0mWQi8TZwGtgFLKX7Z8qF
U2A4Y4ENJEPvtb5b4gGwE5gknGLC6U+ymcBFGvdc1zXhFAdOC8nTnC/APQCF
07MaAZwBN48UTu/6mMcE21ZFOLHhtAGPCLh5k3BiwzlJ0F2/hBMXziwCbxcn
nLhw2oUjnDT1TDjCSVNdwhFOmuoMDKdDOJ6q0uSxcOLCORwYzgHhxIUzMzCc
6WWC09R5lTrhPBEQzTGAosPJbF6ljl85PAyE5gHVvZaLCCfEvEodT4ljguC5
D4z++e+2QHBCzavUuZ9qq546s1rLKWDYb+fpgsAJN6/SoEGupcDTJq7hCbCI
bl4wUgQ4IedVGng11w9YApxv0HF/I3kx2hKg718vKXMOJ+y8SpNuCYwG1gLn
gC81HOvnKpbVwKge3YvIOZyw8yoZ3FcaBMyuXkUeAq4Az0nePvOtmvfV310G
DpK8DmAWKTbuzjOc0PMqFLzyDKddOMJJA+eZcISTBk6XcISTBk7oeRXheKpK
Na8inLhwQs+rCCcunNDzKsKJfQMw7LyKcOJ/5RByXkU48b/kDDmvIpx8jFWE
m1cRTr4GucLMqwgnf6OjIeZVhJPvYfXM5lWEU5zHY5o6ryKcoHBMueKHYIRj
hGOEY4RjjHCMcIxwjHCMcIwRjqlDvg8A5/TdLBe62ugAAAAASUVORK5CYII=
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 16064, :content_type image/png, :filename music3213.png, :id #uuid "3a52eb87-b5fe-5df0-98b1-43e80f28d2dc", :metadata {:XMP-tiff:ResolutionUnit inches, :PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :XMP-exif:ExifImageHeight 128, :XMP-xmpMM:HistoryInstanceID [xmp.iid:53306deb-5603-42e1-90b3-87742d687a07 xmp.iid:6c087cbe-1f8e-48be-a55a-4fdfc5d9269a], :XMP-xmpMM:DocumentID adobe:docid:photoshop:2e3bce64-8a58-1179-8ef5-891dc2bd10cf, :XMP-xmpMM:InstanceID xmp.iid:6c087cbe-1f8e-48be-a55a-4fdfc5d9269a, :PNG:GreenX 0.21, :ExifTool:ExifToolVersion 10.4, :XMP-exif:ColorSpace Uncalibrated, :XMP-xmp:CreateDate 2016:07:14 15:46:11+02:00, :Composite:Megapixels 0.018, :XMP-tiff:Orientation Horizontal (normal), :PNG:WhitePointY 0.32899, :XMP-x:XMPToolkit Adobe XMP Core 5.6-c111 79.158325, 2015/09/10-01:10:20        , :System:Directory /tmp/tmp.qSpfBizLgM, :XMP-tiff:XResolution 72, :XMP-photoshop:ColorMode RGB, :XMP-exif:ExifImageWidth 142, :XMP-xmpMM:HistoryAction [created saved], :System:FileSize 16 kB, :PNG:ImageHeight 128, :XMP-xmpMM:HistoryWhen [2016:07:14 15:46:11+02:00 2016:07:14 15:49:28+02:00], :File:FileTypeExtension png, :XMP-xmp:MetadataDate 2016:07:14 15:49:28+02:00, :XMP-xmp:CreatorTool Adobe Photoshop CC 2015 (Macintosh), :File:FileType PNG, :PNG:BitDepth 8, :XMP-xmpMM:HistorySoftwareAgent [Adobe Photoshop CC 2015 (Macintosh) Adobe Photoshop CC 2015 (Macintosh)], :Composite:ImageSize 142x128, :XMP-xmp:ModifyDate 2016:07:14 15:49:28+02:00, :PNG:ColorType RGB with Alpha, :PNG:WhitePointX 0.31269, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 142, :File:MIMEType image/png, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :PNG:BlueY 0.05999, :XMP-xmpMM:HistoryChanged /, :SourceFile /tmp/tmp.qSpfBizLgM/music3213.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG:RedX 0.63999, :PNG:GreenY 0.71, :PNG:BlueX 0.14999, :PNG:RedY 0.33, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName music3213.png, :XMP-tiff:YResolution 72, :PNG-pHYs:PixelUnits meters, :XMP-xmpMM:OriginalDocumentID xmp.did:53306deb-5603-42e1-90b3-87742d687a07, :PNG:Filter Adaptive, :XMP-dc:Format image/png}}
2023-12-11T15:36:17.888Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "f6885671-3bf3-56f2-8e92-b5112d0f703f"]
>debug 4
>debug 5 {:id #uuid "6c8a0d77-6711-5156-a59a-12425ba01cff", :name Werkstatt-Technik}
>debug 5a id #uuid "6c8a0d77-6711-5156-a59a-12425ba01cff"
2023-12-11T15:36:17.888Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "6c8a0d77-6711-5156-a59a-12425ba01cff"]
>debug 5b {:main_category_id #uuid "6c8a0d77-6711-5156-a59a-12425ba01cff", :content iVBORw0KGgoAAAANSUhEUgAAAGYAAACACAYAAAD5whz9AAAABHNCSVQICAgI
fAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAABrVJREFUeJztnVmMVEUUhr9p
GpdhlBmGYZ8BFByJGwGNoMYlPiku8UFNiMTlQU2MRk1QYkz0QY1riNEYE8WM
4oY8EaOGoAYVFRRE2TeHYRjAiAuiYByQ8eFQ0vTC9F2qqqvnfMn/AN1dt6r+
O/d2nzp1LiiKoiiKoiiKoiiKoiiKoiiKoig2qfHdgQqiP3AuMBU4GxgPjAIa
gROBDHAA+B3YAWwB1gLLga8O/7+SElngauAdYC/QE1OHgGXAQ8BYpyOoMuqA
B4DtxDfjWPoQuNjZaKqAfsAdwM/YMSRf7wOjnYwsYFqBr3FjSK5+A8Y5GF+Q
zAD24d4Uo1n2hxgWGeA5/BliNM32QEOiP/A2fg3ZA9xpe6AhkQXew58hh4CX
gSbbAw2JGmAO/kz5HJhofZQBMgs/hnQCN6DRlKJcjlxGXBryN/AoUGt/eGHS
gMSwXJryLtDiYnAh4/K+shINuZTFebgxZDdwOxLaUcpgEXYNOQDMRi6XSpnY
/mtZCExwNpoq4nXsGLIFWavRr78xOAnYjx1jrnI4jgIyPg+eAtOQZd+qI3Rj
rvTdAVuEbswlvjtgi5CNaaKKf3WHbMyZvjtgk5CNqeo0oZCNGeG7AzYJ2Zh6
3x2wScjGHOe7AzbJ+u6A8j+DkMSNJuDZkI3p9t2BlKgF7gMeREJMAJNCNib0
7PoaJEfgGaA577UpIRuzy3cHEjAReAG4qMTr+x32JXUuxe46zI/A9aQb9m8A
XqL3hJEVKR7TOU3YNcboS2BKwr5mgFspf5fBnITH804HbszpQTJi4kQbzgKW
RDzWLTGOU1HYWr0spX+Qm3U5P24HAE8BB2McJ/ioxo24NcboF+BuJHG9GNcA
22K2vSzZlFQGdfjd97IRuJYjXxBagAUJ27w/venxSxv+jDFajKTJJj1JuoEh
Kc6NU+ry/j0Z/8akpTeST48fJgCbOBK6MCzE/6Qm1SHgjMQz5IHTgZ+QQdyb
99pk3Gf5p603E8+QB1qREIwZxA4K05Zewd+kJtVfSBWOoGgFdlI4mJl576sH
uoq8LwTdk3SSXHMaxU3pQUqMDM97/2XAvyXeX6laRGALluPpfSPS/CKfm9nL
ZypJnQT29Xgc5V+Wpud9toYw7jd7kDhaMJxKtOI7e5H7UC5ZYF6ENlzrT+CC
hPPklKimGK2nMLCYBd6K0ZZt/Qqcn3CenHIKcs2NO+BPgePz2swATydoM21t
QL7QBMNY4kdjc7WA4mlN05HfCj5NmQcMTDJJrhlDOqYYfUDxPffjgS9SPE65
2o2cGEHtTBuDnVXIpcDQIsfLALdxdBTBlrqB55F8saAYDWzF3sR0AReWOLbJ
5UrzL9VoH/AictIFRwvQjv2z9iDwCKXTafsBVwBzkTy1uMc5AHyC1AA4OcnE
GHxc91qQhSWX2yjWAHchlZFKkQUmcXR532bkUlSLmNgN/IGEidqB1chS8BLk
t0mwNCP5Wrb/UkppAVqyqoBRyN55X6bk6iPgHLvDDYORVI4pPUg12VTuBSEz
EtiMfzOMlhLYDz0bjETW6H2bYbQMNYURSN6VbzOMvqHKtweWw3Aqy5RvUVMY
hkRRfZthtBytM8YwZG3EtxlGK1BTGAqsw78ZRt8RYAAxbYYiTx/ybYbRStQU
hlB5pjRaHXEANCEBQt9mGH2PmkITEl31bYbRD8BgqyMOgMHAKvybYbQKNYXB
yNnp2wyj1ejjQGhEruO+zTBaQ2AppjZoRL7x+DZDTclhEPKDzbcZRmtRUyrO
lHUUT03qUzQg8SbfZhitR+JxfZoGJDLr2wyjDRRuVOpz1CNrGL7NUFNyqEdW
+3ybYbQRNYWByLp4lIl7Fdk4lEHyxh4nvX2Qm6iCgjdJGYhkkESZuMdKtDUj
YjvFtBlJ5ujTDCD6k7s7OXYV2sUR28vVFgLc926DuUSfvN7qnjwco0015TAZ
ZJPmTTE+ayMhvR3Zq99loe3gaCPemb2d0oXUAD6L2F47VfzYkThsJf694IkS
bd4csR01pQhxajbmqg0p55RF9rw8SbSvy1uR3WVKHkmNSaIOAt0S54IO/Jiy
DTXlmLgukWtMqeonJqXBVNya0olUwVDK4DXcmLIdqRejlMkJwMfYNaULNSUW
tSSLb/VmyjhnI6lC6pCnP6Rpyg5kz7ySkDhrMqW0EzUlVRpInhmzk8Bqc4VC
I/Hzk3dRWA5RSZEhRN8ltgupKq5YZjjlJ5F3IfX3FUcMAGYj1YdKmTIfzZBM
jairkMOA65DyUY1IKai1SFWjjel2TVEURVEURVEURVGUxPwHYcurS2vCftQA
AAAASUVORK5CYII=
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 1811, :content_type image/png, :filename werkzeug.png, :id #uuid "f4e1f230-df2e-5e95-bf89-827f7a6b4b3b", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.013, :System:Directory /tmp/tmp.qSpfBizLgM, :System:FileSize 1811 bytes, :PNG:ImageHeight 128, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 102x128, :PNG:ColorType RGB with Alpha, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 102, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/werkzeug.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName werkzeug.png, :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-11T15:36:17.889Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "6c8a0d77-6711-5156-a59a-12425ba01cff"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.892Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.893Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.896Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.896Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.897Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.897Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.898Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.899Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.900Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.900Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.901Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.901Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.901Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.902Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.903Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.903Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.903Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.904Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.904Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.905Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.905Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.906Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.907Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.907Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.908Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.908Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.909Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.909Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.909Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.910Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.910Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.910Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.911Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.911Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.912Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.912Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.912Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.914Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.915Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.915Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.916Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.916Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.917Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.917Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.918Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.918Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.919Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.920Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.920Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.921Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.922Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.922Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.923Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.923Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.923Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.924Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.924Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.924Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.925Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.925Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.926Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.926Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.927Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.927Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.928Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.928Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.928Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.929Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.929Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.929Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.930Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.930Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.931Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.931Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.932Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.932Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.933Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.933Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.933Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.934Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.934Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.935Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.935Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.935Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.936Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.936Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.937Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.937Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.938Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.939Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.939Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.940Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.940Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.941Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.941Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.941Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.942Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.942Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.943Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.943Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.944Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.944Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.945Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.945Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.945Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.945Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.946Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.946Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.946Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.947Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.947Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.948Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.948Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.948Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.949Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.949Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.949Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.950Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.950Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.950Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.951Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.951Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.952Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.952Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.952Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.952Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.953Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.953Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.954Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.954Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.955Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.955Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.956Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.956Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.957Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.957Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.957Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.958Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.958Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.958Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.958Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.959Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.959Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.960Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.960Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.960Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.961Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.961Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.962Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.962Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.963Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.963Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.963Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.963Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.964Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.964Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.964Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.965Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.965Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.965Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.965Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.966Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.967Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.967Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.968Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.969Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.970Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.970Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.970Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.970Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.973Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.973Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.975Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.975Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.976Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.976Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.977Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.978Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.978Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.978Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.978Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.979Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.979Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.980Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.980Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.981Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.981Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.981Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.982Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.982Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.983Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.983Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.983Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.984Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.984Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.984Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.984Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.985Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.985Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.985Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.985Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.986Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.987Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.987Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.987Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.988Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.988Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.988Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.989Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.989Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.990Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.990Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.991Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.991Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.992Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.992Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.993Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.993Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.994Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.994Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.995Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.995Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.995Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.995Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:17.996Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:17.996Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:17.997Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:17.997Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false

>request-grapql _> request {:leihs-user-language {:name Deutsch, :locale de-CH, :default true, :active true}, :authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 90abade9-82d6-4fb6-9898-f7566773263f}, leihs-user-session {:value 3d37de50-dd5a-42c5-bca6-445a84997cf0}}, :remote-addr 127.0.0.1, :start-time 20604640149083, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type application/json, cookie leihs-anti-csrf-token=90abade9-82d6-4fb6-9898-f7566773263f; leihs-user-session=3d37de50-dd5a-42c5-bca6-445a84997cf0, content-length 255, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/admin/categories/f68856713bf356f28e92b5112d0f703f, connection keep-alive, pragma no-cache, x-csrf-token 90abade9-82d6-4fb6-9898-f7566773263f, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x1c7a2657 /127.0.0.1:3230<->/127.0.0.1:65348], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x29d7116a HikariDataSource (db-pool)]}, :content-length 255, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:operationName MainCategoriesIndex, :variables {}, :query query MainCategoriesIndex {
  main_categories {
    id
    name
    image_url
    categories {
      id
      name
      can_delete
      __typename
    }
    __typename
  }
}
}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0x46dd5e9 leihs.procurement.graphql$handler@46dd5e9], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>request-c-grapql _> request (json) {"leihs-user-language":{"name":"Deutsch","locale":"de-CH","default":true,"active":true},"authenticated-entity":{"email":"manuel.radl@zhdk.ch","contracts_count":1,"lastname":"Radl","org_id":"271682","scope_read":true,"is_admin":true,"authentication-method":"session","login":"mradl","scope_system_admin_write":true,"scope_write":true,"firstname":"Manuel","scope_admin_write":true,"user_session_created_at":"2023-12-11T13:47:06.369416Z","id":"a786135f-c159-4618-9dd3-0012ebb3d500","user_session_id":"eaf44d43-6c37-4367-8386-da902cc69e3e","scope_system_admin_read":true,"access-rights":[{"role":"customer","inventory_pool_id":"3977012c-ce0e-501f-889b-8715fdb5d83b"},{"role":"customer","inventory_pool_id":"5863967f-9804-4909-a9b7-92254616d6b2"},{"role":"customer","inventory_pool_id":"5dd25b58-fa56-5095-bd97-2696d92c2fb1"},{"role":"customer","inventory_pool_id":"77e88ec8-9ff6-5435-818e-dc902fc631a6"},{"role":"inventory_manager","inventory_pool_id":"8bd16d45-056d-5590-bc7f-12849f034351"},{"role":"inventory_manager","inventory_pool_id":"a02b8163-9a16-5066-b48e-9eb74cf8b791"},{"role":"inventory_manager","inventory_pool_id":"b534b07c-d9bf-4572-840c-0a630b8cd8ed"},{"role":"customer","inventory_pool_id":"fc5a841e-36c6-5dc3-8207-1306c1fb89bf"},{"role":"customer","inventory_pool_id":"ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}],"user_id":"a786135f-c159-4618-9dd3-0012ebb3d500","is_system_admin":true,"external_sign_out_url":null,"language_locale":"de-CH","inventory_pool_roles_count":9,"scope_admin_read":true},"cookies":{"leihs-anti-csrf-token":{"value":"90abade9-82d6-4fb6-9898-f7566773263f"},"leihs-user-session":{"value":"3d37de50-dd5a-42c5-bca6-445a84997cf0"}},"remote-addr":"127.0.0.1","start-time":20604640149083,"params":{},"settings":{"email_sending_enabled":false,"sessions_max_lifetime_secs":432000,"smtp_default_from_address":"noreply@zhdk.ch","public_image_caching_enabled":true,"sessions_force_secure":false,"deliver_received_order_notifications":false,"external_base_url":"http:\/\/localhost:3200","sessions_force_uniqueness":false,"email_signature":"Das ZHdK-Ausleihe-Team"},"query-params-raw":{},"route-params":null,"headers":{"origin":"http:\/\/localhost:3230","sec-fetch-site":"same-origin","sec-ch-ua-mobile":"?0","host":"localhost:3230","user-agent":"Mozilla\/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit\/537.36 (KHTML, like Gecko) Chrome\/119.0.0.0 Safari\/537.36","content-type":"application\/json","cookie":"leihs-anti-csrf-token=90abade9-82d6-4fb6-9898-f7566773263f; leihs-user-session=3d37de50-dd5a-42c5-bca6-445a84997cf0","content-length":"255","sec-ch-ua":"\"Google Chrome\";v=\"119\", \"Chromium\";v=\"119\", \"Not?A_Brand\";v=\"24\"","sec-ch-ua-platform":"\"macOS\"","referer":"http:\/\/localhost:3230\/procure\/admin\/categories\/f68856713bf356f28e92b5112d0f703f","connection":"keep-alive","pragma":"no-cache","x-csrf-token":"90abade9-82d6-4fb6-9898-f7566773263f","accept":"application\/json","accept-language":"de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7","sec-fetch-dest":"empty","accept-encoding":"gzip, deflate, br","sec-fetch-mode":"cors","cache-control":"no-cache"},"server-port":3230,"params-raw":{},"content-length":255,"form-params":{},"websocket?":false,"query-params":{},"content-type":"application\/json","form-params-raw":{},"character-encoding":"utf8","uri":"\/procure\/graphql","server-name":"localhost","handler-key":"graphql","query-string":null,"body":{"operationName":"MainCategoriesIndex","variables":{},"query":"query MainCategoriesIndex {\n  main_categories {\n    id\n    name\n    image_url\n    categories {\n      id\n      name\n      can_delete\n      __typename\n    }\n    __typename\n  }\n}\n"},"multipart-params":{},"scheme":"http","request-method":"post","accept":{"mime":"json","charset":null,"encoding":null,"language":null}}

>request-grapql _> result => {:data #ordered/map ([:main_categories [#ordered/map ([:id 519f7a95-9ca7-5256-bf63-142cfc23dc62] [:name Audio- und Videotechnik] [:image_url /procure/images/ee215167-b2c3-5fcc-90c3-098ad20d16ea] [:categories [#ordered/map ([:id 4e48b48c-e1bf-50d7-ab2d-9aa438c638de] [:name Beamer] [:can_delete false] [:__typename :Category]) #ordered/map ([:id a1727606-c7c8-54a2-aaa1-ceff7a7d4b40] [:name Funk-Strecken] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 00382e27-a87a-5313-b31b-a369dad6c5f8] [:name Lautsprecher] [:can_delete false] [:__typename :Category]) #ordered/map ([:id ce5424cc-ce77-5e67-8201-333ec20963eb] [:name Lautsprecherstative] [:can_delete false] [:__typename :Category]) #ordered/map ([:id ce0812d7-080b-5f49-8530-dd4a821c57b6] [:name Mikrofone] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 67e5fc60-6fe3-53bb-9495-3669b917038a] [:name Mikrofonstative] [:can_delete false] [:__typename :Category]) #ordered/map ([:id f94f72e8-ff65-5bad-b1f9-81ddd8fa7c0c] [:name Monitore / Screens] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 89e4a22f-7d6c-5006-b26a-3ef6f8f19630] [:name Schnittplatz / Mischpult / Regie] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 1fb59e17-a703-5abc-8a80-fc7a9c20ee1d] [:name Video/Film-Kameras] [:can_delete false] [:__typename :Category]) #ordered/map ([:id c17698c1-5d5d-51ea-927f-b6ca96431a50] [:name Video/Film-Stative] [:can_delete false] [:__typename :Category]) #ordered/map ([:id fabe3b8c-58b5-5009-8873-cc3e945a7c0d] [:name Video/Filmobjektive] [:can_delete false] [:__typename :Category]) #ordered/map ([:id ebb12585-ce23-5cbe-8f4f-41a42d60a656] [:name Zuteilung unbekannt - Audio- und Videotechnik] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id 1a047acd-dc98-52c2-99d3-dc6332adc1e0] [:name Bauliche Anpassungen und Mobiliar] [:image_url /procure/images/8e07c37e-d244-514d-bfa9-306158056160] [:categories [#ordered/map ([:id 0a082661-cc1c-5b49-baab-f4db926faa7e] [:name Bauprojekte] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 42cc2d9a-cc45-5d77-85d3-0f21270d7a35] [:name Einrichtungsprojekte] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 56aaec64-8d65-50b3-bd81-f788d477b927] [:name Mobiliarergänzungen] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 483ac871-b632-5dcd-9d37-789d65f4c424] [:name Schliessanlagen und Türen] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 2b3749a2-6a59-5a25-9b9f-32f5e485e635] [:name Signaletik] [:can_delete false] [:__typename :Category]) #ordered/map ([:id fad911e4-8c69-535c-a138-f3e2544519ba] [:name Vorhänge] [:can_delete false] [:__typename :Category]) #ordered/map ([:id c3f14f79-931c-52c8-a847-ed77449ce9a6] [:name Zuteilung unbekannt - Bauliche Anpassungen und Mobiliar] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id dda588f4-660c-573c-a2ff-944ae93ad42e] [:name Beleuchtungstechnik] [:image_url /procure/images/8debe2ef-4a7e-58a1-bf4c-1622dead4579] [:categories [#ordered/map ([:id b9e4f492-55e3-57e4-9467-91c81bfe2325] [:name Bühnenlicht] [:can_delete false] [:__typename :Category]) #ordered/map ([:id a7cca5a4-e265-5f36-b794-1024c8aacc3e] [:name Film-Beleuchtung] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 79822b89-0edb-588c-b9e5-65b7722ac50b] [:name Kameralicht] [:can_delete false] [:__typename :Category]) #ordered/map ([:id ab911807-6431-5ca7-890a-3573737bb4d3] [:name Mobiles Raumlicht für Ausstellungen] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 64c6f8ad-a1b7-530b-946a-ebb1644ac897] [:name Studio-Licht] [:can_delete false] [:__typename :Category]) #ordered/map ([:id f2bb3f23-bb5b-5855-b03f-0166bd19fc0c] [:name Zuteilung unbekannt - Beleuchtungstechnik] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id 2b07eb8a-4174-5257-83eb-920d536cc44a] [:name Betriebseinrichtungen und Fahrzeuge] [:image_url /procure/images/3d6cbe63-c327-5c6b-b7fa-48e6c52f2cdc] [:categories [#ordered/map ([:id 5d8639a3-4569-5009-af28-f63f2af5209d] [:name Betriebseinrichtungen] [:can_delete false] [:__typename :Category]) #ordered/map ([:id b34f1cbb-4ac7-59a0-81f2-3ca7ecc94e71] [:name Fahrzeuge] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 73e97867-43ea-5bee-b46b-d7c74fbf873b] [:name Hub- und Hebegeräte] [:can_delete false] [:__typename :Category]) #ordered/map ([:id b6601a86-b5d3-5682-88b6-cff956b00d7b] [:name Zuteilung unbekannt - Betriebseinrichtungen und Fahrzeuge] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id f6827594-33a6-5760-ac41-f94ceefacfab] [:name Bühnentechnik] [:image_url /procure/images/9a8cba78-10ab-585b-a4c2-9d8e7f0818ee] [:categories [#ordered/map ([:id 455bc6dc-afbd-579d-a621-6d75e0fca9ea] [:name Bühnentechnik] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 747b6b21-9fad-4a01-acd9-cd8983aed286] [:name Fundus] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 07a6af37-e127-5f4b-94ec-698a5698d98c] [:name Zuteilung unbekannt - Bühnentechnik] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id 517b82ae-2b7e-4822-9aeb-0d4753dec821] [:name Darlehen] [:image_url nil] [:categories [#ordered/map ([:id 671ab85c-b8c1-4659-9c6e-9ebe2f122a59] [:name Darlehen] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id ca1d97ac-0ac4-597a-8edb-f9c466b1c7da] [:name Fotografie] [:image_url /procure/images/07a33b4c-d274-54e5-a2ce-11f26d57be05] [:categories [#ordered/map ([:id e1b4cad8-0416-5cf7-9e4a-dde208d0abad] [:name Blitzanlagen] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 011ff3f3-09fa-59e1-9713-52466786adf8] [:name Fotokameras] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 54b87eb0-061c-5a97-96ad-e9b6da605184] [:name Fotostative] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 5858ec5d-5f01-50fb-bc96-4b4766bd7799] [:name Kompakt-Blitze] [:can_delete false] [:__typename :Category]) #ordered/map ([:id ba5b41a7-4317-5160-9b82-b0931a48aec0] [:name Objektive] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 9df68a66-4523-5072-aa31-1df9abeaa1c7] [:name Zuteilung unbekannt - Fotografie] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id 2ea39047-e663-50d5-9080-838b75883704] [:name IT & Elektronik] [:image_url /procure/images/1464e46c-e726-54a9-a42b-f937a0342d22] [:categories [#ordered/map ([:id f2531d7e-d9ff-5c3e-9e88-6d3a16a89aa1] [:name Desktop] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 1af3a7f2-b16a-4203-b6ac-f2c7be612d74] [:name IT_Projekte] [:can_delete false] [:__typename :Category]) #ordered/map ([:id ccab158d-79c7-5c28-a8a2-47cb4925f101] [:name IT-Basisinfrastruktur] [:can_delete false] [:__typename :Category]) #ordered/map ([:id eb1e7bef-80c6-4958-b16e-35555735ce61] [:name IT-Security] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 4ecc9e97-2d12-5173-bd8c-781482c842e8] [:name Laptops] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 80226a51-c17a-5fd8-93db-40aef5b03491] [:name Monitore] [:can_delete false] [:__typename :Category]) #ordered/map ([:id fe602c35-1097-52d0-acd0-40579d295f00] [:name Scanner] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 56065d53-cd2f-5a39-9b66-532fd83ad2e6] [:name Schnittstellengeräte] [:can_delete false] [:__typename :Category]) #ordered/map ([:id fc7bc38c-62f3-5576-802f-c874e06ee776] [:name Software] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 76fdca98-4a2a-5640-bc98-f33059d6ffa0] [:name Tablets] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 77857566-03d9-58f4-8b0d-290227434aff] [:name Telefon] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 5059c4fc-d34c-5c9a-9efe-257c7ec6fb6b] [:name Zuteilung unbekannt - IT & Elektronik] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id f6885671-3bf3-56f2-8e92-b5112d0f703f] [:name Musikinstrumente] [:image_url /procure/images/3a52eb87-b5fe-5df0-98b1-43e80f28d2dc] [:categories [#ordered/map ([:id af3372a1-63a8-52dc-850e-c2ae91c1c078] [:name Musikinstrumente] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 17a52112-1986-5074-b1d9-0faff29a785b] [:name Zuteilung unbekannt - Musikinstrumente] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id 6c8a0d77-6711-5156-a59a-12425ba01cff] [:name Werkstatt-Technik] [:image_url /procure/images/f4e1f230-df2e-5e95-bf89-827f7a6b4b3b] [:categories [#ordered/map ([:id 6870a16c-9a71-5e60-b94a-f0b784398fec] [:name Handwerkzeug] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 771fddcf-b19a-5e6b-8b6f-7266b6922c4f] [:name Maschinen] [:can_delete false] [:__typename :Category]) #ordered/map ([:id c7ece4a6-2b5c-409f-96ea-e4fd6e8f9792] [:name Sicherheit] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 3eaad5d5-516a-5610-8caf-342cfdcaac62] [:name Zuteilung unbekannt - Werkstatt-Technik] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory])]])}
2023-12-11T15:36:18.004Z NX-41294 DEBUG [leihs.procurement.graphql:86] - result => {:data #ordered/map ([:main_categories [#ordered/map ([:id "519f7a95-9ca7-5256-bf63-142cfc23dc62"] [:name "Audio- und Videotechnik"] [:image_url "/procure/images/ee215167-b2c3-5fcc-90c3-098ad20d16ea"] [:categories [#ordered/map ([:id "4e48b48c-e1bf-50d7-ab2d-9aa438c638de"] [:name "Beamer"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "a1727606-c7c8-54a2-aaa1-ceff7a7d4b40"] [:name "Funk-Strecken"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "00382e27-a87a-5313-b31b-a369dad6c5f8"] [:name "Lautsprecher"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "ce5424cc-ce77-5e67-8201-333ec20963eb"] [:name "Lautsprecherstative"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "ce0812d7-080b-5f49-8530-dd4a821c57b6"] [:name "Mikrofone"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "67e5fc60-6fe3-53bb-9495-3669b917038a"] [:name "Mikrofonstative"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "f94f72e8-ff65-5bad-b1f9-81ddd8fa7c0c"] [:name "Monitore / Screens"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "89e4a22f-7d6c-5006-b26a-3ef6f8f19630"] [:name "Schnittplatz / Mischpult / Regie"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "1fb59e17-a703-5abc-8a80-fc7a9c20ee1d"] [:name "Video/Film-Kameras"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "c17698c1-5d5d-51ea-927f-b6ca96431a50"] [:name "Video/Film-Stative"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "fabe3b8c-58b5-5009-8873-cc3e945a7c0d"] [:name "Video/Filmobjektive"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "ebb12585-ce23-5cbe-8f4f-41a42d60a656"] [:name "Zuteilung unbekannt - Audio- und Videotechnik"] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "1a047acd-dc98-52c2-99d3-dc6332adc1e0"] [:name "Bauliche Anpassungen und Mobiliar"] [:image_url "/procure/images/8e07c37e-d244-514d-bfa9-306158056160"] [:categories [#ordered/map ([:id "0a082661-cc1c-5b49-baab-f4db926faa7e"] [:name "Bauprojekte"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "42cc2d9a-cc45-5d77-85d3-0f21270d7a35"] [:name "Einrichtungsprojekte"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "56aaec64-8d65-50b3-bd81-f788d477b927"] [:name "Mobiliarergänzungen"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "483ac871-b632-5dcd-9d37-789d65f4c424"] [:name "Schliessanlagen und Türen"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "2b3749a2-6a59-5a25-9b9f-32f5e485e635"] [:name "Signaletik"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "fad911e4-8c69-535c-a138-f3e2544519ba"] [:name "Vorhänge"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "c3f14f79-931c-52c8-a847-ed77449ce9a6"] [:name "Zuteilung unbekannt - Bauliche Anpassungen und Mobiliar"] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "dda588f4-660c-573c-a2ff-944ae93ad42e"] [:name "Beleuchtungstechnik"] [:image_url "/procure/images/8debe2ef-4a7e-58a1-bf4c-1622dead4579"] [:categories [#ordered/map ([:id "b9e4f492-55e3-57e4-9467-91c81bfe2325"] [:name "Bühnenlicht"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "a7cca5a4-e265-5f36-b794-1024c8aacc3e"] [:name "Film-Beleuchtung"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "79822b89-0edb-588c-b9e5-65b7722ac50b"] [:name "Kameralicht"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "ab911807-6431-5ca7-890a-3573737bb4d3"] [:name "Mobiles Raumlicht für Ausstellungen"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "64c6f8ad-a1b7-530b-946a-ebb1644ac897"] [:name "Studio-Licht"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "f2bb3f23-bb5b-5855-b03f-0166bd19fc0c"] [:name "Zuteilung unbekannt - Beleuchtungstechnik"] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "2b07eb8a-4174-5257-83eb-920d536cc44a"] [:name "Betriebseinrichtungen und Fahrzeuge"] [:image_url "/procure/images/3d6cbe63-c327-5c6b-b7fa-48e6c52f2cdc"] [:categories [#ordered/map ([:id "5d8639a3-4569-5009-af28-f63f2af5209d"] [:name "Betriebseinrichtungen"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "b34f1cbb-4ac7-59a0-81f2-3ca7ecc94e71"] [:name "Fahrzeuge"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "73e97867-43ea-5bee-b46b-d7c74fbf873b"] [:name "Hub- und Hebegeräte"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "b6601a86-b5d3-5682-88b6-cff956b00d7b"] [:name "Zuteilung unbekannt - Betriebseinrichtungen und Fahrzeuge"] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "f6827594-33a6-5760-ac41-f94ceefacfab"] [:name "Bühnentechnik"] [:image_url "/procure/images/9a8cba78-10ab-585b-a4c2-9d8e7f0818ee"] [:categories [#ordered/map ([:id "455bc6dc-afbd-579d-a621-6d75e0fca9ea"] [:name "Bühnentechnik"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "747b6b21-9fad-4a01-acd9-cd8983aed286"] [:name "Fundus"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "07a6af37-e127-5f4b-94ec-698a5698d98c"] [:name "Zuteilung unbekannt - Bühnentechnik"] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "517b82ae-2b7e-4822-9aeb-0d4753dec821"] [:name "Darlehen"] [:image_url nil] [:categories [#ordered/map ([:id "671ab85c-b8c1-4659-9c6e-9ebe2f122a59"] [:name "Darlehen"] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da"] [:name "Fotografie"] [:image_url "/procure/images/07a33b4c-d274-54e5-a2ce-11f26d57be05"] [:categories [#ordered/map ([:id "e1b4cad8-0416-5cf7-9e4a-dde208d0abad"] [:name "Blitzanlagen"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "011ff3f3-09fa-59e1-9713-52466786adf8"] [:name "Fotokameras"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "54b87eb0-061c-5a97-96ad-e9b6da605184"] [:name "Fotostative"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "5858ec5d-5f01-50fb-bc96-4b4766bd7799"] [:name "Kompakt-Blitze"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "ba5b41a7-4317-5160-9b82-b0931a48aec0"] [:name "Objektive"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "9df68a66-4523-5072-aa31-1df9abeaa1c7"] [:name "Zuteilung unbekannt - Fotografie"] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "2ea39047-e663-50d5-9080-838b75883704"] [:name "IT & Elektronik"] [:image_url "/procure/images/1464e46c-e726-54a9-a42b-f937a0342d22"] [:categories [#ordered/map ([:id "f2531d7e-d9ff-5c3e-9e88-6d3a16a89aa1"] [:name "Desktop"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "1af3a7f2-b16a-4203-b6ac-f2c7be612d74"] [:name "IT_Projekte"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "ccab158d-79c7-5c28-a8a2-47cb4925f101"] [:name "IT-Basisinfrastruktur"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "eb1e7bef-80c6-4958-b16e-35555735ce61"] [:name "IT-Security"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "4ecc9e97-2d12-5173-bd8c-781482c842e8"] [:name "Laptops"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "80226a51-c17a-5fd8-93db-40aef5b03491"] [:name "Monitore"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "fe602c35-1097-52d0-acd0-40579d295f00"] [:name "Scanner"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "56065d53-cd2f-5a39-9b66-532fd83ad2e6"] [:name "Schnittstellengeräte"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "fc7bc38c-62f3-5576-802f-c874e06ee776"] [:name "Software"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "76fdca98-4a2a-5640-bc98-f33059d6ffa0"] [:name "Tablets"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "77857566-03d9-58f4-8b0d-290227434aff"] [:name "Telefon"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "5059c4fc-d34c-5c9a-9efe-257c7ec6fb6b"] [:name "Zuteilung unbekannt - IT & Elektronik"] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "f6885671-3bf3-56f2-8e92-b5112d0f703f"] [:name "Musikinstrumente"] [:image_url "/procure/images/3a52eb87-b5fe-5df0-98b1-43e80f28d2dc"] [:categories [#ordered/map ([:id "af3372a1-63a8-52dc-850e-c2ae91c1c078"] [:name "Musikinstrumente"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "17a52112-1986-5074-b1d9-0faff29a785b"] [:name "Zuteilung unbekannt - Musikinstrumente"] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "6c8a0d77-6711-5156-a59a-12425ba01cff"] [:name "Werkstatt-Technik"] [:image_url "/procure/images/f4e1f230-df2e-5e95-bf89-827f7a6b4b3b"] [:categories [#ordered/map ([:id "6870a16c-9a71-5e60-b94a-f0b784398fec"] [:name "Handwerkzeug"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "771fddcf-b19a-5e6b-8b6f-7266b6922c4f"] [:name "Maschinen"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "c7ece4a6-2b5c-409f-96ea-e4fd6e8f9792"] [:name "Sicherheit"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "3eaad5d5-516a-5610-8caf-342cfdcaac62"] [:name "Zuteilung unbekannt - Werkstatt-Technik"] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory])]])}
>>> authenticate::skip= nil  handler-key= :graphql
>>> authenticate::authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}

>> authorize >

>> authorize::handler > #object[leihs.core.locale$wrap$fn__44947 0x75cb2fad leihs.core.locale$wrap$fn__44947@75cb2fad]

>> authorize::request > {:authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 90abade9-82d6-4fb6-9898-f7566773263f}, leihs-user-session {:value 3d37de50-dd5a-42c5-bca6-445a84997cf0}}, :remote-addr 127.0.0.1, :start-time 20604829100500, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type application/json, cookie leihs-anti-csrf-token=90abade9-82d6-4fb6-9898-f7566773263f; leihs-user-session=3d37de50-dd5a-42c5-bca6-445a84997cf0, content-length 595, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/admin/categories/f68856713bf356f28e92b5112d0f703f, connection keep-alive, pragma no-cache, x-csrf-token 90abade9-82d6-4fb6-9898-f7566773263f, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x264b1bf9 /127.0.0.1:3230<->/127.0.0.1:65348], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x29d7116a HikariDataSource (db-pool)]}, :content-length 595, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:operationName MainCategories, :variables {}, :query query MainCategories {
  main_categories {
    ...MainCatProps
    __typename
  }
}

fragment MainCatProps on MainCategory {
  id
  name
  can_delete
  image_url
  categories {
    id
    name
    can_delete
    cost_center
    general_ledger_account
    procurement_account
    inspectors {
      ...UserProps
      __typename
    }
    viewers {
      ...UserProps
      __typename
    }
    __typename
  }
  __typename
}

fragment UserProps on User {
  id
  firstname
  lastname
  __typename
}
}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0x46dd5e9 leihs.procurement.graphql$handler@46dd5e9], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>> authorize::handler-key >> :graphql
>myprint>  authEnt? {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>myprint>  txn #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.041Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.042Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>myprint>  admin true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.044Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> inspector? {:result false}
>myprint>  inspector false
>o> viewer? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.046Z NX-41294 DEBUG [leihs.procurement.permissions.user:83] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> viewer? {:result false}
>myprint>  viewer false
>o> requester?? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.046Z NX-41294 DEBUG [leihs.procurement.permissions.user:167] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> requester?? {:exists false}
>myprint>  requester false
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.047Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.047Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.048Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> inspector? {:result false}
>o> viewer? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.048Z NX-41294 DEBUG [leihs.procurement.permissions.user:83] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> viewer? {:result false}
>o> requester?? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.049Z NX-41294 DEBUG [leihs.procurement.permissions.user:167] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> requester?? {:exists false}

> 1 anti-csrf-token >  90abade9-82d6-4fb6-9898-f7566773263f

> 1 anti-csrf-token class >  java.lang.String

> 2 anti-csrf-token-new >  nil
pure-handler >> 2
2023-12-11T15:36:18.053Z NX-41294 DEBUG [leihs.procurement.graphql:46] - graphql query query MainCategories {
  main_categories {
    ...MainCatProps
    __typename
  }
}

fragment MainCatProps on MainCategory {
  id
  name
  can_delete
  image_url
  categories {
    id
    name
    can_delete
    cost_center
    general_ledger_account
    procurement_account
    inspectors {
      ...UserProps
      __typename
    }
    viewers {
      ...UserProps
      __typename
    }
    __typename
  }
  __typename
}

fragment UserProps on User {
  id
  firstname
  lastname
  __typename
}
 with variables {}
>oo> vars from graphQL-Requst nil nil nil {}
>debug 2
>debug 3
2023-12-11T15:36:18.059Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format main-categories-base-query) => ["SELECT procurement_main_categories.* FROM procurement_main_categories ORDER BY procurement_main_categories.name ASC"]
>debug 4
>debug 5 {:id #uuid "519f7a95-9ca7-5256-bf63-142cfc23dc62", :name Audio- und Videotechnik}
>debug 5a id #uuid "519f7a95-9ca7-5256-bf63-142cfc23dc62"
2023-12-11T15:36:18.061Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "519f7a95-9ca7-5256-bf63-142cfc23dc62"]
>debug 5b {:main_category_id #uuid "519f7a95-9ca7-5256-bf63-142cfc23dc62", :content iVBORw0KGgoAAAANSUhEUgAAAHAAAACACAYAAADTcu1SAAAABHNCSVQICAgI
fAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAAA9tJREFUeJzt3U1rVFcAgOE3
Y6maVJeK/gIpbWmtJtaPneCqiOBfKLTgv3EtVPAPCEKroGsVEYpYu5LSYpd+
tDXtKtPFyQRTJ7lzzz0fOZn3gbNy7szNeefeTO7FOSBJkiRJkiRJkiRJkiRJ
kqTdYCHi8V8AF4AV4BhwBDgQ8Vy1jYG/gD+AX4AHwI/AT+v/tqvsB64QftDx
Lh8/A98B+5LM3A5wGfid+hNbevwGXEowfyl8TDg7/AusAreAz7o2WgJuUH8i
a4/rwGLXZGX0JfBqyn6tAstbbXQYeDxlo3kdj9bnpLQTTI83GfembXQYeLbN
RvM6ngGHOqc8na54Y+Cf/2+0hEfeduMRZU6ns8SbjE38ndc9vu+a/YFOAq97
7M+GyxE/zLyOi90dovSNtxFwP/P5p0Ls+BXY292jl2X6x9sIeKXSRLQ8vu1u
MrPYeGMIl8Dm4QpL6vGUNJcPl4E3A/aD4ztgMlodnVdDOqwwLN54RLgwrThD
5m4FuAMcHLIDo/UnUpxTA7YbHA/gA8ItIcWJmbtJvAMpdmBEuJ+nOEd7Pj5p
PAifotZo72bsTrEG7JnxsV8Bt0kYD0K4cconnEOzvPlPE+7nJY0H4RSqvLLF
g/AhRvmcJpw2P8r1Ah6B+WSPBwbM5QwF4oEBczhL+J2XPR4YMLWzwA8Uigd+
iElpcuQtlXxRj8A0zlEhHhgwhXOE02bxeOCVmBTeUikeGLB5nkIbZ8DGGbBx
BmycARtnwMYZsHEGbJwBG2fAxhmwcQZsnAEbZ8DGGbBxBmycARtnwMYZsHEG
bJwBG2fA4V7VfHEDDneeihENONxjKkY0YBrVIhownSoRDZhW8YgGTK9oRAPm
USyiAfMpEtGAeWWPaMD8skYc4X/wHGJtxsdlizgiLMGmOH/2eGyWiCPC+nmK
86Ln45NHHBG+sV5xYuYuacQRYeVKxbkfuV3SiJ9T/+v7Wx2fRMz3u44DLwfu
AwuEZUdrT0Zr4wlpvqp6UMTJnxFXE+zIvLnK+hEwUJLT6T7CmrG139WtjOfA
h1EzvbXYI3HDpYIT0Pr4uqtGpJiIm1xP8MPt9nGtI8JQfSNuskhYZrT2JO3U
8ZCw1mJufSK+x0WQp4/SiyDPEvG9RZAnDuGR+O54SNl4E10R72638SJhwd/a
k1d7XKPMaXMrW0V8S1hzt9NFwpqxtSey9HhOvk+bfR0DbgGrwN/ATXpeBdpL
WDP2KfUnNvd4AnxD+r/zsuh7KWgB+JSwcuUpwjvjKGEhw9bu7q8R7ue9INxV
uE/44vLJm1SSJEmSJEmSJEmSJEmSJEkq5j8E8YerHU6LEAAAAABJRU5ErkJg
gg==
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 1081, :content_type image/png, :filename video.png, :id #uuid "ee215167-b2c3-5fcc-90c3-098ad20d16ea", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.014, :System:Directory /tmp/tmp.qSpfBizLgM, :System:FileSize 1081 bytes, :PNG:ImageHeight 128, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 112x128, :PNG:ColorType RGB with Alpha, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 112, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/video.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName video.png, :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-11T15:36:18.062Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "519f7a95-9ca7-5256-bf63-142cfc23dc62"]
>debug 4
>debug 5 {:id #uuid "1a047acd-dc98-52c2-99d3-dc6332adc1e0", :name Bauliche Anpassungen und Mobiliar}
>debug 5a id #uuid "1a047acd-dc98-52c2-99d3-dc6332adc1e0"
2023-12-11T15:36:18.062Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "1a047acd-dc98-52c2-99d3-dc6332adc1e0"]
>debug 5b {:main_category_id #uuid "1a047acd-dc98-52c2-99d3-dc6332adc1e0", :content iVBORw0KGgoAAAANSUhEUgAAAGQAAACACAYAAAD9N8zAAAAABHNCSVQICAgI
fAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAABiNJREFUeJztnXmoVVUUh7+r
PvVpZebLHDJDsGywMiuLioSIIsMsMiqpoIIgqEwKLYUiqCAaoD+KlCQblKKR
BopSG0xJyyJKmp2liTSnJn32x763nqd97rD2uffu897vgwXCO2etvffv3Lv3
XnudKwghhBBCCCGEEEIIIYQQQgghhBBCCCFyTqHZDciAfsCw4r/XA781sS1d
lm7AFcAKYE/ClgNTCH/Y7gB+9/ivZKuAwwJj54r+wJtUHpjXcJ8eC0Or8F/O
5hrj5o6RwFdUPzBfACMMcY6uIYbPXrJ0Lm+MB36l9sH5GTitxlgSpALXAH9j
H6A/cXNOtUiQFLoD9xM2OB3tLtyCoBISxMO+wCtkJ0bJngP6VIgtQRIMBz4j
ezFK9hEwpEz8pglSzce30ZyC20uMrmOMscUYY+oYw0RsgkwBFgMDGxBrKLAE
mNSAWLmjG3An9q+Ir4tmubcdmM7eO/suPYf0AZ7F3vmFwAFFWxTgZy7Qs9im
LivIEPz5qGrtUaClg7+ewJwAf+8CbXRRQY4HNmDr8G5gKv4EYgG4CfdVZPH9
LXCR8d7cCnIBsANbZ7cCE6qIcR6wzRgjJCuQK0EKwAzsHV1DbcvhY4C1AfE6
tSC9gHnYO7kU/3K4BXi4aC2evx8ELAuI2ykFORB4H3sHnwJ6e/wOYO+VVWnF
laQ38HRA/E4lyFHA99g7dxv+yfsI3AScvP4bYJTn+gIwK6AdnUKQc3Bn3JZO
7cStdix+twBnp9w7GdvRbK4FKQA34Janlg5tBE5I8XtjlX53F6/1fbpOBDYZ
25Y7QVqAR7B35mNcnimJddM3m/924B05GPgkoJ25EKQ/8Bb2jjwP9PX4bcPt
oq1+38EtAJL0BV4M8Bu1ICOBL7F3Iu00L3RRULLvgCM9/rsB92TgPypBxmMr
QNiDO+++PMXvBNzOPKuB2gqcmxLrSuCvjOI0VZCrsacafgJO9fgsADdjz0eV
s93ANPyT/enALxnEaIog3YH7DI0t2efAoR6/vXCp8KyFSNpj+Cf7Ebjqw1wJ
ElqA8Dqwn8fvQMJ29LXae7gsQpJ+wBsBflcCrRVHMSOGE1aA8CDQw+N3NC55
2CgxSrYad/6RpAfwUIDf5cDg8kMZzsnAj8YG7gKuTfE7EXuqPAvbhkvX+7iu
2HaL3/XUsZDiMuAPY8M2A2d6fJbS8fWYvGu1duAW/JP9Wbh0jMXvDjIupMii
AOFwj9/ewBMBfutlj+MWFklG4U9mVmszyOB9nNAChEX40+GDaPwZRS32Af6z
lwGEZQzm4Re7KgbjJiZr8Nn4D4yOA9YF+G2UrcWdOCbpiVsyW/0uwVB3NgZ7
AUI7rsjA9/G8EPtZejNsO3C+px+hG9fV+Fd2XiYFDNo2/AUIBWBmHQasEdYO
3Ir/AZuIEy3Lsdpr0KZjV30N/gKEVmB+Ewc0K3sS/zHysdi/gttJSeP0wq0u
rI1diismSDKEsHkoNluGW5AkGQR8GOB3Dh3SOPUqQBiLfR6K2dbh3+y1AgsC
/C6meGYTIsZM/N+tk3Fn4s0evHrZDtwCJUkBuD3A70KwTeBpBQihDcqbzcL/
QF6CrZBiC9RevLYJfwFCH+CZCAap0TYff2Z3HPBDjb7mgDtXXlnlDStxxQFJ
huJeE2v24DTLluN/Re4Q4NMqfaygg7DDqKzmC/gLEE6iviU1ebENuIVMkn2A
lyvcuxGPoONIz+bejb8A4VLqX3SWJ9uJW9Ak6Q7cW+Ye3xQAuHf8Ol5c7oX7
qREMQKx2fcqYXcX/CykuTrn2X6bhyjRXUf4nKV6NoOOxWrkz9TNwafzNpAtn
QoLYBClLbK9Fd3kkSGRIkMiQIJEhQSJDgkSGBIkMX0lnrJSOli0UyMnDlydB
BlA8LzDQhvsxzOjJxVPTlZAgkSFBIkOCRIYEiQwJEhkSJDIkSGRIkMiQIJEh
QSJDgkSGBIkMCRIZEiQyJEhkSJDIkCCRIUEiI0SQnZm1ovOx3XpjiCBvB9zb
2WnK2LTQ2J/j2z+grW0NbOcimljN0xd4APeO4a46W6gg9W7fRtxra5X+00oh
hBBCCCGEEEIIIYQQQgghhBBCCCGEEA3kH1vl9UN9mBbVAAAAAElFTkSuQmCC
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 1665, :content_type image/png, :filename bauprojekte.png, :id #uuid "8e07c37e-d244-514d-bfa9-306158056160", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.013, :System:Directory /tmp/tmp.qSpfBizLgM, :System:FileSize 1665 bytes, :PNG:ImageHeight 128, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 100x128, :PNG:ColorType RGB with Alpha, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 100, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/bauprojekte.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName bauprojekte.png, :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-11T15:36:18.063Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "1a047acd-dc98-52c2-99d3-dc6332adc1e0"]
>debug 4
>debug 5 {:id #uuid "dda588f4-660c-573c-a2ff-944ae93ad42e", :name Beleuchtungstechnik}
>debug 5a id #uuid "dda588f4-660c-573c-a2ff-944ae93ad42e"
2023-12-11T15:36:18.063Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "dda588f4-660c-573c-a2ff-944ae93ad42e"]
>debug 5b {:main_category_id #uuid "dda588f4-660c-573c-a2ff-944ae93ad42e", :content iVBORw0KGgoAAAANSUhEUgAAAJsAAACACAYAAAAccBvUAAAACXBIWXMAAAQK
AAAECgFCV1GHAAA59GlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFj
a2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQi
Pz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0
az0iQWRvYmUgWE1QIENvcmUgNS42LWMxMTEgNzkuMTU4MzI1LCAyMDE1LzA5
LzEwLTAxOjEwOjIwICAgICAgICAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9
Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMi
PgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAg
ICAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8i
CiAgICAgICAgICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxl
bWVudHMvMS4xLyIKICAgICAgICAgICAgeG1sbnM6cGhvdG9zaG9wPSJodHRw
Oi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIgogICAgICAgICAgICB4
bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIK
ICAgICAgICAgICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20v
eGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgICAgICAgICAgeG1s
bnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAg
ICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8x
LjAvIj4KICAgICAgICAgPHhtcDpDcmVhdG9yVG9vbD5BZG9iZSBQaG90b3No
b3AgQ0MgMjAxNSAoTWFjaW50b3NoKTwveG1wOkNyZWF0b3JUb29sPgogICAg
ICAgICA8eG1wOkNyZWF0ZURhdGU+MjAxNi0wNy0xNFQxNTo0NTo0MSswMjow
MDwveG1wOkNyZWF0ZURhdGU+CiAgICAgICAgIDx4bXA6TW9kaWZ5RGF0ZT4y
MDE2LTA3LTE0VDE1OjQ5OjAyKzAyOjAwPC94bXA6TW9kaWZ5RGF0ZT4KICAg
ICAgICAgPHhtcDpNZXRhZGF0YURhdGU+MjAxNi0wNy0xNFQxNTo0OTowMisw
MjowMDwveG1wOk1ldGFkYXRhRGF0ZT4KICAgICAgICAgPGRjOmZvcm1hdD5p
bWFnZS9wbmc8L2RjOmZvcm1hdD4KICAgICAgICAgPHBob3Rvc2hvcDpDb2xv
ck1vZGU+MzwvcGhvdG9zaG9wOkNvbG9yTW9kZT4KICAgICAgICAgPHhtcE1N
Okluc3RhbmNlSUQ+eG1wLmlpZDozMTMzODRjNi0zYzM5LTQzNjgtODE5OS01
OWJhZDM3ODBkNGQ8L3htcE1NOkluc3RhbmNlSUQ+CiAgICAgICAgIDx4bXBN
TTpEb2N1bWVudElEPmFkb2JlOmRvY2lkOnBob3Rvc2hvcDoxYTU3ZjVjYy04
YTU4LTExNzktOGVmNS04OTFkYzJiZDEwY2Y8L3htcE1NOkRvY3VtZW50SUQ+
CiAgICAgICAgIDx4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ+eG1wLmRpZDpk
OWQ5MWY5NC0yNjQ0LTQ4NTItODAwYS0yZTA2OTBlN2VjMzM8L3htcE1NOk9y
aWdpbmFsRG9jdW1lbnRJRD4KICAgICAgICAgPHhtcE1NOkhpc3Rvcnk+CiAg
ICAgICAgICAgIDxyZGY6U2VxPgogICAgICAgICAgICAgICA8cmRmOmxpIHJk
ZjpwYXJzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgICAgICAgPHN0
RXZ0OmFjdGlvbj5jcmVhdGVkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAg
ICAgICAgIDxzdEV2dDppbnN0YW5jZUlEPnhtcC5paWQ6ZDlkOTFmOTQtMjY0
NC00ODUyLTgwMGEtMmUwNjkwZTdlYzMzPC9zdEV2dDppbnN0YW5jZUlEPgog
ICAgICAgICAgICAgICAgICA8c3RFdnQ6d2hlbj4yMDE2LTA3LTE0VDE1OjQ1
OjQxKzAyOjAwPC9zdEV2dDp3aGVuPgogICAgICAgICAgICAgICAgICA8c3RF
dnQ6c29mdHdhcmVBZ2VudD5BZG9iZSBQaG90b3Nob3AgQ0MgMjAxNSAoTWFj
aW50b3NoKTwvc3RFdnQ6c29mdHdhcmVBZ2VudD4KICAgICAgICAgICAgICAg
PC9yZGY6bGk+CiAgICAgICAgICAgICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlw
ZT0iUmVzb3VyY2UiPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6YWN0aW9u
PnNhdmVkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAgICAgICAgIDxzdEV2
dDppbnN0YW5jZUlEPnhtcC5paWQ6MzEzMzg0YzYtM2MzOS00MzY4LTgxOTkt
NTliYWQzNzgwZDRkPC9zdEV2dDppbnN0YW5jZUlEPgogICAgICAgICAgICAg
ICAgICA8c3RFdnQ6d2hlbj4yMDE2LTA3LTE0VDE1OjQ5OjAyKzAyOjAwPC9z
dEV2dDp3aGVuPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6c29mdHdhcmVB
Z2VudD5BZG9iZSBQaG90b3Nob3AgQ0MgMjAxNSAoTWFjaW50b3NoKTwvc3RF
dnQ6c29mdHdhcmVBZ2VudD4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OmNo
YW5nZWQ+Lzwvc3RFdnQ6Y2hhbmdlZD4KICAgICAgICAgICAgICAgPC9yZGY6
bGk+CiAgICAgICAgICAgIDwvcmRmOlNlcT4KICAgICAgICAgPC94bXBNTTpI
aXN0b3J5PgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9y
aWVudGF0aW9uPgogICAgICAgICA8dGlmZjpYUmVzb2x1dGlvbj4yNjI2MzYv
MTAwMDA8L3RpZmY6WFJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOllSZXNv
bHV0aW9uPjI2MjYzNi8xMDAwMDwvdGlmZjpZUmVzb2x1dGlvbj4KICAgICAg
ICAgPHRpZmY6UmVzb2x1dGlvblVuaXQ+MjwvdGlmZjpSZXNvbHV0aW9uVW5p
dD4KICAgICAgICAgPGV4aWY6Q29sb3JTcGFjZT42NTUzNTwvZXhpZjpDb2xv
clNwYWNlPgogICAgICAgICA8ZXhpZjpQaXhlbFhEaW1lbnNpb24+MTU1PC9l
eGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGlt
ZW5zaW9uPjEyODwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgIDwvcmRm
OkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAo8P3hwYWNrZXQgZW5kPSJ3
Ij8+W7LKAQAAACBjSFJNAAB6JQAAgIMAAPn/AACA6AAAUggAARVYAAA6lwAA
F2/XWh+QAAAJGElEQVR42uyda4hVVRTHf75GxJEhmxlFHEFHApEmicgnGppI
iJWSOlghGvghS8QQRpRQVOjlo4JUUkILH6SJiUJJfagsUjH9oCgOpuAjx5Ss
NEdzpg/toZA7M2fte869Z+2zPmyQ8c7Ze/33b+7Za+2916K5uRlr/zWgGpgO
zANWAB8Ce4AfgLPAn66ddT/b4z6zwv3OdKDatMyhrcFFJVALbAR+Bppjaj+7
Z9YClQZbBmEDOgDjgVXAcaApRsBaa02ur1Wu7w4GW9iQdQdeBk4XAK722mk3
lu4GW1iQVQFvAtdTANn97bobW5XBphuyx4HtwN0UQnZ/u+vG+rjBpguyB4CP
FADWWvsIeMBgSz9ozwCXFIPW0i4Bzxhs6YSswr2GmgNr24EKgy09oNUCVwME
raVdBWoNtuLHy9YVaMJvAPVux+Bz135wP7tRoDGs0x6f0wpaR2BTgsHXd4HJ
LmxSEmE8Je6zk93vJhUs3gR0NNgKB1on4OMYJ/B3YD3wLNAzxnH2dM9c7/qI
a7wfA50MtuRB6xyjI3ASmAv0KMC4e7i+TsboOHQ22JKbsC7Azhgm6jNgbBHt
GOvGkK8dO4EuBlsyk7Qjz8k5DoxKkT2j3JjysWmHwRb/xDyfpyc5P43rHLf+
nJ+nR/u8wRbfhPQCrvn+5QO9FdjYO49v7mtAL4MtnonY5TkJSxV62ks9bd1l
sOUv/jQP4f8G5igOVs9xNkjtnmaw+YteDjQIBb8FPB3AFtzTzhaJ7Q1AucHm
J7g0ntaYJm8zJm+1URp/M9jkQg/2eI0sDPBs3kIPHQYbbDKR3xYK/LXmPcN2
9oC/FmrxtsEmiz1dFp7j71ugsb0AHAJuAueAw8A+4D3guSRCEEBf4f2Jy2nd
O00jbBPT6IUBD0cczyngnTgvsXh45RMNtmjCfioQ9asCjustj0ssW4CamPr/
StD3pwZbtGM5jWmMLQGT8thSWh/lXFyM326NcR6XChW2uQJBrxTy1INbrO8C
7nkC910+W2fu1MsVQX9zDba2BZV4Xm8UaYwDXJR/ObDZjTnqja4LwGN59P2G
xEM32NoW85zg+HZ1isbdwQVhP4hw+eYy8GAeGZaiHjc/Z7C1/ZqKenv925Sf
Jn4K+DGJc2jAtwIHpaPBllvEPoJXxAYlt79mA3+1YsN0z+duEOjUx2DLLeIw
gYiLFO0CPNnKpvpFz+ctEug0zGDLLeJUgYgzlG07LW7Fjr4ez5oh0GmqwZZb
xAUCEUcozA33Rw47Jnk8a4RApwUGW24R12hdi0S0L5fD8HrCa9s1BltuETcL
RCxRCNv7OexY7fGcEoFOmw223CKuFojYWyFsuTbyH/a8HBNVp9UGW24R6wQi
1miD7b4jSoeAFzyfUSPQqc5gyy3ibIGI40JOB9qOTuMEOs022PI/VTErw7DN
Eug0yWDLLeJQSSafDMMmyeA01GBr/fhzVBF/yWLhCrcF9otAp74GW+tinhUI
OSSDsA0R6HPWTn20LaYkbenKDMK2UpIW1WBrW8zJAjF/A8oyBFqZszmqPpMN
tvYFleS5WJIh2JYI852UGWzti3pQIOqvQGkGQCt1tkbV5aDdroom7GvSm0sZ
gG29UJPXDLbof8XSIhpTAgZtikeRjlKDLZl90pYUDFUBglblUbqyLrX2pHiN
Iv12+x7oFhBo3ZxNQXyrpT0/W53HReD92tK1t3Eheb+H/XWptivlHtgVD8G3
qS658++Vxm0edl9Ju2eeduEneKY7WKcYNp/ib/eACam3TYH4yzxzayxXCNpy
T1uXqbBPyWvlgOckzFME2jxPGw9oWTZomYgKl5TFJ039Ewrse8IzHf0FTZWW
Nb1iRnpkz26pt16ZYrsqPevaNwIjVS0TlK1pZnq+ar5M46vGLRG+9LRppro1
aYYW0YsVpWUIzvnRClsHYKvn+m10iuwY7blO26r1SLzWWFRXlzZUOlEX07Cg
dg7PRc9UqV3VxhAVBz/LgXqNBWE9yz3Wp702VbCwuUl7yLMW6agijnmUZ03R
h9Tv+QawaT3GIyRypBjrHrfePOIR4hgTxEmWQI7jLNMQOvAM3SwLYY5Cgq0r
cNrDWehewDF293AKTmt2CIKEzU3m2DTHqzzjg2ODOnkc2DHqLR6VlysKFOqQ
VkbeEtwx98Bgq/DwTucXYFzzPbzPCoMt/cC9JJzYYwUY0zHhmF4K8qZYoJl+
vhFO7iMJjucR4Vi+CTVDU6h3LQcBd9KQVVuYBf0OMCjYO7ABX+79RDDJDUnc
ynK3pBoE4/gk6Jv9AcM2vNilrj1KkA832PQCd1Qw0SsS6H+FoP+jwecsCRw2
iWe6L4H+92XdA80SbN2Am1G3rxLoP+r21M2QUkdkEjY34ZJDlpUx9lspORQZ
+jxkBba1gkmfEGO/EwT9rjXYwoDtRUlhMaA2piYp/PaiwRYGbDWeN5gK2WoM
Nv2gDfTYlyxGOwYMNNj0glbtkbWxmO06UG2w6QOtBDiuCLSWdlxj4d6swzZV
IWgtbarBpgu2vYph22uw6YKtXjFs9QabLthuKYbtlsGmC7ZTimE7ZbDpgm27
Yti2G2y6YHtFMWyvGGy6YOsCnFAI2okQioZkcQdhBNCkCLQmYITtIBhsBpvB
Zq9Rg80cBHMQLPRhoQ+DzYK6FtS17SrbrjLY2oftjGLYzhhsumDbrRi23Qab
LtimKIZtisGmL852RCFoRyzOphO4/sBVRaBdBfrbDoJe4AYo2Uk4AQywq3z6
gXtVAWyv2iXlMGA7qQC2kwZbGOs2LWu2/gabbtjGK4JtvMGmG7YximAbY7Dp
hq1MyQHKJqDMYLMLy3Yx2WBLJPNksZplngwEtq7A4RSDdjikmqKZhs0B109Y
aaVQrQHol4U5yAxsDrhyYBVwOwWQ3XZjKc+K/pmC7X/QVQFLgR3AT4I6Cfm0
m66vHa7vqqzpnknYcsBXCpxPELTzQGnWdTbY/gNuYoKwTTSNDbb7gduWAGjb
TFuDrTUH4miMoB3NmgNgsMmA6wF8EQNoXwA9TFODrT3gOgMb8wBtI9DZtDTY
JNA96kIV9yIAds999lHTzmDLB7qBLja2FTjkKrFcd//e6v5voGnVfvtnAC9c
0Cv54m27AAAAAElFTkSuQmCC
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 17298, :content_type image/png, :filename bulb12323.png, :id #uuid "8debe2ef-4a7e-58a1-bf4c-1622dead4579", :metadata {:XMP-tiff:ResolutionUnit inches, :PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 1034, :XMP-exif:ExifImageHeight 128, :XMP-xmpMM:HistoryInstanceID [xmp.iid:d9d91f94-2644-4852-800a-2e0690e7ec33 xmp.iid:313384c6-3c39-4368-8199-59bad3780d4d], :XMP-xmpMM:DocumentID adobe:docid:photoshop:1a57f5cc-8a58-1179-8ef5-891dc2bd10cf, :XMP-xmpMM:InstanceID xmp.iid:313384c6-3c39-4368-8199-59bad3780d4d, :PNG:GreenX 0.21, :ExifTool:ExifToolVersion 10.4, :XMP-exif:ColorSpace Uncalibrated, :XMP-xmp:CreateDate 2016:07:14 15:45:41+02:00, :Composite:Megapixels 0.02, :XMP-tiff:Orientation Horizontal (normal), :PNG:WhitePointY 0.32899, :XMP-x:XMPToolkit Adobe XMP Core 5.6-c111 79.158325, 2015/09/10-01:10:20        , :System:Directory /tmp/tmp.qSpfBizLgM, :XMP-tiff:XResolution 26.2636, :XMP-photoshop:ColorMode RGB, :XMP-exif:ExifImageWidth 155, :XMP-xmpMM:HistoryAction [created saved], :System:FileSize 17 kB, :PNG:ImageHeight 128, :XMP-xmpMM:HistoryWhen [2016:07:14 15:45:41+02:00 2016:07:14 15:49:02+02:00], :File:FileTypeExtension png, :XMP-xmp:MetadataDate 2016:07:14 15:49:02+02:00, :XMP-xmp:CreatorTool Adobe Photoshop CC 2015 (Macintosh), :File:FileType PNG, :PNG:BitDepth 8, :XMP-xmpMM:HistorySoftwareAgent [Adobe Photoshop CC 2015 (Macintosh) Adobe Photoshop CC 2015 (Macintosh)], :Composite:ImageSize 155x128, :XMP-xmp:ModifyDate 2016:07:14 15:49:02+02:00, :PNG:ColorType RGB with Alpha, :PNG:WhitePointX 0.31269, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 155, :File:MIMEType image/png, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :PNG:BlueY 0.05999, :XMP-xmpMM:HistoryChanged /, :SourceFile /tmp/tmp.qSpfBizLgM/bulb12323.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG:RedX 0.63999, :PNG:GreenY 0.71, :PNG:BlueX 0.14999, :PNG:RedY 0.33, :PNG-pHYs:PixelsPerUnitX 1034, :System:FileName bulb12323.png, :XMP-tiff:YResolution 26.2636, :PNG-pHYs:PixelUnits meters, :XMP-xmpMM:OriginalDocumentID xmp.did:d9d91f94-2644-4852-800a-2e0690e7ec33, :PNG:Filter Adaptive, :XMP-dc:Format image/png}}
2023-12-11T15:36:18.064Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "dda588f4-660c-573c-a2ff-944ae93ad42e"]
>debug 4
>debug 5 {:id #uuid "2b07eb8a-4174-5257-83eb-920d536cc44a", :name Betriebseinrichtungen und Fahrzeuge}
>debug 5a id #uuid "2b07eb8a-4174-5257-83eb-920d536cc44a"
2023-12-11T15:36:18.065Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "2b07eb8a-4174-5257-83eb-920d536cc44a"]
>debug 5b {:main_category_id #uuid "2b07eb8a-4174-5257-83eb-920d536cc44a", :content iVBORw0KGgoAAAANSUhEUgAAAGwAAACACAYAAADu4Iw0AAAABHNCSVQICAgI
fAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAABE1JREFUeJzt3U+PFEUcxvHv
7AoriPEkckFI1JGErBtfAQgniJD4JtCIWRKPxkO/CfTgichJEz0QzoYEr7Ig
ARJOIokHCBDQXcLCjofaCaRpuqu6q7q6ap5P8ktIhqmpp5+dfzs7MyAiIiIi
IiIiIiIiIiIiIiIiIiIikrd9wHlgDZjM+KwB54BxpyMa0D7gPvEP1NDmHjCe
73BgQzkDLMbexABtA/aMYu+iwhrweuxNDNTqEAubxN7AkM3F3oC4UWGJUWGJ
UWGJUWGJUWGJUWGJUWGJUWGJUWGJUWGJCVXYCPgE+AG4Caxj/zKC9OwgcIn4
rx/lOl59M4BAuY83xQDCzMJ4UQwgyKxMZ8UAQszSdFIMIMCsTWvFADY/i9NK
4XABF4E9DmvHPiBDH2eFw+IXgTcd1499QIY+TgqHhduURaCQOY21wmHRtmUR
KGROY6VwWLBLWQQKmdM0KhwW61oWgULmNLUKh4V8lEWgkDnNK33rsIivsggY
NJepdNhhAZ9lETBoLvOSeeCq5Zl9l0XAoLnMS45ZnjFEWXgOl91U/YnAZxYH
9XfgCPDI4v+KR1WFfdRwHpUVUdUb+v4BdtWcZy/wV5DdGJW302KUCxsBT4DX
HM7jmwqrUb5J3EZ9WRJZuRybsnQNiKh8DXsWZRdirVzY0yi7EGsqLDFVj/h0
HzVgevdKYlRYYlRYYlRYYlRYYlRYYlRYYlRYYlRYYlRYYlRYYlRYYlRYYlRY
YlRYYlRYYlRYYlRYYlRYYqaFvfh9Xb5dAk4A7wNbgQXgA+Bz4HKAy+tb7/lC
fV/XE+Ak9dfiOWAZtw/AHMrEysf5QGGO1AQpO+o5VB9lxcoX5GsLTzqEmVoO
sI9QEzOf95/sP2j3YGYOuOJ5LyEmZr7Hc8BKiwuv8z2w0eJ8G8B3nvcSQsx8
KwCHgP/w9xP4XocNjT3uI9TEyvcvcODFhX4FbtP9JnJLh0ALHS+7j+kz3zqm
k18wTxsqjYDtmC8Orfrb+42GC9kaMFAfb4eKnW+EOfbbqTj+VXeeE2AVeLz5
77KHDZt6127vlfY2nP6gw9q2YuebYI79KhXHv82jnVsNpx9qsebU4YbT/+6w
tq3s8p2l/mq9QrsfBJtP4Pmx495tDDpfmwu+0HD6EvBVi3VPAfsb/s9vLdZ1
lV2+dzDv1Gx6dHPUYc1PLdd820uCelnm+7nhwqcbWKb+WjwPfE1zmAnwU4Ac
r5JdviWaH/5O5wrwBea53sLmfAh8if2nxj0DFkMGKsky32nLzfiY06HDVMgu
3w7geg9hrgFv9BGoJMt8Y+BuwDB3MK/expJlvo8JE+rO5tqxZZlvDNxo2KDr
zUTMa1ZZlvl28Py1orZBNjB3wDHus5pkm28J8zzG5rnHdNYxz0P6fOjeVtR8
IT+scidwHPOts4vAbuCtzdMeYH7R+Sfm1zHnMLfpKck9n4iIiIiIiIiIiIiI
iEjv/gec0agwRiP7+AAAAABJRU5ErkJggg==
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 1195, :content_type image/png, :filename fahrzeuge.png, :id #uuid "3d6cbe63-c327-5c6b-b7fa-48e6c52f2cdc", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:01+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.014, :System:Directory /tmp/tmp.qSpfBizLgM, :System:FileSize 1195 bytes, :PNG:ImageHeight 128, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 108x128, :PNG:ColorType RGB with Alpha, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 108, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:01+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/fahrzeuge.png, :System:FileAccessDate 2018:11:14 17:31:01+00:00, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName fahrzeuge.png, :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-11T15:36:18.065Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "2b07eb8a-4174-5257-83eb-920d536cc44a"]
>debug 4
>debug 5 {:id #uuid "f6827594-33a6-5760-ac41-f94ceefacfab", :name Bühnentechnik}
>debug 5a id #uuid "f6827594-33a6-5760-ac41-f94ceefacfab"
2023-12-11T15:36:18.066Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "f6827594-33a6-5760-ac41-f94ceefacfab"]
>debug 5b {:main_category_id #uuid "f6827594-33a6-5760-ac41-f94ceefacfab", :content iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAA3NCSVQICAjb
4U/gAAAACXBIWXMAAAG7AAABuwE67OPiAAAAGXRFWHRTb2Z0d2FyZQB3d3cu
aW5rc2NhcGUub3Jnm+48GgAAAM9QTFRF////AAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAA+q0M9gAAAER0Uk5TAAQGBwgJCwwQFBUbISIvMDIzNDU3ODtBREpP
UlNVVldpcXN7gIqTl6Chpqytv8PExsrS1uDj5Obo6evs7fLz9ff4/P3Djn9u
AAABnElEQVRYw+3XxXbDMBQE0AkzM3McZuY4/v9v6sKFKLEUPWXV085acxe2
9WQhNjR4mRcBACjOuUuGMfD7hnFwAYDrIFgyhCFKEgCSwiViIAUAqX/glwNx
AIi/AQQBIPgG4AEAjzpwMTfTRRlYmMBCGRiYwEAZqJlATRlImEBCFTjaTMB2
VAQ0fEZTBMJfQFgNmOA7EyWg/AOUVYAR7jKiA7fIPRC5kQENTDQqMHOzgHtG
Aw4hPCR0oAB6Fk/J6vLAtQCLFK6ywDEDy2SOcsAyCk6iSxmg6wU33u5LYJOH
MPmNEFjX3XgRd33NB5oOSMTR5AK7igxQ2QmeQd//qu7vix/iriTul3YvX2NL
1G/JfEhVfr8q9SXqOV4/p8vthVPEuh85ye7GVcCqH1jJz4OeFdCjDJTgcz+o
U0Za+xlok2bi2ffY951pU7n5CDSJY33vZPvOPfVgeZhrUfLJVGaBMhlosECD
DHRYoEMGxiwwJgNbFtjSfzDs9327wh8K8yE4/ybAnFIOPsC7fE/Z1zjlXr45
1/9JmgXSE871/wOnFjUuRak9PwAAAABJRU5ErkJggg==
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 841, :content_type image/png, :filename curtain-2.png, :id #uuid "9a8cba78-10ab-585b-a4c2-9d8e7f0818ee", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 443, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.004, :System:Directory /tmp/tmp.qSpfBizLgM, :PNG:Palette (Binary data 207 bytes, use -b option to extract), :System:FileSize 841 bytes, :PNG:ImageHeight 64, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 64x64, :PNG:ColorType Palette, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 64, :PNG:Software www.inkscape.org, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/curtain-2.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitX 443, :System:FileName curtain-2.png, :PNG:Transparency (Binary data 68 bytes, use -b option to extract), :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-11T15:36:18.067Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "f6827594-33a6-5760-ac41-f94ceefacfab"]
>debug 4
>debug 5 {:id #uuid "517b82ae-2b7e-4822-9aeb-0d4753dec821", :name Darlehen}
>debug 5a id #uuid "517b82ae-2b7e-4822-9aeb-0d4753dec821"
2023-12-11T15:36:18.067Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "517b82ae-2b7e-4822-9aeb-0d4753dec821"]
>debug 5b nil
2023-12-11T15:36:18.067Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "517b82ae-2b7e-4822-9aeb-0d4753dec821"]
>debug 4
>debug 5 {:id #uuid "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da", :name Fotografie}
>debug 5a id #uuid "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da"
2023-12-11T15:36:18.068Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da"]
>debug 5b {:main_category_id #uuid "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da", :content iVBORw0KGgoAAAANSUhEUgAAAGAAAACACAYAAAD03Gy6AAAABHNCSVQICAgI
fAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAABvdJREFUeJztnWuIVVUUx3/3
OpPaQ6d8ZKI9TM0sKyGnB72ozNKIisjqY0RQQVBQH0PqS4UZmSFB+EkqKMqi
l2JPCCwRGaWyzDzO5GPyEfmYcXzM9GHNhUHHe/a6d92zz51ZP9gg45q9197/
c+7es/ba+4LjOI7jOI7jOI7jOI7jOI7jOAOdQsr/jwbmA7OBK4DxwNBaO1Xn
HAV2Ai3AKuB9YI+2kpHAIqAT6PFSVTkMvN47pkFcA7TmwPGBVlqB5rTBnwN0
5MDZgVo6e8e4X67FP3KyEmFWadBLk3ATsBGYcCp1HFNagRnA/iG9P3gFWek4
2TASOA1YVQDGAG348jJrDgMTisBD+ODHYBgwvwjcEduTQczsAjIhTIztSY5o
B9YDXYrfGYGsIocr20oAjhB/aZaHchx4BmhQDmKJc4Dlyja7yEHH81KeVg/5
yRSBFZp2C73/GOy0ApOQt6BaLgE2hRoXDRocCKzBZvABfkcR/XQBhE7j+g6F
GroAkXEBIuMCRMYFiIwLEBkXIDIuQGRcgMi4AJFxAYQh6SYqgiOqLoAw1bCu
kcB5ocYugNBMQNJUIE+iHNfYcfi8lFZgmmbg+uF+lBtc9bQfkADfAeuAzcAu
4CDi/xnAWOBi4CrgZmB6BW10Ae8CPyNZCyEUkLyqOZTJeitH7CevXDkAvAnM
JD2T+0QmAy8ie7yx+1GuRHegv3IUWAiMUg56f5wOPAfsz0G/6kKADchZBGsm
IPn6sfuXawHeQ57YWlEEXspBP3MpwGKyWxY/nlGf6kaAt9BPstXyhJHvdS/A
F9iHAkJZGOjjgBVgBzYrnUppBH7qx69BI8B9VQ9h9VwGHGMQCvAD2X/un4ql
RBoHTSiiDfgmxaYZuDSwvrnAl4G2teZCYAthq7B24KsUmweQ8EgQoWqtCKjr
x8C6EvIXif2CMN//JX3RkATW1WM5CGciZ4xD+AjoNmzbgg8D7ZqQ2JQJlgJc
Tfhy8mvDdq1YrbANfdBSsRTgcoXtOsN2rWgDdgfamsWqLAWYHGh3EJnI8kYP
8GegbWhfU7EUYHygXSk+n0d2BdqF9jUVSwFCbwPpMGzTmtC8/iarBi0FCD1r
nLflZ19CFxHDrBq0HIzQIz7B9+ZEINQ3syW0pQChm9jjqPwoaK0JPS8dfAQp
DUsB9gXaNWCbCGVFI+F+7bVq1FKA7Qrb6wzbtWIm4fOYpq9lsRTgL4XtXYbt
WjFXYfuHVaOWAmxU2M4DzjZsu1oKwCMK+xarhi0FWI/k84QwDHjMsO1quROY
orBfY9m4ZTj6e0V9/yC3jMSmCKwl3O/tpG8kJaH1Wf9R9LnCdgySOhibR5FI
biifYhxKsXwDLlLU14P8QXObXVfUTAL+68evcuWmgHoTRX2mAoDE+jUd2o0I
lzVnIZOpxtfNhM2bSWidtYjLLFbajwZWojhVYsBw5IHSxvUXU4OdPOs3oIgs
STVPVunpyuJNaAK+rcC/XYTnrSaKes0FALi7gg72ICujWxXtaJkO/Fahb08p
2kkU9dZEgALwWYUd7QZeQzb5rWgAnqXyq5k3oAsgJoq6ayIASGRRu8LoW3Yg
B960NxH2pQH5/oNfq/DjOPoDfImi/poJAPCgov5Tlb1I9vTthInRiAT7Xsbm
Gv4FFfQ7Ca1fkxn3CXBvBc4sQq6DtOAo8AsyYe9EzpD1IB9X5yKH9GZQ3VvT
l9VImEJ7n1wCXBBqXMs3AORjQHWVY07KJuQu0EpIQtvJYn/2GPAw6XmleaIN
udI5dJOpYrLaIO8E7kEOyeWdrcAtyPxRc7LMUDiEiLA8wza1rAWuR7e5VDW1
ngNOpAA8j0xssT/n+5Z3sJu8E0W7mQtQ4gbkSYs98HuQ5bIliaL9aAKALB8X
IsvLrAe+G1iGBAOtSRR+RBWgxFTkG+e6Ff5UUz4GrqxhfxKFL7kQoMQU4A1k
+Wc96PuAJYQfoaqGROFXrgQoMRTJnHgbSRmvdNC39NYxD/nWoqxIQn3Ma4pg
F7K/XNpjHovcAzQN+RN/HBLXH4ospQ8jgb92pPObkCyNPJ5DOIk8vgH1TkLg
uOY5VXxQ4AJERiNAlpNYvaM6wBE6B7Qjmx1OeSahW6mpjBdk1o36pAHlXngB
uedS82QvQ7YIE/J32j0Wjchf1i8ANyp+70gB2AacXwuvnFS2FjHMdXfUtBSp
j12qgcrKAhKO/Rv/TuGs6QQmFpENiaWRnRmMLAH2lk56jEQSav17hbNhG5K/
dKDvD5upPHfSS3jpoMyJnDkuQs0HP/Ur5Gchr0hsZwdaSVCcRRuBbJb721B9
6QBeRY5EnUTacctRSHr3bGRHajweFU3jCHKUtQU5evUBhndLOI7jOI7jOI7j
OI7jOI7jOI5Tf/wPcYhVe1hRfeIAAAAASUVORK5CYII=
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 1877, :content_type image/png, :filename fotografie.png, :id #uuid "07a33b4c-d274-54e5-a2ce-11f26d57be05", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.012, :System:Directory /tmp/tmp.qSpfBizLgM, :System:FileSize 1877 bytes, :PNG:ImageHeight 128, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 96x128, :PNG:ColorType RGB with Alpha, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 96, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/fotografie.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName fotografie.png, :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-11T15:36:18.068Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da"]
>debug 4
>debug 5 {:id #uuid "2ea39047-e663-50d5-9080-838b75883704", :name IT & Elektronik}
>debug 5a id #uuid "2ea39047-e663-50d5-9080-838b75883704"
2023-12-11T15:36:18.069Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "2ea39047-e663-50d5-9080-838b75883704"]
>debug 5b {:main_category_id #uuid "2ea39047-e663-50d5-9080-838b75883704", :content iVBORw0KGgoAAAANSUhEUgAAAHgAAACACAYAAADApa2mAAAABHNCSVQICAgI
fAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAr5JREFUeJzt3b9qU2Ech/En
0UVbFAernQRHQZy8AtFNdJQWCgq6633oUCzeRi3qoHgBDiIugosglNY6Vq1L
/zicgC2kiel5k5N8fT7wLm15c/g9bU/+kQOSJEmSJEmSJEmSJEmSJEmSpG6m
gQfAK2AN2AH2XAfWTmc2L4H7wNSRJj1iLWAB+E7zA5y0tQHMDz7y0WkDz2h+
UJO+ljqzHCstjFtyPR1s/MO3QPNDSVtzAxU4RKvAHtPAF+Bsgb301wZwEdiq
s0mJ//VzGHcYzgF36m5SIvDtAnuou7GY7Rq9zyXL+BfezQywQu/ZrTZ2dPv0
exLDuIc7T+/Zbde9gRJ3svZGcBvJhjq/sXtArbIMHM7A4QwczsDhDBzOwOEM
HM7A4QwczsDhDBzOwOEMHM7A4QwczsDhDBzOwOEMHM7A4QwczsDhDBzOwOEM
HM7A4QwczsDhDBzOwOEMHM7A4QwczsDhDBzOwOEMHM7A4QwczsDhDBzOwOFK
BN7t8/2ZAreRarbP93dGchR99Ps44RWqT1XVQbPAC4b8ccLH624AfKD3b+JN
YL3A7fyP3tfdoMS/6OUCe6i72rMt8VnOU1QX5fBcW9Y3qoty/K6zSYm/4F/A
owL76KCH1Ixb2hLNX2soZS0OOPuRaFNdsavp4Uz6WmTMn5+Yozp/ND2oSVvr
FLhO0qicBO5RPQZepbp6SNMDHLe13ZnNc+AucOJIk5YkSWOpRXXCV6ixfryl
+gwczsDhkgNforqP8S/rckPHOHTJgY8N6WcnSgvYwqfJUm21gbdNH4WG5nWL
6lz1Dphu+GBU1g/gahv4BNzAN8YlWQOuA5/3f/EM8ITqLThNv5TmOtr6CTzu
tAS6v+nuNHALuAZcAS4Ap8i+xz2JdoFN4CvwEXhD9fr7ZpMHJUmSJEmSJEmS
JEmSJEmSJEml/QGym5SaY0sX5gAAAABJRU5ErkJggg==
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 796, :content_type image/png, :filename laptop.png, :id #uuid "1464e46c-e726-54a9-a42b-f937a0342d22", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:01+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.015, :System:Directory /tmp/tmp.qSpfBizLgM, :System:FileSize 796 bytes, :PNG:ImageHeight 128, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 120x128, :PNG:ColorType RGB with Alpha, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 120, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:01+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/laptop.png, :System:FileAccessDate 2018:11:14 17:31:01+00:00, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName laptop.png, :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-11T15:36:18.071Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "2ea39047-e663-50d5-9080-838b75883704"]
>debug 4
>debug 5 {:id #uuid "f6885671-3bf3-56f2-8e92-b5112d0f703f", :name Musikinstrumente}
>debug 5a id #uuid "f6885671-3bf3-56f2-8e92-b5112d0f703f"
2023-12-11T15:36:18.072Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "f6885671-3bf3-56f2-8e92-b5112d0f703f"]
>debug 5b {:main_category_id #uuid "f6885671-3bf3-56f2-8e92-b5112d0f703f", :content iVBORw0KGgoAAAANSUhEUgAAAI4AAACACAYAAADd91F4AAAACXBIWXMAAAsT
AAALEwEAmpwYAAA59GlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFj
a2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQi
Pz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0
az0iQWRvYmUgWE1QIENvcmUgNS42LWMxMTEgNzkuMTU4MzI1LCAyMDE1LzA5
LzEwLTAxOjEwOjIwICAgICAgICAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9
Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMi
PgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAg
ICAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8i
CiAgICAgICAgICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxl
bWVudHMvMS4xLyIKICAgICAgICAgICAgeG1sbnM6cGhvdG9zaG9wPSJodHRw
Oi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIgogICAgICAgICAgICB4
bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIK
ICAgICAgICAgICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20v
eGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgICAgICAgICAgeG1s
bnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAg
ICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8x
LjAvIj4KICAgICAgICAgPHhtcDpDcmVhdG9yVG9vbD5BZG9iZSBQaG90b3No
b3AgQ0MgMjAxNSAoTWFjaW50b3NoKTwveG1wOkNyZWF0b3JUb29sPgogICAg
ICAgICA8eG1wOkNyZWF0ZURhdGU+MjAxNi0wNy0xNFQxNTo0NjoxMSswMjow
MDwveG1wOkNyZWF0ZURhdGU+CiAgICAgICAgIDx4bXA6TW9kaWZ5RGF0ZT4y
MDE2LTA3LTE0VDE1OjQ5OjI4KzAyOjAwPC94bXA6TW9kaWZ5RGF0ZT4KICAg
ICAgICAgPHhtcDpNZXRhZGF0YURhdGU+MjAxNi0wNy0xNFQxNTo0OToyOCsw
MjowMDwveG1wOk1ldGFkYXRhRGF0ZT4KICAgICAgICAgPGRjOmZvcm1hdD5p
bWFnZS9wbmc8L2RjOmZvcm1hdD4KICAgICAgICAgPHBob3Rvc2hvcDpDb2xv
ck1vZGU+MzwvcGhvdG9zaG9wOkNvbG9yTW9kZT4KICAgICAgICAgPHhtcE1N
Okluc3RhbmNlSUQ+eG1wLmlpZDo2YzA4N2NiZS0xZjhlLTQ4YmUtYTU1YS00
ZmRmYzVkOTI2OWE8L3htcE1NOkluc3RhbmNlSUQ+CiAgICAgICAgIDx4bXBN
TTpEb2N1bWVudElEPmFkb2JlOmRvY2lkOnBob3Rvc2hvcDoyZTNiY2U2NC04
YTU4LTExNzktOGVmNS04OTFkYzJiZDEwY2Y8L3htcE1NOkRvY3VtZW50SUQ+
CiAgICAgICAgIDx4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ+eG1wLmRpZDo1
MzMwNmRlYi01NjAzLTQyZTEtOTBiMy04Nzc0MmQ2ODdhMDc8L3htcE1NOk9y
aWdpbmFsRG9jdW1lbnRJRD4KICAgICAgICAgPHhtcE1NOkhpc3Rvcnk+CiAg
ICAgICAgICAgIDxyZGY6U2VxPgogICAgICAgICAgICAgICA8cmRmOmxpIHJk
ZjpwYXJzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgICAgICAgPHN0
RXZ0OmFjdGlvbj5jcmVhdGVkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAg
ICAgICAgIDxzdEV2dDppbnN0YW5jZUlEPnhtcC5paWQ6NTMzMDZkZWItNTYw
My00MmUxLTkwYjMtODc3NDJkNjg3YTA3PC9zdEV2dDppbnN0YW5jZUlEPgog
ICAgICAgICAgICAgICAgICA8c3RFdnQ6d2hlbj4yMDE2LTA3LTE0VDE1OjQ2
OjExKzAyOjAwPC9zdEV2dDp3aGVuPgogICAgICAgICAgICAgICAgICA8c3RF
dnQ6c29mdHdhcmVBZ2VudD5BZG9iZSBQaG90b3Nob3AgQ0MgMjAxNSAoTWFj
aW50b3NoKTwvc3RFdnQ6c29mdHdhcmVBZ2VudD4KICAgICAgICAgICAgICAg
PC9yZGY6bGk+CiAgICAgICAgICAgICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlw
ZT0iUmVzb3VyY2UiPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6YWN0aW9u
PnNhdmVkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAgICAgICAgIDxzdEV2
dDppbnN0YW5jZUlEPnhtcC5paWQ6NmMwODdjYmUtMWY4ZS00OGJlLWE1NWEt
NGZkZmM1ZDkyNjlhPC9zdEV2dDppbnN0YW5jZUlEPgogICAgICAgICAgICAg
ICAgICA8c3RFdnQ6d2hlbj4yMDE2LTA3LTE0VDE1OjQ5OjI4KzAyOjAwPC9z
dEV2dDp3aGVuPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6c29mdHdhcmVB
Z2VudD5BZG9iZSBQaG90b3Nob3AgQ0MgMjAxNSAoTWFjaW50b3NoKTwvc3RF
dnQ6c29mdHdhcmVBZ2VudD4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OmNo
YW5nZWQ+Lzwvc3RFdnQ6Y2hhbmdlZD4KICAgICAgICAgICAgICAgPC9yZGY6
bGk+CiAgICAgICAgICAgIDwvcmRmOlNlcT4KICAgICAgICAgPC94bXBNTTpI
aXN0b3J5PgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9y
aWVudGF0aW9uPgogICAgICAgICA8dGlmZjpYUmVzb2x1dGlvbj43MjAwMDAv
MTAwMDA8L3RpZmY6WFJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOllSZXNv
bHV0aW9uPjcyMDAwMC8xMDAwMDwvdGlmZjpZUmVzb2x1dGlvbj4KICAgICAg
ICAgPHRpZmY6UmVzb2x1dGlvblVuaXQ+MjwvdGlmZjpSZXNvbHV0aW9uVW5p
dD4KICAgICAgICAgPGV4aWY6Q29sb3JTcGFjZT42NTUzNTwvZXhpZjpDb2xv
clNwYWNlPgogICAgICAgICA8ZXhpZjpQaXhlbFhEaW1lbnNpb24+MTQyPC9l
eGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGlt
ZW5zaW9uPjEyODwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgIDwvcmRm
OkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAo8P3hwYWNrZXQgZW5kPSJ3
Ij8+x0kGyQAAACBjSFJNAAB6JQAAgIMAAPn/AACA6AAAUggAARVYAAA6lwAA
F2/XWh+QAAAERklEQVR42uzdy4tOcRzH8ffIfUoYK7nGnlIuJZRSYutW4h+Q
+4KVUoSlUiSXWSgSFsrGJSJ2bpH7NSk7uYWZ8Vich9Bg5jyX8z3nvL/1qWma
xfk9vZrzPef5nt+hUqlgTG/jh2CEY4RjhGOEY4xwjHCMcIxwjHCMEY6JBMdq
SPUBpgHbgdtAJ9BR/Xkz0PrjD4VjDQQWAPuA10DlH7kHjBNOeasNWAGcAD78
B0t3eAYLpzw1AVgPXAK6eonlz2wSTjn6lbs1QvkzN4VT3n6llnwRTrn7ldQR
jv2KcOxXhCOc5vUrwrFfEU6Z4GTerwjHfkU4BYMTul8Rjv2KcHIKJ5f9inCy
Ow1tBO4UGYpw6lsjSYacKmWLcNLXAOB6GdEIp7ZaV1Y0wqmtbghHOGnqq3CE
k6YqwhGOcIQjHOEIRzjCEY5whCMc4QhHOMIRjnCEIxzhlAbOV+EIp6d5CxwB
FgNDhCOcf+UFsBuYC/TrzfqEUz4414EtwGSgJe36hFN8OB3AWWAVMKZe6xNO
MeG8A44Cy4ChjVifcIoD5xWwB5gH9G/0+oSTbzi3gK3AlP/0K8IpOZxO4AKw
Bhif5fqEEx/Oe+A4sBwYHmV9wokJ5zWwF5hP8qRouPUJJw6cO8A2YCrJViih
1yec7OB0kWxOsB6YSLwSTiA4H4GTwEpgBLFLOBnDeQPsBxYCg8hPCScjODuA
GUH6FeHkCE7eSzjCEY5whCMc4QhHOMIRjnCEIxzhCEc4whGOcIQjHOEIRzjC
EY5whCMc4QhHOMIpM5xWYA7Ju7PagavAS+DTL8f0mWQi8TZwGtgFLKX7Z8qF
U2A4Y4ENJEPvtb5b4gGwE5gknGLC6U+ymcBFGvdc1zXhFAdOC8nTnC/APQCF
07MaAZwBN48UTu/6mMcE21ZFOLHhtAGPCLh5k3BiwzlJ0F2/hBMXziwCbxcn
nLhw2oUjnDT1TDjCSVNdwhFOmuoMDKdDOJ6q0uSxcOLCORwYzgHhxIUzMzCc
6WWC09R5lTrhPBEQzTGAosPJbF6ljl85PAyE5gHVvZaLCCfEvEodT4ljguC5
D4z++e+2QHBCzavUuZ9qq546s1rLKWDYb+fpgsAJN6/SoEGupcDTJq7hCbCI
bl4wUgQ4IedVGng11w9YApxv0HF/I3kx2hKg718vKXMOJ+y8SpNuCYwG1gLn
gC81HOvnKpbVwKge3YvIOZyw8yoZ3FcaBMyuXkUeAq4Az0nePvOtmvfV310G
DpK8DmAWKTbuzjOc0PMqFLzyDKddOMJJA+eZcISTBk6XcISTBk7oeRXheKpK
Na8inLhwQs+rCCcunNDzKsKJfQMw7LyKcOJ/5RByXkU48b/kDDmvIpx8jFWE
m1cRTr4GucLMqwgnf6OjIeZVhJPvYfXM5lWEU5zHY5o6ryKcoHBMueKHYIRj
hGOEY4RjjHCMcIxwjHCMcIwRjqlDvg8A5/TdLBe62ugAAAAASUVORK5CYII=
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 16064, :content_type image/png, :filename music3213.png, :id #uuid "3a52eb87-b5fe-5df0-98b1-43e80f28d2dc", :metadata {:XMP-tiff:ResolutionUnit inches, :PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :XMP-exif:ExifImageHeight 128, :XMP-xmpMM:HistoryInstanceID [xmp.iid:53306deb-5603-42e1-90b3-87742d687a07 xmp.iid:6c087cbe-1f8e-48be-a55a-4fdfc5d9269a], :XMP-xmpMM:DocumentID adobe:docid:photoshop:2e3bce64-8a58-1179-8ef5-891dc2bd10cf, :XMP-xmpMM:InstanceID xmp.iid:6c087cbe-1f8e-48be-a55a-4fdfc5d9269a, :PNG:GreenX 0.21, :ExifTool:ExifToolVersion 10.4, :XMP-exif:ColorSpace Uncalibrated, :XMP-xmp:CreateDate 2016:07:14 15:46:11+02:00, :Composite:Megapixels 0.018, :XMP-tiff:Orientation Horizontal (normal), :PNG:WhitePointY 0.32899, :XMP-x:XMPToolkit Adobe XMP Core 5.6-c111 79.158325, 2015/09/10-01:10:20        , :System:Directory /tmp/tmp.qSpfBizLgM, :XMP-tiff:XResolution 72, :XMP-photoshop:ColorMode RGB, :XMP-exif:ExifImageWidth 142, :XMP-xmpMM:HistoryAction [created saved], :System:FileSize 16 kB, :PNG:ImageHeight 128, :XMP-xmpMM:HistoryWhen [2016:07:14 15:46:11+02:00 2016:07:14 15:49:28+02:00], :File:FileTypeExtension png, :XMP-xmp:MetadataDate 2016:07:14 15:49:28+02:00, :XMP-xmp:CreatorTool Adobe Photoshop CC 2015 (Macintosh), :File:FileType PNG, :PNG:BitDepth 8, :XMP-xmpMM:HistorySoftwareAgent [Adobe Photoshop CC 2015 (Macintosh) Adobe Photoshop CC 2015 (Macintosh)], :Composite:ImageSize 142x128, :XMP-xmp:ModifyDate 2016:07:14 15:49:28+02:00, :PNG:ColorType RGB with Alpha, :PNG:WhitePointX 0.31269, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 142, :File:MIMEType image/png, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :PNG:BlueY 0.05999, :XMP-xmpMM:HistoryChanged /, :SourceFile /tmp/tmp.qSpfBizLgM/music3213.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG:RedX 0.63999, :PNG:GreenY 0.71, :PNG:BlueX 0.14999, :PNG:RedY 0.33, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName music3213.png, :XMP-tiff:YResolution 72, :PNG-pHYs:PixelUnits meters, :XMP-xmpMM:OriginalDocumentID xmp.did:53306deb-5603-42e1-90b3-87742d687a07, :PNG:Filter Adaptive, :XMP-dc:Format image/png}}
2023-12-11T15:36:18.073Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "f6885671-3bf3-56f2-8e92-b5112d0f703f"]
>debug 4
>debug 5 {:id #uuid "6c8a0d77-6711-5156-a59a-12425ba01cff", :name Werkstatt-Technik}
>debug 5a id #uuid "6c8a0d77-6711-5156-a59a-12425ba01cff"
2023-12-11T15:36:18.074Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "6c8a0d77-6711-5156-a59a-12425ba01cff"]
>debug 5b {:main_category_id #uuid "6c8a0d77-6711-5156-a59a-12425ba01cff", :content iVBORw0KGgoAAAANSUhEUgAAAGYAAACACAYAAAD5whz9AAAABHNCSVQICAgI
fAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAABrVJREFUeJztnVmMVEUUhr9p
GpdhlBmGYZ8BFByJGwGNoMYlPiku8UFNiMTlQU2MRk1QYkz0QY1riNEYE8WM
4oY8EaOGoAYVFRRE2TeHYRjAiAuiYByQ8eFQ0vTC9F2qqqvnfMn/AN1dt6r+
O/d2nzp1LiiKoiiKoiiKoiiKoiiKoiiKoig2qfHdgQqiP3AuMBU4GxgPjAIa
gROBDHAA+B3YAWwB1gLLga8O/7+SElngauAdYC/QE1OHgGXAQ8BYpyOoMuqA
B4DtxDfjWPoQuNjZaKqAfsAdwM/YMSRf7wOjnYwsYFqBr3FjSK5+A8Y5GF+Q
zAD24d4Uo1n2hxgWGeA5/BliNM32QEOiP/A2fg3ZA9xpe6AhkQXew58hh4CX
gSbbAw2JGmAO/kz5HJhofZQBMgs/hnQCN6DRlKJcjlxGXBryN/AoUGt/eGHS
gMSwXJryLtDiYnAh4/K+shINuZTFebgxZDdwOxLaUcpgEXYNOQDMRi6XSpnY
/mtZCExwNpoq4nXsGLIFWavRr78xOAnYjx1jrnI4jgIyPg+eAtOQZd+qI3Rj
rvTdAVuEbswlvjtgi5CNaaKKf3WHbMyZvjtgk5CNqeo0oZCNGeG7AzYJ2Zh6
3x2wScjGHOe7AzbJ+u6A8j+DkMSNJuDZkI3p9t2BlKgF7gMeREJMAJNCNib0
7PoaJEfgGaA577UpIRuzy3cHEjAReAG4qMTr+x32JXUuxe46zI/A9aQb9m8A
XqL3hJEVKR7TOU3YNcboS2BKwr5mgFspf5fBnITH804HbszpQTJi4kQbzgKW
RDzWLTGOU1HYWr0spX+Qm3U5P24HAE8BB2McJ/ioxo24NcboF+BuJHG9GNcA
22K2vSzZlFQGdfjd97IRuJYjXxBagAUJ27w/venxSxv+jDFajKTJJj1JuoEh
Kc6NU+ry/j0Z/8akpTeST48fJgCbOBK6MCzE/6Qm1SHgjMQz5IHTgZ+QQdyb
99pk3Gf5p603E8+QB1qREIwZxA4K05Zewd+kJtVfSBWOoGgFdlI4mJl576sH
uoq8LwTdk3SSXHMaxU3pQUqMDM97/2XAvyXeX6laRGALluPpfSPS/CKfm9nL
ZypJnQT29Xgc5V+Wpud9toYw7jd7kDhaMJxKtOI7e5H7UC5ZYF6ENlzrT+CC
hPPklKimGK2nMLCYBd6K0ZZt/Qqcn3CenHIKcs2NO+BPgePz2swATydoM21t
QL7QBMNY4kdjc7WA4mlN05HfCj5NmQcMTDJJrhlDOqYYfUDxPffjgS9SPE65
2o2cGEHtTBuDnVXIpcDQIsfLALdxdBTBlrqB55F8saAYDWzF3sR0AReWOLbJ
5UrzL9VoH/AictIFRwvQjv2z9iDwCKXTafsBVwBzkTy1uMc5AHyC1AA4OcnE
GHxc91qQhSWX2yjWAHchlZFKkQUmcXR532bkUlSLmNgN/IGEidqB1chS8BLk
t0mwNCP5Wrb/UkppAVqyqoBRyN55X6bk6iPgHLvDDYORVI4pPUg12VTuBSEz
EtiMfzOMlhLYDz0bjETW6H2bYbQMNYURSN6VbzOMvqHKtweWw3Aqy5RvUVMY
hkRRfZthtBytM8YwZG3EtxlGK1BTGAqsw78ZRt8RYAAxbYYiTx/ybYbRStQU
hlB5pjRaHXEANCEBQt9mGH2PmkITEl31bYbRD8BgqyMOgMHAKvybYbQKNYXB
yNnp2wyj1ejjQGhEruO+zTBaQ2AppjZoRL7x+DZDTclhEPKDzbcZRmtRUyrO
lHUUT03qUzQg8SbfZhitR+JxfZoGJDLr2wyjDRRuVOpz1CNrGL7NUFNyqEdW
+3ybYbQRNYWByLp4lIl7Fdk4lEHyxh4nvX2Qm6iCgjdJGYhkkESZuMdKtDUj
YjvFtBlJ5ujTDCD6k7s7OXYV2sUR28vVFgLc926DuUSfvN7qnjwco0015TAZ
ZJPmTTE+ayMhvR3Zq99loe3gaCPemb2d0oXUAD6L2F47VfzYkThsJf694IkS
bd4csR01pQhxajbmqg0p55RF9rw8SbSvy1uR3WVKHkmNSaIOAt0S54IO/Jiy
DTXlmLgukWtMqeonJqXBVNya0olUwVDK4DXcmLIdqRejlMkJwMfYNaULNSUW
tSSLb/VmyjhnI6lC6pCnP6Rpyg5kz7ySkDhrMqW0EzUlVRpInhmzk8Bqc4VC
I/Hzk3dRWA5RSZEhRN8ltgupKq5YZjjlJ5F3IfX3FUcMAGYj1YdKmTIfzZBM
jairkMOA65DyUY1IKai1SFWjjel2TVEURVEURVEURVGUxPwHYcurS2vCftQA
AAAASUVORK5CYII=
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 1811, :content_type image/png, :filename werkzeug.png, :id #uuid "f4e1f230-df2e-5e95-bf89-827f7a6b4b3b", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.013, :System:Directory /tmp/tmp.qSpfBizLgM, :System:FileSize 1811 bytes, :PNG:ImageHeight 128, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 102x128, :PNG:ColorType RGB with Alpha, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 102, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/werkzeug.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName werkzeug.png, :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-11T15:36:18.074Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "6c8a0d77-6711-5156-a59a-12425ba01cff"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.076Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.077Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete3
2023-12-11T15:36:18.078Z NX-41294 DEBUG [leihs.procurement.resources.main-category:?] - (sql-format (sql/select (vector [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] :result))) => ["SELECT NOT EXISTS (SELECT TRUE FROM procurement_requests AS pr INNER JOIN procurement_categories AS pc ON pc.id = pr.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AND NOT EXISTS (SELECT TRUE FROM procurement_templates AS pt INNER JOIN procurement_categories AS pc ON pc.id = pt.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AS result" #uuid "519f7a95-9ca7-5256-bf63-142cfc23dc62" #uuid "519f7a95-9ca7-5256-bf63-142cfc23dc62"]
2023-12-11T15:36:18.079Z NX-41294 DEBUG [leihs.procurement.resources.main-category:154] - (-> (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format spy)) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.080Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.080Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.080Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.081Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.081Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.081Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.085Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.086Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "4e48b48c-e1bf-50d7-ab2d-9aa438c638de"]
2023-12-11T15:36:18.086Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "4e48b48c-e1bf-50d7-ab2d-9aa438c638de"]
>o> inspector? {:result false}
2023-12-11T15:36:18.088Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "4e48b48c-e1bf-50d7-ab2d-9aa438c638de"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.091Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.092Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.092Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.092Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.093Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.093Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.095Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.096Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "a1727606-c7c8-54a2-aaa1-ceff7a7d4b40"]
2023-12-11T15:36:18.096Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "a1727606-c7c8-54a2-aaa1-ceff7a7d4b40"]
>o> inspector? {:result false}
2023-12-11T15:36:18.096Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "a1727606-c7c8-54a2-aaa1-ceff7a7d4b40"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.097Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.097Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.098Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.098Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.099Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.099Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.100Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.101Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "00382e27-a87a-5313-b31b-a369dad6c5f8"]
2023-12-11T15:36:18.101Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "00382e27-a87a-5313-b31b-a369dad6c5f8"]
>o> inspector? {:result false}
2023-12-11T15:36:18.102Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "00382e27-a87a-5313-b31b-a369dad6c5f8"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.103Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.103Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.104Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.104Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.104Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.104Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.106Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.107Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "ce5424cc-ce77-5e67-8201-333ec20963eb"]
2023-12-11T15:36:18.107Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "ce5424cc-ce77-5e67-8201-333ec20963eb"]
>o> inspector? {:result false}
2023-12-11T15:36:18.108Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "ce5424cc-ce77-5e67-8201-333ec20963eb"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.109Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.110Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.110Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.110Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.111Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.111Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.112Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.112Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "ce0812d7-080b-5f49-8530-dd4a821c57b6"]
2023-12-11T15:36:18.112Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "ce0812d7-080b-5f49-8530-dd4a821c57b6"]
>o> inspector? {:result false}
2023-12-11T15:36:18.113Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "ce0812d7-080b-5f49-8530-dd4a821c57b6"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.113Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.114Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.116Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.116Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.116Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.117Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.118Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.119Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "67e5fc60-6fe3-53bb-9495-3669b917038a"]
2023-12-11T15:36:18.119Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "67e5fc60-6fe3-53bb-9495-3669b917038a"]
>o> inspector? {:result false}
2023-12-11T15:36:18.119Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "67e5fc60-6fe3-53bb-9495-3669b917038a"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.121Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.121Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.122Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.122Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.123Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.123Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.126Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.127Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "f94f72e8-ff65-5bad-b1f9-81ddd8fa7c0c"]
2023-12-11T15:36:18.127Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "f94f72e8-ff65-5bad-b1f9-81ddd8fa7c0c"]
>o> inspector? {:result false}
2023-12-11T15:36:18.127Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "f94f72e8-ff65-5bad-b1f9-81ddd8fa7c0c"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.129Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.129Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.130Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.130Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.130Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.131Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.132Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.132Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "89e4a22f-7d6c-5006-b26a-3ef6f8f19630"]
2023-12-11T15:36:18.132Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "89e4a22f-7d6c-5006-b26a-3ef6f8f19630"]
>o> inspector? {:result false}
2023-12-11T15:36:18.132Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "89e4a22f-7d6c-5006-b26a-3ef6f8f19630"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.133Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.134Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.134Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.134Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.135Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.135Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.136Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.137Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "1fb59e17-a703-5abc-8a80-fc7a9c20ee1d"]
2023-12-11T15:36:18.137Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "1fb59e17-a703-5abc-8a80-fc7a9c20ee1d"]
>o> inspector? {:result false}
2023-12-11T15:36:18.137Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "1fb59e17-a703-5abc-8a80-fc7a9c20ee1d"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.138Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.139Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.140Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.140Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.140Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.140Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.141Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.142Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "c17698c1-5d5d-51ea-927f-b6ca96431a50"]
2023-12-11T15:36:18.142Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "c17698c1-5d5d-51ea-927f-b6ca96431a50"]
>o> inspector? {:result false}
2023-12-11T15:36:18.144Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "c17698c1-5d5d-51ea-927f-b6ca96431a50"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.144Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.145Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.145Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.145Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.146Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.147Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.148Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.148Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "fabe3b8c-58b5-5009-8873-cc3e945a7c0d"]
2023-12-11T15:36:18.149Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "fabe3b8c-58b5-5009-8873-cc3e945a7c0d"]
>o> inspector? {:result false}
2023-12-11T15:36:18.149Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "fabe3b8c-58b5-5009-8873-cc3e945a7c0d"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.150Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.151Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.152Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.152Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.152Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.152Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.157Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.157Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "ebb12585-ce23-5cbe-8f4f-41a42d60a656"]
2023-12-11T15:36:18.158Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "ebb12585-ce23-5cbe-8f4f-41a42d60a656"]
>o> inspector? {:result false}
2023-12-11T15:36:18.158Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "ebb12585-ce23-5cbe-8f4f-41a42d60a656"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.159Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.159Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete3
2023-12-11T15:36:18.160Z NX-41294 DEBUG [leihs.procurement.resources.main-category:?] - (sql-format (sql/select (vector [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] :result))) => ["SELECT NOT EXISTS (SELECT TRUE FROM procurement_requests AS pr INNER JOIN procurement_categories AS pc ON pc.id = pr.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AND NOT EXISTS (SELECT TRUE FROM procurement_templates AS pt INNER JOIN procurement_categories AS pc ON pc.id = pt.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AS result" #uuid "1a047acd-dc98-52c2-99d3-dc6332adc1e0" #uuid "1a047acd-dc98-52c2-99d3-dc6332adc1e0"]
2023-12-11T15:36:18.161Z NX-41294 DEBUG [leihs.procurement.resources.main-category:154] - (-> (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format spy)) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.161Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.161Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.161Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.162Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.162Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.162Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.163Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.163Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "0a082661-cc1c-5b49-baab-f4db926faa7e"]
2023-12-11T15:36:18.164Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "0a082661-cc1c-5b49-baab-f4db926faa7e"]
>o> inspector? {:result false}
2023-12-11T15:36:18.164Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "0a082661-cc1c-5b49-baab-f4db926faa7e"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.165Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.165Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.166Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.166Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.166Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.166Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.168Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.168Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "42cc2d9a-cc45-5d77-85d3-0f21270d7a35"]
2023-12-11T15:36:18.168Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "42cc2d9a-cc45-5d77-85d3-0f21270d7a35"]
>o> inspector? {:result false}
2023-12-11T15:36:18.169Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "42cc2d9a-cc45-5d77-85d3-0f21270d7a35"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.169Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.169Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.170Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.170Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.170Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.171Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.173Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.173Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "56aaec64-8d65-50b3-bd81-f788d477b927"]
2023-12-11T15:36:18.173Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "56aaec64-8d65-50b3-bd81-f788d477b927"]
>o> inspector? {:result false}
2023-12-11T15:36:18.174Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "56aaec64-8d65-50b3-bd81-f788d477b927"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.175Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.175Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.175Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.176Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.176Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.177Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.178Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.178Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "483ac871-b632-5dcd-9d37-789d65f4c424"]
2023-12-11T15:36:18.178Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "483ac871-b632-5dcd-9d37-789d65f4c424"]
>o> inspector? {:result false}
2023-12-11T15:36:18.179Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "483ac871-b632-5dcd-9d37-789d65f4c424"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.179Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.180Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.180Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.181Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.181Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.181Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.182Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.182Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "2b3749a2-6a59-5a25-9b9f-32f5e485e635"]
2023-12-11T15:36:18.182Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "2b3749a2-6a59-5a25-9b9f-32f5e485e635"]
>o> inspector? {:result false}
2023-12-11T15:36:18.183Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "2b3749a2-6a59-5a25-9b9f-32f5e485e635"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.183Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.184Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.184Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.184Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.185Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.185Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.186Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.186Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "fad911e4-8c69-535c-a138-f3e2544519ba"]
2023-12-11T15:36:18.186Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "fad911e4-8c69-535c-a138-f3e2544519ba"]
>o> inspector? {:result false}
2023-12-11T15:36:18.189Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "fad911e4-8c69-535c-a138-f3e2544519ba"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.190Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.190Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.191Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.191Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.191Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.191Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.193Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.193Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "c3f14f79-931c-52c8-a847-ed77449ce9a6"]
2023-12-11T15:36:18.193Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "c3f14f79-931c-52c8-a847-ed77449ce9a6"]
>o> inspector? {:result false}
2023-12-11T15:36:18.193Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "c3f14f79-931c-52c8-a847-ed77449ce9a6"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.194Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.194Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete3
2023-12-11T15:36:18.194Z NX-41294 DEBUG [leihs.procurement.resources.main-category:?] - (sql-format (sql/select (vector [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] :result))) => ["SELECT NOT EXISTS (SELECT TRUE FROM procurement_requests AS pr INNER JOIN procurement_categories AS pc ON pc.id = pr.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AND NOT EXISTS (SELECT TRUE FROM procurement_templates AS pt INNER JOIN procurement_categories AS pc ON pc.id = pt.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AS result" #uuid "dda588f4-660c-573c-a2ff-944ae93ad42e" #uuid "dda588f4-660c-573c-a2ff-944ae93ad42e"]
2023-12-11T15:36:18.195Z NX-41294 DEBUG [leihs.procurement.resources.main-category:154] - (-> (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format spy)) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.195Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.196Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.196Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.196Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.196Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.197Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.199Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.199Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "b9e4f492-55e3-57e4-9467-91c81bfe2325"]
2023-12-11T15:36:18.200Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "b9e4f492-55e3-57e4-9467-91c81bfe2325"]
>o> inspector? {:result false}
2023-12-11T15:36:18.200Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "b9e4f492-55e3-57e4-9467-91c81bfe2325"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.201Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.202Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.202Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.202Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.203Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.205Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.207Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.207Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "a7cca5a4-e265-5f36-b794-1024c8aacc3e"]
2023-12-11T15:36:18.208Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "a7cca5a4-e265-5f36-b794-1024c8aacc3e"]
>o> inspector? {:result false}
2023-12-11T15:36:18.208Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "a7cca5a4-e265-5f36-b794-1024c8aacc3e"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.209Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.209Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.210Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.210Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.211Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.211Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.212Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.212Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "79822b89-0edb-588c-b9e5-65b7722ac50b"]
2023-12-11T15:36:18.212Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "79822b89-0edb-588c-b9e5-65b7722ac50b"]
>o> inspector? {:result false}
2023-12-11T15:36:18.213Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "79822b89-0edb-588c-b9e5-65b7722ac50b"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.213Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.213Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.214Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.214Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.214Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.215Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.215Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.215Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "ab911807-6431-5ca7-890a-3573737bb4d3"]
2023-12-11T15:36:18.216Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "ab911807-6431-5ca7-890a-3573737bb4d3"]
>o> inspector? {:result false}
2023-12-11T15:36:18.216Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "ab911807-6431-5ca7-890a-3573737bb4d3"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.216Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.217Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.217Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.217Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.218Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.218Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.219Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.219Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "64c6f8ad-a1b7-530b-946a-ebb1644ac897"]
2023-12-11T15:36:18.219Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "64c6f8ad-a1b7-530b-946a-ebb1644ac897"]
>o> inspector? {:result false}
2023-12-11T15:36:18.220Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "64c6f8ad-a1b7-530b-946a-ebb1644ac897"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.221Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.221Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.221Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.221Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.222Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.222Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.224Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.224Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "f2bb3f23-bb5b-5855-b03f-0166bd19fc0c"]
2023-12-11T15:36:18.224Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "f2bb3f23-bb5b-5855-b03f-0166bd19fc0c"]
>o> inspector? {:result false}
2023-12-11T15:36:18.225Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "f2bb3f23-bb5b-5855-b03f-0166bd19fc0c"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.225Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.225Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete3
2023-12-11T15:36:18.226Z NX-41294 DEBUG [leihs.procurement.resources.main-category:?] - (sql-format (sql/select (vector [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] :result))) => ["SELECT NOT EXISTS (SELECT TRUE FROM procurement_requests AS pr INNER JOIN procurement_categories AS pc ON pc.id = pr.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AND NOT EXISTS (SELECT TRUE FROM procurement_templates AS pt INNER JOIN procurement_categories AS pc ON pc.id = pt.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AS result" #uuid "2b07eb8a-4174-5257-83eb-920d536cc44a" #uuid "2b07eb8a-4174-5257-83eb-920d536cc44a"]
2023-12-11T15:36:18.227Z NX-41294 DEBUG [leihs.procurement.resources.main-category:154] - (-> (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format spy)) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.227Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.228Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.228Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.228Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.229Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.229Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.231Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.231Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "5d8639a3-4569-5009-af28-f63f2af5209d"]
2023-12-11T15:36:18.231Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "5d8639a3-4569-5009-af28-f63f2af5209d"]
>o> inspector? {:result false}
2023-12-11T15:36:18.232Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "5d8639a3-4569-5009-af28-f63f2af5209d"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.232Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.232Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.233Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.233Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.233Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.234Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.234Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.235Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "b34f1cbb-4ac7-59a0-81f2-3ca7ecc94e71"]
2023-12-11T15:36:18.235Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "b34f1cbb-4ac7-59a0-81f2-3ca7ecc94e71"]
>o> inspector? {:result false}
2023-12-11T15:36:18.235Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "b34f1cbb-4ac7-59a0-81f2-3ca7ecc94e71"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.236Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.239Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.240Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.240Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.240Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.241Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.242Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.242Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "73e97867-43ea-5bee-b46b-d7c74fbf873b"]
2023-12-11T15:36:18.242Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "73e97867-43ea-5bee-b46b-d7c74fbf873b"]
>o> inspector? {:result false}
2023-12-11T15:36:18.243Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "73e97867-43ea-5bee-b46b-d7c74fbf873b"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.244Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.244Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.245Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.245Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.245Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.246Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.246Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.247Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "b6601a86-b5d3-5682-88b6-cff956b00d7b"]
2023-12-11T15:36:18.247Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "b6601a86-b5d3-5682-88b6-cff956b00d7b"]
>o> inspector? {:result false}
2023-12-11T15:36:18.247Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "b6601a86-b5d3-5682-88b6-cff956b00d7b"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.248Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.248Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete3
2023-12-11T15:36:18.248Z NX-41294 DEBUG [leihs.procurement.resources.main-category:?] - (sql-format (sql/select (vector [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] :result))) => ["SELECT NOT EXISTS (SELECT TRUE FROM procurement_requests AS pr INNER JOIN procurement_categories AS pc ON pc.id = pr.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AND NOT EXISTS (SELECT TRUE FROM procurement_templates AS pt INNER JOIN procurement_categories AS pc ON pc.id = pt.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AS result" #uuid "f6827594-33a6-5760-ac41-f94ceefacfab" #uuid "f6827594-33a6-5760-ac41-f94ceefacfab"]
2023-12-11T15:36:18.249Z NX-41294 DEBUG [leihs.procurement.resources.main-category:154] - (-> (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format spy)) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.250Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.250Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.250Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.250Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.251Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.252Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.253Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.254Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "455bc6dc-afbd-579d-a621-6d75e0fca9ea"]
2023-12-11T15:36:18.254Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "455bc6dc-afbd-579d-a621-6d75e0fca9ea"]
>o> inspector? {:result false}
2023-12-11T15:36:18.254Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "455bc6dc-afbd-579d-a621-6d75e0fca9ea"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.256Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.257Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.257Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.257Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.258Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.258Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.259Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.259Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "747b6b21-9fad-4a01-acd9-cd8983aed286"]
2023-12-11T15:36:18.259Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "747b6b21-9fad-4a01-acd9-cd8983aed286"]
>o> inspector? {:result false}
2023-12-11T15:36:18.259Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "747b6b21-9fad-4a01-acd9-cd8983aed286"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.260Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.260Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.261Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.261Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.261Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.261Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.262Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.262Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "07a6af37-e127-5f4b-94ec-698a5698d98c"]
2023-12-11T15:36:18.262Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "07a6af37-e127-5f4b-94ec-698a5698d98c"]
>o> inspector? {:result false}
2023-12-11T15:36:18.262Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "07a6af37-e127-5f4b-94ec-698a5698d98c"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.263Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.263Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete3
2023-12-11T15:36:18.263Z NX-41294 DEBUG [leihs.procurement.resources.main-category:?] - (sql-format (sql/select (vector [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] :result))) => ["SELECT NOT EXISTS (SELECT TRUE FROM procurement_requests AS pr INNER JOIN procurement_categories AS pc ON pc.id = pr.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AND NOT EXISTS (SELECT TRUE FROM procurement_templates AS pt INNER JOIN procurement_categories AS pc ON pc.id = pt.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AS result" #uuid "517b82ae-2b7e-4822-9aeb-0d4753dec821" #uuid "517b82ae-2b7e-4822-9aeb-0d4753dec821"]
2023-12-11T15:36:18.264Z NX-41294 DEBUG [leihs.procurement.resources.main-category:154] - (-> (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format spy)) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.264Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.265Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.266Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.266Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.266Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.266Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.267Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.268Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "671ab85c-b8c1-4659-9c6e-9ebe2f122a59"]
2023-12-11T15:36:18.268Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "671ab85c-b8c1-4659-9c6e-9ebe2f122a59"]
>o> inspector? {:result false}
2023-12-11T15:36:18.268Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "671ab85c-b8c1-4659-9c6e-9ebe2f122a59"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.269Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.269Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete3
2023-12-11T15:36:18.269Z NX-41294 DEBUG [leihs.procurement.resources.main-category:?] - (sql-format (sql/select (vector [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] :result))) => ["SELECT NOT EXISTS (SELECT TRUE FROM procurement_requests AS pr INNER JOIN procurement_categories AS pc ON pc.id = pr.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AND NOT EXISTS (SELECT TRUE FROM procurement_templates AS pt INNER JOIN procurement_categories AS pc ON pc.id = pt.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AS result" #uuid "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da" #uuid "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da"]
2023-12-11T15:36:18.272Z NX-41294 DEBUG [leihs.procurement.resources.main-category:154] - (-> (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format spy)) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.272Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.273Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.273Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.273Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.273Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.273Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.274Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.274Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "e1b4cad8-0416-5cf7-9e4a-dde208d0abad"]
2023-12-11T15:36:18.274Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "e1b4cad8-0416-5cf7-9e4a-dde208d0abad"]
>o> inspector? {:result false}
2023-12-11T15:36:18.275Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "e1b4cad8-0416-5cf7-9e4a-dde208d0abad"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.276Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.277Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.277Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.277Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.277Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.278Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.278Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.278Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "011ff3f3-09fa-59e1-9713-52466786adf8"]
2023-12-11T15:36:18.278Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "011ff3f3-09fa-59e1-9713-52466786adf8"]
>o> inspector? {:result false}
2023-12-11T15:36:18.279Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "011ff3f3-09fa-59e1-9713-52466786adf8"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.279Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.280Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.280Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.280Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.280Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.281Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.281Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.282Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "54b87eb0-061c-5a97-96ad-e9b6da605184"]
2023-12-11T15:36:18.282Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "54b87eb0-061c-5a97-96ad-e9b6da605184"]
>o> inspector? {:result false}
2023-12-11T15:36:18.282Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "54b87eb0-061c-5a97-96ad-e9b6da605184"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.283Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.283Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.284Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.284Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.284Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.284Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.285Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.285Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "5858ec5d-5f01-50fb-bc96-4b4766bd7799"]
2023-12-11T15:36:18.285Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "5858ec5d-5f01-50fb-bc96-4b4766bd7799"]
>o> inspector? {:result false}
2023-12-11T15:36:18.286Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "5858ec5d-5f01-50fb-bc96-4b4766bd7799"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.287Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.287Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.290Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.291Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.291Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.291Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.292Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.293Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "ba5b41a7-4317-5160-9b82-b0931a48aec0"]
2023-12-11T15:36:18.293Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "ba5b41a7-4317-5160-9b82-b0931a48aec0"]
>o> inspector? {:result false}
2023-12-11T15:36:18.293Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "ba5b41a7-4317-5160-9b82-b0931a48aec0"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.294Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.294Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.294Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.294Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.295Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.295Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.296Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.296Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "9df68a66-4523-5072-aa31-1df9abeaa1c7"]
2023-12-11T15:36:18.296Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "9df68a66-4523-5072-aa31-1df9abeaa1c7"]
>o> inspector? {:result false}
2023-12-11T15:36:18.297Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "9df68a66-4523-5072-aa31-1df9abeaa1c7"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.297Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.305Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete3
2023-12-11T15:36:18.305Z NX-41294 DEBUG [leihs.procurement.resources.main-category:?] - (sql-format (sql/select (vector [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] :result))) => ["SELECT NOT EXISTS (SELECT TRUE FROM procurement_requests AS pr INNER JOIN procurement_categories AS pc ON pc.id = pr.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AND NOT EXISTS (SELECT TRUE FROM procurement_templates AS pt INNER JOIN procurement_categories AS pc ON pc.id = pt.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AS result" #uuid "2ea39047-e663-50d5-9080-838b75883704" #uuid "2ea39047-e663-50d5-9080-838b75883704"]
2023-12-11T15:36:18.306Z NX-41294 DEBUG [leihs.procurement.resources.main-category:154] - (-> (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format spy)) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.307Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.307Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.308Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.308Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.308Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.308Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.310Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.310Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "f2531d7e-d9ff-5c3e-9e88-6d3a16a89aa1"]
2023-12-11T15:36:18.310Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "f2531d7e-d9ff-5c3e-9e88-6d3a16a89aa1"]
>o> inspector? {:result false}
2023-12-11T15:36:18.311Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "f2531d7e-d9ff-5c3e-9e88-6d3a16a89aa1"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.311Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.311Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.312Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.312Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.312Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.312Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.313Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.313Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "1af3a7f2-b16a-4203-b6ac-f2c7be612d74"]
2023-12-11T15:36:18.315Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "1af3a7f2-b16a-4203-b6ac-f2c7be612d74"]
>o> inspector? {:result false}
2023-12-11T15:36:18.315Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "1af3a7f2-b16a-4203-b6ac-f2c7be612d74"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.316Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.317Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.317Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.317Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.317Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.318Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.318Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.319Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "ccab158d-79c7-5c28-a8a2-47cb4925f101"]
2023-12-11T15:36:18.319Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "ccab158d-79c7-5c28-a8a2-47cb4925f101"]
>o> inspector? {:result false}
2023-12-11T15:36:18.319Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "ccab158d-79c7-5c28-a8a2-47cb4925f101"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.320Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.320Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.322Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.322Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.322Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.323Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.324Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.324Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "eb1e7bef-80c6-4958-b16e-35555735ce61"]
2023-12-11T15:36:18.324Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "eb1e7bef-80c6-4958-b16e-35555735ce61"]
>o> inspector? {:result false}
2023-12-11T15:36:18.324Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "eb1e7bef-80c6-4958-b16e-35555735ce61"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.325Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.325Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.325Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.325Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.326Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.326Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.327Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.327Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "4ecc9e97-2d12-5173-bd8c-781482c842e8"]
2023-12-11T15:36:18.327Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "4ecc9e97-2d12-5173-bd8c-781482c842e8"]
>o> inspector? {:result false}
2023-12-11T15:36:18.327Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "4ecc9e97-2d12-5173-bd8c-781482c842e8"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.328Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.328Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.328Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.328Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.329Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.329Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.330Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.331Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "80226a51-c17a-5fd8-93db-40aef5b03491"]
2023-12-11T15:36:18.331Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "80226a51-c17a-5fd8-93db-40aef5b03491"]
>o> inspector? {:result false}
2023-12-11T15:36:18.331Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "80226a51-c17a-5fd8-93db-40aef5b03491"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.331Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.332Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.332Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.332Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.332Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.332Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.333Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.333Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "fe602c35-1097-52d0-acd0-40579d295f00"]
2023-12-11T15:36:18.333Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "fe602c35-1097-52d0-acd0-40579d295f00"]
>o> inspector? {:result false}
2023-12-11T15:36:18.334Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "fe602c35-1097-52d0-acd0-40579d295f00"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.334Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.334Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.335Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.335Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.335Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.335Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.336Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.336Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "56065d53-cd2f-5a39-9b66-532fd83ad2e6"]
2023-12-11T15:36:18.336Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "56065d53-cd2f-5a39-9b66-532fd83ad2e6"]
>o> inspector? {:result false}
2023-12-11T15:36:18.337Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "56065d53-cd2f-5a39-9b66-532fd83ad2e6"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.337Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.337Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.338Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.338Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.338Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.338Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.339Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.339Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "fc7bc38c-62f3-5576-802f-c874e06ee776"]
2023-12-11T15:36:18.340Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "fc7bc38c-62f3-5576-802f-c874e06ee776"]
>o> inspector? {:result false}
2023-12-11T15:36:18.340Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "fc7bc38c-62f3-5576-802f-c874e06ee776"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.341Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.341Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.341Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.341Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.342Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.342Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.343Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.344Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "76fdca98-4a2a-5640-bc98-f33059d6ffa0"]
2023-12-11T15:36:18.344Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "76fdca98-4a2a-5640-bc98-f33059d6ffa0"]
>o> inspector? {:result false}
2023-12-11T15:36:18.344Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "76fdca98-4a2a-5640-bc98-f33059d6ffa0"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.345Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.346Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.346Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.346Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.346Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.346Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.347Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.347Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "77857566-03d9-58f4-8b0d-290227434aff"]
2023-12-11T15:36:18.347Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "77857566-03d9-58f4-8b0d-290227434aff"]
>o> inspector? {:result false}
2023-12-11T15:36:18.348Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "77857566-03d9-58f4-8b0d-290227434aff"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.348Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.348Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.349Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.349Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.349Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.349Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.350Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.350Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "5059c4fc-d34c-5c9a-9efe-257c7ec6fb6b"]
2023-12-11T15:36:18.350Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "5059c4fc-d34c-5c9a-9efe-257c7ec6fb6b"]
>o> inspector? {:result false}
2023-12-11T15:36:18.350Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "5059c4fc-d34c-5c9a-9efe-257c7ec6fb6b"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.351Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.351Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete3
2023-12-11T15:36:18.351Z NX-41294 DEBUG [leihs.procurement.resources.main-category:?] - (sql-format (sql/select (vector [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] :result))) => ["SELECT NOT EXISTS (SELECT TRUE FROM procurement_requests AS pr INNER JOIN procurement_categories AS pc ON pc.id = pr.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AND NOT EXISTS (SELECT TRUE FROM procurement_templates AS pt INNER JOIN procurement_categories AS pc ON pc.id = pt.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AS result" #uuid "f6885671-3bf3-56f2-8e92-b5112d0f703f" #uuid "f6885671-3bf3-56f2-8e92-b5112d0f703f"]
2023-12-11T15:36:18.352Z NX-41294 DEBUG [leihs.procurement.resources.main-category:154] - (-> (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format spy)) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.352Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.352Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.353Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.353Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.353Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.353Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.354Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.354Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "af3372a1-63a8-52dc-850e-c2ae91c1c078"]
2023-12-11T15:36:18.354Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "af3372a1-63a8-52dc-850e-c2ae91c1c078"]
>o> inspector? {:result false}
2023-12-11T15:36:18.355Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "af3372a1-63a8-52dc-850e-c2ae91c1c078"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.355Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.355Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.356Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.356Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.356Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.357Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.357Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.357Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "17a52112-1986-5074-b1d9-0faff29a785b"]
2023-12-11T15:36:18.357Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "17a52112-1986-5074-b1d9-0faff29a785b"]
>o> inspector? {:result false}
2023-12-11T15:36:18.358Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "17a52112-1986-5074-b1d9-0faff29a785b"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.358Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.359Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete3
2023-12-11T15:36:18.359Z NX-41294 DEBUG [leihs.procurement.resources.main-category:?] - (sql-format (sql/select (vector [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] :result))) => ["SELECT NOT EXISTS (SELECT TRUE FROM procurement_requests AS pr INNER JOIN procurement_categories AS pc ON pc.id = pr.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AND NOT EXISTS (SELECT TRUE FROM procurement_templates AS pt INNER JOIN procurement_categories AS pc ON pc.id = pt.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AS result" #uuid "6c8a0d77-6711-5156-a59a-12425ba01cff" #uuid "6c8a0d77-6711-5156-a59a-12425ba01cff"]
2023-12-11T15:36:18.360Z NX-41294 DEBUG [leihs.procurement.resources.main-category:154] - (-> (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format spy)) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.360Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.360Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.360Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.360Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.361Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.361Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.361Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.361Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "6870a16c-9a71-5e60-b94a-f0b784398fec"]
2023-12-11T15:36:18.362Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "6870a16c-9a71-5e60-b94a-f0b784398fec"]
>o> inspector? {:result false}
2023-12-11T15:36:18.362Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "6870a16c-9a71-5e60-b94a-f0b784398fec"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.362Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.363Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.363Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.363Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.363Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.363Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.364Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.364Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "771fddcf-b19a-5e6b-8b6f-7266b6922c4f"]
2023-12-11T15:36:18.364Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "771fddcf-b19a-5e6b-8b6f-7266b6922c4f"]
>o> inspector? {:result false}
2023-12-11T15:36:18.365Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "771fddcf-b19a-5e6b-8b6f-7266b6922c4f"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.365Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.365Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.365Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.365Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.366Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.366Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.366Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.366Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "c7ece4a6-2b5c-409f-96ea-e4fd6e8f9792"]
2023-12-11T15:36:18.367Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "c7ece4a6-2b5c-409f-96ea-e4fd6e8f9792"]
>o> inspector? {:result false}
2023-12-11T15:36:18.367Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "c7ece4a6-2b5c-409f-96ea-e4fd6e8f9792"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.368Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.368Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>> can-delete1
2023-12-11T15:36:18.368Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-11T15:36:18.368Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.368Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.369Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.370Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.370Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "3eaad5d5-516a-5610-8caf-342cfdcaac62"]
2023-12-11T15:36:18.370Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "3eaad5d5-516a-5610-8caf-342cfdcaac62"]
>o> inspector? {:result false}
2023-12-11T15:36:18.370Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "3eaad5d5-516a-5610-8caf-342cfdcaac62"]

>request-grapql _> request {:leihs-user-language {:name Deutsch, :locale de-CH, :default true, :active true}, :authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 90abade9-82d6-4fb6-9898-f7566773263f}, leihs-user-session {:value 3d37de50-dd5a-42c5-bca6-445a84997cf0}}, :remote-addr 127.0.0.1, :start-time 20604829100500, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type application/json, cookie leihs-anti-csrf-token=90abade9-82d6-4fb6-9898-f7566773263f; leihs-user-session=3d37de50-dd5a-42c5-bca6-445a84997cf0, content-length 595, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/admin/categories/f68856713bf356f28e92b5112d0f703f, connection keep-alive, pragma no-cache, x-csrf-token 90abade9-82d6-4fb6-9898-f7566773263f, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x264b1bf9 /127.0.0.1:3230<->/127.0.0.1:65348], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x29d7116a HikariDataSource (db-pool)]}, :content-length 595, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:operationName MainCategories, :variables {}, :query query MainCategories {
  main_categories {
    ...MainCatProps
    __typename
  }
}

fragment MainCatProps on MainCategory {
  id
  name
  can_delete
  image_url
  categories {
    id
    name
    can_delete
    cost_center
    general_ledger_account
    procurement_account
    inspectors {
      ...UserProps
      __typename
    }
    viewers {
      ...UserProps
      __typename
    }
    __typename
  }
  __typename
}

fragment UserProps on User {
  id
  firstname
  lastname
  __typename
}
}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0x46dd5e9 leihs.procurement.graphql$handler@46dd5e9], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>request-c-grapql _> request (json) {"leihs-user-language":{"name":"Deutsch","locale":"de-CH","default":true,"active":true},"authenticated-entity":{"email":"manuel.radl@zhdk.ch","contracts_count":1,"lastname":"Radl","org_id":"271682","scope_read":true,"is_admin":true,"authentication-method":"session","login":"mradl","scope_system_admin_write":true,"scope_write":true,"firstname":"Manuel","scope_admin_write":true,"user_session_created_at":"2023-12-11T13:47:06.369416Z","id":"a786135f-c159-4618-9dd3-0012ebb3d500","user_session_id":"eaf44d43-6c37-4367-8386-da902cc69e3e","scope_system_admin_read":true,"access-rights":[{"role":"customer","inventory_pool_id":"3977012c-ce0e-501f-889b-8715fdb5d83b"},{"role":"customer","inventory_pool_id":"5863967f-9804-4909-a9b7-92254616d6b2"},{"role":"customer","inventory_pool_id":"5dd25b58-fa56-5095-bd97-2696d92c2fb1"},{"role":"customer","inventory_pool_id":"77e88ec8-9ff6-5435-818e-dc902fc631a6"},{"role":"inventory_manager","inventory_pool_id":"8bd16d45-056d-5590-bc7f-12849f034351"},{"role":"inventory_manager","inventory_pool_id":"a02b8163-9a16-5066-b48e-9eb74cf8b791"},{"role":"inventory_manager","inventory_pool_id":"b534b07c-d9bf-4572-840c-0a630b8cd8ed"},{"role":"customer","inventory_pool_id":"fc5a841e-36c6-5dc3-8207-1306c1fb89bf"},{"role":"customer","inventory_pool_id":"ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}],"user_id":"a786135f-c159-4618-9dd3-0012ebb3d500","is_system_admin":true,"external_sign_out_url":null,"language_locale":"de-CH","inventory_pool_roles_count":9,"scope_admin_read":true},"cookies":{"leihs-anti-csrf-token":{"value":"90abade9-82d6-4fb6-9898-f7566773263f"},"leihs-user-session":{"value":"3d37de50-dd5a-42c5-bca6-445a84997cf0"}},"remote-addr":"127.0.0.1","start-time":20604829100500,"params":{},"settings":{"email_sending_enabled":false,"sessions_max_lifetime_secs":432000,"smtp_default_from_address":"noreply@zhdk.ch","public_image_caching_enabled":true,"sessions_force_secure":false,"deliver_received_order_notifications":false,"external_base_url":"http:\/\/localhost:3200","sessions_force_uniqueness":false,"email_signature":"Das ZHdK-Ausleihe-Team"},"query-params-raw":{},"route-params":null,"headers":{"origin":"http:\/\/localhost:3230","sec-fetch-site":"same-origin","sec-ch-ua-mobile":"?0","host":"localhost:3230","user-agent":"Mozilla\/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit\/537.36 (KHTML, like Gecko) Chrome\/119.0.0.0 Safari\/537.36","content-type":"application\/json","cookie":"leihs-anti-csrf-token=90abade9-82d6-4fb6-9898-f7566773263f; leihs-user-session=3d37de50-dd5a-42c5-bca6-445a84997cf0","content-length":"595","sec-ch-ua":"\"Google Chrome\";v=\"119\", \"Chromium\";v=\"119\", \"Not?A_Brand\";v=\"24\"","sec-ch-ua-platform":"\"macOS\"","referer":"http:\/\/localhost:3230\/procure\/admin\/categories\/f68856713bf356f28e92b5112d0f703f","connection":"keep-alive","pragma":"no-cache","x-csrf-token":"90abade9-82d6-4fb6-9898-f7566773263f","accept":"application\/json","accept-language":"de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7","sec-fetch-dest":"empty","accept-encoding":"gzip, deflate, br","sec-fetch-mode":"cors","cache-control":"no-cache"},"server-port":3230,"params-raw":{},"content-length":595,"form-params":{},"websocket?":false,"query-params":{},"content-type":"application\/json","form-params-raw":{},"character-encoding":"utf8","uri":"\/procure\/graphql","server-name":"localhost","handler-key":"graphql","query-string":null,"body":{"operationName":"MainCategories","variables":{},"query":"query MainCategories {\n  main_categories {\n    ...MainCatProps\n    __typename\n  }\n}\n\nfragment MainCatProps on MainCategory {\n  id\n  name\n  can_delete\n  image_url\n  categories {\n    id\n    name\n    can_delete\n    cost_center\n    general_ledger_account\n    procurement_account\n    inspectors {\n      ...UserProps\n      __typename\n    }\n    viewers {\n      ...UserProps\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment UserProps on User {\n  id\n  firstname\n  lastname\n  __typename\n}\n"},"multipart-params":{},"scheme":"http","request-method":"post","accept":{"mime":"json","charset":null,"encoding":null,"language":null}}

>request-grapql _> result => {:data #ordered/map ([:main_categories [#ordered/map ([:id 519f7a95-9ca7-5256-bf63-142cfc23dc62] [:name Audio- und Videotechnik] [:can_delete false] [:image_url /procure/images/ee215167-b2c3-5fcc-90c3-098ad20d16ea] [:categories [#ordered/map ([:id 4e48b48c-e1bf-50d7-ab2d-9aa438c638de] [:name Beamer] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id a1727606-c7c8-54a2-aaa1-ceff7a7d4b40] [:name Funk-Strecken] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 00382e27-a87a-5313-b31b-a369dad6c5f8] [:name Lautsprecher] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id ce5424cc-ce77-5e67-8201-333ec20963eb] [:name Lautsprecherstative] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id ce0812d7-080b-5f49-8530-dd4a821c57b6] [:name Mikrofone] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 67e5fc60-6fe3-53bb-9495-3669b917038a] [:name Mikrofonstative] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id f94f72e8-ff65-5bad-b1f9-81ddd8fa7c0c] [:name Monitore / Screens] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 89e4a22f-7d6c-5006-b26a-3ef6f8f19630] [:name Schnittplatz / Mischpult / Regie] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 1fb59e17-a703-5abc-8a80-fc7a9c20ee1d] [:name Video/Film-Kameras] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id c17698c1-5d5d-51ea-927f-b6ca96431a50] [:name Video/Film-Stative] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id fabe3b8c-58b5-5009-8873-cc3e945a7c0d] [:name Video/Filmobjektive] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id ebb12585-ce23-5cbe-8f4f-41a42d60a656] [:name Zuteilung unbekannt - Audio- und Videotechnik] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id c0777d74-668b-5e01-abb5-f8277baa0ea8] [:firstname Matus] [:lastname Kmit] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 8a9d832a-cf4c-5253-bcaa-385ef03565c1] [:firstname Nadja] [:lastname Weisskopf-Admin] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id 1a047acd-dc98-52c2-99d3-dc6332adc1e0] [:name Bauliche Anpassungen und Mobiliar] [:can_delete false] [:image_url /procure/images/8e07c37e-d244-514d-bfa9-306158056160] [:categories [#ordered/map ([:id 0a082661-cc1c-5b49-baab-f4db926faa7e] [:name Bauprojekte] [:can_delete false] [:cost_center 11410210] [:general_ledger_account 5069097000] [:procurement_account 3119097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 797264c9-a2c2-5642-9c1a-d45b01f4fdc5] [:firstname Heike] [:lastname Heldt] [:__typename :User]) #ordered/map ([:id 2c1de10b-6145-56d6-a76e-3c207cfc35a1] [:firstname Marco] [:lastname Castellano] [:__typename :User]) #ordered/map ([:id 57bb6aaa-95fb-435f-8dd9-d0b853bf2279] [:firstname Pascale] [:lastname Gisel] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 42cc2d9a-cc45-5d77-85d3-0f21270d7a35] [:name Einrichtungsprojekte] [:can_delete false] [:cost_center 11410220] [:general_ledger_account 5069097000] [:procurement_account 3110097001] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 797264c9-a2c2-5642-9c1a-d45b01f4fdc5] [:firstname Heike] [:lastname Heldt] [:__typename :User]) #ordered/map ([:id 2c1de10b-6145-56d6-a76e-3c207cfc35a1] [:firstname Marco] [:lastname Castellano] [:__typename :User]) #ordered/map ([:id 57bb6aaa-95fb-435f-8dd9-d0b853bf2279] [:firstname Pascale] [:lastname Gisel] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 56aaec64-8d65-50b3-bd81-f788d477b927] [:name Mobiliarergänzungen] [:can_delete false] [:cost_center 11410220] [:general_ledger_account 5069097000] [:procurement_account 3110097001] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 797264c9-a2c2-5642-9c1a-d45b01f4fdc5] [:firstname Heike] [:lastname Heldt] [:__typename :User]) #ordered/map ([:id 2c1de10b-6145-56d6-a76e-3c207cfc35a1] [:firstname Marco] [:lastname Castellano] [:__typename :User]) #ordered/map ([:id 57bb6aaa-95fb-435f-8dd9-d0b853bf2279] [:firstname Pascale] [:lastname Gisel] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 483ac871-b632-5dcd-9d37-789d65f4c424] [:name Schliessanlagen und Türen] [:can_delete false] [:cost_center 11410210] [:general_ledger_account 5069097000] [:procurement_account 3119097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 797264c9-a2c2-5642-9c1a-d45b01f4fdc5] [:firstname Heike] [:lastname Heldt] [:__typename :User]) #ordered/map ([:id 2c1de10b-6145-56d6-a76e-3c207cfc35a1] [:firstname Marco] [:lastname Castellano] [:__typename :User]) #ordered/map ([:id 57bb6aaa-95fb-435f-8dd9-d0b853bf2279] [:firstname Pascale] [:lastname Gisel] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 2b3749a2-6a59-5a25-9b9f-32f5e485e635] [:name Signaletik] [:can_delete false] [:cost_center 11410210] [:general_ledger_account 5069097000] [:procurement_account 3119097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 797264c9-a2c2-5642-9c1a-d45b01f4fdc5] [:firstname Heike] [:lastname Heldt] [:__typename :User]) #ordered/map ([:id 2c1de10b-6145-56d6-a76e-3c207cfc35a1] [:firstname Marco] [:lastname Castellano] [:__typename :User]) #ordered/map ([:id 57bb6aaa-95fb-435f-8dd9-d0b853bf2279] [:firstname Pascale] [:lastname Gisel] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id fad911e4-8c69-535c-a138-f3e2544519ba] [:name Vorhänge] [:can_delete false] [:cost_center 11410210] [:general_ledger_account 5069097000] [:procurement_account 3119097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 797264c9-a2c2-5642-9c1a-d45b01f4fdc5] [:firstname Heike] [:lastname Heldt] [:__typename :User]) #ordered/map ([:id 2c1de10b-6145-56d6-a76e-3c207cfc35a1] [:firstname Marco] [:lastname Castellano] [:__typename :User]) #ordered/map ([:id 57bb6aaa-95fb-435f-8dd9-d0b853bf2279] [:firstname Pascale] [:lastname Gisel] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id c3f14f79-931c-52c8-a847-ed77449ce9a6] [:name Zuteilung unbekannt - Bauliche Anpassungen und Mobiliar] [:can_delete false] [:cost_center 11410220] [:general_ledger_account 5069097000] [:procurement_account 3119097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 797264c9-a2c2-5642-9c1a-d45b01f4fdc5] [:firstname Heike] [:lastname Heldt] [:__typename :User]) #ordered/map ([:id 2c1de10b-6145-56d6-a76e-3c207cfc35a1] [:firstname Marco] [:lastname Castellano] [:__typename :User]) #ordered/map ([:id 57bb6aaa-95fb-435f-8dd9-d0b853bf2279] [:firstname Pascale] [:lastname Gisel] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id dda588f4-660c-573c-a2ff-944ae93ad42e] [:name Beleuchtungstechnik] [:can_delete false] [:image_url /procure/images/8debe2ef-4a7e-58a1-bf4c-1622dead4579] [:categories [#ordered/map ([:id b9e4f492-55e3-57e4-9467-91c81bfe2325] [:name Bühnenlicht] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User])]] [:viewers [#ordered/map ([:id 8448b7b2-f5d9-4590-8355-2295b50bba40] [:firstname Sergej] [:lastname Tratar Baamonde] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id a7cca5a4-e265-5f36-b794-1024c8aacc3e] [:name Film-Beleuchtung] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User])]] [:viewers [#ordered/map ([:id 8448b7b2-f5d9-4590-8355-2295b50bba40] [:firstname Sergej] [:lastname Tratar Baamonde] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id 79822b89-0edb-588c-b9e5-65b7722ac50b] [:name Kameralicht] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User])]] [:viewers [#ordered/map ([:id 8448b7b2-f5d9-4590-8355-2295b50bba40] [:firstname Sergej] [:lastname Tratar Baamonde] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id ab911807-6431-5ca7-890a-3573737bb4d3] [:name Mobiles Raumlicht für Ausstellungen] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 2c1de10b-6145-56d6-a76e-3c207cfc35a1] [:firstname Marco] [:lastname Castellano] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 64c6f8ad-a1b7-530b-946a-ebb1644ac897] [:name Studio-Licht] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User])]] [:viewers [#ordered/map ([:id 8448b7b2-f5d9-4590-8355-2295b50bba40] [:firstname Sergej] [:lastname Tratar Baamonde] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id f2bb3f23-bb5b-5855-b03f-0166bd19fc0c] [:name Zuteilung unbekannt - Beleuchtungstechnik] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User])]] [:viewers [#ordered/map ([:id 8448b7b2-f5d9-4590-8355-2295b50bba40] [:firstname Sergej] [:lastname Tratar Baamonde] [:__typename :User])]] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id 2b07eb8a-4174-5257-83eb-920d536cc44a] [:name Betriebseinrichtungen und Fahrzeuge] [:can_delete false] [:image_url /procure/images/3d6cbe63-c327-5c6b-b7fa-48e6c52f2cdc] [:categories [#ordered/map ([:id 5d8639a3-4569-5009-af28-f63f2af5209d] [:name Betriebseinrichtungen] [:can_delete false] [:cost_center 11410200] [:general_ledger_account 5061097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 2c1de10b-6145-56d6-a76e-3c207cfc35a1] [:firstname Marco] [:lastname Castellano] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id b34f1cbb-4ac7-59a0-81f2-3ca7ecc94e71] [:name Fahrzeuge] [:can_delete false] [:cost_center 11410200] [:general_ledger_account 5061097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 2c1de10b-6145-56d6-a76e-3c207cfc35a1] [:firstname Marco] [:lastname Castellano] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 73e97867-43ea-5bee-b46b-d7c74fbf873b] [:name Hub- und Hebegeräte] [:can_delete false] [:cost_center 11410200] [:general_ledger_account 5061097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 2c1de10b-6145-56d6-a76e-3c207cfc35a1] [:firstname Marco] [:lastname Castellano] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id b6601a86-b5d3-5682-88b6-cff956b00d7b] [:name Zuteilung unbekannt - Betriebseinrichtungen und Fahrzeuge] [:can_delete false] [:cost_center 11410200] [:general_ledger_account 5061097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 2c1de10b-6145-56d6-a76e-3c207cfc35a1] [:firstname Marco] [:lastname Castellano] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id f6827594-33a6-5760-ac41-f94ceefacfab] [:name Bühnentechnik] [:can_delete false] [:image_url /procure/images/9a8cba78-10ab-585b-a4c2-9d8e7f0818ee] [:categories [#ordered/map ([:id 455bc6dc-afbd-579d-a621-6d75e0fca9ea] [:name Bühnentechnik] [:can_delete false] [:cost_center 11410500] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id 428a72a9-36df-52fa-880f-64db35843013] [:firstname Dominik] [:lastname Fedier] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 8448b7b2-f5d9-4590-8355-2295b50bba40] [:firstname Sergej] [:lastname Tratar Baamonde] [:__typename :User])]] [:viewers [#ordered/map ([:id 8448b7b2-f5d9-4590-8355-2295b50bba40] [:firstname Sergej] [:lastname Tratar Baamonde] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id 747b6b21-9fad-4a01-acd9-cd8983aed286] [:name Fundus] [:can_delete false] [:cost_center 11410500] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id 428a72a9-36df-52fa-880f-64db35843013] [:firstname Dominik] [:lastname Fedier] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User])]] [:viewers [#ordered/map ([:id 8448b7b2-f5d9-4590-8355-2295b50bba40] [:firstname Sergej] [:lastname Tratar Baamonde] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id 07a6af37-e127-5f4b-94ec-698a5698d98c] [:name Zuteilung unbekannt - Bühnentechnik] [:can_delete false] [:cost_center 11410500] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id 428a72a9-36df-52fa-880f-64db35843013] [:firstname Dominik] [:lastname Fedier] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 8448b7b2-f5d9-4590-8355-2295b50bba40] [:firstname Sergej] [:lastname Tratar Baamonde] [:__typename :User])]] [:viewers [#ordered/map ([:id 8448b7b2-f5d9-4590-8355-2295b50bba40] [:firstname Sergej] [:lastname Tratar Baamonde] [:__typename :User])]] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id 517b82ae-2b7e-4822-9aeb-0d4753dec821] [:name Darlehen] [:can_delete false] [:image_url nil] [:categories [#ordered/map ([:id 671ab85c-b8c1-4659-9c6e-9ebe2f122a59] [:name Darlehen] [:can_delete false] [:cost_center 11410101] [:general_ledger_account 5064097000] [:procurement_account ] [:inspectors [#ordered/map ([:id b610f5bd-6da8-5122-94f0-c0bbf1b7ed73] [:firstname Daniel] [:lastname Fischer] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id ca1d97ac-0ac4-597a-8edb-f9c466b1c7da] [:name Fotografie] [:can_delete false] [:image_url /procure/images/07a33b4c-d274-54e5-a2ce-11f26d57be05] [:categories [#ordered/map ([:id e1b4cad8-0416-5cf7-9e4a-dde208d0abad] [:name Blitzanlagen] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 011ff3f3-09fa-59e1-9713-52466786adf8] [:name Fotokameras] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 54b87eb0-061c-5a97-96ad-e9b6da605184] [:name Fotostative] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 5858ec5d-5f01-50fb-bc96-4b4766bd7799] [:name Kompakt-Blitze] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id ba5b41a7-4317-5160-9b82-b0931a48aec0] [:name Objektive] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 9df68a66-4523-5072-aa31-1df9abeaa1c7] [:name Zuteilung unbekannt - Fotografie] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id 2ea39047-e663-50d5-9080-838b75883704] [:name IT & Elektronik] [:can_delete false] [:image_url /procure/images/1464e46c-e726-54a9-a42b-f937a0342d22] [:categories [#ordered/map ([:id f2531d7e-d9ff-5c3e-9e88-6d3a16a89aa1] [:name Desktop] [:can_delete false] [:cost_center 11410660] [:general_ledger_account 5064097000] [:procurement_account 3113097000] [:inspectors [#ordered/map ([:id e9656e43-9f35-502d-b495-eec36093208e] [:firstname Christian] [:lastname Wildhaber] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 28552e7e-f8be-5019-bdad-846babd8c642] [:firstname Hugo] [:lastname Vögtle] [:__typename :User]) #ordered/map ([:id 301988e6-5e0e-43a9-bcb6-3d0022b7ca99] [:firstname Lars] [:lastname Gnädinger] [:__typename :User]) #ordered/map ([:id 0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d] [:firstname Lenny Ron] [:lastname Frei] [:__typename :User]) #ordered/map ([:id b5d09795-0b94-423d-a645-bae0aed895ce] [:firstname Lukas] [:lastname Brupbacher] [:__typename :User]) #ordered/map ([:id b41e6486-ec39-4855-8d8a-c03aa83af233] [:firstname Matthias] [:lastname Daniels] [:__typename :User]) #ordered/map ([:id 8a9d832a-cf4c-5253-bcaa-385ef03565c1] [:firstname Nadja] [:lastname Weisskopf-Admin] [:__typename :User]) #ordered/map ([:id 4884241c-8104-5c10-a393-0e21dcd1a46e] [:firstname Patrice] [:lastname Huber] [:__typename :User]) #ordered/map ([:id 52c2d39d-7f53-592f-8142-824afbaf59d3] [:firstname Tilo] [:lastname Seiring] [:__typename :User]) #ordered/map ([:id 96c5a731-ae34-5ede-917c-90a42dc66a1e] [:firstname Ugo] [:lastname De Vito] [:__typename :User])]] [:viewers [#ordered/map ([:id b363936a-fd9c-567a-82a4-f0b523dbb26b] [:firstname Beat] [:lastname Rohrer] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id 1af3a7f2-b16a-4203-b6ac-f2c7be612d74] [:name IT_Projekte] [:can_delete false] [:cost_center 11410650] [:general_ledger_account 5064097000] [:procurement_account 3118097000] [:inspectors [#ordered/map ([:id e9656e43-9f35-502d-b495-eec36093208e] [:firstname Christian] [:lastname Wildhaber] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 28552e7e-f8be-5019-bdad-846babd8c642] [:firstname Hugo] [:lastname Vögtle] [:__typename :User]) #ordered/map ([:id 301988e6-5e0e-43a9-bcb6-3d0022b7ca99] [:firstname Lars] [:lastname Gnädinger] [:__typename :User]) #ordered/map ([:id 0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d] [:firstname Lenny Ron] [:lastname Frei] [:__typename :User]) #ordered/map ([:id b5d09795-0b94-423d-a645-bae0aed895ce] [:firstname Lukas] [:lastname Brupbacher] [:__typename :User]) #ordered/map ([:id b41e6486-ec39-4855-8d8a-c03aa83af233] [:firstname Matthias] [:lastname Daniels] [:__typename :User]) #ordered/map ([:id 4884241c-8104-5c10-a393-0e21dcd1a46e] [:firstname Patrice] [:lastname Huber] [:__typename :User]) #ordered/map ([:id 52c2d39d-7f53-592f-8142-824afbaf59d3] [:firstname Tilo] [:lastname Seiring] [:__typename :User]) #ordered/map ([:id 96c5a731-ae34-5ede-917c-90a42dc66a1e] [:firstname Ugo] [:lastname De Vito] [:__typename :User])]] [:viewers [#ordered/map ([:id b363936a-fd9c-567a-82a4-f0b523dbb26b] [:firstname Beat] [:lastname Rohrer] [:__typename :User]) #ordered/map ([:id b5d09795-0b94-423d-a645-bae0aed895ce] [:firstname Lukas] [:lastname Brupbacher] [:__typename :User]) #ordered/map ([:id 233a038c-66fb-4036-9149-762c10a5b72e] [:firstname Maria] [:lastname Krause] [:__typename :User]) #ordered/map ([:id d65e52a5-0404-4069-b6a0-7e8ef60dc1e1] [:firstname Maurizio] [:lastname Mattiola] [:__typename :User]) #ordered/map ([:id 119a33c1-151f-4579-8c79-0d3225d4b9b6] [:firstname Michael] [:lastname Bozenicar] [:__typename :User]) #ordered/map ([:id 45b1cf11-1f50-5d8b-aedf-5d8b83b19a52] [:firstname Monika] [:lastname Petschen] [:__typename :User]) #ordered/map ([:id 8160a951-8900-448d-8c3e-e31ec60fd3f3] [:firstname Stefan] [:lastname Uhle] [:__typename :User]) #ordered/map ([:id a4d8f8c9-8f5e-444f-b2cf-67e53f7d3d0c] [:firstname Thomas] [:lastname Bickel] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id ccab158d-79c7-5c28-a8a2-47cb4925f101] [:name IT-Basisinfrastruktur] [:can_delete false] [:cost_center 11410640] [:general_ledger_account 5064097000] [:procurement_account 3113097000] [:inspectors [#ordered/map ([:id e9656e43-9f35-502d-b495-eec36093208e] [:firstname Christian] [:lastname Wildhaber] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 28552e7e-f8be-5019-bdad-846babd8c642] [:firstname Hugo] [:lastname Vögtle] [:__typename :User]) #ordered/map ([:id 301988e6-5e0e-43a9-bcb6-3d0022b7ca99] [:firstname Lars] [:lastname Gnädinger] [:__typename :User]) #ordered/map ([:id 0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d] [:firstname Lenny Ron] [:lastname Frei] [:__typename :User]) #ordered/map ([:id b41e6486-ec39-4855-8d8a-c03aa83af233] [:firstname Matthias] [:lastname Daniels] [:__typename :User]) #ordered/map ([:id 4884241c-8104-5c10-a393-0e21dcd1a46e] [:firstname Patrice] [:lastname Huber] [:__typename :User]) #ordered/map ([:id 52c2d39d-7f53-592f-8142-824afbaf59d3] [:firstname Tilo] [:lastname Seiring] [:__typename :User]) #ordered/map ([:id 96c5a731-ae34-5ede-917c-90a42dc66a1e] [:firstname Ugo] [:lastname De Vito] [:__typename :User])]] [:viewers [#ordered/map ([:id b363936a-fd9c-567a-82a4-f0b523dbb26b] [:firstname Beat] [:lastname Rohrer] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id eb1e7bef-80c6-4958-b16e-35555735ce61] [:name IT-Security] [:can_delete false] [:cost_center 11410600] [:general_ledger_account 5064097000] [:procurement_account 3113097000] [:inspectors [#ordered/map ([:id 3651eeeb-0fb1-4840-80dd-6c739bda6c57] [:firstname Christian] [:lastname Schneider] [:__typename :User]) #ordered/map ([:id 301988e6-5e0e-43a9-bcb6-3d0022b7ca99] [:firstname Lars] [:lastname Gnädinger] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 4ecc9e97-2d12-5173-bd8c-781482c842e8] [:name Laptops] [:can_delete false] [:cost_center 11410660] [:general_ledger_account 5064097000] [:procurement_account 3113097000] [:inspectors [#ordered/map ([:id e9656e43-9f35-502d-b495-eec36093208e] [:firstname Christian] [:lastname Wildhaber] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 28552e7e-f8be-5019-bdad-846babd8c642] [:firstname Hugo] [:lastname Vögtle] [:__typename :User]) #ordered/map ([:id 301988e6-5e0e-43a9-bcb6-3d0022b7ca99] [:firstname Lars] [:lastname Gnädinger] [:__typename :User]) #ordered/map ([:id 0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d] [:firstname Lenny Ron] [:lastname Frei] [:__typename :User]) #ordered/map ([:id b41e6486-ec39-4855-8d8a-c03aa83af233] [:firstname Matthias] [:lastname Daniels] [:__typename :User]) #ordered/map ([:id 4884241c-8104-5c10-a393-0e21dcd1a46e] [:firstname Patrice] [:lastname Huber] [:__typename :User]) #ordered/map ([:id 52c2d39d-7f53-592f-8142-824afbaf59d3] [:firstname Tilo] [:lastname Seiring] [:__typename :User]) #ordered/map ([:id 96c5a731-ae34-5ede-917c-90a42dc66a1e] [:firstname Ugo] [:lastname De Vito] [:__typename :User])]] [:viewers [#ordered/map ([:id b363936a-fd9c-567a-82a4-f0b523dbb26b] [:firstname Beat] [:lastname Rohrer] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id 80226a51-c17a-5fd8-93db-40aef5b03491] [:name Monitore] [:can_delete false] [:cost_center 11410660] [:general_ledger_account 5064097000] [:procurement_account 3113097000] [:inspectors [#ordered/map ([:id e9656e43-9f35-502d-b495-eec36093208e] [:firstname Christian] [:lastname Wildhaber] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 28552e7e-f8be-5019-bdad-846babd8c642] [:firstname Hugo] [:lastname Vögtle] [:__typename :User]) #ordered/map ([:id 301988e6-5e0e-43a9-bcb6-3d0022b7ca99] [:firstname Lars] [:lastname Gnädinger] [:__typename :User]) #ordered/map ([:id 0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d] [:firstname Lenny Ron] [:lastname Frei] [:__typename :User]) #ordered/map ([:id b41e6486-ec39-4855-8d8a-c03aa83af233] [:firstname Matthias] [:lastname Daniels] [:__typename :User]) #ordered/map ([:id 4884241c-8104-5c10-a393-0e21dcd1a46e] [:firstname Patrice] [:lastname Huber] [:__typename :User]) #ordered/map ([:id 52c2d39d-7f53-592f-8142-824afbaf59d3] [:firstname Tilo] [:lastname Seiring] [:__typename :User]) #ordered/map ([:id 96c5a731-ae34-5ede-917c-90a42dc66a1e] [:firstname Ugo] [:lastname De Vito] [:__typename :User])]] [:viewers [#ordered/map ([:id b363936a-fd9c-567a-82a4-f0b523dbb26b] [:firstname Beat] [:lastname Rohrer] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id fe602c35-1097-52d0-acd0-40579d295f00] [:name Scanner] [:can_delete false] [:cost_center 11410660] [:general_ledger_account 5064097000] [:procurement_account 3113097000] [:inspectors [#ordered/map ([:id e9656e43-9f35-502d-b495-eec36093208e] [:firstname Christian] [:lastname Wildhaber] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 28552e7e-f8be-5019-bdad-846babd8c642] [:firstname Hugo] [:lastname Vögtle] [:__typename :User]) #ordered/map ([:id 301988e6-5e0e-43a9-bcb6-3d0022b7ca99] [:firstname Lars] [:lastname Gnädinger] [:__typename :User]) #ordered/map ([:id 0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d] [:firstname Lenny Ron] [:lastname Frei] [:__typename :User]) #ordered/map ([:id b41e6486-ec39-4855-8d8a-c03aa83af233] [:firstname Matthias] [:lastname Daniels] [:__typename :User]) #ordered/map ([:id 4884241c-8104-5c10-a393-0e21dcd1a46e] [:firstname Patrice] [:lastname Huber] [:__typename :User]) #ordered/map ([:id 52c2d39d-7f53-592f-8142-824afbaf59d3] [:firstname Tilo] [:lastname Seiring] [:__typename :User]) #ordered/map ([:id 96c5a731-ae34-5ede-917c-90a42dc66a1e] [:firstname Ugo] [:lastname De Vito] [:__typename :User])]] [:viewers [#ordered/map ([:id b363936a-fd9c-567a-82a4-f0b523dbb26b] [:firstname Beat] [:lastname Rohrer] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id 56065d53-cd2f-5a39-9b66-532fd83ad2e6] [:name Schnittstellengeräte] [:can_delete false] [:cost_center 11410660] [:general_ledger_account 5064097000] [:procurement_account 3113097000] [:inspectors [#ordered/map ([:id e9656e43-9f35-502d-b495-eec36093208e] [:firstname Christian] [:lastname Wildhaber] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 28552e7e-f8be-5019-bdad-846babd8c642] [:firstname Hugo] [:lastname Vögtle] [:__typename :User]) #ordered/map ([:id 301988e6-5e0e-43a9-bcb6-3d0022b7ca99] [:firstname Lars] [:lastname Gnädinger] [:__typename :User]) #ordered/map ([:id 0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d] [:firstname Lenny Ron] [:lastname Frei] [:__typename :User]) #ordered/map ([:id b41e6486-ec39-4855-8d8a-c03aa83af233] [:firstname Matthias] [:lastname Daniels] [:__typename :User]) #ordered/map ([:id 4884241c-8104-5c10-a393-0e21dcd1a46e] [:firstname Patrice] [:lastname Huber] [:__typename :User]) #ordered/map ([:id 52c2d39d-7f53-592f-8142-824afbaf59d3] [:firstname Tilo] [:lastname Seiring] [:__typename :User]) #ordered/map ([:id 96c5a731-ae34-5ede-917c-90a42dc66a1e] [:firstname Ugo] [:lastname De Vito] [:__typename :User])]] [:viewers [#ordered/map ([:id b363936a-fd9c-567a-82a4-f0b523dbb26b] [:firstname Beat] [:lastname Rohrer] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id fc7bc38c-62f3-5576-802f-c874e06ee776] [:name Software] [:can_delete false] [:cost_center 11410660] [:general_ledger_account 5064097000] [:procurement_account 3118097000] [:inspectors [#ordered/map ([:id e9656e43-9f35-502d-b495-eec36093208e] [:firstname Christian] [:lastname Wildhaber] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 28552e7e-f8be-5019-bdad-846babd8c642] [:firstname Hugo] [:lastname Vögtle] [:__typename :User]) #ordered/map ([:id 301988e6-5e0e-43a9-bcb6-3d0022b7ca99] [:firstname Lars] [:lastname Gnädinger] [:__typename :User]) #ordered/map ([:id 0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d] [:firstname Lenny Ron] [:lastname Frei] [:__typename :User]) #ordered/map ([:id b41e6486-ec39-4855-8d8a-c03aa83af233] [:firstname Matthias] [:lastname Daniels] [:__typename :User]) #ordered/map ([:id 8a9d832a-cf4c-5253-bcaa-385ef03565c1] [:firstname Nadja] [:lastname Weisskopf-Admin] [:__typename :User]) #ordered/map ([:id 4884241c-8104-5c10-a393-0e21dcd1a46e] [:firstname Patrice] [:lastname Huber] [:__typename :User]) #ordered/map ([:id 52c2d39d-7f53-592f-8142-824afbaf59d3] [:firstname Tilo] [:lastname Seiring] [:__typename :User]) #ordered/map ([:id 96c5a731-ae34-5ede-917c-90a42dc66a1e] [:firstname Ugo] [:lastname De Vito] [:__typename :User])]] [:viewers [#ordered/map ([:id b363936a-fd9c-567a-82a4-f0b523dbb26b] [:firstname Beat] [:lastname Rohrer] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id 76fdca98-4a2a-5640-bc98-f33059d6ffa0] [:name Tablets] [:can_delete false] [:cost_center 11410660] [:general_ledger_account 5064097000] [:procurement_account 3113097000] [:inspectors [#ordered/map ([:id e9656e43-9f35-502d-b495-eec36093208e] [:firstname Christian] [:lastname Wildhaber] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 28552e7e-f8be-5019-bdad-846babd8c642] [:firstname Hugo] [:lastname Vögtle] [:__typename :User]) #ordered/map ([:id 301988e6-5e0e-43a9-bcb6-3d0022b7ca99] [:firstname Lars] [:lastname Gnädinger] [:__typename :User]) #ordered/map ([:id 0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d] [:firstname Lenny Ron] [:lastname Frei] [:__typename :User]) #ordered/map ([:id b41e6486-ec39-4855-8d8a-c03aa83af233] [:firstname Matthias] [:lastname Daniels] [:__typename :User]) #ordered/map ([:id 4884241c-8104-5c10-a393-0e21dcd1a46e] [:firstname Patrice] [:lastname Huber] [:__typename :User]) #ordered/map ([:id 52c2d39d-7f53-592f-8142-824afbaf59d3] [:firstname Tilo] [:lastname Seiring] [:__typename :User]) #ordered/map ([:id 96c5a731-ae34-5ede-917c-90a42dc66a1e] [:firstname Ugo] [:lastname De Vito] [:__typename :User])]] [:viewers [#ordered/map ([:id b363936a-fd9c-567a-82a4-f0b523dbb26b] [:firstname Beat] [:lastname Rohrer] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id 77857566-03d9-58f4-8b0d-290227434aff] [:name Telefon] [:can_delete false] [:cost_center 11410660] [:general_ledger_account 5064097000] [:procurement_account 3113097000] [:inspectors [#ordered/map ([:id e9656e43-9f35-502d-b495-eec36093208e] [:firstname Christian] [:lastname Wildhaber] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 28552e7e-f8be-5019-bdad-846babd8c642] [:firstname Hugo] [:lastname Vögtle] [:__typename :User]) #ordered/map ([:id 301988e6-5e0e-43a9-bcb6-3d0022b7ca99] [:firstname Lars] [:lastname Gnädinger] [:__typename :User]) #ordered/map ([:id 0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d] [:firstname Lenny Ron] [:lastname Frei] [:__typename :User]) #ordered/map ([:id b41e6486-ec39-4855-8d8a-c03aa83af233] [:firstname Matthias] [:lastname Daniels] [:__typename :User]) #ordered/map ([:id 4884241c-8104-5c10-a393-0e21dcd1a46e] [:firstname Patrice] [:lastname Huber] [:__typename :User]) #ordered/map ([:id 52c2d39d-7f53-592f-8142-824afbaf59d3] [:firstname Tilo] [:lastname Seiring] [:__typename :User]) #ordered/map ([:id 96c5a731-ae34-5ede-917c-90a42dc66a1e] [:firstname Ugo] [:lastname De Vito] [:__typename :User])]] [:viewers [#ordered/map ([:id b363936a-fd9c-567a-82a4-f0b523dbb26b] [:firstname Beat] [:lastname Rohrer] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id 5059c4fc-d34c-5c9a-9efe-257c7ec6fb6b] [:name Zuteilung unbekannt - IT & Elektronik] [:can_delete false] [:cost_center 11410600] [:general_ledger_account 5064097000] [:procurement_account 3113097000] [:inspectors [#ordered/map ([:id e9656e43-9f35-502d-b495-eec36093208e] [:firstname Christian] [:lastname Wildhaber] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 28552e7e-f8be-5019-bdad-846babd8c642] [:firstname Hugo] [:lastname Vögtle] [:__typename :User]) #ordered/map ([:id 301988e6-5e0e-43a9-bcb6-3d0022b7ca99] [:firstname Lars] [:lastname Gnädinger] [:__typename :User]) #ordered/map ([:id 0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d] [:firstname Lenny Ron] [:lastname Frei] [:__typename :User]) #ordered/map ([:id b41e6486-ec39-4855-8d8a-c03aa83af233] [:firstname Matthias] [:lastname Daniels] [:__typename :User]) #ordered/map ([:id 4884241c-8104-5c10-a393-0e21dcd1a46e] [:firstname Patrice] [:lastname Huber] [:__typename :User]) #ordered/map ([:id 52c2d39d-7f53-592f-8142-824afbaf59d3] [:firstname Tilo] [:lastname Seiring] [:__typename :User]) #ordered/map ([:id 96c5a731-ae34-5ede-917c-90a42dc66a1e] [:firstname Ugo] [:lastname De Vito] [:__typename :User])]] [:viewers [#ordered/map ([:id b363936a-fd9c-567a-82a4-f0b523dbb26b] [:firstname Beat] [:lastname Rohrer] [:__typename :User])]] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id f6885671-3bf3-56f2-8e92-b5112d0f703f] [:name Musikinstrumente] [:can_delete false] [:image_url /procure/images/3a52eb87-b5fe-5df0-98b1-43e80f28d2dc] [:categories [#ordered/map ([:id af3372a1-63a8-52dc-850e-c2ae91c1c078] [:name Musikinstrumente] [:can_delete false] [:cost_center 11410800] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 6eeeeb75-e3d8-56c9-b7b6-0c45b7795cb9] [:firstname Martin] [:lastname Weyermann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 17a52112-1986-5074-b1d9-0faff29a785b] [:name Zuteilung unbekannt - Musikinstrumente] [:can_delete false] [:cost_center 11410800] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 6eeeeb75-e3d8-56c9-b7b6-0c45b7795cb9] [:firstname Martin] [:lastname Weyermann] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id 6c8a0d77-6711-5156-a59a-12425ba01cff] [:name Werkstatt-Technik] [:can_delete false] [:image_url /procure/images/f4e1f230-df2e-5e95-bf89-827f7a6b4b3b] [:categories [#ordered/map ([:id 6870a16c-9a71-5e60-b94a-f0b784398fec] [:name Handwerkzeug] [:can_delete false] [:cost_center 11410400] [:general_ledger_account 5061097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id ad765b67-18f7-55a8-88b6-11a82cd0d0b4] [:firstname Adrian] [:lastname Brazerol] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 771fddcf-b19a-5e6b-8b6f-7266b6922c4f] [:name Maschinen] [:can_delete false] [:cost_center 11410400] [:general_ledger_account 5061097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id ad765b67-18f7-55a8-88b6-11a82cd0d0b4] [:firstname Adrian] [:lastname Brazerol] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id c7ece4a6-2b5c-409f-96ea-e4fd6e8f9792] [:name Sicherheit] [:can_delete false] [:cost_center 11410400] [:general_ledger_account 5061097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id ad765b67-18f7-55a8-88b6-11a82cd0d0b4] [:firstname Adrian] [:lastname Brazerol] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 3eaad5d5-516a-5610-8caf-342cfdcaac62] [:name Zuteilung unbekannt - Werkstatt-Technik] [:can_delete false] [:cost_center 11410400] [:general_ledger_account 5061097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id ad765b67-18f7-55a8-88b6-11a82cd0d0b4] [:firstname Adrian] [:lastname Brazerol] [:__typename :User]) #ordered/map ([:id cbcbc88f-e7b4-58fd-8dc2-e83be0d06475] [:firstname Claudia] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id da18869a-e4bd-4493-a4c9-2e6fe78c94e7] [:firstname Etienne] [:lastname Schudel] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 6ecace30-0931-59f4-9032-cd412530256c] [:firstname Judith] [:lastname Richi] [:__typename :User]) #ordered/map ([:id de3d3911-8b37-4bfe-aa59-25ee8dac5b07] [:firstname Julio] [:lastname Barrantes Zunzunegui] [:__typename :User]) #ordered/map ([:id b1e54635-ec2a-444f-8edd-7186075b0760] [:firstname Nomce] [:lastname Tanaskoski] [:__typename :User]) #ordered/map ([:id 8448b7b2-f5d9-4590-8355-2295b50bba40] [:firstname Sergej] [:lastname Tratar Baamonde] [:__typename :User]) #ordered/map ([:id 48e259df-9b53-5e56-a03e-65ce562f231a] [:firstname Silvan] [:lastname Becchio] [:__typename :User]) #ordered/map ([:id d0853239-fe13-4540-9c16-4ec1656461d3] [:firstname Silvia] [:lastname Eichenberger] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User]) #ordered/map ([:id baa628c5-c7fc-4cce-bea7-d8093f78adca] [:firstname Zelda] [:lastname Keller] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory])]])}
2023-12-11T15:36:18.397Z NX-41294 DEBUG [leihs.procurement.graphql:86] - result => {:data #ordered/map ([:main_categories [#ordered/map ([:id "519f7a95-9ca7-5256-bf63-142cfc23dc62"] [:name "Audio- und Videotechnik"] [:can_delete false] [:image_url "/procure/images/ee215167-b2c3-5fcc-90c3-098ad20d16ea"] [:categories [#ordered/map ([:id "4e48b48c-e1bf-50d7-ab2d-9aa438c638de"] [:name "Beamer"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "a1727606-c7c8-54a2-aaa1-ceff7a7d4b40"] [:name "Funk-Strecken"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "00382e27-a87a-5313-b31b-a369dad6c5f8"] [:name "Lautsprecher"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "ce5424cc-ce77-5e67-8201-333ec20963eb"] [:name "Lautsprecherstative"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "ce0812d7-080b-5f49-8530-dd4a821c57b6"] [:name "Mikrofone"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "67e5fc60-6fe3-53bb-9495-3669b917038a"] [:name "Mikrofonstative"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "f94f72e8-ff65-5bad-b1f9-81ddd8fa7c0c"] [:name "Monitore / Screens"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "89e4a22f-7d6c-5006-b26a-3ef6f8f19630"] [:name "Schnittplatz / Mischpult / Regie"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "1fb59e17-a703-5abc-8a80-fc7a9c20ee1d"] [:name "Video/Film-Kameras"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "c17698c1-5d5d-51ea-927f-b6ca96431a50"] [:name "Video/Film-Stative"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "fabe3b8c-58b5-5009-8873-cc3e945a7c0d"] [:name "Video/Filmobjektive"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "ebb12585-ce23-5cbe-8f4f-41a42d60a656"] [:name "Zuteilung unbekannt - Audio- und Videotechnik"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "c0777d74-668b-5e01-abb5-f8277baa0ea8"] [:firstname "Matus"] [:lastname "Kmit"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "8a9d832a-cf4c-5253-bcaa-385ef03565c1"] [:firstname "Nadja"] [:lastname "Weisskopf-Admin"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "1a047acd-dc98-52c2-99d3-dc6332adc1e0"] [:name "Bauliche Anpassungen und Mobiliar"] [:can_delete false] [:image_url "/procure/images/8e07c37e-d244-514d-bfa9-306158056160"] [:categories [#ordered/map ([:id "0a082661-cc1c-5b49-baab-f4db926faa7e"] [:name "Bauprojekte"] [:can_delete false] [:cost_center "11410210"] [:general_ledger_account "5069097000"] [:procurement_account "3119097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "797264c9-a2c2-5642-9c1a-d45b01f4fdc5"] [:firstname "Heike"] [:lastname "Heldt"] [:__typename :User]) #ordered/map ([:id "2c1de10b-6145-56d6-a76e-3c207cfc35a1"] [:firstname "Marco"] [:lastname "Castellano"] [:__typename :User]) #ordered/map ([:id "57bb6aaa-95fb-435f-8dd9-d0b853bf2279"] [:firstname "Pascale"] [:lastname "Gisel"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "42cc2d9a-cc45-5d77-85d3-0f21270d7a35"] [:name "Einrichtungsprojekte"] [:can_delete false] [:cost_center "11410220"] [:general_ledger_account "5069097000"] [:procurement_account "3110097001"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "797264c9-a2c2-5642-9c1a-d45b01f4fdc5"] [:firstname "Heike"] [:lastname "Heldt"] [:__typename :User]) #ordered/map ([:id "2c1de10b-6145-56d6-a76e-3c207cfc35a1"] [:firstname "Marco"] [:lastname "Castellano"] [:__typename :User]) #ordered/map ([:id "57bb6aaa-95fb-435f-8dd9-d0b853bf2279"] [:firstname "Pascale"] [:lastname "Gisel"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "56aaec64-8d65-50b3-bd81-f788d477b927"] [:name "Mobiliarergänzungen"] [:can_delete false] [:cost_center "11410220"] [:general_ledger_account "5069097000"] [:procurement_account "3110097001"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "797264c9-a2c2-5642-9c1a-d45b01f4fdc5"] [:firstname "Heike"] [:lastname "Heldt"] [:__typename :User]) #ordered/map ([:id "2c1de10b-6145-56d6-a76e-3c207cfc35a1"] [:firstname "Marco"] [:lastname "Castellano"] [:__typename :User]) #ordered/map ([:id "57bb6aaa-95fb-435f-8dd9-d0b853bf2279"] [:firstname "Pascale"] [:lastname "Gisel"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "483ac871-b632-5dcd-9d37-789d65f4c424"] [:name "Schliessanlagen und Türen"] [:can_delete false] [:cost_center "11410210"] [:general_ledger_account "5069097000"] [:procurement_account "3119097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "797264c9-a2c2-5642-9c1a-d45b01f4fdc5"] [:firstname "Heike"] [:lastname "Heldt"] [:__typename :User]) #ordered/map ([:id "2c1de10b-6145-56d6-a76e-3c207cfc35a1"] [:firstname "Marco"] [:lastname "Castellano"] [:__typename :User]) #ordered/map ([:id "57bb6aaa-95fb-435f-8dd9-d0b853bf2279"] [:firstname "Pascale"] [:lastname "Gisel"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "2b3749a2-6a59-5a25-9b9f-32f5e485e635"] [:name "Signaletik"] [:can_delete false] [:cost_center "11410210"] [:general_ledger_account "5069097000"] [:procurement_account "3119097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "797264c9-a2c2-5642-9c1a-d45b01f4fdc5"] [:firstname "Heike"] [:lastname "Heldt"] [:__typename :User]) #ordered/map ([:id "2c1de10b-6145-56d6-a76e-3c207cfc35a1"] [:firstname "Marco"] [:lastname "Castellano"] [:__typename :User]) #ordered/map ([:id "57bb6aaa-95fb-435f-8dd9-d0b853bf2279"] [:firstname "Pascale"] [:lastname "Gisel"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "fad911e4-8c69-535c-a138-f3e2544519ba"] [:name "Vorhänge"] [:can_delete false] [:cost_center "11410210"] [:general_ledger_account "5069097000"] [:procurement_account "3119097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "797264c9-a2c2-5642-9c1a-d45b01f4fdc5"] [:firstname "Heike"] [:lastname "Heldt"] [:__typename :User]) #ordered/map ([:id "2c1de10b-6145-56d6-a76e-3c207cfc35a1"] [:firstname "Marco"] [:lastname "Castellano"] [:__typename :User]) #ordered/map ([:id "57bb6aaa-95fb-435f-8dd9-d0b853bf2279"] [:firstname "Pascale"] [:lastname "Gisel"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "c3f14f79-931c-52c8-a847-ed77449ce9a6"] [:name "Zuteilung unbekannt - Bauliche Anpassungen und Mobiliar"] [:can_delete false] [:cost_center "11410220"] [:general_ledger_account "5069097000"] [:procurement_account "3119097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "797264c9-a2c2-5642-9c1a-d45b01f4fdc5"] [:firstname "Heike"] [:lastname "Heldt"] [:__typename :User]) #ordered/map ([:id "2c1de10b-6145-56d6-a76e-3c207cfc35a1"] [:firstname "Marco"] [:lastname "Castellano"] [:__typename :User]) #ordered/map ([:id "57bb6aaa-95fb-435f-8dd9-d0b853bf2279"] [:firstname "Pascale"] [:lastname "Gisel"] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "dda588f4-660c-573c-a2ff-944ae93ad42e"] [:name "Beleuchtungstechnik"] [:can_delete false] [:image_url "/procure/images/8debe2ef-4a7e-58a1-bf4c-1622dead4579"] [:categories [#ordered/map ([:id "b9e4f492-55e3-57e4-9467-91c81bfe2325"] [:name "Bühnenlicht"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User])]] [:viewers [#ordered/map ([:id "8448b7b2-f5d9-4590-8355-2295b50bba40"] [:firstname "Sergej"] [:lastname "Tratar Baamonde"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "a7cca5a4-e265-5f36-b794-1024c8aacc3e"] [:name "Film-Beleuchtung"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User])]] [:viewers [#ordered/map ([:id "8448b7b2-f5d9-4590-8355-2295b50bba40"] [:firstname "Sergej"] [:lastname "Tratar Baamonde"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "79822b89-0edb-588c-b9e5-65b7722ac50b"] [:name "Kameralicht"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User])]] [:viewers [#ordered/map ([:id "8448b7b2-f5d9-4590-8355-2295b50bba40"] [:firstname "Sergej"] [:lastname "Tratar Baamonde"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "ab911807-6431-5ca7-890a-3573737bb4d3"] [:name "Mobiles Raumlicht für Ausstellungen"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "2c1de10b-6145-56d6-a76e-3c207cfc35a1"] [:firstname "Marco"] [:lastname "Castellano"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "64c6f8ad-a1b7-530b-946a-ebb1644ac897"] [:name "Studio-Licht"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User])]] [:viewers [#ordered/map ([:id "8448b7b2-f5d9-4590-8355-2295b50bba40"] [:firstname "Sergej"] [:lastname "Tratar Baamonde"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "f2bb3f23-bb5b-5855-b03f-0166bd19fc0c"] [:name "Zuteilung unbekannt - Beleuchtungstechnik"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User])]] [:viewers [#ordered/map ([:id "8448b7b2-f5d9-4590-8355-2295b50bba40"] [:firstname "Sergej"] [:lastname "Tratar Baamonde"] [:__typename :User])]] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "2b07eb8a-4174-5257-83eb-920d536cc44a"] [:name "Betriebseinrichtungen und Fahrzeuge"] [:can_delete false] [:image_url "/procure/images/3d6cbe63-c327-5c6b-b7fa-48e6c52f2cdc"] [:categories [#ordered/map ([:id "5d8639a3-4569-5009-af28-f63f2af5209d"] [:name "Betriebseinrichtungen"] [:can_delete false] [:cost_center "11410200"] [:general_ledger_account "5061097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "2c1de10b-6145-56d6-a76e-3c207cfc35a1"] [:firstname "Marco"] [:lastname "Castellano"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "b34f1cbb-4ac7-59a0-81f2-3ca7ecc94e71"] [:name "Fahrzeuge"] [:can_delete false] [:cost_center "11410200"] [:general_ledger_account "5061097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "2c1de10b-6145-56d6-a76e-3c207cfc35a1"] [:firstname "Marco"] [:lastname "Castellano"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "73e97867-43ea-5bee-b46b-d7c74fbf873b"] [:name "Hub- und Hebegeräte"] [:can_delete false] [:cost_center "11410200"] [:general_ledger_account "5061097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "2c1de10b-6145-56d6-a76e-3c207cfc35a1"] [:firstname "Marco"] [:lastname "Castellano"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "b6601a86-b5d3-5682-88b6-cff956b00d7b"] [:name "Zuteilung unbekannt - Betriebseinrichtungen und Fahrzeuge"] [:can_delete false] [:cost_center "11410200"] [:general_ledger_account "5061097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "2c1de10b-6145-56d6-a76e-3c207cfc35a1"] [:firstname "Marco"] [:lastname "Castellano"] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "f6827594-33a6-5760-ac41-f94ceefacfab"] [:name "Bühnentechnik"] [:can_delete false] [:image_url "/procure/images/9a8cba78-10ab-585b-a4c2-9d8e7f0818ee"] [:categories [#ordered/map ([:id "455bc6dc-afbd-579d-a621-6d75e0fca9ea"] [:name "Bühnentechnik"] [:can_delete false] [:cost_center "11410500"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "428a72a9-36df-52fa-880f-64db35843013"] [:firstname "Dominik"] [:lastname "Fedier"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "8448b7b2-f5d9-4590-8355-2295b50bba40"] [:firstname "Sergej"] [:lastname "Tratar Baamonde"] [:__typename :User])]] [:viewers [#ordered/map ([:id "8448b7b2-f5d9-4590-8355-2295b50bba40"] [:firstname "Sergej"] [:lastname "Tratar Baamonde"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "747b6b21-9fad-4a01-acd9-cd8983aed286"] [:name "Fundus"] [:can_delete false] [:cost_center "11410500"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "428a72a9-36df-52fa-880f-64db35843013"] [:firstname "Dominik"] [:lastname "Fedier"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User])]] [:viewers [#ordered/map ([:id "8448b7b2-f5d9-4590-8355-2295b50bba40"] [:firstname "Sergej"] [:lastname "Tratar Baamonde"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "07a6af37-e127-5f4b-94ec-698a5698d98c"] [:name "Zuteilung unbekannt - Bühnentechnik"] [:can_delete false] [:cost_center "11410500"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "428a72a9-36df-52fa-880f-64db35843013"] [:firstname "Dominik"] [:lastname "Fedier"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "8448b7b2-f5d9-4590-8355-2295b50bba40"] [:firstname "Sergej"] [:lastname "Tratar Baamonde"] [:__typename :User])]] [:viewers [#ordered/map ([:id "8448b7b2-f5d9-4590-8355-2295b50bba40"] [:firstname "Sergej"] [:lastname "Tratar Baamonde"] [:__typename :User])]] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "517b82ae-2b7e-4822-9aeb-0d4753dec821"] [:name "Darlehen"] [:can_delete false] [:image_url nil] [:categories [#ordered/map ([:id "671ab85c-b8c1-4659-9c6e-9ebe2f122a59"] [:name "Darlehen"] [:can_delete false] [:cost_center "11410101"] [:general_ledger_account "5064097000"] [:procurement_account ""] [:inspectors [#ordered/map ([:id "b610f5bd-6da8-5122-94f0-c0bbf1b7ed73"] [:firstname "Daniel"] [:lastname "Fischer"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da"] [:name "Fotografie"] [:can_delete false] [:image_url "/procure/images/07a33b4c-d274-54e5-a2ce-11f26d57be05"] [:categories [#ordered/map ([:id "e1b4cad8-0416-5cf7-9e4a-dde208d0abad"] [:name "Blitzanlagen"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "011ff3f3-09fa-59e1-9713-52466786adf8"] [:name "Fotokameras"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "54b87eb0-061c-5a97-96ad-e9b6da605184"] [:name "Fotostative"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "5858ec5d-5f01-50fb-bc96-4b4766bd7799"] [:name "Kompakt-Blitze"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "ba5b41a7-4317-5160-9b82-b0931a48aec0"] [:name "Objektive"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "9df68a66-4523-5072-aa31-1df9abeaa1c7"] [:name "Zuteilung unbekannt - Fotografie"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "2ea39047-e663-50d5-9080-838b75883704"] [:name "IT & Elektronik"] [:can_delete false] [:image_url "/procure/images/1464e46c-e726-54a9-a42b-f937a0342d22"] [:categories [#ordered/map ([:id "f2531d7e-d9ff-5c3e-9e88-6d3a16a89aa1"] [:name "Desktop"] [:can_delete false] [:cost_center "11410660"] [:general_ledger_account "5064097000"] [:procurement_account "3113097000"] [:inspectors [#ordered/map ([:id "e9656e43-9f35-502d-b495-eec36093208e"] [:firstname "Christian"] [:lastname "Wildhaber"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "28552e7e-f8be-5019-bdad-846babd8c642"] [:firstname "Hugo"] [:lastname "Vögtle"] [:__typename :User]) #ordered/map ([:id "301988e6-5e0e-43a9-bcb6-3d0022b7ca99"] [:firstname "Lars"] [:lastname "Gnädinger"] [:__typename :User]) #ordered/map ([:id "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d"] [:firstname "Lenny Ron"] [:lastname "Frei"] [:__typename :User]) #ordered/map ([:id "b5d09795-0b94-423d-a645-bae0aed895ce"] [:firstname "Lukas"] [:lastname "Brupbacher"] [:__typename :User]) #ordered/map ([:id "b41e6486-ec39-4855-8d8a-c03aa83af233"] [:firstname "Matthias"] [:lastname "Daniels"] [:__typename :User]) #ordered/map ([:id "8a9d832a-cf4c-5253-bcaa-385ef03565c1"] [:firstname "Nadja"] [:lastname "Weisskopf-Admin"] [:__typename :User]) #ordered/map ([:id "4884241c-8104-5c10-a393-0e21dcd1a46e"] [:firstname "Patrice"] [:lastname "Huber"] [:__typename :User]) #ordered/map ([:id "52c2d39d-7f53-592f-8142-824afbaf59d3"] [:firstname "Tilo"] [:lastname "Seiring"] [:__typename :User]) #ordered/map ([:id "96c5a731-ae34-5ede-917c-90a42dc66a1e"] [:firstname "Ugo"] [:lastname "De Vito"] [:__typename :User])]] [:viewers [#ordered/map ([:id "b363936a-fd9c-567a-82a4-f0b523dbb26b"] [:firstname "Beat"] [:lastname "Rohrer"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "1af3a7f2-b16a-4203-b6ac-f2c7be612d74"] [:name "IT_Projekte"] [:can_delete false] [:cost_center "11410650"] [:general_ledger_account "5064097000"] [:procurement_account "3118097000"] [:inspectors [#ordered/map ([:id "e9656e43-9f35-502d-b495-eec36093208e"] [:firstname "Christian"] [:lastname "Wildhaber"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "28552e7e-f8be-5019-bdad-846babd8c642"] [:firstname "Hugo"] [:lastname "Vögtle"] [:__typename :User]) #ordered/map ([:id "301988e6-5e0e-43a9-bcb6-3d0022b7ca99"] [:firstname "Lars"] [:lastname "Gnädinger"] [:__typename :User]) #ordered/map ([:id "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d"] [:firstname "Lenny Ron"] [:lastname "Frei"] [:__typename :User]) #ordered/map ([:id "b5d09795-0b94-423d-a645-bae0aed895ce"] [:firstname "Lukas"] [:lastname "Brupbacher"] [:__typename :User]) #ordered/map ([:id "b41e6486-ec39-4855-8d8a-c03aa83af233"] [:firstname "Matthias"] [:lastname "Daniels"] [:__typename :User]) #ordered/map ([:id "4884241c-8104-5c10-a393-0e21dcd1a46e"] [:firstname "Patrice"] [:lastname "Huber"] [:__typename :User]) #ordered/map ([:id "52c2d39d-7f53-592f-8142-824afbaf59d3"] [:firstname "Tilo"] [:lastname "Seiring"] [:__typename :User]) #ordered/map ([:id "96c5a731-ae34-5ede-917c-90a42dc66a1e"] [:firstname "Ugo"] [:lastname "De Vito"] [:__typename :User])]] [:viewers [#ordered/map ([:id "b363936a-fd9c-567a-82a4-f0b523dbb26b"] [:firstname "Beat"] [:lastname "Rohrer"] [:__typename :User]) #ordered/map ([:id "b5d09795-0b94-423d-a645-bae0aed895ce"] [:firstname "Lukas"] [:lastname "Brupbacher"] [:__typename :User]) #ordered/map ([:id "233a038c-66fb-4036-9149-762c10a5b72e"] [:firstname "Maria"] [:lastname "Krause"] [:__typename :User]) #ordered/map ([:id "d65e52a5-0404-4069-b6a0-7e8ef60dc1e1"] [:firstname "Maurizio"] [:lastname "Mattiola"] [:__typename :User]) #ordered/map ([:id "119a33c1-151f-4579-8c79-0d3225d4b9b6"] [:firstname "Michael"] [:lastname "Bozenicar"] [:__typename :User]) #ordered/map ([:id "45b1cf11-1f50-5d8b-aedf-5d8b83b19a52"] [:firstname "Monika"] [:lastname "Petschen"] [:__typename :User]) #ordered/map ([:id "8160a951-8900-448d-8c3e-e31ec60fd3f3"] [:firstname "Stefan"] [:lastname "Uhle"] [:__typename :User]) #ordered/map ([:id "a4d8f8c9-8f5e-444f-b2cf-67e53f7d3d0c"] [:firstname "Thomas"] [:lastname "Bickel"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "ccab158d-79c7-5c28-a8a2-47cb4925f101"] [:name "IT-Basisinfrastruktur"] [:can_delete false] [:cost_center "11410640"] [:general_ledger_account "5064097000"] [:procurement_account "3113097000"] [:inspectors [#ordered/map ([:id "e9656e43-9f35-502d-b495-eec36093208e"] [:firstname "Christian"] [:lastname "Wildhaber"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "28552e7e-f8be-5019-bdad-846babd8c642"] [:firstname "Hugo"] [:lastname "Vögtle"] [:__typename :User]) #ordered/map ([:id "301988e6-5e0e-43a9-bcb6-3d0022b7ca99"] [:firstname "Lars"] [:lastname "Gnädinger"] [:__typename :User]) #ordered/map ([:id "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d"] [:firstname "Lenny Ron"] [:lastname "Frei"] [:__typename :User]) #ordered/map ([:id "b41e6486-ec39-4855-8d8a-c03aa83af233"] [:firstname "Matthias"] [:lastname "Daniels"] [:__typename :User]) #ordered/map ([:id "4884241c-8104-5c10-a393-0e21dcd1a46e"] [:firstname "Patrice"] [:lastname "Huber"] [:__typename :User]) #ordered/map ([:id "52c2d39d-7f53-592f-8142-824afbaf59d3"] [:firstname "Tilo"] [:lastname "Seiring"] [:__typename :User]) #ordered/map ([:id "96c5a731-ae34-5ede-917c-90a42dc66a1e"] [:firstname "Ugo"] [:lastname "De Vito"] [:__typename :User])]] [:viewers [#ordered/map ([:id "b363936a-fd9c-567a-82a4-f0b523dbb26b"] [:firstname "Beat"] [:lastname "Rohrer"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "eb1e7bef-80c6-4958-b16e-35555735ce61"] [:name "IT-Security"] [:can_delete false] [:cost_center "11410600"] [:general_ledger_account "5064097000"] [:procurement_account "3113097000"] [:inspectors [#ordered/map ([:id "3651eeeb-0fb1-4840-80dd-6c739bda6c57"] [:firstname "Christian"] [:lastname "Schneider"] [:__typename :User]) #ordered/map ([:id "301988e6-5e0e-43a9-bcb6-3d0022b7ca99"] [:firstname "Lars"] [:lastname "Gnädinger"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "4ecc9e97-2d12-5173-bd8c-781482c842e8"] [:name "Laptops"] [:can_delete false] [:cost_center "11410660"] [:general_ledger_account "5064097000"] [:procurement_account "3113097000"] [:inspectors [#ordered/map ([:id "e9656e43-9f35-502d-b495-eec36093208e"] [:firstname "Christian"] [:lastname "Wildhaber"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "28552e7e-f8be-5019-bdad-846babd8c642"] [:firstname "Hugo"] [:lastname "Vögtle"] [:__typename :User]) #ordered/map ([:id "301988e6-5e0e-43a9-bcb6-3d0022b7ca99"] [:firstname "Lars"] [:lastname "Gnädinger"] [:__typename :User]) #ordered/map ([:id "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d"] [:firstname "Lenny Ron"] [:lastname "Frei"] [:__typename :User]) #ordered/map ([:id "b41e6486-ec39-4855-8d8a-c03aa83af233"] [:firstname "Matthias"] [:lastname "Daniels"] [:__typename :User]) #ordered/map ([:id "4884241c-8104-5c10-a393-0e21dcd1a46e"] [:firstname "Patrice"] [:lastname "Huber"] [:__typename :User]) #ordered/map ([:id "52c2d39d-7f53-592f-8142-824afbaf59d3"] [:firstname "Tilo"] [:lastname "Seiring"] [:__typename :User]) #ordered/map ([:id "96c5a731-ae34-5ede-917c-90a42dc66a1e"] [:firstname "Ugo"] [:lastname "De Vito"] [:__typename :User])]] [:viewers [#ordered/map ([:id "b363936a-fd9c-567a-82a4-f0b523dbb26b"] [:firstname "Beat"] [:lastname "Rohrer"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "80226a51-c17a-5fd8-93db-40aef5b03491"] [:name "Monitore"] [:can_delete false] [:cost_center "11410660"] [:general_ledger_account "5064097000"] [:procurement_account "3113097000"] [:inspectors [#ordered/map ([:id "e9656e43-9f35-502d-b495-eec36093208e"] [:firstname "Christian"] [:lastname "Wildhaber"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "28552e7e-f8be-5019-bdad-846babd8c642"] [:firstname "Hugo"] [:lastname "Vögtle"] [:__typename :User]) #ordered/map ([:id "301988e6-5e0e-43a9-bcb6-3d0022b7ca99"] [:firstname "Lars"] [:lastname "Gnädinger"] [:__typename :User]) #ordered/map ([:id "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d"] [:firstname "Lenny Ron"] [:lastname "Frei"] [:__typename :User]) #ordered/map ([:id "b41e6486-ec39-4855-8d8a-c03aa83af233"] [:firstname "Matthias"] [:lastname "Daniels"] [:__typename :User]) #ordered/map ([:id "4884241c-8104-5c10-a393-0e21dcd1a46e"] [:firstname "Patrice"] [:lastname "Huber"] [:__typename :User]) #ordered/map ([:id "52c2d39d-7f53-592f-8142-824afbaf59d3"] [:firstname "Tilo"] [:lastname "Seiring"] [:__typename :User]) #ordered/map ([:id "96c5a731-ae34-5ede-917c-90a42dc66a1e"] [:firstname "Ugo"] [:lastname "De Vito"] [:__typename :User])]] [:viewers [#ordered/map ([:id "b363936a-fd9c-567a-82a4-f0b523dbb26b"] [:firstname "Beat"] [:lastname "Rohrer"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "fe602c35-1097-52d0-acd0-40579d295f00"] [:name "Scanner"] [:can_delete false] [:cost_center "11410660"] [:general_ledger_account "5064097000"] [:procurement_account "3113097000"] [:inspectors [#ordered/map ([:id "e9656e43-9f35-502d-b495-eec36093208e"] [:firstname "Christian"] [:lastname "Wildhaber"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "28552e7e-f8be-5019-bdad-846babd8c642"] [:firstname "Hugo"] [:lastname "Vögtle"] [:__typename :User]) #ordered/map ([:id "301988e6-5e0e-43a9-bcb6-3d0022b7ca99"] [:firstname "Lars"] [:lastname "Gnädinger"] [:__typename :User]) #ordered/map ([:id "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d"] [:firstname "Lenny Ron"] [:lastname "Frei"] [:__typename :User]) #ordered/map ([:id "b41e6486-ec39-4855-8d8a-c03aa83af233"] [:firstname "Matthias"] [:lastname "Daniels"] [:__typename :User]) #ordered/map ([:id "4884241c-8104-5c10-a393-0e21dcd1a46e"] [:firstname "Patrice"] [:lastname "Huber"] [:__typename :User]) #ordered/map ([:id "52c2d39d-7f53-592f-8142-824afbaf59d3"] [:firstname "Tilo"] [:lastname "Seiring"] [:__typename :User]) #ordered/map ([:id "96c5a731-ae34-5ede-917c-90a42dc66a1e"] [:firstname "Ugo"] [:lastname "De Vito"] [:__typename :User])]] [:viewers [#ordered/map ([:id "b363936a-fd9c-567a-82a4-f0b523dbb26b"] [:firstname "Beat"] [:lastname "Rohrer"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "56065d53-cd2f-5a39-9b66-532fd83ad2e6"] [:name "Schnittstellengeräte"] [:can_delete false] [:cost_center "11410660"] [:general_ledger_account "5064097000"] [:procurement_account "3113097000"] [:inspectors [#ordered/map ([:id "e9656e43-9f35-502d-b495-eec36093208e"] [:firstname "Christian"] [:lastname "Wildhaber"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "28552e7e-f8be-5019-bdad-846babd8c642"] [:firstname "Hugo"] [:lastname "Vögtle"] [:__typename :User]) #ordered/map ([:id "301988e6-5e0e-43a9-bcb6-3d0022b7ca99"] [:firstname "Lars"] [:lastname "Gnädinger"] [:__typename :User]) #ordered/map ([:id "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d"] [:firstname "Lenny Ron"] [:lastname "Frei"] [:__typename :User]) #ordered/map ([:id "b41e6486-ec39-4855-8d8a-c03aa83af233"] [:firstname "Matthias"] [:lastname "Daniels"] [:__typename :User]) #ordered/map ([:id "4884241c-8104-5c10-a393-0e21dcd1a46e"] [:firstname "Patrice"] [:lastname "Huber"] [:__typename :User]) #ordered/map ([:id "52c2d39d-7f53-592f-8142-824afbaf59d3"] [:firstname "Tilo"] [:lastname "Seiring"] [:__typename :User]) #ordered/map ([:id "96c5a731-ae34-5ede-917c-90a42dc66a1e"] [:firstname "Ugo"] [:lastname "De Vito"] [:__typename :User])]] [:viewers [#ordered/map ([:id "b363936a-fd9c-567a-82a4-f0b523dbb26b"] [:firstname "Beat"] [:lastname "Rohrer"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "fc7bc38c-62f3-5576-802f-c874e06ee776"] [:name "Software"] [:can_delete false] [:cost_center "11410660"] [:general_ledger_account "5064097000"] [:procurement_account "3118097000"] [:inspectors [#ordered/map ([:id "e9656e43-9f35-502d-b495-eec36093208e"] [:firstname "Christian"] [:lastname "Wildhaber"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "28552e7e-f8be-5019-bdad-846babd8c642"] [:firstname "Hugo"] [:lastname "Vögtle"] [:__typename :User]) #ordered/map ([:id "301988e6-5e0e-43a9-bcb6-3d0022b7ca99"] [:firstname "Lars"] [:lastname "Gnädinger"] [:__typename :User]) #ordered/map ([:id "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d"] [:firstname "Lenny Ron"] [:lastname "Frei"] [:__typename :User]) #ordered/map ([:id "b41e6486-ec39-4855-8d8a-c03aa83af233"] [:firstname "Matthias"] [:lastname "Daniels"] [:__typename :User]) #ordered/map ([:id "8a9d832a-cf4c-5253-bcaa-385ef03565c1"] [:firstname "Nadja"] [:lastname "Weisskopf-Admin"] [:__typename :User]) #ordered/map ([:id "4884241c-8104-5c10-a393-0e21dcd1a46e"] [:firstname "Patrice"] [:lastname "Huber"] [:__typename :User]) #ordered/map ([:id "52c2d39d-7f53-592f-8142-824afbaf59d3"] [:firstname "Tilo"] [:lastname "Seiring"] [:__typename :User]) #ordered/map ([:id "96c5a731-ae34-5ede-917c-90a42dc66a1e"] [:firstname "Ugo"] [:lastname "De Vito"] [:__typename :User])]] [:viewers [#ordered/map ([:id "b363936a-fd9c-567a-82a4-f0b523dbb26b"] [:firstname "Beat"] [:lastname "Rohrer"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "76fdca98-4a2a-5640-bc98-f33059d6ffa0"] [:name "Tablets"] [:can_delete false] [:cost_center "11410660"] [:general_ledger_account "5064097000"] [:procurement_account "3113097000"] [:inspectors [#ordered/map ([:id "e9656e43-9f35-502d-b495-eec36093208e"] [:firstname "Christian"] [:lastname "Wildhaber"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "28552e7e-f8be-5019-bdad-846babd8c642"] [:firstname "Hugo"] [:lastname "Vögtle"] [:__typename :User]) #ordered/map ([:id "301988e6-5e0e-43a9-bcb6-3d0022b7ca99"] [:firstname "Lars"] [:lastname "Gnädinger"] [:__typename :User]) #ordered/map ([:id "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d"] [:firstname "Lenny Ron"] [:lastname "Frei"] [:__typename :User]) #ordered/map ([:id "b41e6486-ec39-4855-8d8a-c03aa83af233"] [:firstname "Matthias"] [:lastname "Daniels"] [:__typename :User]) #ordered/map ([:id "4884241c-8104-5c10-a393-0e21dcd1a46e"] [:firstname "Patrice"] [:lastname "Huber"] [:__typename :User]) #ordered/map ([:id "52c2d39d-7f53-592f-8142-824afbaf59d3"] [:firstname "Tilo"] [:lastname "Seiring"] [:__typename :User]) #ordered/map ([:id "96c5a731-ae34-5ede-917c-90a42dc66a1e"] [:firstname "Ugo"] [:lastname "De Vito"] [:__typename :User])]] [:viewers [#ordered/map ([:id "b363936a-fd9c-567a-82a4-f0b523dbb26b"] [:firstname "Beat"] [:lastname "Rohrer"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "77857566-03d9-58f4-8b0d-290227434aff"] [:name "Telefon"] [:can_delete false] [:cost_center "11410660"] [:general_ledger_account "5064097000"] [:procurement_account "3113097000"] [:inspectors [#ordered/map ([:id "e9656e43-9f35-502d-b495-eec36093208e"] [:firstname "Christian"] [:lastname "Wildhaber"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "28552e7e-f8be-5019-bdad-846babd8c642"] [:firstname "Hugo"] [:lastname "Vögtle"] [:__typename :User]) #ordered/map ([:id "301988e6-5e0e-43a9-bcb6-3d0022b7ca99"] [:firstname "Lars"] [:lastname "Gnädinger"] [:__typename :User]) #ordered/map ([:id "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d"] [:firstname "Lenny Ron"] [:lastname "Frei"] [:__typename :User]) #ordered/map ([:id "b41e6486-ec39-4855-8d8a-c03aa83af233"] [:firstname "Matthias"] [:lastname "Daniels"] [:__typename :User]) #ordered/map ([:id "4884241c-8104-5c10-a393-0e21dcd1a46e"] [:firstname "Patrice"] [:lastname "Huber"] [:__typename :User]) #ordered/map ([:id "52c2d39d-7f53-592f-8142-824afbaf59d3"] [:firstname "Tilo"] [:lastname "Seiring"] [:__typename :User]) #ordered/map ([:id "96c5a731-ae34-5ede-917c-90a42dc66a1e"] [:firstname "Ugo"] [:lastname "De Vito"] [:__typename :User])]] [:viewers [#ordered/map ([:id "b363936a-fd9c-567a-82a4-f0b523dbb26b"] [:firstname "Beat"] [:lastname "Rohrer"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "5059c4fc-d34c-5c9a-9efe-257c7ec6fb6b"] [:name "Zuteilung unbekannt - IT & Elektronik"] [:can_delete false] [:cost_center "11410600"] [:general_ledger_account "5064097000"] [:procurement_account "3113097000"] [:inspectors [#ordered/map ([:id "e9656e43-9f35-502d-b495-eec36093208e"] [:firstname "Christian"] [:lastname "Wildhaber"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "28552e7e-f8be-5019-bdad-846babd8c642"] [:firstname "Hugo"] [:lastname "Vögtle"] [:__typename :User]) #ordered/map ([:id "301988e6-5e0e-43a9-bcb6-3d0022b7ca99"] [:firstname "Lars"] [:lastname "Gnädinger"] [:__typename :User]) #ordered/map ([:id "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d"] [:firstname "Lenny Ron"] [:lastname "Frei"] [:__typename :User]) #ordered/map ([:id "b41e6486-ec39-4855-8d8a-c03aa83af233"] [:firstname "Matthias"] [:lastname "Daniels"] [:__typename :User]) #ordered/map ([:id "4884241c-8104-5c10-a393-0e21dcd1a46e"] [:firstname "Patrice"] [:lastname "Huber"] [:__typename :User]) #ordered/map ([:id "52c2d39d-7f53-592f-8142-824afbaf59d3"] [:firstname "Tilo"] [:lastname "Seiring"] [:__typename :User]) #ordered/map ([:id "96c5a731-ae34-5ede-917c-90a42dc66a1e"] [:firstname "Ugo"] [:lastname "De Vito"] [:__typename :User])]] [:viewers [#ordered/map ([:id "b363936a-fd9c-567a-82a4-f0b523dbb26b"] [:firstname "Beat"] [:lastname "Rohrer"] [:__typename :User])]] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "f6885671-3bf3-56f2-8e92-b5112d0f703f"] [:name "Musikinstrumente"] [:can_delete false] [:image_url "/procure/images/3a52eb87-b5fe-5df0-98b1-43e80f28d2dc"] [:categories [#ordered/map ([:id "af3372a1-63a8-52dc-850e-c2ae91c1c078"] [:name "Musikinstrumente"] [:can_delete false] [:cost_center "11410800"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "6eeeeb75-e3d8-56c9-b7b6-0c45b7795cb9"] [:firstname "Martin"] [:lastname "Weyermann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "17a52112-1986-5074-b1d9-0faff29a785b"] [:name "Zuteilung unbekannt - Musikinstrumente"] [:can_delete false] [:cost_center "11410800"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "6eeeeb75-e3d8-56c9-b7b6-0c45b7795cb9"] [:firstname "Martin"] [:lastname "Weyermann"] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "6c8a0d77-6711-5156-a59a-12425ba01cff"] [:name "Werkstatt-Technik"] [:can_delete false] [:image_url "/procure/images/f4e1f230-df2e-5e95-bf89-827f7a6b4b3b"] [:categories [#ordered/map ([:id "6870a16c-9a71-5e60-b94a-f0b784398fec"] [:name "Handwerkzeug"] [:can_delete false] [:cost_center "11410400"] [:general_ledger_account "5061097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "ad765b67-18f7-55a8-88b6-11a82cd0d0b4"] [:firstname "Adrian"] [:lastname "Brazerol"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "771fddcf-b19a-5e6b-8b6f-7266b6922c4f"] [:name "Maschinen"] [:can_delete false] [:cost_center "11410400"] [:general_ledger_account "5061097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "ad765b67-18f7-55a8-88b6-11a82cd0d0b4"] [:firstname "Adrian"] [:lastname "Brazerol"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "c7ece4a6-2b5c-409f-96ea-e4fd6e8f9792"] [:name "Sicherheit"] [:can_delete false] [:cost_center "11410400"] [:general_ledger_account "5061097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "ad765b67-18f7-55a8-88b6-11a82cd0d0b4"] [:firstname "Adrian"] [:lastname "Brazerol"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "3eaad5d5-516a-5610-8caf-342cfdcaac62"] [:name "Zuteilung unbekannt - Werkstatt-Technik"] [:can_delete false] [:cost_center "11410400"] [:general_ledger_account "5061097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "ad765b67-18f7-55a8-88b6-11a82cd0d0b4"] [:firstname "Adrian"] [:lastname "Brazerol"] [:__typename :User]) #ordered/map ([:id "cbcbc88f-e7b4-58fd-8dc2-e83be0d06475"] [:firstname "Claudia"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "da18869a-e4bd-4493-a4c9-2e6fe78c94e7"] [:firstname "Etienne"] [:lastname "Schudel"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "6ecace30-0931-59f4-9032-cd412530256c"] [:firstname "Judith"] [:lastname "Richi"] [:__typename :User]) #ordered/map ([:id "de3d3911-8b37-4bfe-aa59-25ee8dac5b07"] [:firstname "Julio"] [:lastname "Barrantes Zunzunegui"] [:__typename :User]) #ordered/map ([:id "b1e54635-ec2a-444f-8edd-7186075b0760"] [:firstname "Nomce"] [:lastname "Tanaskoski"] [:__typename :User]) #ordered/map ([:id "8448b7b2-f5d9-4590-8355-2295b50bba40"] [:firstname "Sergej"] [:lastname "Tratar Baamonde"] [:__typename :User]) #ordered/map ([:id "48e259df-9b53-5e56-a03e-65ce562f231a"] [:firstname "Silvan"] [:lastname "Becchio"] [:__typename :User]) #ordered/map ([:id "d0853239-fe13-4540-9c16-4ec1656461d3"] [:firstname "Silvia"] [:lastname "Eichenberger"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User]) #ordered/map ([:id "baa628c5-c7fc-4cce-bea7-d8093f78adca"] [:firstname "Zelda"] [:lastname "Keller"] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory])]])}
>>> authenticate::skip= true  handler-key= :image
>>> authenticate::authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}

>> authorize >

>> authorize::handler > #object[leihs.core.locale$wrap$fn__44947 0x75cb2fad leihs.core.locale$wrap$fn__44947@75cb2fad]

>> authorize::request > {:authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 90abade9-82d6-4fb6-9898-f7566773263f}, leihs-user-session {:value 3d37de50-dd5a-42c5-bca6-445a84997cf0}}, :remote-addr 127.0.0.1, :start-time 20605391478958, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}, :query-params-raw {}, :route-params {:image-id 3a52eb87-b5fe-5df0-98b1-43e80f28d2dc}, :headers {sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, cookie leihs-anti-csrf-token=90abade9-82d6-4fb6-9898-f7566773263f; leihs-user-session=3d37de50-dd5a-42c5-bca6-445a84997cf0, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/admin/categories/f68856713bf356f28e92b5112d0f703f, connection keep-alive, pragma no-cache, accept image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest image, accept-encoding gzip, deflate, br, sec-fetch-mode no-cors, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x380e82c7 /127.0.0.1:3230<->/127.0.0.1:65348], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x29d7116a HikariDataSource (db-pool)]}, :content-length 0, :form-params {}, :websocket? false, :query-params {}, :content-type nil, :form-params-raw {}, :character-encoding utf8, :uri /procure/images/3a52eb87-b5fe-5df0-98b1-43e80f28d2dc, :server-name localhost, :handler-key :image, :query-string nil, :body nil, :graphql-schema #CompiledSchema<>, :handler #object[compojure.core$routes$fn__27950 0x6a941da8 compojure.core$routes$fn__27950@6a941da8], :multipart-params {}, :scheme :http, :request-method :get, :accept {:mime :apng, :charset nil, :encoding nil, :language nil}}

>> authorize::handler-key >> :image
>myprint>  authEnt? {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>myprint>  txn #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6ce63d3e HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.598Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:18.599Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>myprint>  admin true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.599Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> inspector? {:result false}
>myprint>  inspector false
>o> viewer? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.599Z NX-41294 DEBUG [leihs.procurement.permissions.user:83] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> viewer? {:result false}
>myprint>  viewer false
>o> requester?? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:18.600Z NX-41294 DEBUG [leihs.procurement.permissions.user:167] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> requester?? {:exists false}
>myprint>  requester false

> 1 anti-csrf-token >  90abade9-82d6-4fb6-9898-f7566773263f

> 1 anti-csrf-token class >  java.lang.String

> 2 anti-csrf-token-new >  nil
>>> authenticate::skip= nil  handler-key= :graphql
>>> authenticate::authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}

>> authorize >

>> authorize::handler > #object[leihs.core.locale$wrap$fn__44947 0x75cb2fad leihs.core.locale$wrap$fn__44947@75cb2fad]

>> authorize::request > {:authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 90abade9-82d6-4fb6-9898-f7566773263f}, leihs-user-session {:value 3d37de50-dd5a-42c5-bca6-445a84997cf0}}, :remote-addr 127.0.0.1, :start-time 20609583995875, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.pool.HikariProxyConnection 0x2e83fb96 HikariProxyConnection@780401558 wrapping org.postgresql.jdbc.PgConnection@2ed68bea], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type application/json, cookie leihs-anti-csrf-token=90abade9-82d6-4fb6-9898-f7566773263f; leihs-user-session=3d37de50-dd5a-42c5-bca6-445a84997cf0, content-length 1381, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/admin/categories/f68856713bf356f28e92b5112d0f703f, connection keep-alive, pragma no-cache, x-csrf-token 90abade9-82d6-4fb6-9898-f7566773263f, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x6f8d9afd /127.0.0.1:3230<->/127.0.0.1:65348], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x29d7116a HikariDataSource (db-pool)], :connection #object[com.zaxxer.hikari.pool.HikariProxyConnection 0x7397670 HikariProxyConnection@121206384 wrapping org.postgresql.jdbc.PgConnection@4d8a58d5], :level 1, :rollback #object[clojure.lang.Atom 0x4a8c269d {:status :ready, :val false}]}, :content-length 1381, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:operationName updateCategoriesPeriods, :variables {:mainCategories [{:id f6885671-3bf3-56f2-8e92-b5112d0f703f, :name Musikinstrumente, :new_image_url [], :categories [{:id af3372a1-63a8-52dc-850e-c2ae91c1c078, :name Musikinstrumente, :procurement_account 3111022000, :general_ledger_account 5063097000, :cost_center 11410800, :inspectors [f721d6b7-8275-5ee0-b225-aa7c13781f45 6eeeeb75-e3d8-56c9-b7b6-0c45b7795cb9], :viewers []} {:id 17a52112-1986-5074-b1d9-0faff29a785b, :name Zuteilung unbekannt - Musikinstrumente, :procurement_account 3111097000, :general_ledger_account 5063097000, :cost_center 11410800, :inspectors [f721d6b7-8275-5ee0-b225-aa7c13781f45 6eeeeb75-e3d8-56c9-b7b6-0c45b7795cb9], :viewers []}]}]}, :query mutation updateCategoriesPeriods($mainCategories: [MainCategoryInput]) {
  main_categories(input_data: $mainCategories) {
    ...MainCatProps
    __typename
  }
}

fragment MainCatProps on MainCategory {
  id
  name
  can_delete
  image_url
  categories {
    id
    name
    can_delete
    cost_center
    general_ledger_account
    procurement_account
    inspectors {
      ...UserProps
      __typename
    }
    viewers {
      ...UserProps
      __typename
    }
    __typename
  }
  __typename
}

fragment UserProps on User {
  id
  firstname
  lastname
  __typename
}
}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0x46dd5e9 leihs.procurement.graphql$handler@46dd5e9], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>> authorize::handler-key >> :graphql
>myprint>  authEnt? {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>myprint>  txn #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.pool.HikariProxyConnection 0x2e83fb96 HikariProxyConnection@780401558 wrapping org.postgresql.jdbc.PgConnection@2ed68bea], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:22.829Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:22.830Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>myprint>  admin true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:22.830Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> inspector? {:result false}
>myprint>  inspector false
>o> viewer? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:22.831Z NX-41294 DEBUG [leihs.procurement.permissions.user:83] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> viewer? {:result false}
>myprint>  viewer false
>o> requester?? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:22.832Z NX-41294 DEBUG [leihs.procurement.permissions.user:167] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> requester?? {:exists false}
>myprint>  requester false
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:22.832Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:22.832Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:22.833Z NX-41294 DEBUG [leihs.procurement.permissions.user:60] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> inspector? {:result false}
>o> viewer? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:22.833Z NX-41294 DEBUG [leihs.procurement.permissions.user:83] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> viewer? {:result false}
>o> requester?? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:22.833Z NX-41294 DEBUG [leihs.procurement.permissions.user:167] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> requester?? {:exists false}

> 1 anti-csrf-token >  90abade9-82d6-4fb6-9898-f7566773263f

> 1 anti-csrf-token class >  java.lang.String

> 2 anti-csrf-token-new >  nil
pure-handler >> 1
2023-12-11T15:36:22.838Z NX-41294 DEBUG [leihs.procurement.graphql:46] - graphql query mutation updateCategoriesPeriods($mainCategories: [MainCategoryInput]) {
  main_categories(input_data: $mainCategories) {
    ...MainCatProps
    __typename
  }
}

fragment MainCatProps on MainCategory {
  id
  name
  can_delete
  image_url
  categories {
    id
    name
    can_delete
    cost_center
    general_ledger_account
    procurement_account
    inspectors {
      ...UserProps
      __typename
    }
    viewers {
      ...UserProps
      __typename
    }
    __typename
  }
  __typename
}

fragment UserProps on User {
  id
  firstname
  lastname
  __typename
}
 with variables {:mainCategories [{:id "f6885671-3bf3-56f2-8e92-b5112d0f703f", :name "Musikinstrumente", :new_image_url [], :categories [{:id "af3372a1-63a8-52dc-850e-c2ae91c1c078", :name "Musikinstrumente", :procurement_account "3111022000", :general_ledger_account "5063097000", :cost_center "11410800", :inspectors ["f721d6b7-8275-5ee0-b225-aa7c13781f45" "6eeeeb75-e3d8-56c9-b7b6-0c45b7795cb9"], :viewers []} {:id "17a52112-1986-5074-b1d9-0faff29a785b", :name "Zuteilung unbekannt - Musikinstrumente", :procurement_account "3111097000", :general_ledger_account "5063097000", :cost_center "11410800", :inspectors ["f721d6b7-8275-5ee0-b225-aa7c13781f45" "6eeeeb75-e3d8-56c9-b7b6-0c45b7795cb9"], :viewers []}]}]}
>oo> vars from graphQL-Requst nil nil nil {:mainCategories [{:id f6885671-3bf3-56f2-8e92-b5112d0f703f, :name Musikinstrumente, :new_image_url [], :categories [{:id af3372a1-63a8-52dc-850e-c2ae91c1c078, :name Musikinstrumente, :procurement_account 3111022000, :general_ledger_account 5063097000, :cost_center 11410800, :inspectors [f721d6b7-8275-5ee0-b225-aa7c13781f45 6eeeeb75-e3d8-56c9-b7b6-0c45b7795cb9], :viewers []} {:id 17a52112-1986-5074-b1d9-0faff29a785b, :name Zuteilung unbekannt - Musikinstrumente, :procurement_account 3111097000, :general_ledger_account 5063097000, :cost_center 11410800, :inspectors [f721d6b7-8275-5ee0-b225-aa7c13781f45 6eeeeb75-e3d8-56c9-b7b6-0c45b7795cb9], :viewers []}]}]}
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.pool.HikariProxyConnection 0x2e83fb96 HikariProxyConnection@780401558 wrapping org.postgresql.jdbc.PgConnection@2ed68bea], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-11T15:36:22.852Z NX-41294 DEBUG [leihs.procurement.permissions.user:36] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-11T15:36:22.852Z NX-41294 DEBUG [leihs.procurement.permissions.user:40] - (:exists result) => true
>debug 
>o> abc tocheck >> {:id f6885671-3bf3-56f2-8e92-b5112d0f703f, :name Musikinstrumente}
>o> no / 22 / my-cast /debug  {:id f6885671-3bf3-56f2-8e92-b5112d0f703f, :name Musikinstrumente}
2023-12-11T15:36:22.854Z NX-41294 DEBUG [leihs.procurement.resources.main-category:134] - data => {:id [[:cast "f6885671-3bf3-56f2-8e92-b5112d0f703f" :uuid]], :name "Musikinstrumente"}
2023-12-11T15:36:22.854Z NX-41294 DEBUG [leihs.procurement.resources.main-category:145] - (my-cast mc) => {:id [[:cast "f6885671-3bf3-56f2-8e92-b5112d0f703f" :uuid]], :name "Musikinstrumente"}
2023-12-11T15:36:22.855Z NX-41294 DEBUG [leihs.procurement.resources.main-category:146] - (:id mc) => f6885671-3bf3-56f2-8e92-b5112d0f703f
2023-12-11T15:36:22.858Z NX-41294 DEBUG [leihs.procurement.resources.main-category:143] - (jdbc/execute! tx (-> (sql/update :procurement_main_categories) (sqlo/sset (spy (my-cast mc))) (sql/where [:= :procurement_main_categories.id [:cast (spy (:id mc)) :uuid]]) sql-format)) => [{:next.jdbc/update-count 1}]
>o> no / 22 / my-cast /debug  {:id af3372a1-63a8-52dc-850e-c2ae91c1c078, :name Musikinstrumente, :procurement_account 3111022000, :general_ledger_account 5063097000, :cost_center 11410800, :main_category_id f6885671-3bf3-56f2-8e92-b5112d0f703f}
2023-12-11T15:36:22.859Z NX-41294 DEBUG [leihs.procurement.resources.category:75] - data => {:id [[:cast "af3372a1-63a8-52dc-850e-c2ae91c1c078" :uuid]], :name "Musikinstrumente", :procurement_account "3111022000", :general_ledger_account "5063097000", :cost_center "11410800", :main_category_id [[:cast "f6885671-3bf3-56f2-8e92-b5112d0f703f" :uuid]]}
2023-12-11T15:36:22.860Z NX-41294 DEBUG [leihs.procurement.resources.category:?] - (sql-format (sql/where (sql/set (sql/update :procurement_categories) (my-cast c)) [:= :procurement_categories.id [:cast (:id c) :uuid]])) => ["UPDATE procurement_categories SET id = (CAST(? AS UUID)), name = ?, procurement_account = ?, general_ledger_account = ?, cost_center = ?, main_category_id = (CAST(? AS UUID)) WHERE procurement_categories.id = CAST(? AS UUID)" "af3372a1-63a8-52dc-850e-c2ae91c1c078" "Musikinstrumente" "3111022000" "5063097000" "11410800" "f6885671-3bf3-56f2-8e92-b5112d0f703f" "af3372a1-63a8-52dc-850e-c2ae91c1c078"]
>e> #error {
 :cause ERROR: syntax error at or near "("
  Position: 44
 :via
 [{:type org.postgresql.util.PSQLException
   :message ERROR: syntax error at or near "("
  Position: 44
   :at [org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse QueryExecutorImpl.java 2533]}]
 :trace
 [[org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse QueryExecutorImpl.java 2533]
  [org.postgresql.core.v3.QueryExecutorImpl processResults QueryExecutorImpl.java 2268]
  [org.postgresql.core.v3.QueryExecutorImpl execute QueryExecutorImpl.java 313]
  [org.postgresql.jdbc.PgStatement executeInternal PgStatement.java 448]
  [org.postgresql.jdbc.PgStatement execute PgStatement.java 369]
  [org.postgresql.jdbc.PgPreparedStatement executeWithFlags PgPreparedStatement.java 159]
  [org.postgresql.jdbc.PgPreparedStatement execute PgPreparedStatement.java 148]
  [com.zaxxer.hikari.pool.ProxyPreparedStatement execute ProxyPreparedStatement.java 44]
  [com.zaxxer.hikari.pool.HikariProxyPreparedStatement execute HikariProxyPreparedStatement.java -1]
  [next.jdbc.result_set$stmt__GT_result_set invokeStatic result_set.clj 669]
  [next.jdbc.result_set$stmt__GT_result_set invoke result_set.clj 664]
  [next.jdbc.result_set$eval11828$fn__11836 invoke result_set.clj 897]
  [next.jdbc.protocols$eval10723$fn__10754$G__10714__10763 invoke protocols.clj 34]
  [next.jdbc.default_options$eval11019$fn__11024 invoke default_options.clj 31]
  [next.jdbc.protocols$eval10723$fn__10754$G__10714__10763 invoke protocols.clj 34]
  [next.jdbc$execute_BANG_ invokeStatic jdbc.clj 251]
  [next.jdbc$execute_BANG_ invoke jdbc.clj 238]
  [leihs.procurement.resources.inspectors$delete_inspectors_for_category_id_BANG_ invokeStatic inspectors.clj 29]
  [leihs.procurement.resources.inspectors$delete_inspectors_for_category_id_BANG_ invoke inspectors.clj 27]
  [leihs.procurement.resources.inspectors$update_inspectors_BANG_ invokeStatic inspectors.clj 43]
  [leihs.procurement.resources.inspectors$update_inspectors_BANG_ invoke inspectors.clj 41]
  [leihs.procurement.resources.categories$update_categories_BANG_ invokeStatic categories.clj 118]
  [leihs.procurement.resources.categories$update_categories_BANG_ invoke categories.clj 105]
  [leihs.procurement.resources.main_categories$update_main_categories_BANG_ invokeStatic main_categories.clj 122]
  [leihs.procurement.resources.main_categories$update_main_categories_BANG_ invoke main_categories.clj 88]
  [leihs.procurement.authorization$wrap_ensure_one_of$fn__39312 invoke authorization.clj 39]
  [leihs.procurement.graphql.resolver$wrap_resolver_with_error$fn__45133 invoke resolver.clj 16]
  [com.walmartlabs.lacinia.schema$wrap_resolver_to_ensure_resolver_result$fn__14023 invoke schema.clj 986]
  [com.walmartlabs.lacinia.executor$invoke_resolver_for_field invokeStatic executor.clj 86]
  [com.walmartlabs.lacinia.executor$invoke_resolver_for_field invoke executor.clj 68]
  [com.walmartlabs.lacinia.executor$resolve_and_select invokeStatic executor.clj 353]
  [com.walmartlabs.lacinia.executor$resolve_and_select invoke executor.clj 234]
  [com.walmartlabs.lacinia.executor$apply_field_selection invokeStatic executor.clj 140]
  [com.walmartlabs.lacinia.executor$apply_field_selection invoke executor.clj 135]
  [com.walmartlabs.lacinia.executor$apply_selection invokeStatic executor.clj 173]
  [com.walmartlabs.lacinia.executor$apply_selection invoke executor.clj 165]
  [com.walmartlabs.lacinia.executor$combine_selection_results_sync$fn__17487 invoke executor.clj 212]
  [com.walmartlabs.lacinia.resolve.ResolverResultImpl on_deliver_BANG_ resolve.clj 135]
  [com.walmartlabs.lacinia.executor$combine_selection_results_sync invokeStatic executor.clj 208]
  [com.walmartlabs.lacinia.executor$combine_selection_results_sync invoke executor.clj 203]
  [com.walmartlabs.lacinia.executor$execute_nested_selections_sync$fn__17494 invoke executor.clj 230]
  [clojure.lang.ArrayChunk reduce ArrayChunk.java 58]
  [clojure.core.protocols$fn__8176 invokeStatic protocols.clj 136]
  [clojure.core.protocols$fn__8176 invoke protocols.clj 124]
  [clojure.core.protocols$fn__8136$G__8131__8145 invoke protocols.clj 19]
  [clojure.core.protocols$seq_reduce invokeStatic protocols.clj 31]
  [clojure.core.protocols$fn__8168 invokeStatic protocols.clj 75]
  [clojure.core.protocols$fn__8168 invoke protocols.clj 75]
  [clojure.core.protocols$fn__8110$G__8105__8123 invoke protocols.clj 13]
  [clojure.core$reduce invokeStatic core.clj 6830]
  [clojure.core$reduce invoke core.clj 6812]
  [com.walmartlabs.lacinia.executor$execute_nested_selections_sync invokeStatic executor.clj 230]
  [com.walmartlabs.lacinia.executor$execute_nested_selections_sync invoke executor.clj 221]
  [com.walmartlabs.lacinia.executor$execute_query$fn__17519 invoke executor.clj 400]
  [clojure.lang.AFn applyToHelper AFn.java 152]
  [clojure.lang.AFn applyTo AFn.java 144]
  [clojure.core$apply invokeStatic core.clj 667]
  [clojure.core$with_bindings_STAR_ invokeStatic core.clj 1977]
  [clojure.core$with_bindings_STAR_ doInvoke core.clj 1977]
  [clojure.lang.RestFn invoke RestFn.java 425]
  [clojure.lang.AFn applyToHelper AFn.java 156]
  [clojure.lang.RestFn applyTo RestFn.java 132]
  [clojure.core$apply invokeStatic core.clj 671]
  [clojure.core$bound_fn_STAR_$fn__5767 doInvoke core.clj 2007]
  [clojure.lang.RestFn invoke RestFn.java 397]
  [com.walmartlabs.lacinia.executor$execute_query$fn__17524 invoke executor.clj 421]
  [clojure.core$binding_conveyor_fn$fn__5772 invoke core.clj 2034]
  [clojure.lang.AFn call AFn.java 18]
  [java.util.concurrent.FutureTask run FutureTask.java 264]
  [java.util.concurrent.ThreadPoolExecutor runWorker ThreadPoolExecutor.java 1128]
  [java.util.concurrent.ThreadPoolExecutor$Worker run ThreadPoolExecutor.java 628]
  [java.lang.Thread run Thread.java 829]]}
2023-12-11T15:36:22.869Z NX-41294 WARN [leihs.procurement.graphql.resolver:326] - ERROR: syntax error at or near "("
  Position: 44
2023-12-11T15:36:22.869Z NX-41294 DEBUG [leihs.procurement.graphql.resolver:326] - #error {
 :cause ERROR: syntax error at or near "("
  Position: 44
 :via
 [{:type org.postgresql.util.PSQLException
   :message ERROR: syntax error at or near "("
  Position: 44
   :at [org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse QueryExecutorImpl.java 2533]}]
 :trace
 [[org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse QueryExecutorImpl.java 2533]
  [org.postgresql.core.v3.QueryExecutorImpl processResults QueryExecutorImpl.java 2268]
  [org.postgresql.core.v3.QueryExecutorImpl execute QueryExecutorImpl.java 313]
  [org.postgresql.jdbc.PgStatement executeInternal PgStatement.java 448]
  [org.postgresql.jdbc.PgStatement execute PgStatement.java 369]
  [org.postgresql.jdbc.PgPreparedStatement executeWithFlags PgPreparedStatement.java 159]
  [org.postgresql.jdbc.PgPreparedStatement execute PgPreparedStatement.java 148]
  [com.zaxxer.hikari.pool.ProxyPreparedStatement execute ProxyPreparedStatement.java 44]
  [com.zaxxer.hikari.pool.HikariProxyPreparedStatement execute HikariProxyPreparedStatement.java -1]
  [next.jdbc.result_set$stmt__GT_result_set invokeStatic result_set.clj 669]
  [next.jdbc.result_set$stmt__GT_result_set invoke result_set.clj 664]
  [next.jdbc.result_set$eval11828$fn__11836 invoke result_set.clj 897]
  [next.jdbc.protocols$eval10723$fn__10754$G__10714__10763 invoke protocols.clj 34]
  [next.jdbc.default_options$eval11019$fn__11024 invoke default_options.clj 31]
  [next.jdbc.protocols$eval10723$fn__10754$G__10714__10763 invoke protocols.clj 34]
  [next.jdbc$execute_BANG_ invokeStatic jdbc.clj 251]
  [next.jdbc$execute_BANG_ invoke jdbc.clj 238]
  [leihs.procurement.resources.inspectors$delete_inspectors_for_category_id_BANG_ invokeStatic inspectors.clj 29]
  [leihs.procurement.resources.inspectors$delete_inspectors_for_category_id_BANG_ invoke inspectors.clj 27]
  [leihs.procurement.resources.inspectors$update_inspectors_BANG_ invokeStatic inspectors.clj 43]
  [leihs.procurement.resources.inspectors$update_inspectors_BANG_ invoke inspectors.clj 41]
  [leihs.procurement.resources.categories$update_categories_BANG_ invokeStatic categories.clj 118]
  [leihs.procurement.resources.categories$update_categories_BANG_ invoke categories.clj 105]
  [leihs.procurement.resources.main_categories$update_main_categories_BANG_ invokeStatic main_categories.clj 122]
  [leihs.procurement.resources.main_categories$update_main_categories_BANG_ invoke main_categories.clj 88]
  [leihs.procurement.authorization$wrap_ensure_one_of$fn__39312 invoke authorization.clj 39]
  [leihs.procurement.graphql.resolver$wrap_resolver_with_error$fn__45133 invoke resolver.clj 16]
  [com.walmartlabs.lacinia.schema$wrap_resolver_to_ensure_resolver_result$fn__14023 invoke schema.clj 986]
  [com.walmartlabs.lacinia.executor$invoke_resolver_for_field invokeStatic executor.clj 86]
  [com.walmartlabs.lacinia.executor$invoke_resolver_for_field invoke executor.clj 68]
  [com.walmartlabs.lacinia.executor$resolve_and_select invokeStatic executor.clj 353]
  [com.walmartlabs.lacinia.executor$resolve_and_select invoke executor.clj 234]
  [com.walmartlabs.lacinia.executor$apply_field_selection invokeStatic executor.clj 140]
  [com.walmartlabs.lacinia.executor$apply_field_selection invoke executor.clj 135]
  [com.walmartlabs.lacinia.executor$apply_selection invokeStatic executor.clj 173]
  [com.walmartlabs.lacinia.executor$apply_selection invoke executor.clj 165]
  [com.walmartlabs.lacinia.executor$combine_selection_results_sync$fn__17487 invoke executor.clj 212]
  [com.walmartlabs.lacinia.resolve.ResolverResultImpl on_deliver_BANG_ resolve.clj 135]
  [com.walmartlabs.lacinia.executor$combine_selection_results_sync invokeStatic executor.clj 208]
  [com.walmartlabs.lacinia.executor$combine_selection_results_sync invoke executor.clj 203]
  [com.walmartlabs.lacinia.executor$execute_nested_selections_sync$fn__17494 invoke executor.clj 230]
  [clojure.lang.ArrayChunk reduce ArrayChunk.java 58]
  [clojure.core.protocols$fn__8176 invokeStatic protocols.clj 136]
  [clojure.core.protocols$fn__8176 invoke protocols.clj 124]
  [clojure.core.protocols$fn__8136$G__8131__8145 invoke protocols.clj 19]
  [clojure.core.protocols$seq_reduce invokeStatic protocols.clj 31]
  [clojure.core.protocols$fn__8168 invokeStatic protocols.clj 75]
  [clojure.core.protocols$fn__8168 invoke protocols.clj 75]
  [clojure.core.protocols$fn__8110$G__8105__8123 invoke protocols.clj 13]
  [clojure.core$reduce invokeStatic core.clj 6830]
  [clojure.core$reduce invoke core.clj 6812]
  [com.walmartlabs.lacinia.executor$execute_nested_selections_sync invokeStatic executor.clj 230]
  [com.walmartlabs.lacinia.executor$execute_nested_selections_sync invoke executor.clj 221]
  [com.walmartlabs.lacinia.executor$execute_query$fn__17519 invoke executor.clj 400]
  [clojure.lang.AFn applyToHelper AFn.java 152]
  [clojure.lang.AFn applyTo AFn.java 144]
  [clojure.core$apply invokeStatic core.clj 667]
  [clojure.core$with_bindings_STAR_ invokeStatic core.clj 1977]
  [clojure.core$with_bindings_STAR_ doInvoke core.clj 1977]
  [clojure.lang.RestFn invoke RestFn.java 425]
  [clojure.lang.AFn applyToHelper AFn.java 156]
  [clojure.lang.RestFn applyTo RestFn.java 132]
  [clojure.core$apply invokeStatic core.clj 671]
  [clojure.core$bound_fn_STAR_$fn__5767 doInvoke core.clj 2007]
  [clojure.lang.RestFn invoke RestFn.java 397]
  [com.walmartlabs.lacinia.executor$execute_query$fn__17524 invoke executor.clj 421]
  [clojure.core$binding_conveyor_fn$fn__5772 invoke core.clj 2034]
  [clojure.lang.AFn call AFn.java 18]
  [java.util.concurrent.FutureTask run FutureTask.java 264]
  [java.util.concurrent.ThreadPoolExecutor runWorker ThreadPoolExecutor.java 1128]
  [java.util.concurrent.ThreadPoolExecutor$Worker run ThreadPoolExecutor.java 628]
  [java.lang.Thread run Thread.java 829]]}

>request-grapql _> request {:leihs-user-language {:name Deutsch, :locale de-CH, :default true, :active true}, :authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-11T13:47:06.369416Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "eaf44d43-6c37-4367-8386-da902cc69e3e", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 90abade9-82d6-4fb6-9898-f7566773263f}, leihs-user-session {:value 3d37de50-dd5a-42c5-bca6-445a84997cf0}}, :remote-addr 127.0.0.1, :start-time 20609583995875, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.pool.HikariProxyConnection 0x2e83fb96 HikariProxyConnection@780401558 wrapping org.postgresql.jdbc.PgConnection@2ed68bea], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x4c80b126 next.jdbc.result_set$as_unqualified_lower_maps@4c80b126]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type application/json, cookie leihs-anti-csrf-token=90abade9-82d6-4fb6-9898-f7566773263f; leihs-user-session=3d37de50-dd5a-42c5-bca6-445a84997cf0, content-length 1381, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/admin/categories/f68856713bf356f28e92b5112d0f703f, connection keep-alive, pragma no-cache, x-csrf-token 90abade9-82d6-4fb6-9898-f7566773263f, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x6f8d9afd /127.0.0.1:3230<->/127.0.0.1:65348], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x29d7116a HikariDataSource (db-pool)], :connection #object[com.zaxxer.hikari.pool.HikariProxyConnection 0x7397670 HikariProxyConnection@121206384 wrapping org.postgresql.jdbc.PgConnection@4d8a58d5], :level 2, :rollback #object[clojure.lang.Atom 0x4a8c269d {:status :ready, :val false}]}, :content-length 1381, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:operationName updateCategoriesPeriods, :variables {:mainCategories [{:id f6885671-3bf3-56f2-8e92-b5112d0f703f, :name Musikinstrumente, :new_image_url [], :categories [{:id af3372a1-63a8-52dc-850e-c2ae91c1c078, :name Musikinstrumente, :procurement_account 3111022000, :general_ledger_account 5063097000, :cost_center 11410800, :inspectors [f721d6b7-8275-5ee0-b225-aa7c13781f45 6eeeeb75-e3d8-56c9-b7b6-0c45b7795cb9], :viewers []} {:id 17a52112-1986-5074-b1d9-0faff29a785b, :name Zuteilung unbekannt - Musikinstrumente, :procurement_account 3111097000, :general_ledger_account 5063097000, :cost_center 11410800, :inspectors [f721d6b7-8275-5ee0-b225-aa7c13781f45 6eeeeb75-e3d8-56c9-b7b6-0c45b7795cb9], :viewers []}]}]}, :query mutation updateCategoriesPeriods($mainCategories: [MainCategoryInput]) {
  main_categories(input_data: $mainCategories) {
    ...MainCatProps
    __typename
  }
}

fragment MainCatProps on MainCategory {
  id
  name
  can_delete
  image_url
  categories {
    id
    name
    can_delete
    cost_center
    general_ledger_account
    procurement_account
    inspectors {
      ...UserProps
      __typename
    }
    viewers {
      ...UserProps
      __typename
    }
    __typename
  }
  __typename
}

fragment UserProps on User {
  id
  firstname
  lastname
  __typename
}
}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0x46dd5e9 leihs.procurement.graphql$handler@46dd5e9], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>request-c-grapql _> request (json) {"leihs-user-language":{"name":"Deutsch","locale":"de-CH","default":true,"active":true},"authenticated-entity":{"email":"manuel.radl@zhdk.ch","contracts_count":1,"lastname":"Radl","org_id":"271682","scope_read":true,"is_admin":true,"authentication-method":"session","login":"mradl","scope_system_admin_write":true,"scope_write":true,"firstname":"Manuel","scope_admin_write":true,"user_session_created_at":"2023-12-11T13:47:06.369416Z","id":"a786135f-c159-4618-9dd3-0012ebb3d500","user_session_id":"eaf44d43-6c37-4367-8386-da902cc69e3e","scope_system_admin_read":true,"access-rights":[{"role":"customer","inventory_pool_id":"3977012c-ce0e-501f-889b-8715fdb5d83b"},{"role":"customer","inventory_pool_id":"5863967f-9804-4909-a9b7-92254616d6b2"},{"role":"customer","inventory_pool_id":"5dd25b58-fa56-5095-bd97-2696d92c2fb1"},{"role":"customer","inventory_pool_id":"77e88ec8-9ff6-5435-818e-dc902fc631a6"},{"role":"inventory_manager","inventory_pool_id":"8bd16d45-056d-5590-bc7f-12849f034351"},{"role":"inventory_manager","inventory_pool_id":"a02b8163-9a16-5066-b48e-9eb74cf8b791"},{"role":"inventory_manager","inventory_pool_id":"b534b07c-d9bf-4572-840c-0a630b8cd8ed"},{"role":"customer","inventory_pool_id":"fc5a841e-36c6-5dc3-8207-1306c1fb89bf"},{"role":"customer","inventory_pool_id":"ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}],"user_id":"a786135f-c159-4618-9dd3-0012ebb3d500","is_system_admin":true,"external_sign_out_url":null,"language_locale":"de-CH","inventory_pool_roles_count":9,"scope_admin_read":true},"cookies":{"leihs-anti-csrf-token":{"value":"90abade9-82d6-4fb6-9898-f7566773263f"},"leihs-user-session":{"value":"3d37de50-dd5a-42c5-bca6-445a84997cf0"}},"remote-addr":"127.0.0.1","start-time":20609583995875,"params":{},"settings":{"email_sending_enabled":false,"sessions_max_lifetime_secs":432000,"smtp_default_from_address":"noreply@zhdk.ch","public_image_caching_enabled":true,"sessions_force_secure":false,"deliver_received_order_notifications":false,"external_base_url":"http:\/\/localhost:3200","sessions_force_uniqueness":false,"email_signature":"Das ZHdK-Ausleihe-Team"},"query-params-raw":{},"route-params":null,"headers":{"origin":"http:\/\/localhost:3230","sec-fetch-site":"same-origin","sec-ch-ua-mobile":"?0","host":"localhost:3230","user-agent":"Mozilla\/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit\/537.36 (KHTML, like Gecko) Chrome\/119.0.0.0 Safari\/537.36","content-type":"application\/json","cookie":"leihs-anti-csrf-token=90abade9-82d6-4fb6-9898-f7566773263f; leihs-user-session=3d37de50-dd5a-42c5-bca6-445a84997cf0","content-length":"1381","sec-ch-ua":"\"Google Chrome\";v=\"119\", \"Chromium\";v=\"119\", \"Not?A_Brand\";v=\"24\"","sec-ch-ua-platform":"\"macOS\"","referer":"http:\/\/localhost:3230\/procure\/admin\/categories\/f68856713bf356f28e92b5112d0f703f","connection":"keep-alive","pragma":"no-cache","x-csrf-token":"90abade9-82d6-4fb6-9898-f7566773263f","accept":"application\/json","accept-language":"de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7","sec-fetch-dest":"empty","accept-encoding":"gzip, deflate, br","sec-fetch-mode":"cors","cache-control":"no-cache"},"server-port":3230,"params-raw":{},"content-length":1381,"form-params":{},"websocket?":false,"query-params":{},"content-type":"application\/json","form-params-raw":{},"character-encoding":"utf8","uri":"\/procure\/graphql","server-name":"localhost","handler-key":"graphql","query-string":null,"body":{"operationName":"updateCategoriesPeriods","variables":{"mainCategories":[{"id":"f6885671-3bf3-56f2-8e92-b5112d0f703f","name":"Musikinstrumente","new_image_url":[],"categories":[{"id":"af3372a1-63a8-52dc-850e-c2ae91c1c078","name":"Musikinstrumente","procurement_account":"3111022000","general_ledger_account":"5063097000","cost_center":"11410800","inspectors":["f721d6b7-8275-5ee0-b225-aa7c13781f45","6eeeeb75-e3d8-56c9-b7b6-0c45b7795cb9"],"viewers":[]},{"id":"17a52112-1986-5074-b1d9-0faff29a785b","name":"Zuteilung unbekannt - Musikinstrumente","procurement_account":"3111097000","general_ledger_account":"5063097000","cost_center":"11410800","inspectors":["f721d6b7-8275-5ee0-b225-aa7c13781f45","6eeeeb75-e3d8-56c9-b7b6-0c45b7795cb9"],"viewers":[]}]}]},"query":"mutation updateCategoriesPeriods($mainCategories: [MainCategoryInput]) {\n  main_categories(input_data: $mainCategories) {\n    ...MainCatProps\n    __typename\n  }\n}\n\nfragment MainCatProps on MainCategory {\n  id\n  name\n  can_delete\n  image_url\n  categories {\n    id\n    name\n    can_delete\n    cost_center\n    general_ledger_account\n    procurement_account\n    inspectors {\n      ...UserProps\n      __typename\n    }\n    viewers {\n      ...UserProps\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment UserProps on User {\n  id\n  firstname\n  lastname\n  __typename\n}\n"},"multipart-params":{},"scheme":"http","request-method":"post","accept":{"mime":"json","charset":null,"encoding":null,"language":null}}

>request-grapql _> result => {:data #ordered/map ([:main_categories nil]), :errors ({:message ERROR: syntax error at or near "("
  Position: 44, :locations [{:line 2, :column 3}], :path [:main_categories], :extensions {:exception PSQLException, :arguments {:input_data $mainCategories}}})}
2023-12-11T15:36:22.873Z NX-41294 DEBUG [leihs.procurement.graphql:86] - result => {:data #ordered/map ([:main_categories nil]), :errors ({:message "ERROR: syntax error at or near \"(\"\n  Position: 44", :locations [{:line 2, :column 3}], :path [:main_categories], :extensions {:exception "PSQLException", :arguments {:input_data $mainCategories}}})}
2023-12-11T15:36:22.873Z NX-41294 DEBUG [leihs.procurement.graphql:87] - {:data #ordered/map ([:main_categories nil]), :errors ({:message "ERROR: syntax error at or near \"(\"\n  Position: 44", :locations [{:line 2, :column 3}], :path [:main_categories], :extensions {:exception "PSQLException", :arguments {:input_data $mainCategories}}})}

>o> ERROR 4pure-handler, result=> {:data #ordered/map ([:main_categories nil]), :errors ({:message ERROR: syntax error at or near "("
  Position: 44, :locations [{:line 2, :column 3}], :path [:main_categories], :extensions {:exception PSQLException, :arguments {:input_data $mainCategories}}})}
