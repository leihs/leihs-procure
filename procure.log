# java_leihs-procure-server env check via asdf v0.13.1
# java_leihs-procure-server env skipped update; touch .tool-versions or remove /var/folders/jl/49spzkdd2v3cdz37fgmp0ddr6cj76v/T/asdf_cache_java_leihs-procure-server to force update
# clojure_leihs-procure-server env check via asdf v0.13.1
# clojure_leihs-procure-server env skipped update; touch .tool-versions or remove /var/folders/jl/49spzkdd2v3cdz37fgmp0ddr6cj76v/T/asdf_cache_clojure_leihs-procure-server to force update
Warning: environ value /Users/mradl/.asdf/installs/java/zulu-11.60.19 for key :java-home has been overwritten with /Users/mradl/.asdf/installs/java/zulu-11.60.19/zulu-11.jdk/Contents/Home
>oo >tocheck users3 sql-order-users, sqlmap= {:select [:users.id :users.firstname :users.lastname], :from [:users]}
>oo >tocheck users3 sql-order-users, sqlmap= {:select [:users.*], :from [:users], :where [:in :users.id {:select [:procurement_admins.user_id], :from [:procurement_admins]}]}
>o> conc concat(lower(coalesce(procurement_requests.article_name, '')), lower(coalesce(models.product, '')), lower(coalesce(models.version, '')))
2023-12-12T11:31:17.927Z NX-41294 DEBUG [leihs.procurement.resources.request:209] - (-> (sql/select [[:raw (str "DISTINCT ON (procurement_requests.id, " conc ") procurement_requests.*")]]) (sql/from :procurement_requests) (sql/left-join :models [:= :models.id :procurement_requests.model_id]) (sql/order-by :procurement_requests.id [[:raw conc]])) => {:select [[[:raw "DISTINCT ON (procurement_requests.id, concat(lower(coalesce(procurement_requests.article_name, '')), lower(coalesce(models.product, '')), lower(coalesce(models.version, '')))) procurement_requests.*"]]], :from [:procurement_requests], :left-join [:models [:= :models.id :procurement_requests.model_id]], :order-by [:procurement_requests.id [[:raw "concat(lower(coalesce(procurement_requests.article_name, '')), lower(coalesce(models.product, '')), lower(coalesce(models.version, '')))"]]]}
>o> templates::templates-base-query ERROR?
2023-12-12T11:31:17.981Z NX-41294 DEBUG [leihs.procurement.resources.templates:27] - (-> (sql/select :procurement_templates.*) (sql/from :procurement_templates) (sql/left-join :models [:= :models.id :procurement_templates.model_id]) (sql/order-by [[:concat (->> [:procurement_templates.article_name :models.product :models.version] (map (fn* [p1__44856#] (->> [:lower [:coalesce p1__44856# ""]]))))]])) => {:select [:procurement_templates.*], :from [:procurement_templates], :left-join [:models [:= :models.id :procurement_templates.model_id]], :order-by [[[:concat ([:lower [:coalesce :procurement_templates.article_name ""]] [:lower [:coalesce :models.product ""]] [:lower [:coalesce :models.version ""]])]]]}
2023-12-12T11:31:18.228Z NX-41294 WARN [leihs.core.release:13] - Failed to read releases.yml, returning bogus value 
2023-12-12T11:31:18.751Z NX-41294 INFO [leihs.core.logging:37] - initializing logging  {:min-level [[#{"leihs.procurement" "leihs.procurement.resources.*" "leihs.procurement.permissions.*" "leihs.procurement.authorization" "leihs.procurement.*"} :debug] [#{"com.zaxxer.hikari.*" "leihs.*"} :info] [#{"*"} :warn]], :log-level nil}
2023-12-12T11:31:18.754Z NX-41294 INFO [leihs.core.logging:39] - initialized logging  {:min-level [[#{"leihs.procurement" "leihs.procurement.resources.*" "leihs.procurement.permissions.*" "leihs.procurement.authorization" "leihs.procurement.*"} :debug] [#{"com.zaxxer.hikari.*" "leihs.*"} :info] [#{"*"} :warn]], :ns-filter #{"*"}, :middleware [], :timestamp-opts {:pattern :iso8601, :locale :jvm-default, :timezone :utc}, :output-fn #object[taoensso.timbre$default_output_fn 0x16c77299 "taoensso.timbre$default_output_fn@16c77299"], :appenders {:println {:enabled? true, :fn #object[taoensso.timbre.appenders.core$println_appender$fn__3459 0x60a8871f "taoensso.timbre.appenders.core$println_appender$fn__3459@60a8871f"]}}, :_init-config {:loaded-from-source :default, :compile-time-config {:min-level nil, :ns-pattern "*"}}, :log-level nil}
2023-12-12T11:31:18.756Z NX-41294 INFO [leihs.procurement.main:50] - main ("--dev-mode" "true" "--repl" "true" "run")
2023-12-12T11:31:18.767Z NX-41294 INFO [leihs.core.repl:62] - init {:dev-mode true, :repl true, :repl-bind "localhost", :repl-port 21609, :repl-port-file ".nrepl-port"}
2023-12-12T11:31:18.769Z NX-41294 INFO [leihs.core.repl:70] - starting nREPL server  21609 localhost
2023-12-12T11:31:18.787Z NX-41294 INFO [leihs.core.repl:75] - started nREPL server 
2023-12-12T11:31:18.790Z NX-41294 INFO [leihs.procurement.run:326] - Invoking run with options:  {:db-host localhost, :db-max-pool-size 16, :db-min-pool-size 2, :db-name leihs_test, :db-password leihs, :db-port 5415, :db-user leihs, :dev-mode true, :http-host localhost, :http-max-threads 8, :http-min-threads 1, :http-port 3230, :http-queue-capacity 640, :http-thread-keep-alive-seconds 10, :http-worker-prefix leihs-service-http-worker-, :pid-file nil, :repl true, :repl-bind localhost, :repl-port 21609, :repl-port-file .nrepl-port}
2023-12-12T11:31:18.791Z NX-41294 INFO [leihs.core.shutdown:20] - PID 26560
2023-12-12T11:31:18.803Z NX-41294 INFO [leihs.core.shutdown:29] - Registering SIGTERM handler for shutdown.
2023-12-12T11:31:18.864Z NX-41294 INFO [leihs.core.graphql:17] - Initialized graphQL schema.
2023-12-12T11:31:18.865Z NX-41294 INFO [leihs.core.db:220] - Initializing db  {:db-name "leihs_test", :db-port 5415, :db-host "localhost", :db-user "leihs", :db-password "leihs", :db-min-pool-size 2, :db-max-pool-size 16}
2023-12-12T11:31:18.871Z NX-41294 INFO [com.zaxxer.hikari.HikariDataSource:80] - db-pool - Starting...
2023-12-12T11:31:18.944Z NX-41294 INFO [com.zaxxer.hikari.pool.HikariPool:565] - db-pool - Added connection org.postgresql.jdbc.PgConnection@2bfe7fef
2023-12-12T11:31:18.950Z NX-41294 INFO [com.zaxxer.hikari.HikariDataSource:82] - db-pool - Start completed.
2023-12-12T11:31:18.950Z NX-41294 INFO [leihs.core.db:222] - Initialized db  {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x65dc1b71 "HikariDataSource (db-pool)"]}
2023-12-12T11:31:18.951Z NX-41294 INFO [leihs.core.db:223] - Initializing ds-next  {:db-name "leihs_test", :db-port 5415, :db-host "localhost", :db-user "leihs", :db-password "leihs", :db-min-pool-size 2, :db-max-pool-size 16}
2023-12-12T11:31:18.965Z NX-41294 INFO [com.zaxxer.hikari.HikariDataSource:110] - HikariPool-1 - Starting...
2023-12-12T11:31:18.974Z NX-41294 INFO [com.zaxxer.hikari.pool.HikariPool:565] - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@6f737354
2023-12-12T11:31:18.975Z NX-41294 INFO [com.zaxxer.hikari.HikariDataSource:123] - HikariPool-1 - Start completed.
2023-12-12T11:31:18.980Z NX-41294 INFO [leihs.core.db:225] - Initialized ds-next  #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d "HikariDataSource (HikariPool-1)"], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 "next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1"]}}
2023-12-12T11:31:18.987Z NX-41294 INFO [leihs.core.http-server:101] - starting http-server  {:port 3230, :ip "localhost", :pool {:queue #object[java.util.concurrent.ArrayBlockingQueue 0x37414081 "[]"], :pool #object[java.util.concurrent.ThreadPoolExecutor 0x69d81d88 "java.util.concurrent.ThreadPoolExecutor@69d81d88[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]"]}}
2023-12-12T11:31:18.999Z NX-41294 INFO [leihs.core.http-server:104] - started http-server 
>>> authenticate::skip= nil  handler-key= :not-found
>>> authenticate::authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}

>> authorize >

>> authorize::handler > #object[leihs.core.locale$wrap$fn__45159 0x55069a5c leihs.core.locale$wrap$fn__45159@55069a5c]

>> authorize::request > {:authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 219b97e6-bb13-401e-92a7-2304bf206106}, leihs-user-session {:value d429c048-7118-407f-a7a9-b33da6f15b06}}, :remote-addr 127.0.0.1, :start-time 47991259473750, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}, :query-params-raw {}, :route-params nil, :headers {sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, cookie leihs-anti-csrf-token=219b97e6-bb13-401e-92a7-2304bf206106; leihs-user-session=d429c048-7118-407f-a7a9-b33da6f15b06, sec-fetch-user ?1, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/admin/budget-periods, connection keep-alive, upgrade-insecure-requests 1, pragma no-cache, accept text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest document, accept-encoding gzip, deflate, br, sec-fetch-mode navigate, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x14ddc722 /127.0.0.1:3230<->/127.0.0.1:53027], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x65dc1b71 HikariDataSource (db-pool)]}, :content-length 0, :form-params {}, :websocket? false, :query-params {}, :content-type nil, :form-params-raw {}, :character-encoding utf8, :uri /procure/admin/categories/dda588f4660c573ca2ff944ae93ad42e, :server-name localhost, :handler-key :not-found, :query-string nil, :body nil, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.backend.html$not_found_handler 0x51c7ef79 leihs.procurement.backend.html$not_found_handler@51c7ef79], :multipart-params {}, :scheme :http, :request-method :get, :accept {:mime :html, :charset nil, :encoding nil, :language nil}}

>> authorize::handler-key >> :not-found
>myprint>  authEnt? {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>myprint>  txn #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
2023-12-12T11:31:24.916Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:24.917Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:24.919Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>myprint>  admin true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:24.921Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> inspector? {:result false}
>myprint>  inspector false
>o> viewer? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:24.925Z NX-41294 DEBUG [leihs.procurement.permissions.user:85] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> viewer? {:result false}
>myprint>  viewer false
>o> requester?? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:24.927Z NX-41294 DEBUG [leihs.procurement.permissions.user:169] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> requester?? {:exists false}
2023-12-12T11:31:24.929Z NX-41294 DEBUG [leihs.procurement.permissions.user:173] - (:exists result) => false
>myprint>  requester false
2023-12-12T11:31:24.929Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:24.929Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:24.931Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:24.931Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> inspector? {:result false}
>o> viewer? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:24.932Z NX-41294 DEBUG [leihs.procurement.permissions.user:85] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> viewer? {:result false}
>o> requester?? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:24.933Z NX-41294 DEBUG [leihs.procurement.permissions.user:169] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> requester?? {:exists false}
2023-12-12T11:31:24.934Z NX-41294 DEBUG [leihs.procurement.permissions.user:173] - (:exists result) => false

> 1 anti-csrf-token >  219b97e6-bb13-401e-92a7-2304bf206106

> 1 anti-csrf-token class >  java.lang.String

> 2 anti-csrf-token-new >  nil
>>> authenticate::skip= nil  handler-key= :graphql
>>> authenticate::authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}

>> authorize >

>> authorize::handler > #object[leihs.core.locale$wrap$fn__45159 0x55069a5c leihs.core.locale$wrap$fn__45159@55069a5c]

>> authorize::request > {:authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 219b97e6-bb13-401e-92a7-2304bf206106}, leihs-user-session {:value d429c048-7118-407f-a7a9-b33da6f15b06}}, :remote-addr 127.0.0.1, :start-time 47991550731625, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type application/json, cookie leihs-anti-csrf-token=219b97e6-bb13-401e-92a7-2304bf206106; leihs-user-session=d429c048-7118-407f-a7a9-b33da6f15b06, content-length 502, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/admin/categories/dda588f4660c573ca2ff944ae93ad42e, connection keep-alive, pragma no-cache, x-csrf-token 219b97e6-bb13-401e-92a7-2304bf206106, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x78ec0eb /127.0.0.1:3230<->/127.0.0.1:53029], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x65dc1b71 HikariDataSource (db-pool)]}, :content-length 502, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:operationName me, :variables {}, :query query me {
  current_user {
    navbarProps
    user {
      id
      firstname
      lastname
      permissions {
        isAdmin
        isRequester
        isInspectorForCategories {
          id
          __typename
        }
        isViewerForCategories {
          id
          __typename
        }
        __typename
      }
      __typename
    }
    __typename
  }
  settings {
    contact_url
    __typename
  }
}
}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0xbde374d leihs.procurement.graphql$handler@bde374d], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>> authorize::handler-key >> :graphql
>myprint>  authEnt? {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>myprint>  txn #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
2023-12-12T11:31:25.148Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.148Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.149Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>myprint>  admin true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.149Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> inspector? {:result false}
>myprint>  inspector false
>o> viewer? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.150Z NX-41294 DEBUG [leihs.procurement.permissions.user:85] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> viewer? {:result false}
>myprint>  viewer false
>o> requester?? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.150Z NX-41294 DEBUG [leihs.procurement.permissions.user:169] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> requester?? {:exists false}
2023-12-12T11:31:25.151Z NX-41294 DEBUG [leihs.procurement.permissions.user:173] - (:exists result) => false
>myprint>  requester false
2023-12-12T11:31:25.151Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.151Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.152Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.152Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> inspector? {:result false}
>o> viewer? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.153Z NX-41294 DEBUG [leihs.procurement.permissions.user:85] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> viewer? {:result false}
>o> requester?? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.154Z NX-41294 DEBUG [leihs.procurement.permissions.user:169] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> requester?? {:exists false}
2023-12-12T11:31:25.155Z NX-41294 DEBUG [leihs.procurement.permissions.user:173] - (:exists result) => false

> 1 anti-csrf-token >  219b97e6-bb13-401e-92a7-2304bf206106

> 1 anti-csrf-token class >  java.lang.String

> 2 anti-csrf-token-new >  nil
pure-handler >> 2
2023-12-12T11:31:25.160Z NX-41294 DEBUG [leihs.procurement.graphql:46] - graphql query query me {
  current_user {
    navbarProps
    user {
      id
      firstname
      lastname
      permissions {
        isAdmin
        isRequester
        isInspectorForCategories {
          id
          __typename
        }
        isViewerForCategories {
          id
          __typename
        }
        __typename
      }
      __typename
    }
    __typename
  }
  settings {
    contact_url
    __typename
  }
}
 with variables {}
>oo> vars from graphQL-Requst nil nil nil {}
>>>1 #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"
>oo >tocheck user2
2023-12-12T11:31:25.169Z NX-41294 DEBUG [leihs.procurement.resources.user:85] - id => #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"
>o> >tocheck>
2023-12-12T11:31:25.170Z NX-41294 DEBUG [leihs.procurement.resources.user:?] - (sql-format (sql/where user-base-query [:= :id [:cast id :uuid]])) => ["SELECT id, firstname, lastname FROM users WHERE id = CAST(? AS UUID)" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>>>2 {:id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :firstname Manuel, :lastname Radl}
>>oida>> #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"
2023-12-12T11:31:25.173Z NX-41294 DEBUG [leihs.procurement.resources.saved-filters:19] - (-> (sql/select :*) (sql/from :procurement_users_filters) (sql/where [:= :user_id [:cast user-id :uuid]]) sql-format) => ["SELECT * FROM procurement_users_filters WHERE user_id = CAST(? AS UUID)" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>>>3 nil
2023-12-12T11:31:25.203Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.204Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.204Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> requester?? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.205Z NX-41294 DEBUG [leihs.procurement.permissions.user:169] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> requester?? {:exists false}
2023-12-12T11:31:25.206Z NX-41294 DEBUG [leihs.procurement.permissions.user:173] - (:exists result) => false

>request-grapql _> request {:leihs-user-language {:name Deutsch, :locale de-CH, :default true, :active true}, :authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 219b97e6-bb13-401e-92a7-2304bf206106}, leihs-user-session {:value d429c048-7118-407f-a7a9-b33da6f15b06}}, :remote-addr 127.0.0.1, :start-time 47991550731625, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type application/json, cookie leihs-anti-csrf-token=219b97e6-bb13-401e-92a7-2304bf206106; leihs-user-session=d429c048-7118-407f-a7a9-b33da6f15b06, content-length 502, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/admin/categories/dda588f4660c573ca2ff944ae93ad42e, connection keep-alive, pragma no-cache, x-csrf-token 219b97e6-bb13-401e-92a7-2304bf206106, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x78ec0eb /127.0.0.1:3230<->/127.0.0.1:53029], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x65dc1b71 HikariDataSource (db-pool)]}, :content-length 502, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:operationName me, :variables {}, :query query me {
  current_user {
    navbarProps
    user {
      id
      firstname
      lastname
      permissions {
        isAdmin
        isRequester
        isInspectorForCategories {
          id
          __typename
        }
        isViewerForCategories {
          id
          __typename
        }
        __typename
      }
      __typename
    }
    __typename
  }
  settings {
    contact_url
    __typename
  }
}
}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0xbde374d leihs.procurement.graphql$handler@bde374d], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>request-c-grapql _> request (json) {"leihs-user-language":{"name":"Deutsch","locale":"de-CH","default":true,"active":true},"authenticated-entity":{"email":"manuel.radl@zhdk.ch","contracts_count":1,"lastname":"Radl","org_id":"271682","scope_read":true,"is_admin":true,"authentication-method":"session","login":"mradl","scope_system_admin_write":true,"scope_write":true,"firstname":"Manuel","scope_admin_write":true,"user_session_created_at":"2023-12-12T11:17:19.570671Z","id":"a786135f-c159-4618-9dd3-0012ebb3d500","user_session_id":"463ca0ef-36e9-430c-b982-23371c7fc689","scope_system_admin_read":true,"access-rights":[{"role":"customer","inventory_pool_id":"3977012c-ce0e-501f-889b-8715fdb5d83b"},{"role":"customer","inventory_pool_id":"5863967f-9804-4909-a9b7-92254616d6b2"},{"role":"customer","inventory_pool_id":"5dd25b58-fa56-5095-bd97-2696d92c2fb1"},{"role":"customer","inventory_pool_id":"77e88ec8-9ff6-5435-818e-dc902fc631a6"},{"role":"inventory_manager","inventory_pool_id":"8bd16d45-056d-5590-bc7f-12849f034351"},{"role":"inventory_manager","inventory_pool_id":"a02b8163-9a16-5066-b48e-9eb74cf8b791"},{"role":"inventory_manager","inventory_pool_id":"b534b07c-d9bf-4572-840c-0a630b8cd8ed"},{"role":"customer","inventory_pool_id":"fc5a841e-36c6-5dc3-8207-1306c1fb89bf"},{"role":"customer","inventory_pool_id":"ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}],"user_id":"a786135f-c159-4618-9dd3-0012ebb3d500","is_system_admin":true,"external_sign_out_url":null,"language_locale":"de-CH","inventory_pool_roles_count":9,"scope_admin_read":true},"cookies":{"leihs-anti-csrf-token":{"value":"219b97e6-bb13-401e-92a7-2304bf206106"},"leihs-user-session":{"value":"d429c048-7118-407f-a7a9-b33da6f15b06"}},"remote-addr":"127.0.0.1","start-time":47991550731625,"params":{},"settings":{"email_sending_enabled":false,"sessions_max_lifetime_secs":432000,"smtp_default_from_address":"noreply@zhdk.ch","public_image_caching_enabled":true,"sessions_force_secure":false,"deliver_received_order_notifications":false,"external_base_url":"http:\/\/localhost:3200","sessions_force_uniqueness":false,"email_signature":"Das ZHdK-Ausleihe-Team"},"query-params-raw":{},"route-params":null,"headers":{"origin":"http:\/\/localhost:3230","sec-fetch-site":"same-origin","sec-ch-ua-mobile":"?0","host":"localhost:3230","user-agent":"Mozilla\/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit\/537.36 (KHTML, like Gecko) Chrome\/119.0.0.0 Safari\/537.36","content-type":"application\/json","cookie":"leihs-anti-csrf-token=219b97e6-bb13-401e-92a7-2304bf206106; leihs-user-session=d429c048-7118-407f-a7a9-b33da6f15b06","content-length":"502","sec-ch-ua":"\"Google Chrome\";v=\"119\", \"Chromium\";v=\"119\", \"Not?A_Brand\";v=\"24\"","sec-ch-ua-platform":"\"macOS\"","referer":"http:\/\/localhost:3230\/procure\/admin\/categories\/dda588f4660c573ca2ff944ae93ad42e","connection":"keep-alive","pragma":"no-cache","x-csrf-token":"219b97e6-bb13-401e-92a7-2304bf206106","accept":"application\/json","accept-language":"de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7","sec-fetch-dest":"empty","accept-encoding":"gzip, deflate, br","sec-fetch-mode":"cors","cache-control":"no-cache"},"server-port":3230,"params-raw":{},"content-length":502,"form-params":{},"websocket?":false,"query-params":{},"content-type":"application\/json","form-params-raw":{},"character-encoding":"utf8","uri":"\/procure\/graphql","server-name":"localhost","handler-key":"graphql","query-string":null,"body":{"operationName":"me","variables":{},"query":"query me {\n  current_user {\n    navbarProps\n    user {\n      id\n      firstname\n      lastname\n      permissions {\n        isAdmin\n        isRequester\n        isInspectorForCategories {\n          id\n          __typename\n        }\n        isViewerForCategories {\n          id\n          __typename\n        }\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  settings {\n    contact_url\n    __typename\n  }\n}\n"},"multipart-params":{},"scheme":"http","request-method":"post","accept":{"mime":"json","charset":null,"encoding":null,"language":null}}

>request-grapql _> result => {:data #ordered/map ([:current_user #ordered/map ([:navbarProps {"csrfToken":{"value":"219b97e6-bb13-401e-92a7-2304bf206106","name":"csrf-token"},"config":{"appTitle":"leihs","appColor":"gray","me":{"user":{"id":"a786135f-c159-4618-9dd3-0012ebb3d500","firstname":"Manuel","lastname":"Radl","login":"mradl","email":"manuel.radl@zhdk.ch"}},"subApps":{"borrow":true,"admin":true,"procure":false,"manage":[{"name":"Ausleihe Toni-Areal","href":"/manage/8bd16d45-056d-5590-bc7f-12849f034351/daily"},{"name":"AVS-Museum/Ausstellungen","href":"/manage/b534b07c-d9bf-4572-840c-0a630b8cd8ed/daily"},{"name":"Kostüm- und Kleinrequisitenfundus DDK","href":"/manage/a02b8163-9a16-5066-b48e-9eb74cf8b791/daily"}]},"locales":[{"name":"Deutsch","locale":"de-CH","active":true,"isDefault":true,"isSelected":true},{"name":"English","locale":"en-GB","active":true,"isDefault":false,"isSelected":false},{"name":"Castellano","locale":"es","active":true,"isDefault":false,"isSelected":false},{"name":"Züritüütsch","locale":"gsw-CH","active":true,"isDefault":false,"isSelected":false}]}}] [:user #ordered/map ([:id a786135f-c159-4618-9dd3-0012ebb3d500] [:firstname Manuel] [:lastname Radl] [:permissions #ordered/map ([:isAdmin true] [:isRequester false] [:isInspectorForCategories []] [:isViewerForCategories []] [:__typename :UserPermissions])] [:__typename :User])] [:__typename :CurrentUser])] [:settings #ordered/map ([:contact_url https://intern.zhdk.ch/index.php?id=leihs_bedarfsermittlung] [:__typename :ProcurementSettings])])}
2023-12-12T11:31:25.223Z NX-41294 DEBUG [leihs.procurement.graphql:86] - result => {:data #ordered/map ([:current_user #ordered/map ([:navbarProps "{\"csrfToken\":{\"value\":\"219b97e6-bb13-401e-92a7-2304bf206106\",\"name\":\"csrf-token\"},\"config\":{\"appTitle\":\"leihs\",\"appColor\":\"gray\",\"me\":{\"user\":{\"id\":\"a786135f-c159-4618-9dd3-0012ebb3d500\",\"firstname\":\"Manuel\",\"lastname\":\"Radl\",\"login\":\"mradl\",\"email\":\"manuel.radl@zhdk.ch\"}},\"subApps\":{\"borrow\":true,\"admin\":true,\"procure\":false,\"manage\":[{\"name\":\"Ausleihe Toni-Areal\",\"href\":\"/manage/8bd16d45-056d-5590-bc7f-12849f034351/daily\"},{\"name\":\"AVS-Museum/Ausstellungen\",\"href\":\"/manage/b534b07c-d9bf-4572-840c-0a630b8cd8ed/daily\"},{\"name\":\"Kostüm- und Kleinrequisitenfundus DDK\",\"href\":\"/manage/a02b8163-9a16-5066-b48e-9eb74cf8b791/daily\"}]},\"locales\":[{\"name\":\"Deutsch\",\"locale\":\"de-CH\",\"active\":true,\"isDefault\":true,\"isSelected\":true},{\"name\":\"English\",\"locale\":\"en-GB\",\"active\":true,\"isDefault\":false,\"isSelected\":false},{\"name\":\"Castellano\",\"locale\":\"es\",\"active\":true,\"isDefault\":false,\"isSelected\":false},{\"name\":\"Züritüütsch\",\"locale\":\"gsw-CH\",\"active\":true,\"isDefault\":false,\"isSelected\":false}]}}"] [:user #ordered/map ([:id "a786135f-c159-4618-9dd3-0012ebb3d500"] [:firstname "Manuel"] [:lastname "Radl"] [:permissions #ordered/map ([:isAdmin true] [:isRequester false] [:isInspectorForCategories []] [:isViewerForCategories []] [:__typename :UserPermissions])] [:__typename :User])] [:__typename :CurrentUser])] [:settings #ordered/map ([:contact_url "https://intern.zhdk.ch/index.php?id=leihs_bedarfsermittlung"] [:__typename :ProcurementSettings])])}
>>> authenticate::skip= nil  handler-key= :graphql
>>> authenticate::authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}

>> authorize >

>> authorize::handler > #object[leihs.core.locale$wrap$fn__45159 0x55069a5c leihs.core.locale$wrap$fn__45159@55069a5c]

>> authorize::request > {:authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 219b97e6-bb13-401e-92a7-2304bf206106}, leihs-user-session {:value d429c048-7118-407f-a7a9-b33da6f15b06}}, :remote-addr 127.0.0.1, :start-time 47991699419458, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type application/json, cookie leihs-anti-csrf-token=219b97e6-bb13-401e-92a7-2304bf206106; leihs-user-session=d429c048-7118-407f-a7a9-b33da6f15b06, content-length 255, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/admin/categories/dda588f4660c573ca2ff944ae93ad42e, connection keep-alive, pragma no-cache, x-csrf-token 219b97e6-bb13-401e-92a7-2304bf206106, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x55e131e /127.0.0.1:3230<->/127.0.0.1:53029], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x65dc1b71 HikariDataSource (db-pool)]}, :content-length 255, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:operationName MainCategoriesIndex, :variables {}, :query query MainCategoriesIndex {
  main_categories {
    id
    name
    image_url
    categories {
      id
      name
      can_delete
      __typename
    }
    __typename
  }
}
}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0xbde374d leihs.procurement.graphql$handler@bde374d], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>> authorize::handler-key >> :graphql
>myprint>  authEnt? {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>myprint>  txn #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
2023-12-12T11:31:25.291Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.291Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.292Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>myprint>  admin true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.292Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> inspector? {:result false}
>myprint>  inspector false
>o> viewer? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.293Z NX-41294 DEBUG [leihs.procurement.permissions.user:85] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> viewer? {:result false}
>myprint>  viewer false
>o> requester?? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.293Z NX-41294 DEBUG [leihs.procurement.permissions.user:169] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> requester?? {:exists false}
2023-12-12T11:31:25.294Z NX-41294 DEBUG [leihs.procurement.permissions.user:173] - (:exists result) => false
>myprint>  requester false
2023-12-12T11:31:25.295Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.295Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.295Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.296Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> inspector? {:result false}
>o> viewer? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.296Z NX-41294 DEBUG [leihs.procurement.permissions.user:85] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> viewer? {:result false}
>o> requester?? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.297Z NX-41294 DEBUG [leihs.procurement.permissions.user:169] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> requester?? {:exists false}
2023-12-12T11:31:25.297Z NX-41294 DEBUG [leihs.procurement.permissions.user:173] - (:exists result) => false

> 1 anti-csrf-token >  219b97e6-bb13-401e-92a7-2304bf206106

> 1 anti-csrf-token class >  java.lang.String

> 2 anti-csrf-token-new >  nil
pure-handler >> 2
2023-12-12T11:31:25.300Z NX-41294 DEBUG [leihs.procurement.graphql:46] - graphql query query MainCategoriesIndex {
  main_categories {
    id
    name
    image_url
    categories {
      id
      name
      can_delete
      __typename
    }
    __typename
  }
}
 with variables {}
>oo> vars from graphQL-Requst nil nil nil {}
>debug 2
>debug 3
2023-12-12T11:31:25.305Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format main-categories-base-query) => ["SELECT procurement_main_categories.* FROM procurement_main_categories ORDER BY procurement_main_categories.name ASC"]
>debug 4
>debug 5 {:id #uuid "519f7a95-9ca7-5256-bf63-142cfc23dc62", :name Audio- und Videotechnik}
>debug 5a id #uuid "519f7a95-9ca7-5256-bf63-142cfc23dc62"
2023-12-12T11:31:25.308Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "519f7a95-9ca7-5256-bf63-142cfc23dc62"]
>debug 5b {:main_category_id #uuid "519f7a95-9ca7-5256-bf63-142cfc23dc62", :content iVBORw0KGgoAAAANSUhEUgAAAHAAAACACAYAAADTcu1SAAAABHNCSVQICAgI
fAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAAA9tJREFUeJzt3U1rVFcAgOE3
Y6maVJeK/gIpbWmtJtaPneCqiOBfKLTgv3EtVPAPCEKroGsVEYpYu5LSYpd+
tDXtKtPFyQRTJ7lzzz0fOZn3gbNy7szNeefeTO7FOSBJkiRJkiRJkiRJkiRJ
kqTdYCHi8V8AF4AV4BhwBDgQ8Vy1jYG/gD+AX4AHwI/AT+v/tqvsB64QftDx
Lh8/A98B+5LM3A5wGfid+hNbevwGXEowfyl8TDg7/AusAreAz7o2WgJuUH8i
a4/rwGLXZGX0JfBqyn6tAstbbXQYeDxlo3kdj9bnpLQTTI83GfembXQYeLbN
RvM6ngGHOqc8na54Y+Cf/2+0hEfeduMRZU6ns8SbjE38ndc9vu+a/YFOAq97
7M+GyxE/zLyOi90dovSNtxFwP/P5p0Ls+BXY292jl2X6x9sIeKXSRLQ8vu1u
MrPYeGMIl8Dm4QpL6vGUNJcPl4E3A/aD4ztgMlodnVdDOqwwLN54RLgwrThD
5m4FuAMcHLIDo/UnUpxTA7YbHA/gA8ItIcWJmbtJvAMpdmBEuJ+nOEd7Pj5p
PAifotZo72bsTrEG7JnxsV8Bt0kYD0K4cconnEOzvPlPE+7nJY0H4RSqvLLF
g/AhRvmcJpw2P8r1Ah6B+WSPBwbM5QwF4oEBczhL+J2XPR4YMLWzwA8Uigd+
iElpcuQtlXxRj8A0zlEhHhgwhXOE02bxeOCVmBTeUikeGLB5nkIbZ8DGGbBx
BmycARtnwMYZsHEGbJwBG2fAxhmwcQZsnAEbZ8DGGbBxBmycARtnwMYZsHEG
bJwBG2fA4V7VfHEDDneeihENONxjKkY0YBrVIhownSoRDZhW8YgGTK9oRAPm
USyiAfMpEtGAeWWPaMD8skYc4X/wHGJtxsdlizgiLMGmOH/2eGyWiCPC+nmK
86Ln45NHHBG+sV5xYuYuacQRYeVKxbkfuV3SiJ9T/+v7Wx2fRMz3u44DLwfu
AwuEZUdrT0Zr4wlpvqp6UMTJnxFXE+zIvLnK+hEwUJLT6T7CmrG139WtjOfA
h1EzvbXYI3HDpYIT0Pr4uqtGpJiIm1xP8MPt9nGtI8JQfSNuskhYZrT2JO3U
8ZCw1mJufSK+x0WQp4/SiyDPEvG9RZAnDuGR+O54SNl4E10R72638SJhwd/a
k1d7XKPMaXMrW0V8S1hzt9NFwpqxtSey9HhOvk+bfR0DbgGrwN/ATXpeBdpL
WDP2KfUnNvd4AnxD+r/zsuh7KWgB+JSwcuUpwjvjKGEhw9bu7q8R7ue9INxV
uE/44vLJm1SSJEmSJEmSJEmSJEmSJEkq5j8E8YerHU6LEAAAAABJRU5ErkJg
gg==
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 1081, :content_type image/png, :filename video.png, :id #uuid "ee215167-b2c3-5fcc-90c3-098ad20d16ea", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.014, :System:Directory /tmp/tmp.qSpfBizLgM, :System:FileSize 1081 bytes, :PNG:ImageHeight 128, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 112x128, :PNG:ColorType RGB with Alpha, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 112, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/video.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName video.png, :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-12T11:31:25.312Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "519f7a95-9ca7-5256-bf63-142cfc23dc62"]
>debug 4
>debug 5 {:id #uuid "1a047acd-dc98-52c2-99d3-dc6332adc1e0", :name Bauliche Anpassungen und Mobiliar}
>debug 5a id #uuid "1a047acd-dc98-52c2-99d3-dc6332adc1e0"
2023-12-12T11:31:25.313Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "1a047acd-dc98-52c2-99d3-dc6332adc1e0"]
>debug 5b {:main_category_id #uuid "1a047acd-dc98-52c2-99d3-dc6332adc1e0", :content iVBORw0KGgoAAAANSUhEUgAAAGQAAACACAYAAAD9N8zAAAAABHNCSVQICAgI
fAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAABiNJREFUeJztnXmoVVUUh7+r
PvVpZebLHDJDsGywMiuLioSIIsMsMiqpoIIgqEwKLYUiqCAaoD+KlCQblKKR
BopSG0xJyyJKmp2liTSnJn32x763nqd97rD2uffu897vgwXCO2etvffv3Lv3
XnudKwghhBBCCCGEEEIIIYQQQgghhBBCCCFyTqHZDciAfsCw4r/XA781sS1d
lm7AFcAKYE/ClgNTCH/Y7gB+9/ivZKuAwwJj54r+wJtUHpjXcJ8eC0Or8F/O
5hrj5o6RwFdUPzBfACMMcY6uIYbPXrJ0Lm+MB36l9sH5GTitxlgSpALXAH9j
H6A/cXNOtUiQFLoD9xM2OB3tLtyCoBISxMO+wCtkJ0bJngP6VIgtQRIMBz4j
ezFK9hEwpEz8pglSzce30ZyC20uMrmOMscUYY+oYw0RsgkwBFgMDGxBrKLAE
mNSAWLmjG3An9q+Ir4tmubcdmM7eO/suPYf0AZ7F3vmFwAFFWxTgZy7Qs9im
LivIEPz5qGrtUaClg7+ewJwAf+8CbXRRQY4HNmDr8G5gKv4EYgG4CfdVZPH9
LXCR8d7cCnIBsANbZ7cCE6qIcR6wzRgjJCuQK0EKwAzsHV1DbcvhY4C1AfE6
tSC9gHnYO7kU/3K4BXi4aC2evx8ELAuI2ykFORB4H3sHnwJ6e/wOYO+VVWnF
laQ38HRA/E4lyFHA99g7dxv+yfsI3AScvP4bYJTn+gIwK6AdnUKQc3Bn3JZO
7cStdix+twBnp9w7GdvRbK4FKQA34Janlg5tBE5I8XtjlX53F6/1fbpOBDYZ
25Y7QVqAR7B35mNcnimJddM3m/924B05GPgkoJ25EKQ/8Bb2jjwP9PX4bcPt
oq1+38EtAJL0BV4M8Bu1ICOBL7F3Iu00L3RRULLvgCM9/rsB92TgPypBxmMr
QNiDO+++PMXvBNzOPKuB2gqcmxLrSuCvjOI0VZCrsacafgJO9fgsADdjz0eV
s93ANPyT/enALxnEaIog3YH7DI0t2efAoR6/vXCp8KyFSNpj+Cf7Ebjqw1wJ
ElqA8Dqwn8fvQMJ29LXae7gsQpJ+wBsBflcCrRVHMSOGE1aA8CDQw+N3NC55
2CgxSrYad/6RpAfwUIDf5cDg8kMZzsnAj8YG7gKuTfE7EXuqPAvbhkvX+7iu
2HaL3/XUsZDiMuAPY8M2A2d6fJbS8fWYvGu1duAW/JP9Wbh0jMXvDjIupMii
AOFwj9/ewBMBfutlj+MWFklG4U9mVmszyOB9nNAChEX40+GDaPwZRS32Af6z
lwGEZQzm4Re7KgbjJiZr8Nn4D4yOA9YF+G2UrcWdOCbpiVsyW/0uwVB3NgZ7
AUI7rsjA9/G8EPtZejNsO3C+px+hG9fV+Fd2XiYFDNo2/AUIBWBmHQasEdYO
3Ir/AZuIEy3Lsdpr0KZjV30N/gKEVmB+Ewc0K3sS/zHysdi/gttJSeP0wq0u
rI1diismSDKEsHkoNluGW5AkGQR8GOB3Dh3SOPUqQBiLfR6K2dbh3+y1AgsC
/C6meGYTIsZM/N+tk3Fn4s0evHrZDtwCJUkBuD3A70KwTeBpBQihDcqbzcL/
QF6CrZBiC9RevLYJfwFCH+CZCAap0TYff2Z3HPBDjb7mgDtXXlnlDStxxQFJ
huJeE2v24DTLluN/Re4Q4NMqfaygg7DDqKzmC/gLEE6iviU1ebENuIVMkn2A
lyvcuxGPoONIz+bejb8A4VLqX3SWJ9uJW9Ak6Q7cW+Ye3xQAuHf8Ol5c7oX7
qREMQKx2fcqYXcX/CykuTrn2X6bhyjRXUf4nKV6NoOOxWrkz9TNwafzNpAtn
QoLYBClLbK9Fd3kkSGRIkMiQIJEhQSJDgkSGBIkMX0lnrJSOli0UyMnDlydB
BlA8LzDQhvsxzOjJxVPTlZAgkSFBIkOCRIYEiQwJEhkSJDIkSGRIkMiQIJEh
QSJDgkSGBIkMCRIZEiQyJEhkSJDIkCCRIUEiI0SQnZm1ovOx3XpjiCBvB9zb
2WnK2LTQ2J/j2z+grW0NbOcimljN0xd4APeO4a46W6gg9W7fRtxra5X+00oh
hBBCCCGEEEIIIYQQQgghhBBCCCGEEA3kH1vl9UN9mBbVAAAAAElFTkSuQmCC
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 1665, :content_type image/png, :filename bauprojekte.png, :id #uuid "8e07c37e-d244-514d-bfa9-306158056160", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.013, :System:Directory /tmp/tmp.qSpfBizLgM, :System:FileSize 1665 bytes, :PNG:ImageHeight 128, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 100x128, :PNG:ColorType RGB with Alpha, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 100, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/bauprojekte.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName bauprojekte.png, :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-12T11:31:25.314Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "1a047acd-dc98-52c2-99d3-dc6332adc1e0"]
>debug 4
>debug 5 {:id #uuid "dda588f4-660c-573c-a2ff-944ae93ad42e", :name Beleuchtungstechnik}
>debug 5a id #uuid "dda588f4-660c-573c-a2ff-944ae93ad42e"
2023-12-12T11:31:25.315Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "dda588f4-660c-573c-a2ff-944ae93ad42e"]
>debug 5b {:main_category_id #uuid "dda588f4-660c-573c-a2ff-944ae93ad42e", :content iVBORw0KGgoAAAANSUhEUgAAAJsAAACACAYAAAAccBvUAAAACXBIWXMAAAQK
AAAECgFCV1GHAAA59GlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFj
a2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQi
Pz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0
az0iQWRvYmUgWE1QIENvcmUgNS42LWMxMTEgNzkuMTU4MzI1LCAyMDE1LzA5
LzEwLTAxOjEwOjIwICAgICAgICAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9
Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMi
PgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAg
ICAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8i
CiAgICAgICAgICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxl
bWVudHMvMS4xLyIKICAgICAgICAgICAgeG1sbnM6cGhvdG9zaG9wPSJodHRw
Oi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIgogICAgICAgICAgICB4
bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIK
ICAgICAgICAgICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20v
eGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgICAgICAgICAgeG1s
bnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAg
ICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8x
LjAvIj4KICAgICAgICAgPHhtcDpDcmVhdG9yVG9vbD5BZG9iZSBQaG90b3No
b3AgQ0MgMjAxNSAoTWFjaW50b3NoKTwveG1wOkNyZWF0b3JUb29sPgogICAg
ICAgICA8eG1wOkNyZWF0ZURhdGU+MjAxNi0wNy0xNFQxNTo0NTo0MSswMjow
MDwveG1wOkNyZWF0ZURhdGU+CiAgICAgICAgIDx4bXA6TW9kaWZ5RGF0ZT4y
MDE2LTA3LTE0VDE1OjQ5OjAyKzAyOjAwPC94bXA6TW9kaWZ5RGF0ZT4KICAg
ICAgICAgPHhtcDpNZXRhZGF0YURhdGU+MjAxNi0wNy0xNFQxNTo0OTowMisw
MjowMDwveG1wOk1ldGFkYXRhRGF0ZT4KICAgICAgICAgPGRjOmZvcm1hdD5p
bWFnZS9wbmc8L2RjOmZvcm1hdD4KICAgICAgICAgPHBob3Rvc2hvcDpDb2xv
ck1vZGU+MzwvcGhvdG9zaG9wOkNvbG9yTW9kZT4KICAgICAgICAgPHhtcE1N
Okluc3RhbmNlSUQ+eG1wLmlpZDozMTMzODRjNi0zYzM5LTQzNjgtODE5OS01
OWJhZDM3ODBkNGQ8L3htcE1NOkluc3RhbmNlSUQ+CiAgICAgICAgIDx4bXBN
TTpEb2N1bWVudElEPmFkb2JlOmRvY2lkOnBob3Rvc2hvcDoxYTU3ZjVjYy04
YTU4LTExNzktOGVmNS04OTFkYzJiZDEwY2Y8L3htcE1NOkRvY3VtZW50SUQ+
CiAgICAgICAgIDx4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ+eG1wLmRpZDpk
OWQ5MWY5NC0yNjQ0LTQ4NTItODAwYS0yZTA2OTBlN2VjMzM8L3htcE1NOk9y
aWdpbmFsRG9jdW1lbnRJRD4KICAgICAgICAgPHhtcE1NOkhpc3Rvcnk+CiAg
ICAgICAgICAgIDxyZGY6U2VxPgogICAgICAgICAgICAgICA8cmRmOmxpIHJk
ZjpwYXJzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgICAgICAgPHN0
RXZ0OmFjdGlvbj5jcmVhdGVkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAg
ICAgICAgIDxzdEV2dDppbnN0YW5jZUlEPnhtcC5paWQ6ZDlkOTFmOTQtMjY0
NC00ODUyLTgwMGEtMmUwNjkwZTdlYzMzPC9zdEV2dDppbnN0YW5jZUlEPgog
ICAgICAgICAgICAgICAgICA8c3RFdnQ6d2hlbj4yMDE2LTA3LTE0VDE1OjQ1
OjQxKzAyOjAwPC9zdEV2dDp3aGVuPgogICAgICAgICAgICAgICAgICA8c3RF
dnQ6c29mdHdhcmVBZ2VudD5BZG9iZSBQaG90b3Nob3AgQ0MgMjAxNSAoTWFj
aW50b3NoKTwvc3RFdnQ6c29mdHdhcmVBZ2VudD4KICAgICAgICAgICAgICAg
PC9yZGY6bGk+CiAgICAgICAgICAgICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlw
ZT0iUmVzb3VyY2UiPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6YWN0aW9u
PnNhdmVkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAgICAgICAgIDxzdEV2
dDppbnN0YW5jZUlEPnhtcC5paWQ6MzEzMzg0YzYtM2MzOS00MzY4LTgxOTkt
NTliYWQzNzgwZDRkPC9zdEV2dDppbnN0YW5jZUlEPgogICAgICAgICAgICAg
ICAgICA8c3RFdnQ6d2hlbj4yMDE2LTA3LTE0VDE1OjQ5OjAyKzAyOjAwPC9z
dEV2dDp3aGVuPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6c29mdHdhcmVB
Z2VudD5BZG9iZSBQaG90b3Nob3AgQ0MgMjAxNSAoTWFjaW50b3NoKTwvc3RF
dnQ6c29mdHdhcmVBZ2VudD4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OmNo
YW5nZWQ+Lzwvc3RFdnQ6Y2hhbmdlZD4KICAgICAgICAgICAgICAgPC9yZGY6
bGk+CiAgICAgICAgICAgIDwvcmRmOlNlcT4KICAgICAgICAgPC94bXBNTTpI
aXN0b3J5PgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9y
aWVudGF0aW9uPgogICAgICAgICA8dGlmZjpYUmVzb2x1dGlvbj4yNjI2MzYv
MTAwMDA8L3RpZmY6WFJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOllSZXNv
bHV0aW9uPjI2MjYzNi8xMDAwMDwvdGlmZjpZUmVzb2x1dGlvbj4KICAgICAg
ICAgPHRpZmY6UmVzb2x1dGlvblVuaXQ+MjwvdGlmZjpSZXNvbHV0aW9uVW5p
dD4KICAgICAgICAgPGV4aWY6Q29sb3JTcGFjZT42NTUzNTwvZXhpZjpDb2xv
clNwYWNlPgogICAgICAgICA8ZXhpZjpQaXhlbFhEaW1lbnNpb24+MTU1PC9l
eGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGlt
ZW5zaW9uPjEyODwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgIDwvcmRm
OkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAo8P3hwYWNrZXQgZW5kPSJ3
Ij8+W7LKAQAAACBjSFJNAAB6JQAAgIMAAPn/AACA6AAAUggAARVYAAA6lwAA
F2/XWh+QAAAJGElEQVR42uyda4hVVRTHf75GxJEhmxlFHEFHApEmicgnGppI
iJWSOlghGvghS8QQRpRQVOjlo4JUUkILH6SJiUJJfagsUjH9oCgOpuAjx5Ss
NEdzpg/toZA7M2fte869Z+2zPmyQ8c7Ze/33b+7Za+2916K5uRlr/zWgGpgO
zANWAB8Ce4AfgLPAn66ddT/b4z6zwv3OdKDatMyhrcFFJVALbAR+Bppjaj+7
Z9YClQZbBmEDOgDjgVXAcaApRsBaa02ur1Wu7w4GW9iQdQdeBk4XAK722mk3
lu4GW1iQVQFvAtdTANn97bobW5XBphuyx4HtwN0UQnZ/u+vG+rjBpguyB4CP
FADWWvsIeMBgSz9ozwCXFIPW0i4Bzxhs6YSswr2GmgNr24EKgy09oNUCVwME
raVdBWoNtuLHy9YVaMJvAPVux+Bz135wP7tRoDGs0x6f0wpaR2BTgsHXd4HJ
LmxSEmE8Je6zk93vJhUs3gR0NNgKB1on4OMYJ/B3YD3wLNAzxnH2dM9c7/qI
a7wfA50MtuRB6xyjI3ASmAv0KMC4e7i+TsboOHQ22JKbsC7Azhgm6jNgbBHt
GOvGkK8dO4EuBlsyk7Qjz8k5DoxKkT2j3JjysWmHwRb/xDyfpyc5P43rHLf+
nJ+nR/u8wRbfhPQCrvn+5QO9FdjYO49v7mtAL4MtnonY5TkJSxV62ks9bd1l
sOUv/jQP4f8G5igOVs9xNkjtnmaw+YteDjQIBb8FPB3AFtzTzhaJ7Q1AucHm
J7g0ntaYJm8zJm+1URp/M9jkQg/2eI0sDPBs3kIPHQYbbDKR3xYK/LXmPcN2
9oC/FmrxtsEmiz1dFp7j71ugsb0AHAJuAueAw8A+4D3guSRCEEBf4f2Jy2nd
O00jbBPT6IUBD0cczyngnTgvsXh45RMNtmjCfioQ9asCjustj0ssW4CamPr/
StD3pwZbtGM5jWmMLQGT8thSWh/lXFyM326NcR6XChW2uQJBrxTy1INbrO8C
7nkC910+W2fu1MsVQX9zDba2BZV4Xm8UaYwDXJR/ObDZjTnqja4LwGN59P2G
xEM32NoW85zg+HZ1isbdwQVhP4hw+eYy8GAeGZaiHjc/Z7C1/ZqKenv925Sf
Jn4K+DGJc2jAtwIHpaPBllvEPoJXxAYlt79mA3+1YsN0z+duEOjUx2DLLeIw
gYiLFO0CPNnKpvpFz+ctEug0zGDLLeJUgYgzlG07LW7Fjr4ez5oh0GmqwZZb
xAUCEUcozA33Rw47Jnk8a4RApwUGW24R12hdi0S0L5fD8HrCa9s1BltuETcL
RCxRCNv7OexY7fGcEoFOmw223CKuFojYWyFsuTbyH/a8HBNVp9UGW24R6wQi
1miD7b4jSoeAFzyfUSPQqc5gyy3ibIGI40JOB9qOTuMEOs022PI/VTErw7DN
Eug0yWDLLeJQSSafDMMmyeA01GBr/fhzVBF/yWLhCrcF9otAp74GW+tinhUI
OSSDsA0R6HPWTn20LaYkbenKDMK2UpIW1WBrW8zJAjF/A8oyBFqZszmqPpMN
tvYFleS5WJIh2JYI852UGWzti3pQIOqvQGkGQCt1tkbV5aDdroom7GvSm0sZ
gG29UJPXDLbof8XSIhpTAgZtikeRjlKDLZl90pYUDFUBglblUbqyLrX2pHiN
Iv12+x7oFhBo3ZxNQXyrpT0/W53HReD92tK1t3Eheb+H/XWptivlHtgVD8G3
qS658++Vxm0edl9Ju2eeduEneKY7WKcYNp/ib/eACam3TYH4yzxzayxXCNpy
T1uXqbBPyWvlgOckzFME2jxPGw9oWTZomYgKl5TFJ039Ewrse8IzHf0FTZWW
Nb1iRnpkz26pt16ZYrsqPevaNwIjVS0TlK1pZnq+ar5M46vGLRG+9LRppro1
aYYW0YsVpWUIzvnRClsHYKvn+m10iuwY7blO26r1SLzWWFRXlzZUOlEX07Cg
dg7PRc9UqV3VxhAVBz/LgXqNBWE9yz3Wp702VbCwuUl7yLMW6agijnmUZ03R
h9Tv+QawaT3GIyRypBjrHrfePOIR4hgTxEmWQI7jLNMQOvAM3SwLYY5Cgq0r
cNrDWehewDF293AKTmt2CIKEzU3m2DTHqzzjg2ODOnkc2DHqLR6VlysKFOqQ
VkbeEtwx98Bgq/DwTucXYFzzPbzPCoMt/cC9JJzYYwUY0zHhmF4K8qZYoJl+
vhFO7iMJjucR4Vi+CTVDU6h3LQcBd9KQVVuYBf0OMCjYO7ABX+79RDDJDUnc
ynK3pBoE4/gk6Jv9AcM2vNilrj1KkA832PQCd1Qw0SsS6H+FoP+jwecsCRw2
iWe6L4H+92XdA80SbN2Am1G3rxLoP+r21M2QUkdkEjY34ZJDlpUx9lspORQZ
+jxkBba1gkmfEGO/EwT9rjXYwoDtRUlhMaA2piYp/PaiwRYGbDWeN5gK2WoM
Nv2gDfTYlyxGOwYMNNj0glbtkbWxmO06UG2w6QOtBDiuCLSWdlxj4d6swzZV
IWgtbarBpgu2vYph22uw6YKtXjFs9QabLthuKYbtlsGmC7ZTimE7ZbDpgm27
Yti2G2y6YHtFMWyvGGy6YOsCnFAI2okQioZkcQdhBNCkCLQmYITtIBhsBpvB
Zq9Rg80cBHMQLPRhoQ+DzYK6FtS17SrbrjLY2oftjGLYzhhsumDbrRi23Qab
LtimKIZtisGmL852RCFoRyzOphO4/sBVRaBdBfrbDoJe4AYo2Uk4AQywq3z6
gXtVAWyv2iXlMGA7qQC2kwZbGOs2LWu2/gabbtjGK4JtvMGmG7YximAbY7Dp
hq1MyQHKJqDMYLMLy3Yx2WBLJPNksZplngwEtq7A4RSDdjikmqKZhs0B109Y
aaVQrQHol4U5yAxsDrhyYBVwOwWQ3XZjKc+K/pmC7X/QVQFLgR3AT4I6Cfm0
m66vHa7vqqzpnknYcsBXCpxPELTzQGnWdTbY/gNuYoKwTTSNDbb7gduWAGjb
TFuDrTUH4miMoB3NmgNgsMmA6wF8EQNoXwA9TFODrT3gOgMb8wBtI9DZtDTY
JNA96kIV9yIAds999lHTzmDLB7qBLja2FTjkKrFcd//e6v5voGnVfvtnAC9c
0Cv54m27AAAAAElFTkSuQmCC
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 17298, :content_type image/png, :filename bulb12323.png, :id #uuid "8debe2ef-4a7e-58a1-bf4c-1622dead4579", :metadata {:XMP-tiff:ResolutionUnit inches, :PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 1034, :XMP-exif:ExifImageHeight 128, :XMP-xmpMM:HistoryInstanceID [xmp.iid:d9d91f94-2644-4852-800a-2e0690e7ec33 xmp.iid:313384c6-3c39-4368-8199-59bad3780d4d], :XMP-xmpMM:DocumentID adobe:docid:photoshop:1a57f5cc-8a58-1179-8ef5-891dc2bd10cf, :XMP-xmpMM:InstanceID xmp.iid:313384c6-3c39-4368-8199-59bad3780d4d, :PNG:GreenX 0.21, :ExifTool:ExifToolVersion 10.4, :XMP-exif:ColorSpace Uncalibrated, :XMP-xmp:CreateDate 2016:07:14 15:45:41+02:00, :Composite:Megapixels 0.02, :XMP-tiff:Orientation Horizontal (normal), :PNG:WhitePointY 0.32899, :XMP-x:XMPToolkit Adobe XMP Core 5.6-c111 79.158325, 2015/09/10-01:10:20        , :System:Directory /tmp/tmp.qSpfBizLgM, :XMP-tiff:XResolution 26.2636, :XMP-photoshop:ColorMode RGB, :XMP-exif:ExifImageWidth 155, :XMP-xmpMM:HistoryAction [created saved], :System:FileSize 17 kB, :PNG:ImageHeight 128, :XMP-xmpMM:HistoryWhen [2016:07:14 15:45:41+02:00 2016:07:14 15:49:02+02:00], :File:FileTypeExtension png, :XMP-xmp:MetadataDate 2016:07:14 15:49:02+02:00, :XMP-xmp:CreatorTool Adobe Photoshop CC 2015 (Macintosh), :File:FileType PNG, :PNG:BitDepth 8, :XMP-xmpMM:HistorySoftwareAgent [Adobe Photoshop CC 2015 (Macintosh) Adobe Photoshop CC 2015 (Macintosh)], :Composite:ImageSize 155x128, :XMP-xmp:ModifyDate 2016:07:14 15:49:02+02:00, :PNG:ColorType RGB with Alpha, :PNG:WhitePointX 0.31269, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 155, :File:MIMEType image/png, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :PNG:BlueY 0.05999, :XMP-xmpMM:HistoryChanged /, :SourceFile /tmp/tmp.qSpfBizLgM/bulb12323.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG:RedX 0.63999, :PNG:GreenY 0.71, :PNG:BlueX 0.14999, :PNG:RedY 0.33, :PNG-pHYs:PixelsPerUnitX 1034, :System:FileName bulb12323.png, :XMP-tiff:YResolution 26.2636, :PNG-pHYs:PixelUnits meters, :XMP-xmpMM:OriginalDocumentID xmp.did:d9d91f94-2644-4852-800a-2e0690e7ec33, :PNG:Filter Adaptive, :XMP-dc:Format image/png}}
2023-12-12T11:31:25.317Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "dda588f4-660c-573c-a2ff-944ae93ad42e"]
>debug 4
>debug 5 {:id #uuid "2b07eb8a-4174-5257-83eb-920d536cc44a", :name Betriebseinrichtungen und Fahrzeuge}
>debug 5a id #uuid "2b07eb8a-4174-5257-83eb-920d536cc44a"
2023-12-12T11:31:25.318Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "2b07eb8a-4174-5257-83eb-920d536cc44a"]
>debug 5b {:main_category_id #uuid "2b07eb8a-4174-5257-83eb-920d536cc44a", :content iVBORw0KGgoAAAANSUhEUgAAAGwAAACACAYAAADu4Iw0AAAABHNCSVQICAgI
fAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAABE1JREFUeJzt3U+PFEUcxvHv
7AoriPEkckFI1JGErBtfAQgniJD4JtCIWRKPxkO/CfTgichJEz0QzoYEr7Ig
ARJOIokHCBDQXcLCjofaCaRpuqu6q7q6ap5P8ktIhqmpp5+dfzs7MyAiIiIi
IiIiIiIiIiIiIiIiIiIikrd9wHlgDZjM+KwB54BxpyMa0D7gPvEP1NDmHjCe
73BgQzkDLMbexABtA/aMYu+iwhrweuxNDNTqEAubxN7AkM3F3oC4UWGJUWGJ
UWGJUWGJUWGJUWGJUWGJUWGJUWGJUWGJCVXYCPgE+AG4Caxj/zKC9OwgcIn4
rx/lOl59M4BAuY83xQDCzMJ4UQwgyKxMZ8UAQszSdFIMIMCsTWvFADY/i9NK
4XABF4E9DmvHPiBDH2eFw+IXgTcd1499QIY+TgqHhduURaCQOY21wmHRtmUR
KGROY6VwWLBLWQQKmdM0KhwW61oWgULmNLUKh4V8lEWgkDnNK33rsIivsggY
NJepdNhhAZ9lETBoLvOSeeCq5Zl9l0XAoLnMS45ZnjFEWXgOl91U/YnAZxYH
9XfgCPDI4v+KR1WFfdRwHpUVUdUb+v4BdtWcZy/wV5DdGJW302KUCxsBT4DX
HM7jmwqrUb5J3EZ9WRJZuRybsnQNiKh8DXsWZRdirVzY0yi7EGsqLDFVj/h0
HzVgevdKYlRYYlRYYlRYYlRYYlRYYlRYYlRYYlRYYlRYYlRYYlRYYlRYYlRY
YlRYYlRYYlRYYlRYYlRYYqaFvfh9Xb5dAk4A7wNbgQXgA+Bz4HKAy+tb7/lC
fV/XE+Ak9dfiOWAZtw/AHMrEysf5QGGO1AQpO+o5VB9lxcoX5GsLTzqEmVoO
sI9QEzOf95/sP2j3YGYOuOJ5LyEmZr7Hc8BKiwuv8z2w0eJ8G8B3nvcSQsx8
KwCHgP/w9xP4XocNjT3uI9TEyvcvcODFhX4FbtP9JnJLh0ALHS+7j+kz3zqm
k18wTxsqjYDtmC8Orfrb+42GC9kaMFAfb4eKnW+EOfbbqTj+VXeeE2AVeLz5
77KHDZt6127vlfY2nP6gw9q2YuebYI79KhXHv82jnVsNpx9qsebU4YbT/+6w
tq3s8p2l/mq9QrsfBJtP4Pmx495tDDpfmwu+0HD6EvBVi3VPAfsb/s9vLdZ1
lV2+dzDv1Gx6dHPUYc1PLdd820uCelnm+7nhwqcbWKb+WjwPfE1zmAnwU4Ac
r5JdviWaH/5O5wrwBea53sLmfAh8if2nxj0DFkMGKsky32nLzfiY06HDVMgu
3w7geg9hrgFv9BGoJMt8Y+BuwDB3MK/expJlvo8JE+rO5tqxZZlvDNxo2KDr
zUTMa1ZZlvl28Py1orZBNjB3wDHus5pkm28J8zzG5rnHdNYxz0P6fOjeVtR8
IT+scidwHPOts4vAbuCtzdMeYH7R+Sfm1zHnMLfpKck9n4iIiIiIiIiIiIiI
iEjv/gec0agwRiP7+AAAAABJRU5ErkJggg==
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 1195, :content_type image/png, :filename fahrzeuge.png, :id #uuid "3d6cbe63-c327-5c6b-b7fa-48e6c52f2cdc", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:01+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.014, :System:Directory /tmp/tmp.qSpfBizLgM, :System:FileSize 1195 bytes, :PNG:ImageHeight 128, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 108x128, :PNG:ColorType RGB with Alpha, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 108, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:01+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/fahrzeuge.png, :System:FileAccessDate 2018:11:14 17:31:01+00:00, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName fahrzeuge.png, :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-12T11:31:25.319Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "2b07eb8a-4174-5257-83eb-920d536cc44a"]
>debug 4
>debug 5 {:id #uuid "f6827594-33a6-5760-ac41-f94ceefacfab", :name Bühnentechnik}
>debug 5a id #uuid "f6827594-33a6-5760-ac41-f94ceefacfab"
2023-12-12T11:31:25.319Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "f6827594-33a6-5760-ac41-f94ceefacfab"]
>debug 5b {:main_category_id #uuid "f6827594-33a6-5760-ac41-f94ceefacfab", :content iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAA3NCSVQICAjb
4U/gAAAACXBIWXMAAAG7AAABuwE67OPiAAAAGXRFWHRTb2Z0d2FyZQB3d3cu
aW5rc2NhcGUub3Jnm+48GgAAAM9QTFRF////AAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAA+q0M9gAAAER0Uk5TAAQGBwgJCwwQFBUbISIvMDIzNDU3ODtBREpP
UlNVVldpcXN7gIqTl6Chpqytv8PExsrS1uDj5Obo6evs7fLz9ff4/P3Djn9u
AAABnElEQVRYw+3XxXbDMBQE0AkzM3McZuY4/v9v6sKFKLEUPWXV085acxe2
9WQhNjR4mRcBACjOuUuGMfD7hnFwAYDrIFgyhCFKEgCSwiViIAUAqX/glwNx
AIi/AQQBIPgG4AEAjzpwMTfTRRlYmMBCGRiYwEAZqJlATRlImEBCFTjaTMB2
VAQ0fEZTBMJfQFgNmOA7EyWg/AOUVYAR7jKiA7fIPRC5kQENTDQqMHOzgHtG
Aw4hPCR0oAB6Fk/J6vLAtQCLFK6ywDEDy2SOcsAyCk6iSxmg6wU33u5LYJOH
MPmNEFjX3XgRd33NB5oOSMTR5AK7igxQ2QmeQd//qu7vix/iriTul3YvX2NL
1G/JfEhVfr8q9SXqOV4/p8vthVPEuh85ye7GVcCqH1jJz4OeFdCjDJTgcz+o
U0Za+xlok2bi2ffY951pU7n5CDSJY33vZPvOPfVgeZhrUfLJVGaBMhlosECD
DHRYoEMGxiwwJgNbFtjSfzDs9327wh8K8yE4/ybAnFIOPsC7fE/Z1zjlXr45
1/9JmgXSE871/wOnFjUuRak9PwAAAABJRU5ErkJggg==
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 841, :content_type image/png, :filename curtain-2.png, :id #uuid "9a8cba78-10ab-585b-a4c2-9d8e7f0818ee", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 443, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.004, :System:Directory /tmp/tmp.qSpfBizLgM, :PNG:Palette (Binary data 207 bytes, use -b option to extract), :System:FileSize 841 bytes, :PNG:ImageHeight 64, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 64x64, :PNG:ColorType Palette, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 64, :PNG:Software www.inkscape.org, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/curtain-2.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitX 443, :System:FileName curtain-2.png, :PNG:Transparency (Binary data 68 bytes, use -b option to extract), :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-12T11:31:25.320Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "f6827594-33a6-5760-ac41-f94ceefacfab"]
>debug 4
>debug 5 {:id #uuid "517b82ae-2b7e-4822-9aeb-0d4753dec821", :name Darlehen}
>debug 5a id #uuid "517b82ae-2b7e-4822-9aeb-0d4753dec821"
2023-12-12T11:31:25.321Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "517b82ae-2b7e-4822-9aeb-0d4753dec821"]
>debug 5b nil
2023-12-12T11:31:25.322Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "517b82ae-2b7e-4822-9aeb-0d4753dec821"]
>debug 4
>debug 5 {:id #uuid "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da", :name Fotografie}
>debug 5a id #uuid "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da"
2023-12-12T11:31:25.324Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da"]
>debug 5b {:main_category_id #uuid "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da", :content iVBORw0KGgoAAAANSUhEUgAAAGAAAACACAYAAAD03Gy6AAAABHNCSVQICAgI
fAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAABvdJREFUeJztnWuIVVUUx3/3
OpPaQ6d8ZKI9TM0sKyGnB72ozNKIisjqY0RQQVBQH0PqS4UZmSFB+EkqKMqi
l2JPCCwRGaWyzDzO5GPyEfmYcXzM9GHNhUHHe/a6d92zz51ZP9gg45q9197/
c+7es/ba+4LjOI7jOI7jOI7jOI7jOI7jOAOdQsr/jwbmA7OBK4DxwNBaO1Xn
HAV2Ai3AKuB9YI+2kpHAIqAT6PFSVTkMvN47pkFcA7TmwPGBVlqB5rTBnwN0
5MDZgVo6e8e4X67FP3KyEmFWadBLk3ATsBGYcCp1HFNagRnA/iG9P3gFWek4
2TASOA1YVQDGAG348jJrDgMTisBD+ODHYBgwvwjcEduTQczsAjIhTIztSY5o
B9YDXYrfGYGsIocr20oAjhB/aZaHchx4BmhQDmKJc4Dlyja7yEHH81KeVg/5
yRSBFZp2C73/GOy0ApOQt6BaLgE2hRoXDRocCKzBZvABfkcR/XQBhE7j+g6F
GroAkXEBIuMCRMYFiIwLEBkXIDIuQGRcgMi4AJFxAYQh6SYqgiOqLoAw1bCu
kcB5ocYugNBMQNJUIE+iHNfYcfi8lFZgmmbg+uF+lBtc9bQfkADfAeuAzcAu
4CDi/xnAWOBi4CrgZmB6BW10Ae8CPyNZCyEUkLyqOZTJeitH7CevXDkAvAnM
JD2T+0QmAy8ie7yx+1GuRHegv3IUWAiMUg56f5wOPAfsz0G/6kKADchZBGsm
IPn6sfuXawHeQ57YWlEEXspBP3MpwGKyWxY/nlGf6kaAt9BPstXyhJHvdS/A
F9iHAkJZGOjjgBVgBzYrnUppBH7qx69BI8B9VQ9h9VwGHGMQCvAD2X/un4ql
RBoHTSiiDfgmxaYZuDSwvrnAl4G2teZCYAthq7B24KsUmweQ8EgQoWqtCKjr
x8C6EvIXif2CMN//JX3RkATW1WM5CGciZ4xD+AjoNmzbgg8D7ZqQ2JQJlgJc
Tfhy8mvDdq1YrbANfdBSsRTgcoXtOsN2rWgDdgfamsWqLAWYHGh3EJnI8kYP
8GegbWhfU7EUYHygXSk+n0d2BdqF9jUVSwFCbwPpMGzTmtC8/iarBi0FCD1r
nLflZ19CFxHDrBq0HIzQIz7B9+ZEINQ3syW0pQChm9jjqPwoaK0JPS8dfAQp
DUsB9gXaNWCbCGVFI+F+7bVq1FKA7Qrb6wzbtWIm4fOYpq9lsRTgL4XtXYbt
WjFXYfuHVaOWAmxU2M4DzjZsu1oKwCMK+xarhi0FWI/k84QwDHjMsO1quROY
orBfY9m4ZTj6e0V9/yC3jMSmCKwl3O/tpG8kJaH1Wf9R9LnCdgySOhibR5FI
biifYhxKsXwDLlLU14P8QXObXVfUTAL+68evcuWmgHoTRX2mAoDE+jUd2o0I
lzVnIZOpxtfNhM2bSWidtYjLLFbajwZWojhVYsBw5IHSxvUXU4OdPOs3oIgs
STVPVunpyuJNaAK+rcC/XYTnrSaKes0FALi7gg72ICujWxXtaJkO/Fahb08p
2kkU9dZEgALwWYUd7QZeQzb5rWgAnqXyq5k3oAsgJoq6ayIASGRRu8LoW3Yg
B960NxH2pQH5/oNfq/DjOPoDfImi/poJAPCgov5Tlb1I9vTthInRiAT7Xsbm
Gv4FFfQ7Ca1fkxn3CXBvBc4sQq6DtOAo8AsyYe9EzpD1IB9X5yKH9GZQ3VvT
l9VImEJ7n1wCXBBqXMs3AORjQHWVY07KJuQu0EpIQtvJYn/2GPAw6XmleaIN
udI5dJOpYrLaIO8E7kEOyeWdrcAtyPxRc7LMUDiEiLA8wza1rAWuR7e5VDW1
ngNOpAA8j0xssT/n+5Z3sJu8E0W7mQtQ4gbkSYs98HuQ5bIliaL9aAKALB8X
IsvLrAe+G1iGBAOtSRR+RBWgxFTkG+e6Ff5UUz4GrqxhfxKFL7kQoMQU4A1k
+Wc96PuAJYQfoaqGROFXrgQoMRTJnHgbSRmvdNC39NYxD/nWoqxIQn3Ma4pg
F7K/XNpjHovcAzQN+RN/HBLXH4ospQ8jgb92pPObkCyNPJ5DOIk8vgH1TkLg
uOY5VXxQ4AJERiNAlpNYvaM6wBE6B7Qjmx1OeSahW6mpjBdk1o36pAHlXngB
uedS82QvQ7YIE/J32j0Wjchf1i8ANyp+70gB2AacXwuvnFS2FjHMdXfUtBSp
j12qgcrKAhKO/Rv/TuGs6QQmFpENiaWRnRmMLAH2lk56jEQSav17hbNhG5K/
dKDvD5upPHfSS3jpoMyJnDkuQs0HP/Ur5Gchr0hsZwdaSVCcRRuBbJb721B9
6QBeRY5EnUTacctRSHr3bGRHajweFU3jCHKUtQU5evUBhndLOI7jOI7jOI7j
OI7jOI7jOI5Tf/wPcYhVe1hRfeIAAAAASUVORK5CYII=
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 1877, :content_type image/png, :filename fotografie.png, :id #uuid "07a33b4c-d274-54e5-a2ce-11f26d57be05", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.012, :System:Directory /tmp/tmp.qSpfBizLgM, :System:FileSize 1877 bytes, :PNG:ImageHeight 128, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 96x128, :PNG:ColorType RGB with Alpha, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 96, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/fotografie.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName fotografie.png, :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-12T11:31:25.325Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da"]
>debug 4
>debug 5 {:id #uuid "2ea39047-e663-50d5-9080-838b75883704", :name IT & Elektronik}
>debug 5a id #uuid "2ea39047-e663-50d5-9080-838b75883704"
2023-12-12T11:31:25.326Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "2ea39047-e663-50d5-9080-838b75883704"]
>debug 5b {:main_category_id #uuid "2ea39047-e663-50d5-9080-838b75883704", :content iVBORw0KGgoAAAANSUhEUgAAAHgAAACACAYAAADApa2mAAAABHNCSVQICAgI
fAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAr5JREFUeJzt3b9qU2Ech/En
0UVbFAernQRHQZy8AtFNdJQWCgq6633oUCzeRi3qoHgBDiIugosglNY6Vq1L
/zicgC2kiel5k5N8fT7wLm15c/g9bU/+kQOSJEmSJEmSJEmSJEmSJEmSpG6m
gQfAK2AN2AH2XAfWTmc2L4H7wNSRJj1iLWAB+E7zA5y0tQHMDz7y0WkDz2h+
UJO+ljqzHCstjFtyPR1s/MO3QPNDSVtzAxU4RKvAHtPAF+Bsgb301wZwEdiq
s0mJ//VzGHcYzgF36m5SIvDtAnuou7GY7Rq9zyXL+BfezQywQu/ZrTZ2dPv0
exLDuIc7T+/Zbde9gRJ3svZGcBvJhjq/sXtArbIMHM7A4QwczsDhDBzOwOEM
HM7A4QwczsDhDBzOwOEMHM7A4QwczsDhDBzOwOEMHM7A4QwczsDhDBzOwOEM
HM7A4QwczsDhDBzOwOEMHM7A4QwczsDhDBzOwOEMHM7A4QwczsDhDBzOwOFK
BN7t8/2ZAreRarbP93dGchR99Ps44RWqT1XVQbPAC4b8ccLH624AfKD3b+JN
YL3A7fyP3tfdoMS/6OUCe6i72rMt8VnOU1QX5fBcW9Y3qoty/K6zSYm/4F/A
owL76KCH1Ixb2hLNX2soZS0OOPuRaFNdsavp4Uz6WmTMn5+Yozp/ND2oSVvr
FLhO0qicBO5RPQZepbp6SNMDHLe13ZnNc+AucOJIk5YkSWOpRXXCV6ixfryl
+gwczsDhkgNforqP8S/rckPHOHTJgY8N6WcnSgvYwqfJUm21gbdNH4WG5nWL
6lz1Dphu+GBU1g/gahv4BNzAN8YlWQOuA5/3f/EM8ITqLThNv5TmOtr6CTzu
tAS6v+nuNHALuAZcAS4Ap8i+xz2JdoFN4CvwEXhD9fr7ZpMHJUmSJEmSJEmS
JEmSJEmSJEml/QGym5SaY0sX5gAAAABJRU5ErkJggg==
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 796, :content_type image/png, :filename laptop.png, :id #uuid "1464e46c-e726-54a9-a42b-f937a0342d22", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:01+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.015, :System:Directory /tmp/tmp.qSpfBizLgM, :System:FileSize 796 bytes, :PNG:ImageHeight 128, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 120x128, :PNG:ColorType RGB with Alpha, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 120, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:01+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/laptop.png, :System:FileAccessDate 2018:11:14 17:31:01+00:00, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName laptop.png, :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-12T11:31:25.327Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "2ea39047-e663-50d5-9080-838b75883704"]
>debug 4
>debug 5 {:id #uuid "f6885671-3bf3-56f2-8e92-b5112d0f703f", :name Musikinstrumente}
>debug 5a id #uuid "f6885671-3bf3-56f2-8e92-b5112d0f703f"
2023-12-12T11:31:25.327Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "f6885671-3bf3-56f2-8e92-b5112d0f703f"]
>debug 5b {:main_category_id #uuid "f6885671-3bf3-56f2-8e92-b5112d0f703f", :content iVBORw0KGgoAAAANSUhEUgAAAI4AAACACAYAAADd91F4AAAACXBIWXMAAAsT
AAALEwEAmpwYAAA59GlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFj
a2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQi
Pz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0
az0iQWRvYmUgWE1QIENvcmUgNS42LWMxMTEgNzkuMTU4MzI1LCAyMDE1LzA5
LzEwLTAxOjEwOjIwICAgICAgICAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9
Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMi
PgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAg
ICAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8i
CiAgICAgICAgICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxl
bWVudHMvMS4xLyIKICAgICAgICAgICAgeG1sbnM6cGhvdG9zaG9wPSJodHRw
Oi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIgogICAgICAgICAgICB4
bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIK
ICAgICAgICAgICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20v
eGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgICAgICAgICAgeG1s
bnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAg
ICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8x
LjAvIj4KICAgICAgICAgPHhtcDpDcmVhdG9yVG9vbD5BZG9iZSBQaG90b3No
b3AgQ0MgMjAxNSAoTWFjaW50b3NoKTwveG1wOkNyZWF0b3JUb29sPgogICAg
ICAgICA8eG1wOkNyZWF0ZURhdGU+MjAxNi0wNy0xNFQxNTo0NjoxMSswMjow
MDwveG1wOkNyZWF0ZURhdGU+CiAgICAgICAgIDx4bXA6TW9kaWZ5RGF0ZT4y
MDE2LTA3LTE0VDE1OjQ5OjI4KzAyOjAwPC94bXA6TW9kaWZ5RGF0ZT4KICAg
ICAgICAgPHhtcDpNZXRhZGF0YURhdGU+MjAxNi0wNy0xNFQxNTo0OToyOCsw
MjowMDwveG1wOk1ldGFkYXRhRGF0ZT4KICAgICAgICAgPGRjOmZvcm1hdD5p
bWFnZS9wbmc8L2RjOmZvcm1hdD4KICAgICAgICAgPHBob3Rvc2hvcDpDb2xv
ck1vZGU+MzwvcGhvdG9zaG9wOkNvbG9yTW9kZT4KICAgICAgICAgPHhtcE1N
Okluc3RhbmNlSUQ+eG1wLmlpZDo2YzA4N2NiZS0xZjhlLTQ4YmUtYTU1YS00
ZmRmYzVkOTI2OWE8L3htcE1NOkluc3RhbmNlSUQ+CiAgICAgICAgIDx4bXBN
TTpEb2N1bWVudElEPmFkb2JlOmRvY2lkOnBob3Rvc2hvcDoyZTNiY2U2NC04
YTU4LTExNzktOGVmNS04OTFkYzJiZDEwY2Y8L3htcE1NOkRvY3VtZW50SUQ+
CiAgICAgICAgIDx4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ+eG1wLmRpZDo1
MzMwNmRlYi01NjAzLTQyZTEtOTBiMy04Nzc0MmQ2ODdhMDc8L3htcE1NOk9y
aWdpbmFsRG9jdW1lbnRJRD4KICAgICAgICAgPHhtcE1NOkhpc3Rvcnk+CiAg
ICAgICAgICAgIDxyZGY6U2VxPgogICAgICAgICAgICAgICA8cmRmOmxpIHJk
ZjpwYXJzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgICAgICAgPHN0
RXZ0OmFjdGlvbj5jcmVhdGVkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAg
ICAgICAgIDxzdEV2dDppbnN0YW5jZUlEPnhtcC5paWQ6NTMzMDZkZWItNTYw
My00MmUxLTkwYjMtODc3NDJkNjg3YTA3PC9zdEV2dDppbnN0YW5jZUlEPgog
ICAgICAgICAgICAgICAgICA8c3RFdnQ6d2hlbj4yMDE2LTA3LTE0VDE1OjQ2
OjExKzAyOjAwPC9zdEV2dDp3aGVuPgogICAgICAgICAgICAgICAgICA8c3RF
dnQ6c29mdHdhcmVBZ2VudD5BZG9iZSBQaG90b3Nob3AgQ0MgMjAxNSAoTWFj
aW50b3NoKTwvc3RFdnQ6c29mdHdhcmVBZ2VudD4KICAgICAgICAgICAgICAg
PC9yZGY6bGk+CiAgICAgICAgICAgICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlw
ZT0iUmVzb3VyY2UiPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6YWN0aW9u
PnNhdmVkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAgICAgICAgIDxzdEV2
dDppbnN0YW5jZUlEPnhtcC5paWQ6NmMwODdjYmUtMWY4ZS00OGJlLWE1NWEt
NGZkZmM1ZDkyNjlhPC9zdEV2dDppbnN0YW5jZUlEPgogICAgICAgICAgICAg
ICAgICA8c3RFdnQ6d2hlbj4yMDE2LTA3LTE0VDE1OjQ5OjI4KzAyOjAwPC9z
dEV2dDp3aGVuPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6c29mdHdhcmVB
Z2VudD5BZG9iZSBQaG90b3Nob3AgQ0MgMjAxNSAoTWFjaW50b3NoKTwvc3RF
dnQ6c29mdHdhcmVBZ2VudD4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OmNo
YW5nZWQ+Lzwvc3RFdnQ6Y2hhbmdlZD4KICAgICAgICAgICAgICAgPC9yZGY6
bGk+CiAgICAgICAgICAgIDwvcmRmOlNlcT4KICAgICAgICAgPC94bXBNTTpI
aXN0b3J5PgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9y
aWVudGF0aW9uPgogICAgICAgICA8dGlmZjpYUmVzb2x1dGlvbj43MjAwMDAv
MTAwMDA8L3RpZmY6WFJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOllSZXNv
bHV0aW9uPjcyMDAwMC8xMDAwMDwvdGlmZjpZUmVzb2x1dGlvbj4KICAgICAg
ICAgPHRpZmY6UmVzb2x1dGlvblVuaXQ+MjwvdGlmZjpSZXNvbHV0aW9uVW5p
dD4KICAgICAgICAgPGV4aWY6Q29sb3JTcGFjZT42NTUzNTwvZXhpZjpDb2xv
clNwYWNlPgogICAgICAgICA8ZXhpZjpQaXhlbFhEaW1lbnNpb24+MTQyPC9l
eGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGlt
ZW5zaW9uPjEyODwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgIDwvcmRm
OkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAo8P3hwYWNrZXQgZW5kPSJ3
Ij8+x0kGyQAAACBjSFJNAAB6JQAAgIMAAPn/AACA6AAAUggAARVYAAA6lwAA
F2/XWh+QAAAERklEQVR42uzdy4tOcRzH8ffIfUoYK7nGnlIuJZRSYutW4h+Q
+4KVUoSlUiSXWSgSFsrGJSJ2bpH7NSk7uYWZ8Vich9Bg5jyX8z3nvL/1qWma
xfk9vZrzPef5nt+hUqlgTG/jh2CEY4RjhGOEY4xwjHCMcIxwjHCMEY6JBMdq
SPUBpgHbgdtAJ9BR/Xkz0PrjD4VjDQQWAPuA10DlH7kHjBNOeasNWAGcAD78
B0t3eAYLpzw1AVgPXAK6eonlz2wSTjn6lbs1QvkzN4VT3n6llnwRTrn7ldQR
jv2KcOxXhCOc5vUrwrFfEU6Z4GTerwjHfkU4BYMTul8Rjv2KcHIKJ5f9inCy
Ow1tBO4UGYpw6lsjSYacKmWLcNLXAOB6GdEIp7ZaV1Y0wqmtbghHOGnqq3CE
k6YqwhGOcIQjHOEIRzjCEY5whCMc4QhHOMIRjnCEIxzhlAbOV+EIp6d5CxwB
FgNDhCOcf+UFsBuYC/TrzfqEUz4414EtwGSgJe36hFN8OB3AWWAVMKZe6xNO
MeG8A44Cy4ChjVifcIoD5xWwB5gH9G/0+oSTbzi3gK3AlP/0K8IpOZxO4AKw
Bhif5fqEEx/Oe+A4sBwYHmV9wokJ5zWwF5hP8qRouPUJJw6cO8A2YCrJViih
1yec7OB0kWxOsB6YSLwSTiA4H4GTwEpgBLFLOBnDeQPsBxYCg8hPCScjODuA
GUH6FeHkCE7eSzjCEY5whCMc4QhHOMIRjnCEIxzhCEc4whGOcIQjHOEIRzjC
EY5whCMc4QhHOMIpM5xWYA7Ju7PagavAS+DTL8f0mWQi8TZwGtgFLKX7Z8qF
U2A4Y4ENJEPvtb5b4gGwE5gknGLC6U+ymcBFGvdc1zXhFAdOC8nTnC/APQCF
07MaAZwBN48UTu/6mMcE21ZFOLHhtAGPCLh5k3BiwzlJ0F2/hBMXziwCbxcn
nLhw2oUjnDT1TDjCSVNdwhFOmuoMDKdDOJ6q0uSxcOLCORwYzgHhxIUzMzCc
6WWC09R5lTrhPBEQzTGAosPJbF6ljl85PAyE5gHVvZaLCCfEvEodT4ljguC5
D4z++e+2QHBCzavUuZ9qq546s1rLKWDYb+fpgsAJN6/SoEGupcDTJq7hCbCI
bl4wUgQ4IedVGng11w9YApxv0HF/I3kx2hKg718vKXMOJ+y8SpNuCYwG1gLn
gC81HOvnKpbVwKge3YvIOZyw8yoZ3FcaBMyuXkUeAq4Az0nePvOtmvfV310G
DpK8DmAWKTbuzjOc0PMqFLzyDKddOMJJA+eZcISTBk6XcISTBk7oeRXheKpK
Na8inLhwQs+rCCcunNDzKsKJfQMw7LyKcOJ/5RByXkU48b/kDDmvIpx8jFWE
m1cRTr4GucLMqwgnf6OjIeZVhJPvYfXM5lWEU5zHY5o6ryKcoHBMueKHYIRj
hGOEY4RjjHCMcIxwjHCMcIwRjqlDvg8A5/TdLBe62ugAAAAASUVORK5CYII=
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 16064, :content_type image/png, :filename music3213.png, :id #uuid "3a52eb87-b5fe-5df0-98b1-43e80f28d2dc", :metadata {:XMP-tiff:ResolutionUnit inches, :PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :XMP-exif:ExifImageHeight 128, :XMP-xmpMM:HistoryInstanceID [xmp.iid:53306deb-5603-42e1-90b3-87742d687a07 xmp.iid:6c087cbe-1f8e-48be-a55a-4fdfc5d9269a], :XMP-xmpMM:DocumentID adobe:docid:photoshop:2e3bce64-8a58-1179-8ef5-891dc2bd10cf, :XMP-xmpMM:InstanceID xmp.iid:6c087cbe-1f8e-48be-a55a-4fdfc5d9269a, :PNG:GreenX 0.21, :ExifTool:ExifToolVersion 10.4, :XMP-exif:ColorSpace Uncalibrated, :XMP-xmp:CreateDate 2016:07:14 15:46:11+02:00, :Composite:Megapixels 0.018, :XMP-tiff:Orientation Horizontal (normal), :PNG:WhitePointY 0.32899, :XMP-x:XMPToolkit Adobe XMP Core 5.6-c111 79.158325, 2015/09/10-01:10:20        , :System:Directory /tmp/tmp.qSpfBizLgM, :XMP-tiff:XResolution 72, :XMP-photoshop:ColorMode RGB, :XMP-exif:ExifImageWidth 142, :XMP-xmpMM:HistoryAction [created saved], :System:FileSize 16 kB, :PNG:ImageHeight 128, :XMP-xmpMM:HistoryWhen [2016:07:14 15:46:11+02:00 2016:07:14 15:49:28+02:00], :File:FileTypeExtension png, :XMP-xmp:MetadataDate 2016:07:14 15:49:28+02:00, :XMP-xmp:CreatorTool Adobe Photoshop CC 2015 (Macintosh), :File:FileType PNG, :PNG:BitDepth 8, :XMP-xmpMM:HistorySoftwareAgent [Adobe Photoshop CC 2015 (Macintosh) Adobe Photoshop CC 2015 (Macintosh)], :Composite:ImageSize 142x128, :XMP-xmp:ModifyDate 2016:07:14 15:49:28+02:00, :PNG:ColorType RGB with Alpha, :PNG:WhitePointX 0.31269, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 142, :File:MIMEType image/png, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :PNG:BlueY 0.05999, :XMP-xmpMM:HistoryChanged /, :SourceFile /tmp/tmp.qSpfBizLgM/music3213.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG:RedX 0.63999, :PNG:GreenY 0.71, :PNG:BlueX 0.14999, :PNG:RedY 0.33, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName music3213.png, :XMP-tiff:YResolution 72, :PNG-pHYs:PixelUnits meters, :XMP-xmpMM:OriginalDocumentID xmp.did:53306deb-5603-42e1-90b3-87742d687a07, :PNG:Filter Adaptive, :XMP-dc:Format image/png}}
2023-12-12T11:31:25.328Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "f6885671-3bf3-56f2-8e92-b5112d0f703f"]
>debug 4
>debug 5 {:id #uuid "6c8a0d77-6711-5156-a59a-12425ba01cff", :name Werkstatt-Technik}
>debug 5a id #uuid "6c8a0d77-6711-5156-a59a-12425ba01cff"
2023-12-12T11:31:25.329Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "6c8a0d77-6711-5156-a59a-12425ba01cff"]
>debug 5b {:main_category_id #uuid "6c8a0d77-6711-5156-a59a-12425ba01cff", :content iVBORw0KGgoAAAANSUhEUgAAAGYAAACACAYAAAD5whz9AAAABHNCSVQICAgI
fAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAABrVJREFUeJztnVmMVEUUhr9p
GpdhlBmGYZ8BFByJGwGNoMYlPiku8UFNiMTlQU2MRk1QYkz0QY1riNEYE8WM
4oY8EaOGoAYVFRRE2TeHYRjAiAuiYByQ8eFQ0vTC9F2qqqvnfMn/AN1dt6r+
O/d2nzp1LiiKoiiKoiiKoiiKoiiKoiiKoig2qfHdgQqiP3AuMBU4GxgPjAIa
gROBDHAA+B3YAWwB1gLLga8O/7+SElngauAdYC/QE1OHgGXAQ8BYpyOoMuqA
B4DtxDfjWPoQuNjZaKqAfsAdwM/YMSRf7wOjnYwsYFqBr3FjSK5+A8Y5GF+Q
zAD24d4Uo1n2hxgWGeA5/BliNM32QEOiP/A2fg3ZA9xpe6AhkQXew58hh4CX
gSbbAw2JGmAO/kz5HJhofZQBMgs/hnQCN6DRlKJcjlxGXBryN/AoUGt/eGHS
gMSwXJryLtDiYnAh4/K+shINuZTFebgxZDdwOxLaUcpgEXYNOQDMRi6XSpnY
/mtZCExwNpoq4nXsGLIFWavRr78xOAnYjx1jrnI4jgIyPg+eAtOQZd+qI3Rj
rvTdAVuEbswlvjtgi5CNaaKKf3WHbMyZvjtgk5CNqeo0oZCNGeG7AzYJ2Zh6
3x2wScjGHOe7AzbJ+u6A8j+DkMSNJuDZkI3p9t2BlKgF7gMeREJMAJNCNib0
7PoaJEfgGaA577UpIRuzy3cHEjAReAG4qMTr+x32JXUuxe46zI/A9aQb9m8A
XqL3hJEVKR7TOU3YNcboS2BKwr5mgFspf5fBnITH804HbszpQTJi4kQbzgKW
RDzWLTGOU1HYWr0spX+Qm3U5P24HAE8BB2McJ/ioxo24NcboF+BuJHG9GNcA
22K2vSzZlFQGdfjd97IRuJYjXxBagAUJ27w/venxSxv+jDFajKTJJj1JuoEh
Kc6NU+ry/j0Z/8akpTeST48fJgCbOBK6MCzE/6Qm1SHgjMQz5IHTgZ+QQdyb
99pk3Gf5p603E8+QB1qREIwZxA4K05Zewd+kJtVfSBWOoGgFdlI4mJl576sH
uoq8LwTdk3SSXHMaxU3pQUqMDM97/2XAvyXeX6laRGALluPpfSPS/CKfm9nL
ZypJnQT29Xgc5V+Wpud9toYw7jd7kDhaMJxKtOI7e5H7UC5ZYF6ENlzrT+CC
hPPklKimGK2nMLCYBd6K0ZZt/Qqcn3CenHIKcs2NO+BPgePz2swATydoM21t
QL7QBMNY4kdjc7WA4mlN05HfCj5NmQcMTDJJrhlDOqYYfUDxPffjgS9SPE65
2o2cGEHtTBuDnVXIpcDQIsfLALdxdBTBlrqB55F8saAYDWzF3sR0AReWOLbJ
5UrzL9VoH/AictIFRwvQjv2z9iDwCKXTafsBVwBzkTy1uMc5AHyC1AA4OcnE
GHxc91qQhSWX2yjWAHchlZFKkQUmcXR532bkUlSLmNgN/IGEidqB1chS8BLk
t0mwNCP5Wrb/UkppAVqyqoBRyN55X6bk6iPgHLvDDYORVI4pPUg12VTuBSEz
EtiMfzOMlhLYDz0bjETW6H2bYbQMNYURSN6VbzOMvqHKtweWw3Aqy5RvUVMY
hkRRfZthtBytM8YwZG3EtxlGK1BTGAqsw78ZRt8RYAAxbYYiTx/ybYbRStQU
hlB5pjRaHXEANCEBQt9mGH2PmkITEl31bYbRD8BgqyMOgMHAKvybYbQKNYXB
yNnp2wyj1ejjQGhEruO+zTBaQ2AppjZoRL7x+DZDTclhEPKDzbcZRmtRUyrO
lHUUT03qUzQg8SbfZhitR+JxfZoGJDLr2wyjDRRuVOpz1CNrGL7NUFNyqEdW
+3ybYbQRNYWByLp4lIl7Fdk4lEHyxh4nvX2Qm6iCgjdJGYhkkESZuMdKtDUj
YjvFtBlJ5ujTDCD6k7s7OXYV2sUR28vVFgLc926DuUSfvN7qnjwco0015TAZ
ZJPmTTE+ayMhvR3Zq99loe3gaCPemb2d0oXUAD6L2F47VfzYkThsJf694IkS
bd4csR01pQhxajbmqg0p55RF9rw8SbSvy1uR3WVKHkmNSaIOAt0S54IO/Jiy
DTXlmLgukWtMqeonJqXBVNya0olUwVDK4DXcmLIdqRejlMkJwMfYNaULNSUW
tSSLb/VmyjhnI6lC6pCnP6Rpyg5kz7ySkDhrMqW0EzUlVRpInhmzk8Bqc4VC
I/Hzk3dRWA5RSZEhRN8ltgupKq5YZjjlJ5F3IfX3FUcMAGYj1YdKmTIfzZBM
jairkMOA65DyUY1IKai1SFWjjel2TVEURVEURVEURVGUxPwHYcurS2vCftQA
AAAASUVORK5CYII=
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 1811, :content_type image/png, :filename werkzeug.png, :id #uuid "f4e1f230-df2e-5e95-bf89-827f7a6b4b3b", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.013, :System:Directory /tmp/tmp.qSpfBizLgM, :System:FileSize 1811 bytes, :PNG:ImageHeight 128, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 102x128, :PNG:ColorType RGB with Alpha, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 102, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/werkzeug.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName werkzeug.png, :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-12T11:31:25.330Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "6c8a0d77-6711-5156-a59a-12425ba01cff"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.333Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.333Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.337Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.340Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.341Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.341Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.341Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.342Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.343Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.343Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.344Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.344Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.344Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.345Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.345Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.345Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.346Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.346Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.347Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.347Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.348Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.348Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.348Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.349Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.349Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.350Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.350Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.350Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.351Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.351Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.352Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.352Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.352Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.353Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.353Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.353Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.353Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.354Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.354Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.354Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.355Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.355Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.355Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.356Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.356Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.356Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.356Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.357Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.357Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.358Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.358Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.358Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.359Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.359Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.360Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.360Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.360Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.361Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.362Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.362Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.363Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.363Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.363Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.364Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.364Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.365Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.365Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.365Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.366Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.366Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.366Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.367Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.367Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.367Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.368Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.368Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.368Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.368Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.369Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.369Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.369Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.370Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.370Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.371Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.371Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.371Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.372Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.372Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.373Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.374Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.374Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.374Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.375Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.376Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.376Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.377Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.377Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.377Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.378Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.378Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.378Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.378Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.378Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.379Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.379Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.380Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.380Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.380Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.381Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.381Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.381Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.382Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.382Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.383Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.383Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.383Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.383Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.384Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.384Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.384Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.385Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.385Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.385Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.386Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.386Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.386Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.386Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.387Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.387Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.387Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.388Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.388Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.388Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.389Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.389Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.389Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.389Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.390Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.390Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.390Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.391Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.391Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.391Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.392Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.392Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.394Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.394Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.394Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.395Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.395Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.395Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.396Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.396Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.397Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.397Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.397Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.397Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.397Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.398Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.398Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.399Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.399Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.400Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.400Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.400Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.401Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.401Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.401Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.402Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.402Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.402Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.402Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.402Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.403Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.403Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.404Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.404Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.404Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.405Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.405Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.405Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.405Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.406Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.406Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.406Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.407Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.407Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.407Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.408Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.408Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.408Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.408Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.409Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.409Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.409Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.410Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.410Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.410Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.411Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.411Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.411Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.411Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.411Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.412Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.412Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.412Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.412Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.413Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.413Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.413Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.414Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.414Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.414Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.415Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.416Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.416Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.416Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.417Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.417Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.417Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.418Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.418Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.418Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.419Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.419Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.419Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.419Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.420Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.420Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.421Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.421Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.421Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.422Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.422Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.422Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.422Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.423Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.423Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.423Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.423Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.424Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.424Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.424Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.425Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.425Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.425Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.425Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.426Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.426Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.426Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.426Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.426Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.427Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.428Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.428Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.428Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.428Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.428Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.429Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.429Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.429Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.429Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.430Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.430Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.430Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.431Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.431Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.431Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.432Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.432Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.432Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.432Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.433Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.433Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.433Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.434Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.434Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.434Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.435Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.435Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.436Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.436Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.436Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.437Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.437Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false

>request-grapql _> request {:leihs-user-language {:name Deutsch, :locale de-CH, :default true, :active true}, :authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 219b97e6-bb13-401e-92a7-2304bf206106}, leihs-user-session {:value d429c048-7118-407f-a7a9-b33da6f15b06}}, :remote-addr 127.0.0.1, :start-time 47991699419458, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type application/json, cookie leihs-anti-csrf-token=219b97e6-bb13-401e-92a7-2304bf206106; leihs-user-session=d429c048-7118-407f-a7a9-b33da6f15b06, content-length 255, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/admin/categories/dda588f4660c573ca2ff944ae93ad42e, connection keep-alive, pragma no-cache, x-csrf-token 219b97e6-bb13-401e-92a7-2304bf206106, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x55e131e /127.0.0.1:3230<->/127.0.0.1:53029], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x65dc1b71 HikariDataSource (db-pool)]}, :content-length 255, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:operationName MainCategoriesIndex, :variables {}, :query query MainCategoriesIndex {
  main_categories {
    id
    name
    image_url
    categories {
      id
      name
      can_delete
      __typename
    }
    __typename
  }
}
}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0xbde374d leihs.procurement.graphql$handler@bde374d], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>request-c-grapql _> request (json) {"leihs-user-language":{"name":"Deutsch","locale":"de-CH","default":true,"active":true},"authenticated-entity":{"email":"manuel.radl@zhdk.ch","contracts_count":1,"lastname":"Radl","org_id":"271682","scope_read":true,"is_admin":true,"authentication-method":"session","login":"mradl","scope_system_admin_write":true,"scope_write":true,"firstname":"Manuel","scope_admin_write":true,"user_session_created_at":"2023-12-12T11:17:19.570671Z","id":"a786135f-c159-4618-9dd3-0012ebb3d500","user_session_id":"463ca0ef-36e9-430c-b982-23371c7fc689","scope_system_admin_read":true,"access-rights":[{"role":"customer","inventory_pool_id":"3977012c-ce0e-501f-889b-8715fdb5d83b"},{"role":"customer","inventory_pool_id":"5863967f-9804-4909-a9b7-92254616d6b2"},{"role":"customer","inventory_pool_id":"5dd25b58-fa56-5095-bd97-2696d92c2fb1"},{"role":"customer","inventory_pool_id":"77e88ec8-9ff6-5435-818e-dc902fc631a6"},{"role":"inventory_manager","inventory_pool_id":"8bd16d45-056d-5590-bc7f-12849f034351"},{"role":"inventory_manager","inventory_pool_id":"a02b8163-9a16-5066-b48e-9eb74cf8b791"},{"role":"inventory_manager","inventory_pool_id":"b534b07c-d9bf-4572-840c-0a630b8cd8ed"},{"role":"customer","inventory_pool_id":"fc5a841e-36c6-5dc3-8207-1306c1fb89bf"},{"role":"customer","inventory_pool_id":"ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}],"user_id":"a786135f-c159-4618-9dd3-0012ebb3d500","is_system_admin":true,"external_sign_out_url":null,"language_locale":"de-CH","inventory_pool_roles_count":9,"scope_admin_read":true},"cookies":{"leihs-anti-csrf-token":{"value":"219b97e6-bb13-401e-92a7-2304bf206106"},"leihs-user-session":{"value":"d429c048-7118-407f-a7a9-b33da6f15b06"}},"remote-addr":"127.0.0.1","start-time":47991699419458,"params":{},"settings":{"email_sending_enabled":false,"sessions_max_lifetime_secs":432000,"smtp_default_from_address":"noreply@zhdk.ch","public_image_caching_enabled":true,"sessions_force_secure":false,"deliver_received_order_notifications":false,"external_base_url":"http:\/\/localhost:3200","sessions_force_uniqueness":false,"email_signature":"Das ZHdK-Ausleihe-Team"},"query-params-raw":{},"route-params":null,"headers":{"origin":"http:\/\/localhost:3230","sec-fetch-site":"same-origin","sec-ch-ua-mobile":"?0","host":"localhost:3230","user-agent":"Mozilla\/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit\/537.36 (KHTML, like Gecko) Chrome\/119.0.0.0 Safari\/537.36","content-type":"application\/json","cookie":"leihs-anti-csrf-token=219b97e6-bb13-401e-92a7-2304bf206106; leihs-user-session=d429c048-7118-407f-a7a9-b33da6f15b06","content-length":"255","sec-ch-ua":"\"Google Chrome\";v=\"119\", \"Chromium\";v=\"119\", \"Not?A_Brand\";v=\"24\"","sec-ch-ua-platform":"\"macOS\"","referer":"http:\/\/localhost:3230\/procure\/admin\/categories\/dda588f4660c573ca2ff944ae93ad42e","connection":"keep-alive","pragma":"no-cache","x-csrf-token":"219b97e6-bb13-401e-92a7-2304bf206106","accept":"application\/json","accept-language":"de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7","sec-fetch-dest":"empty","accept-encoding":"gzip, deflate, br","sec-fetch-mode":"cors","cache-control":"no-cache"},"server-port":3230,"params-raw":{},"content-length":255,"form-params":{},"websocket?":false,"query-params":{},"content-type":"application\/json","form-params-raw":{},"character-encoding":"utf8","uri":"\/procure\/graphql","server-name":"localhost","handler-key":"graphql","query-string":null,"body":{"operationName":"MainCategoriesIndex","variables":{},"query":"query MainCategoriesIndex {\n  main_categories {\n    id\n    name\n    image_url\n    categories {\n      id\n      name\n      can_delete\n      __typename\n    }\n    __typename\n  }\n}\n"},"multipart-params":{},"scheme":"http","request-method":"post","accept":{"mime":"json","charset":null,"encoding":null,"language":null}}

>request-grapql _> result => {:data #ordered/map ([:main_categories [#ordered/map ([:id 519f7a95-9ca7-5256-bf63-142cfc23dc62] [:name Audio- und Videotechnik] [:image_url /procure/images/ee215167-b2c3-5fcc-90c3-098ad20d16ea] [:categories [#ordered/map ([:id 4e48b48c-e1bf-50d7-ab2d-9aa438c638de] [:name Beamer] [:can_delete false] [:__typename :Category]) #ordered/map ([:id a1727606-c7c8-54a2-aaa1-ceff7a7d4b40] [:name Funk-Strecken] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 00382e27-a87a-5313-b31b-a369dad6c5f8] [:name Lautsprecher] [:can_delete false] [:__typename :Category]) #ordered/map ([:id ce5424cc-ce77-5e67-8201-333ec20963eb] [:name Lautsprecherstative] [:can_delete false] [:__typename :Category]) #ordered/map ([:id ce0812d7-080b-5f49-8530-dd4a821c57b6] [:name Mikrofone] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 67e5fc60-6fe3-53bb-9495-3669b917038a] [:name Mikrofonstative] [:can_delete false] [:__typename :Category]) #ordered/map ([:id f94f72e8-ff65-5bad-b1f9-81ddd8fa7c0c] [:name Monitore / Screens] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 89e4a22f-7d6c-5006-b26a-3ef6f8f19630] [:name Schnittplatz / Mischpult / Regie] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 1fb59e17-a703-5abc-8a80-fc7a9c20ee1d] [:name Video/Film-Kameras] [:can_delete false] [:__typename :Category]) #ordered/map ([:id c17698c1-5d5d-51ea-927f-b6ca96431a50] [:name Video/Film-Stative] [:can_delete false] [:__typename :Category]) #ordered/map ([:id fabe3b8c-58b5-5009-8873-cc3e945a7c0d] [:name Video/Filmobjektive] [:can_delete false] [:__typename :Category]) #ordered/map ([:id ebb12585-ce23-5cbe-8f4f-41a42d60a656] [:name Zuteilung unbekannt - Audio- und Videotechnik] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id 1a047acd-dc98-52c2-99d3-dc6332adc1e0] [:name Bauliche Anpassungen und Mobiliar] [:image_url /procure/images/8e07c37e-d244-514d-bfa9-306158056160] [:categories [#ordered/map ([:id 0a082661-cc1c-5b49-baab-f4db926faa7e] [:name Bauprojekte] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 42cc2d9a-cc45-5d77-85d3-0f21270d7a35] [:name Einrichtungsprojekte] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 56aaec64-8d65-50b3-bd81-f788d477b927] [:name Mobiliarergänzungen] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 483ac871-b632-5dcd-9d37-789d65f4c424] [:name Schliessanlagen und Türen] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 2b3749a2-6a59-5a25-9b9f-32f5e485e635] [:name Signaletik] [:can_delete false] [:__typename :Category]) #ordered/map ([:id fad911e4-8c69-535c-a138-f3e2544519ba] [:name Vorhänge] [:can_delete false] [:__typename :Category]) #ordered/map ([:id c3f14f79-931c-52c8-a847-ed77449ce9a6] [:name Zuteilung unbekannt - Bauliche Anpassungen und Mobiliar] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id dda588f4-660c-573c-a2ff-944ae93ad42e] [:name Beleuchtungstechnik] [:image_url /procure/images/8debe2ef-4a7e-58a1-bf4c-1622dead4579] [:categories [#ordered/map ([:id b9e4f492-55e3-57e4-9467-91c81bfe2325] [:name Bühnenlicht] [:can_delete false] [:__typename :Category]) #ordered/map ([:id a7cca5a4-e265-5f36-b794-1024c8aacc3e] [:name Film-Beleuchtung] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 79822b89-0edb-588c-b9e5-65b7722ac50b] [:name Kameralicht] [:can_delete false] [:__typename :Category]) #ordered/map ([:id ab911807-6431-5ca7-890a-3573737bb4d3] [:name Mobiles Raumlicht für Ausstellungen] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 64c6f8ad-a1b7-530b-946a-ebb1644ac897] [:name Studio-Licht] [:can_delete false] [:__typename :Category]) #ordered/map ([:id f2bb3f23-bb5b-5855-b03f-0166bd19fc0c] [:name Zuteilung unbekannt - Beleuchtungstechnik] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id 2b07eb8a-4174-5257-83eb-920d536cc44a] [:name Betriebseinrichtungen und Fahrzeuge] [:image_url /procure/images/3d6cbe63-c327-5c6b-b7fa-48e6c52f2cdc] [:categories [#ordered/map ([:id 5d8639a3-4569-5009-af28-f63f2af5209d] [:name Betriebseinrichtungen] [:can_delete false] [:__typename :Category]) #ordered/map ([:id b34f1cbb-4ac7-59a0-81f2-3ca7ecc94e71] [:name Fahrzeuge] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 73e97867-43ea-5bee-b46b-d7c74fbf873b] [:name Hub- und Hebegeräte] [:can_delete false] [:__typename :Category]) #ordered/map ([:id b6601a86-b5d3-5682-88b6-cff956b00d7b] [:name Zuteilung unbekannt - Betriebseinrichtungen und Fahrzeuge] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id f6827594-33a6-5760-ac41-f94ceefacfab] [:name Bühnentechnik] [:image_url /procure/images/9a8cba78-10ab-585b-a4c2-9d8e7f0818ee] [:categories [#ordered/map ([:id 455bc6dc-afbd-579d-a621-6d75e0fca9ea] [:name Bühnentechnik] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 747b6b21-9fad-4a01-acd9-cd8983aed286] [:name Fundus] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 07a6af37-e127-5f4b-94ec-698a5698d98c] [:name Zuteilung unbekannt - Bühnentechnik] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id 517b82ae-2b7e-4822-9aeb-0d4753dec821] [:name Darlehen] [:image_url nil] [:categories [#ordered/map ([:id 671ab85c-b8c1-4659-9c6e-9ebe2f122a59] [:name Darlehen] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id ca1d97ac-0ac4-597a-8edb-f9c466b1c7da] [:name Fotografie] [:image_url /procure/images/07a33b4c-d274-54e5-a2ce-11f26d57be05] [:categories [#ordered/map ([:id e1b4cad8-0416-5cf7-9e4a-dde208d0abad] [:name Blitzanlagen] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 011ff3f3-09fa-59e1-9713-52466786adf8] [:name Fotokameras] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 54b87eb0-061c-5a97-96ad-e9b6da605184] [:name Fotostative] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 5858ec5d-5f01-50fb-bc96-4b4766bd7799] [:name Kompakt-Blitze] [:can_delete false] [:__typename :Category]) #ordered/map ([:id ba5b41a7-4317-5160-9b82-b0931a48aec0] [:name Objektive] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 9df68a66-4523-5072-aa31-1df9abeaa1c7] [:name Zuteilung unbekannt - Fotografie] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id 2ea39047-e663-50d5-9080-838b75883704] [:name IT & Elektronik] [:image_url /procure/images/1464e46c-e726-54a9-a42b-f937a0342d22] [:categories [#ordered/map ([:id f2531d7e-d9ff-5c3e-9e88-6d3a16a89aa1] [:name Desktop] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 1af3a7f2-b16a-4203-b6ac-f2c7be612d74] [:name IT_Projekte] [:can_delete false] [:__typename :Category]) #ordered/map ([:id ccab158d-79c7-5c28-a8a2-47cb4925f101] [:name IT-Basisinfrastruktur] [:can_delete false] [:__typename :Category]) #ordered/map ([:id eb1e7bef-80c6-4958-b16e-35555735ce61] [:name IT-Security] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 4ecc9e97-2d12-5173-bd8c-781482c842e8] [:name Laptops] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 80226a51-c17a-5fd8-93db-40aef5b03491] [:name Monitore] [:can_delete false] [:__typename :Category]) #ordered/map ([:id fe602c35-1097-52d0-acd0-40579d295f00] [:name Scanner] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 56065d53-cd2f-5a39-9b66-532fd83ad2e6] [:name Schnittstellengeräte] [:can_delete false] [:__typename :Category]) #ordered/map ([:id fc7bc38c-62f3-5576-802f-c874e06ee776] [:name Software] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 76fdca98-4a2a-5640-bc98-f33059d6ffa0] [:name Tablets] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 77857566-03d9-58f4-8b0d-290227434aff] [:name Telefon] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 5059c4fc-d34c-5c9a-9efe-257c7ec6fb6b] [:name Zuteilung unbekannt - IT & Elektronik] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id f6885671-3bf3-56f2-8e92-b5112d0f703f] [:name Musikinstrumente] [:image_url /procure/images/3a52eb87-b5fe-5df0-98b1-43e80f28d2dc] [:categories [#ordered/map ([:id af3372a1-63a8-52dc-850e-c2ae91c1c078] [:name Musikinstrumente] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 17a52112-1986-5074-b1d9-0faff29a785b] [:name Zuteilung unbekannt - Musikinstrumente] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id 6c8a0d77-6711-5156-a59a-12425ba01cff] [:name Werkstatt-Technik] [:image_url /procure/images/f4e1f230-df2e-5e95-bf89-827f7a6b4b3b] [:categories [#ordered/map ([:id 6870a16c-9a71-5e60-b94a-f0b784398fec] [:name Handwerkzeug] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 771fddcf-b19a-5e6b-8b6f-7266b6922c4f] [:name Maschinen] [:can_delete false] [:__typename :Category]) #ordered/map ([:id c7ece4a6-2b5c-409f-96ea-e4fd6e8f9792] [:name Sicherheit] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 3eaad5d5-516a-5610-8caf-342cfdcaac62] [:name Zuteilung unbekannt - Werkstatt-Technik] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory])]])}
2023-12-12T11:31:25.446Z NX-41294 DEBUG [leihs.procurement.graphql:86] - result => {:data #ordered/map ([:main_categories [#ordered/map ([:id "519f7a95-9ca7-5256-bf63-142cfc23dc62"] [:name "Audio- und Videotechnik"] [:image_url "/procure/images/ee215167-b2c3-5fcc-90c3-098ad20d16ea"] [:categories [#ordered/map ([:id "4e48b48c-e1bf-50d7-ab2d-9aa438c638de"] [:name "Beamer"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "a1727606-c7c8-54a2-aaa1-ceff7a7d4b40"] [:name "Funk-Strecken"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "00382e27-a87a-5313-b31b-a369dad6c5f8"] [:name "Lautsprecher"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "ce5424cc-ce77-5e67-8201-333ec20963eb"] [:name "Lautsprecherstative"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "ce0812d7-080b-5f49-8530-dd4a821c57b6"] [:name "Mikrofone"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "67e5fc60-6fe3-53bb-9495-3669b917038a"] [:name "Mikrofonstative"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "f94f72e8-ff65-5bad-b1f9-81ddd8fa7c0c"] [:name "Monitore / Screens"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "89e4a22f-7d6c-5006-b26a-3ef6f8f19630"] [:name "Schnittplatz / Mischpult / Regie"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "1fb59e17-a703-5abc-8a80-fc7a9c20ee1d"] [:name "Video/Film-Kameras"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "c17698c1-5d5d-51ea-927f-b6ca96431a50"] [:name "Video/Film-Stative"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "fabe3b8c-58b5-5009-8873-cc3e945a7c0d"] [:name "Video/Filmobjektive"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "ebb12585-ce23-5cbe-8f4f-41a42d60a656"] [:name "Zuteilung unbekannt - Audio- und Videotechnik"] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "1a047acd-dc98-52c2-99d3-dc6332adc1e0"] [:name "Bauliche Anpassungen und Mobiliar"] [:image_url "/procure/images/8e07c37e-d244-514d-bfa9-306158056160"] [:categories [#ordered/map ([:id "0a082661-cc1c-5b49-baab-f4db926faa7e"] [:name "Bauprojekte"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "42cc2d9a-cc45-5d77-85d3-0f21270d7a35"] [:name "Einrichtungsprojekte"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "56aaec64-8d65-50b3-bd81-f788d477b927"] [:name "Mobiliarergänzungen"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "483ac871-b632-5dcd-9d37-789d65f4c424"] [:name "Schliessanlagen und Türen"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "2b3749a2-6a59-5a25-9b9f-32f5e485e635"] [:name "Signaletik"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "fad911e4-8c69-535c-a138-f3e2544519ba"] [:name "Vorhänge"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "c3f14f79-931c-52c8-a847-ed77449ce9a6"] [:name "Zuteilung unbekannt - Bauliche Anpassungen und Mobiliar"] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "dda588f4-660c-573c-a2ff-944ae93ad42e"] [:name "Beleuchtungstechnik"] [:image_url "/procure/images/8debe2ef-4a7e-58a1-bf4c-1622dead4579"] [:categories [#ordered/map ([:id "b9e4f492-55e3-57e4-9467-91c81bfe2325"] [:name "Bühnenlicht"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "a7cca5a4-e265-5f36-b794-1024c8aacc3e"] [:name "Film-Beleuchtung"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "79822b89-0edb-588c-b9e5-65b7722ac50b"] [:name "Kameralicht"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "ab911807-6431-5ca7-890a-3573737bb4d3"] [:name "Mobiles Raumlicht für Ausstellungen"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "64c6f8ad-a1b7-530b-946a-ebb1644ac897"] [:name "Studio-Licht"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "f2bb3f23-bb5b-5855-b03f-0166bd19fc0c"] [:name "Zuteilung unbekannt - Beleuchtungstechnik"] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "2b07eb8a-4174-5257-83eb-920d536cc44a"] [:name "Betriebseinrichtungen und Fahrzeuge"] [:image_url "/procure/images/3d6cbe63-c327-5c6b-b7fa-48e6c52f2cdc"] [:categories [#ordered/map ([:id "5d8639a3-4569-5009-af28-f63f2af5209d"] [:name "Betriebseinrichtungen"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "b34f1cbb-4ac7-59a0-81f2-3ca7ecc94e71"] [:name "Fahrzeuge"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "73e97867-43ea-5bee-b46b-d7c74fbf873b"] [:name "Hub- und Hebegeräte"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "b6601a86-b5d3-5682-88b6-cff956b00d7b"] [:name "Zuteilung unbekannt - Betriebseinrichtungen und Fahrzeuge"] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "f6827594-33a6-5760-ac41-f94ceefacfab"] [:name "Bühnentechnik"] [:image_url "/procure/images/9a8cba78-10ab-585b-a4c2-9d8e7f0818ee"] [:categories [#ordered/map ([:id "455bc6dc-afbd-579d-a621-6d75e0fca9ea"] [:name "Bühnentechnik"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "747b6b21-9fad-4a01-acd9-cd8983aed286"] [:name "Fundus"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "07a6af37-e127-5f4b-94ec-698a5698d98c"] [:name "Zuteilung unbekannt - Bühnentechnik"] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "517b82ae-2b7e-4822-9aeb-0d4753dec821"] [:name "Darlehen"] [:image_url nil] [:categories [#ordered/map ([:id "671ab85c-b8c1-4659-9c6e-9ebe2f122a59"] [:name "Darlehen"] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da"] [:name "Fotografie"] [:image_url "/procure/images/07a33b4c-d274-54e5-a2ce-11f26d57be05"] [:categories [#ordered/map ([:id "e1b4cad8-0416-5cf7-9e4a-dde208d0abad"] [:name "Blitzanlagen"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "011ff3f3-09fa-59e1-9713-52466786adf8"] [:name "Fotokameras"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "54b87eb0-061c-5a97-96ad-e9b6da605184"] [:name "Fotostative"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "5858ec5d-5f01-50fb-bc96-4b4766bd7799"] [:name "Kompakt-Blitze"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "ba5b41a7-4317-5160-9b82-b0931a48aec0"] [:name "Objektive"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "9df68a66-4523-5072-aa31-1df9abeaa1c7"] [:name "Zuteilung unbekannt - Fotografie"] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "2ea39047-e663-50d5-9080-838b75883704"] [:name "IT & Elektronik"] [:image_url "/procure/images/1464e46c-e726-54a9-a42b-f937a0342d22"] [:categories [#ordered/map ([:id "f2531d7e-d9ff-5c3e-9e88-6d3a16a89aa1"] [:name "Desktop"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "1af3a7f2-b16a-4203-b6ac-f2c7be612d74"] [:name "IT_Projekte"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "ccab158d-79c7-5c28-a8a2-47cb4925f101"] [:name "IT-Basisinfrastruktur"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "eb1e7bef-80c6-4958-b16e-35555735ce61"] [:name "IT-Security"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "4ecc9e97-2d12-5173-bd8c-781482c842e8"] [:name "Laptops"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "80226a51-c17a-5fd8-93db-40aef5b03491"] [:name "Monitore"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "fe602c35-1097-52d0-acd0-40579d295f00"] [:name "Scanner"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "56065d53-cd2f-5a39-9b66-532fd83ad2e6"] [:name "Schnittstellengeräte"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "fc7bc38c-62f3-5576-802f-c874e06ee776"] [:name "Software"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "76fdca98-4a2a-5640-bc98-f33059d6ffa0"] [:name "Tablets"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "77857566-03d9-58f4-8b0d-290227434aff"] [:name "Telefon"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "5059c4fc-d34c-5c9a-9efe-257c7ec6fb6b"] [:name "Zuteilung unbekannt - IT & Elektronik"] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "f6885671-3bf3-56f2-8e92-b5112d0f703f"] [:name "Musikinstrumente"] [:image_url "/procure/images/3a52eb87-b5fe-5df0-98b1-43e80f28d2dc"] [:categories [#ordered/map ([:id "af3372a1-63a8-52dc-850e-c2ae91c1c078"] [:name "Musikinstrumente"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "17a52112-1986-5074-b1d9-0faff29a785b"] [:name "Zuteilung unbekannt - Musikinstrumente"] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "6c8a0d77-6711-5156-a59a-12425ba01cff"] [:name "Werkstatt-Technik"] [:image_url "/procure/images/f4e1f230-df2e-5e95-bf89-827f7a6b4b3b"] [:categories [#ordered/map ([:id "6870a16c-9a71-5e60-b94a-f0b784398fec"] [:name "Handwerkzeug"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "771fddcf-b19a-5e6b-8b6f-7266b6922c4f"] [:name "Maschinen"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "c7ece4a6-2b5c-409f-96ea-e4fd6e8f9792"] [:name "Sicherheit"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "3eaad5d5-516a-5610-8caf-342cfdcaac62"] [:name "Zuteilung unbekannt - Werkstatt-Technik"] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory])]])}
>>> authenticate::skip= nil  handler-key= :graphql
>>> authenticate::authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}

>> authorize >

>> authorize::handler > #object[leihs.core.locale$wrap$fn__45159 0x55069a5c leihs.core.locale$wrap$fn__45159@55069a5c]

>> authorize::request > {:authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 219b97e6-bb13-401e-92a7-2304bf206106}, leihs-user-session {:value d429c048-7118-407f-a7a9-b33da6f15b06}}, :remote-addr 127.0.0.1, :start-time 47991922096583, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type application/json, cookie leihs-anti-csrf-token=219b97e6-bb13-401e-92a7-2304bf206106; leihs-user-session=d429c048-7118-407f-a7a9-b33da6f15b06, content-length 595, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/admin/categories/dda588f4660c573ca2ff944ae93ad42e, connection keep-alive, pragma no-cache, x-csrf-token 219b97e6-bb13-401e-92a7-2304bf206106, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x4f7e6e09 /127.0.0.1:3230<->/127.0.0.1:53029], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x65dc1b71 HikariDataSource (db-pool)]}, :content-length 595, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:operationName MainCategories, :variables {}, :query query MainCategories {
  main_categories {
    ...MainCatProps
    __typename
  }
}

fragment MainCatProps on MainCategory {
  id
  name
  can_delete
  image_url
  categories {
    id
    name
    can_delete
    cost_center
    general_ledger_account
    procurement_account
    inspectors {
      ...UserProps
      __typename
    }
    viewers {
      ...UserProps
      __typename
    }
    __typename
  }
  __typename
}

fragment UserProps on User {
  id
  firstname
  lastname
  __typename
}
}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0xbde374d leihs.procurement.graphql$handler@bde374d], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>> authorize::handler-key >> :graphql
>myprint>  authEnt? {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>myprint>  txn #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
2023-12-12T11:31:25.480Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.481Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.481Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>myprint>  admin true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.481Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> inspector? {:result false}
>myprint>  inspector false
>o> viewer? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.482Z NX-41294 DEBUG [leihs.procurement.permissions.user:85] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> viewer? {:result false}
>myprint>  viewer false
>o> requester?? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.482Z NX-41294 DEBUG [leihs.procurement.permissions.user:169] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> requester?? {:exists false}
2023-12-12T11:31:25.482Z NX-41294 DEBUG [leihs.procurement.permissions.user:173] - (:exists result) => false
>myprint>  requester false
2023-12-12T11:31:25.483Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.483Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.483Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.483Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> inspector? {:result false}
>o> viewer? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.484Z NX-41294 DEBUG [leihs.procurement.permissions.user:85] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> viewer? {:result false}
>o> requester?? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.484Z NX-41294 DEBUG [leihs.procurement.permissions.user:169] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> requester?? {:exists false}
2023-12-12T11:31:25.484Z NX-41294 DEBUG [leihs.procurement.permissions.user:173] - (:exists result) => false

> 1 anti-csrf-token >  219b97e6-bb13-401e-92a7-2304bf206106

> 1 anti-csrf-token class >  java.lang.String

> 2 anti-csrf-token-new >  nil
pure-handler >> 2
2023-12-12T11:31:25.490Z NX-41294 DEBUG [leihs.procurement.graphql:46] - graphql query query MainCategories {
  main_categories {
    ...MainCatProps
    __typename
  }
}

fragment MainCatProps on MainCategory {
  id
  name
  can_delete
  image_url
  categories {
    id
    name
    can_delete
    cost_center
    general_ledger_account
    procurement_account
    inspectors {
      ...UserProps
      __typename
    }
    viewers {
      ...UserProps
      __typename
    }
    __typename
  }
  __typename
}

fragment UserProps on User {
  id
  firstname
  lastname
  __typename
}
 with variables {}
>oo> vars from graphQL-Requst nil nil nil {}
>debug 2
>debug 3
2023-12-12T11:31:25.493Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format main-categories-base-query) => ["SELECT procurement_main_categories.* FROM procurement_main_categories ORDER BY procurement_main_categories.name ASC"]
>debug 4
>debug 5 {:id #uuid "519f7a95-9ca7-5256-bf63-142cfc23dc62", :name Audio- und Videotechnik}
>debug 5a id #uuid "519f7a95-9ca7-5256-bf63-142cfc23dc62"
2023-12-12T11:31:25.495Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "519f7a95-9ca7-5256-bf63-142cfc23dc62"]
>debug 5b {:main_category_id #uuid "519f7a95-9ca7-5256-bf63-142cfc23dc62", :content iVBORw0KGgoAAAANSUhEUgAAAHAAAACACAYAAADTcu1SAAAABHNCSVQICAgI
fAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAAA9tJREFUeJzt3U1rVFcAgOE3
Y6maVJeK/gIpbWmtJtaPneCqiOBfKLTgv3EtVPAPCEKroGsVEYpYu5LSYpd+
tDXtKtPFyQRTJ7lzzz0fOZn3gbNy7szNeefeTO7FOSBJkiRJkiRJkiRJkiRJ
kqTdYCHi8V8AF4AV4BhwBDgQ8Vy1jYG/gD+AX4AHwI/AT+v/tqvsB64QftDx
Lh8/A98B+5LM3A5wGfid+hNbevwGXEowfyl8TDg7/AusAreAz7o2WgJuUH8i
a4/rwGLXZGX0JfBqyn6tAstbbXQYeDxlo3kdj9bnpLQTTI83GfembXQYeLbN
RvM6ngGHOqc8na54Y+Cf/2+0hEfeduMRZU6ns8SbjE38ndc9vu+a/YFOAq97
7M+GyxE/zLyOi90dovSNtxFwP/P5p0Ls+BXY292jl2X6x9sIeKXSRLQ8vu1u
MrPYeGMIl8Dm4QpL6vGUNJcPl4E3A/aD4ztgMlodnVdDOqwwLN54RLgwrThD
5m4FuAMcHLIDo/UnUpxTA7YbHA/gA8ItIcWJmbtJvAMpdmBEuJ+nOEd7Pj5p
PAifotZo72bsTrEG7JnxsV8Bt0kYD0K4cconnEOzvPlPE+7nJY0H4RSqvLLF
g/AhRvmcJpw2P8r1Ah6B+WSPBwbM5QwF4oEBczhL+J2XPR4YMLWzwA8Uigd+
iElpcuQtlXxRj8A0zlEhHhgwhXOE02bxeOCVmBTeUikeGLB5nkIbZ8DGGbBx
BmycARtnwMYZsHEGbJwBG2fAxhmwcQZsnAEbZ8DGGbBxBmycARtnwMYZsHEG
bJwBG2fA4V7VfHEDDneeihENONxjKkY0YBrVIhownSoRDZhW8YgGTK9oRAPm
USyiAfMpEtGAeWWPaMD8skYc4X/wHGJtxsdlizgiLMGmOH/2eGyWiCPC+nmK
86Ln45NHHBG+sV5xYuYuacQRYeVKxbkfuV3SiJ9T/+v7Wx2fRMz3u44DLwfu
AwuEZUdrT0Zr4wlpvqp6UMTJnxFXE+zIvLnK+hEwUJLT6T7CmrG139WtjOfA
h1EzvbXYI3HDpYIT0Pr4uqtGpJiIm1xP8MPt9nGtI8JQfSNuskhYZrT2JO3U
8ZCw1mJufSK+x0WQp4/SiyDPEvG9RZAnDuGR+O54SNl4E10R72638SJhwd/a
k1d7XKPMaXMrW0V8S1hzt9NFwpqxtSey9HhOvk+bfR0DbgGrwN/ATXpeBdpL
WDP2KfUnNvd4AnxD+r/zsuh7KWgB+JSwcuUpwjvjKGEhw9bu7q8R7ue9INxV
uE/44vLJm1SSJEmSJEmSJEmSJEmSJEkq5j8E8YerHU6LEAAAAABJRU5ErkJg
gg==
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 1081, :content_type image/png, :filename video.png, :id #uuid "ee215167-b2c3-5fcc-90c3-098ad20d16ea", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.014, :System:Directory /tmp/tmp.qSpfBizLgM, :System:FileSize 1081 bytes, :PNG:ImageHeight 128, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 112x128, :PNG:ColorType RGB with Alpha, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 112, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/video.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName video.png, :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-12T11:31:25.496Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "519f7a95-9ca7-5256-bf63-142cfc23dc62"]
>debug 4
>debug 5 {:id #uuid "1a047acd-dc98-52c2-99d3-dc6332adc1e0", :name Bauliche Anpassungen und Mobiliar}
>debug 5a id #uuid "1a047acd-dc98-52c2-99d3-dc6332adc1e0"
2023-12-12T11:31:25.497Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "1a047acd-dc98-52c2-99d3-dc6332adc1e0"]
>debug 5b {:main_category_id #uuid "1a047acd-dc98-52c2-99d3-dc6332adc1e0", :content iVBORw0KGgoAAAANSUhEUgAAAGQAAACACAYAAAD9N8zAAAAABHNCSVQICAgI
fAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAABiNJREFUeJztnXmoVVUUh7+r
PvVpZebLHDJDsGywMiuLioSIIsMsMiqpoIIgqEwKLYUiqCAaoD+KlCQblKKR
BopSG0xJyyJKmp2liTSnJn32x763nqd97rD2uffu897vgwXCO2etvffv3Lv3
XnudKwghhBBCCCGEEEIIIYQQQgghhBBCCCFyTqHZDciAfsCw4r/XA781sS1d
lm7AFcAKYE/ClgNTCH/Y7gB+9/ivZKuAwwJj54r+wJtUHpjXcJ8eC0Or8F/O
5hrj5o6RwFdUPzBfACMMcY6uIYbPXrJ0Lm+MB36l9sH5GTitxlgSpALXAH9j
H6A/cXNOtUiQFLoD9xM2OB3tLtyCoBISxMO+wCtkJ0bJngP6VIgtQRIMBz4j
ezFK9hEwpEz8pglSzce30ZyC20uMrmOMscUYY+oYw0RsgkwBFgMDGxBrKLAE
mNSAWLmjG3An9q+Ir4tmubcdmM7eO/suPYf0AZ7F3vmFwAFFWxTgZy7Qs9im
LivIEPz5qGrtUaClg7+ewJwAf+8CbXRRQY4HNmDr8G5gKv4EYgG4CfdVZPH9
LXCR8d7cCnIBsANbZ7cCE6qIcR6wzRgjJCuQK0EKwAzsHV1DbcvhY4C1AfE6
tSC9gHnYO7kU/3K4BXi4aC2evx8ELAuI2ykFORB4H3sHnwJ6e/wOYO+VVWnF
laQ38HRA/E4lyFHA99g7dxv+yfsI3AScvP4bYJTn+gIwK6AdnUKQc3Bn3JZO
7cStdix+twBnp9w7GdvRbK4FKQA34Janlg5tBE5I8XtjlX53F6/1fbpOBDYZ
25Y7QVqAR7B35mNcnimJddM3m/924B05GPgkoJ25EKQ/8Bb2jjwP9PX4bcPt
oq1+38EtAJL0BV4M8Bu1ICOBL7F3Iu00L3RRULLvgCM9/rsB92TgPypBxmMr
QNiDO+++PMXvBNzOPKuB2gqcmxLrSuCvjOI0VZCrsacafgJO9fgsADdjz0eV
s93ANPyT/enALxnEaIog3YH7DI0t2efAoR6/vXCp8KyFSNpj+Cf7Ebjqw1wJ
ElqA8Dqwn8fvQMJ29LXae7gsQpJ+wBsBflcCrRVHMSOGE1aA8CDQw+N3NC55
2CgxSrYad/6RpAfwUIDf5cDg8kMZzsnAj8YG7gKuTfE7EXuqPAvbhkvX+7iu
2HaL3/XUsZDiMuAPY8M2A2d6fJbS8fWYvGu1duAW/JP9Wbh0jMXvDjIupMii
AOFwj9/ewBMBfutlj+MWFklG4U9mVmszyOB9nNAChEX40+GDaPwZRS32Af6z
lwGEZQzm4Re7KgbjJiZr8Nn4D4yOA9YF+G2UrcWdOCbpiVsyW/0uwVB3NgZ7
AUI7rsjA9/G8EPtZejNsO3C+px+hG9fV+Fd2XiYFDNo2/AUIBWBmHQasEdYO
3Ir/AZuIEy3Lsdpr0KZjV30N/gKEVmB+Ewc0K3sS/zHysdi/gttJSeP0wq0u
rI1diismSDKEsHkoNluGW5AkGQR8GOB3Dh3SOPUqQBiLfR6K2dbh3+y1AgsC
/C6meGYTIsZM/N+tk3Fn4s0evHrZDtwCJUkBuD3A70KwTeBpBQihDcqbzcL/
QF6CrZBiC9RevLYJfwFCH+CZCAap0TYff2Z3HPBDjb7mgDtXXlnlDStxxQFJ
huJeE2v24DTLluN/Re4Q4NMqfaygg7DDqKzmC/gLEE6iviU1ebENuIVMkn2A
lyvcuxGPoONIz+bejb8A4VLqX3SWJ9uJW9Ak6Q7cW+Ye3xQAuHf8Ol5c7oX7
qREMQKx2fcqYXcX/CykuTrn2X6bhyjRXUf4nKV6NoOOxWrkz9TNwafzNpAtn
QoLYBClLbK9Fd3kkSGRIkMiQIJEhQSJDgkSGBIkMX0lnrJSOli0UyMnDlydB
BlA8LzDQhvsxzOjJxVPTlZAgkSFBIkOCRIYEiQwJEhkSJDIkSGRIkMiQIJEh
QSJDgkSGBIkMCRIZEiQyJEhkSJDIkCCRIUEiI0SQnZm1ovOx3XpjiCBvB9zb
2WnK2LTQ2J/j2z+grW0NbOcimljN0xd4APeO4a46W6gg9W7fRtxra5X+00oh
hBBCCCGEEEIIIYQQQgghhBBCCCGEEA3kH1vl9UN9mBbVAAAAAElFTkSuQmCC
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 1665, :content_type image/png, :filename bauprojekte.png, :id #uuid "8e07c37e-d244-514d-bfa9-306158056160", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.013, :System:Directory /tmp/tmp.qSpfBizLgM, :System:FileSize 1665 bytes, :PNG:ImageHeight 128, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 100x128, :PNG:ColorType RGB with Alpha, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 100, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/bauprojekte.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName bauprojekte.png, :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-12T11:31:25.497Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "1a047acd-dc98-52c2-99d3-dc6332adc1e0"]
>debug 4
>debug 5 {:id #uuid "dda588f4-660c-573c-a2ff-944ae93ad42e", :name Beleuchtungstechnik}
>debug 5a id #uuid "dda588f4-660c-573c-a2ff-944ae93ad42e"
2023-12-12T11:31:25.498Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "dda588f4-660c-573c-a2ff-944ae93ad42e"]
>debug 5b {:main_category_id #uuid "dda588f4-660c-573c-a2ff-944ae93ad42e", :content iVBORw0KGgoAAAANSUhEUgAAAJsAAACACAYAAAAccBvUAAAACXBIWXMAAAQK
AAAECgFCV1GHAAA59GlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFj
a2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQi
Pz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0
az0iQWRvYmUgWE1QIENvcmUgNS42LWMxMTEgNzkuMTU4MzI1LCAyMDE1LzA5
LzEwLTAxOjEwOjIwICAgICAgICAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9
Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMi
PgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAg
ICAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8i
CiAgICAgICAgICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxl
bWVudHMvMS4xLyIKICAgICAgICAgICAgeG1sbnM6cGhvdG9zaG9wPSJodHRw
Oi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIgogICAgICAgICAgICB4
bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIK
ICAgICAgICAgICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20v
eGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgICAgICAgICAgeG1s
bnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAg
ICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8x
LjAvIj4KICAgICAgICAgPHhtcDpDcmVhdG9yVG9vbD5BZG9iZSBQaG90b3No
b3AgQ0MgMjAxNSAoTWFjaW50b3NoKTwveG1wOkNyZWF0b3JUb29sPgogICAg
ICAgICA8eG1wOkNyZWF0ZURhdGU+MjAxNi0wNy0xNFQxNTo0NTo0MSswMjow
MDwveG1wOkNyZWF0ZURhdGU+CiAgICAgICAgIDx4bXA6TW9kaWZ5RGF0ZT4y
MDE2LTA3LTE0VDE1OjQ5OjAyKzAyOjAwPC94bXA6TW9kaWZ5RGF0ZT4KICAg
ICAgICAgPHhtcDpNZXRhZGF0YURhdGU+MjAxNi0wNy0xNFQxNTo0OTowMisw
MjowMDwveG1wOk1ldGFkYXRhRGF0ZT4KICAgICAgICAgPGRjOmZvcm1hdD5p
bWFnZS9wbmc8L2RjOmZvcm1hdD4KICAgICAgICAgPHBob3Rvc2hvcDpDb2xv
ck1vZGU+MzwvcGhvdG9zaG9wOkNvbG9yTW9kZT4KICAgICAgICAgPHhtcE1N
Okluc3RhbmNlSUQ+eG1wLmlpZDozMTMzODRjNi0zYzM5LTQzNjgtODE5OS01
OWJhZDM3ODBkNGQ8L3htcE1NOkluc3RhbmNlSUQ+CiAgICAgICAgIDx4bXBN
TTpEb2N1bWVudElEPmFkb2JlOmRvY2lkOnBob3Rvc2hvcDoxYTU3ZjVjYy04
YTU4LTExNzktOGVmNS04OTFkYzJiZDEwY2Y8L3htcE1NOkRvY3VtZW50SUQ+
CiAgICAgICAgIDx4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ+eG1wLmRpZDpk
OWQ5MWY5NC0yNjQ0LTQ4NTItODAwYS0yZTA2OTBlN2VjMzM8L3htcE1NOk9y
aWdpbmFsRG9jdW1lbnRJRD4KICAgICAgICAgPHhtcE1NOkhpc3Rvcnk+CiAg
ICAgICAgICAgIDxyZGY6U2VxPgogICAgICAgICAgICAgICA8cmRmOmxpIHJk
ZjpwYXJzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgICAgICAgPHN0
RXZ0OmFjdGlvbj5jcmVhdGVkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAg
ICAgICAgIDxzdEV2dDppbnN0YW5jZUlEPnhtcC5paWQ6ZDlkOTFmOTQtMjY0
NC00ODUyLTgwMGEtMmUwNjkwZTdlYzMzPC9zdEV2dDppbnN0YW5jZUlEPgog
ICAgICAgICAgICAgICAgICA8c3RFdnQ6d2hlbj4yMDE2LTA3LTE0VDE1OjQ1
OjQxKzAyOjAwPC9zdEV2dDp3aGVuPgogICAgICAgICAgICAgICAgICA8c3RF
dnQ6c29mdHdhcmVBZ2VudD5BZG9iZSBQaG90b3Nob3AgQ0MgMjAxNSAoTWFj
aW50b3NoKTwvc3RFdnQ6c29mdHdhcmVBZ2VudD4KICAgICAgICAgICAgICAg
PC9yZGY6bGk+CiAgICAgICAgICAgICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlw
ZT0iUmVzb3VyY2UiPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6YWN0aW9u
PnNhdmVkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAgICAgICAgIDxzdEV2
dDppbnN0YW5jZUlEPnhtcC5paWQ6MzEzMzg0YzYtM2MzOS00MzY4LTgxOTkt
NTliYWQzNzgwZDRkPC9zdEV2dDppbnN0YW5jZUlEPgogICAgICAgICAgICAg
ICAgICA8c3RFdnQ6d2hlbj4yMDE2LTA3LTE0VDE1OjQ5OjAyKzAyOjAwPC9z
dEV2dDp3aGVuPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6c29mdHdhcmVB
Z2VudD5BZG9iZSBQaG90b3Nob3AgQ0MgMjAxNSAoTWFjaW50b3NoKTwvc3RF
dnQ6c29mdHdhcmVBZ2VudD4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OmNo
YW5nZWQ+Lzwvc3RFdnQ6Y2hhbmdlZD4KICAgICAgICAgICAgICAgPC9yZGY6
bGk+CiAgICAgICAgICAgIDwvcmRmOlNlcT4KICAgICAgICAgPC94bXBNTTpI
aXN0b3J5PgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9y
aWVudGF0aW9uPgogICAgICAgICA8dGlmZjpYUmVzb2x1dGlvbj4yNjI2MzYv
MTAwMDA8L3RpZmY6WFJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOllSZXNv
bHV0aW9uPjI2MjYzNi8xMDAwMDwvdGlmZjpZUmVzb2x1dGlvbj4KICAgICAg
ICAgPHRpZmY6UmVzb2x1dGlvblVuaXQ+MjwvdGlmZjpSZXNvbHV0aW9uVW5p
dD4KICAgICAgICAgPGV4aWY6Q29sb3JTcGFjZT42NTUzNTwvZXhpZjpDb2xv
clNwYWNlPgogICAgICAgICA8ZXhpZjpQaXhlbFhEaW1lbnNpb24+MTU1PC9l
eGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGlt
ZW5zaW9uPjEyODwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgIDwvcmRm
OkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAo8P3hwYWNrZXQgZW5kPSJ3
Ij8+W7LKAQAAACBjSFJNAAB6JQAAgIMAAPn/AACA6AAAUggAARVYAAA6lwAA
F2/XWh+QAAAJGElEQVR42uyda4hVVRTHf75GxJEhmxlFHEFHApEmicgnGppI
iJWSOlghGvghS8QQRpRQVOjlo4JUUkILH6SJiUJJfagsUjH9oCgOpuAjx5Ss
NEdzpg/toZA7M2fte869Z+2zPmyQ8c7Ze/33b+7Za+2916K5uRlr/zWgGpgO
zANWAB8Ce4AfgLPAn66ddT/b4z6zwv3OdKDatMyhrcFFJVALbAR+Bppjaj+7
Z9YClQZbBmEDOgDjgVXAcaApRsBaa02ur1Wu7w4GW9iQdQdeBk4XAK722mk3
lu4GW1iQVQFvAtdTANn97bobW5XBphuyx4HtwN0UQnZ/u+vG+rjBpguyB4CP
FADWWvsIeMBgSz9ozwCXFIPW0i4Bzxhs6YSswr2GmgNr24EKgy09oNUCVwME
raVdBWoNtuLHy9YVaMJvAPVux+Bz135wP7tRoDGs0x6f0wpaR2BTgsHXd4HJ
LmxSEmE8Je6zk93vJhUs3gR0NNgKB1on4OMYJ/B3YD3wLNAzxnH2dM9c7/qI
a7wfA50MtuRB6xyjI3ASmAv0KMC4e7i+TsboOHQ22JKbsC7Azhgm6jNgbBHt
GOvGkK8dO4EuBlsyk7Qjz8k5DoxKkT2j3JjysWmHwRb/xDyfpyc5P43rHLf+
nJ+nR/u8wRbfhPQCrvn+5QO9FdjYO49v7mtAL4MtnonY5TkJSxV62ks9bd1l
sOUv/jQP4f8G5igOVs9xNkjtnmaw+YteDjQIBb8FPB3AFtzTzhaJ7Q1AucHm
J7g0ntaYJm8zJm+1URp/M9jkQg/2eI0sDPBs3kIPHQYbbDKR3xYK/LXmPcN2
9oC/FmrxtsEmiz1dFp7j71ugsb0AHAJuAueAw8A+4D3guSRCEEBf4f2Jy2nd
O00jbBPT6IUBD0cczyngnTgvsXh45RMNtmjCfioQ9asCjustj0ssW4CamPr/
StD3pwZbtGM5jWmMLQGT8thSWh/lXFyM326NcR6XChW2uQJBrxTy1INbrO8C
7nkC910+W2fu1MsVQX9zDba2BZV4Xm8UaYwDXJR/ObDZjTnqja4LwGN59P2G
xEM32NoW85zg+HZ1isbdwQVhP4hw+eYy8GAeGZaiHjc/Z7C1/ZqKenv925Sf
Jn4K+DGJc2jAtwIHpaPBllvEPoJXxAYlt79mA3+1YsN0z+duEOjUx2DLLeIw
gYiLFO0CPNnKpvpFz+ctEug0zGDLLeJUgYgzlG07LW7Fjr4ez5oh0GmqwZZb
xAUCEUcozA33Rw47Jnk8a4RApwUGW24R12hdi0S0L5fD8HrCa9s1BltuETcL
RCxRCNv7OexY7fGcEoFOmw223CKuFojYWyFsuTbyH/a8HBNVp9UGW24R6wQi
1miD7b4jSoeAFzyfUSPQqc5gyy3ibIGI40JOB9qOTuMEOs022PI/VTErw7DN
Eug0yWDLLeJQSSafDMMmyeA01GBr/fhzVBF/yWLhCrcF9otAp74GW+tinhUI
OSSDsA0R6HPWTn20LaYkbenKDMK2UpIW1WBrW8zJAjF/A8oyBFqZszmqPpMN
tvYFleS5WJIh2JYI852UGWzti3pQIOqvQGkGQCt1tkbV5aDdroom7GvSm0sZ
gG29UJPXDLbof8XSIhpTAgZtikeRjlKDLZl90pYUDFUBglblUbqyLrX2pHiN
Iv12+x7oFhBo3ZxNQXyrpT0/W53HReD92tK1t3Eheb+H/XWptivlHtgVD8G3
qS658++Vxm0edl9Ju2eeduEneKY7WKcYNp/ib/eACam3TYH4yzxzayxXCNpy
T1uXqbBPyWvlgOckzFME2jxPGw9oWTZomYgKl5TFJ039Ewrse8IzHf0FTZWW
Nb1iRnpkz26pt16ZYrsqPevaNwIjVS0TlK1pZnq+ar5M46vGLRG+9LRppro1
aYYW0YsVpWUIzvnRClsHYKvn+m10iuwY7blO26r1SLzWWFRXlzZUOlEX07Cg
dg7PRc9UqV3VxhAVBz/LgXqNBWE9yz3Wp702VbCwuUl7yLMW6agijnmUZ03R
h9Tv+QawaT3GIyRypBjrHrfePOIR4hgTxEmWQI7jLNMQOvAM3SwLYY5Cgq0r
cNrDWehewDF293AKTmt2CIKEzU3m2DTHqzzjg2ODOnkc2DHqLR6VlysKFOqQ
VkbeEtwx98Bgq/DwTucXYFzzPbzPCoMt/cC9JJzYYwUY0zHhmF4K8qZYoJl+
vhFO7iMJjucR4Vi+CTVDU6h3LQcBd9KQVVuYBf0OMCjYO7ABX+79RDDJDUnc
ynK3pBoE4/gk6Jv9AcM2vNilrj1KkA832PQCd1Qw0SsS6H+FoP+jwecsCRw2
iWe6L4H+92XdA80SbN2Am1G3rxLoP+r21M2QUkdkEjY34ZJDlpUx9lspORQZ
+jxkBba1gkmfEGO/EwT9rjXYwoDtRUlhMaA2piYp/PaiwRYGbDWeN5gK2WoM
Nv2gDfTYlyxGOwYMNNj0glbtkbWxmO06UG2w6QOtBDiuCLSWdlxj4d6swzZV
IWgtbarBpgu2vYph22uw6YKtXjFs9QabLthuKYbtlsGmC7ZTimE7ZbDpgm27
Yti2G2y6YHtFMWyvGGy6YOsCnFAI2okQioZkcQdhBNCkCLQmYITtIBhsBpvB
Zq9Rg80cBHMQLPRhoQ+DzYK6FtS17SrbrjLY2oftjGLYzhhsumDbrRi23Qab
LtimKIZtisGmL852RCFoRyzOphO4/sBVRaBdBfrbDoJe4AYo2Uk4AQywq3z6
gXtVAWyv2iXlMGA7qQC2kwZbGOs2LWu2/gabbtjGK4JtvMGmG7YximAbY7Dp
hq1MyQHKJqDMYLMLy3Yx2WBLJPNksZplngwEtq7A4RSDdjikmqKZhs0B109Y
aaVQrQHol4U5yAxsDrhyYBVwOwWQ3XZjKc+K/pmC7X/QVQFLgR3AT4I6Cfm0
m66vHa7vqqzpnknYcsBXCpxPELTzQGnWdTbY/gNuYoKwTTSNDbb7gduWAGjb
TFuDrTUH4miMoB3NmgNgsMmA6wF8EQNoXwA9TFODrT3gOgMb8wBtI9DZtDTY
JNA96kIV9yIAds999lHTzmDLB7qBLja2FTjkKrFcd//e6v5voGnVfvtnAC9c
0Cv54m27AAAAAElFTkSuQmCC
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 17298, :content_type image/png, :filename bulb12323.png, :id #uuid "8debe2ef-4a7e-58a1-bf4c-1622dead4579", :metadata {:XMP-tiff:ResolutionUnit inches, :PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 1034, :XMP-exif:ExifImageHeight 128, :XMP-xmpMM:HistoryInstanceID [xmp.iid:d9d91f94-2644-4852-800a-2e0690e7ec33 xmp.iid:313384c6-3c39-4368-8199-59bad3780d4d], :XMP-xmpMM:DocumentID adobe:docid:photoshop:1a57f5cc-8a58-1179-8ef5-891dc2bd10cf, :XMP-xmpMM:InstanceID xmp.iid:313384c6-3c39-4368-8199-59bad3780d4d, :PNG:GreenX 0.21, :ExifTool:ExifToolVersion 10.4, :XMP-exif:ColorSpace Uncalibrated, :XMP-xmp:CreateDate 2016:07:14 15:45:41+02:00, :Composite:Megapixels 0.02, :XMP-tiff:Orientation Horizontal (normal), :PNG:WhitePointY 0.32899, :XMP-x:XMPToolkit Adobe XMP Core 5.6-c111 79.158325, 2015/09/10-01:10:20        , :System:Directory /tmp/tmp.qSpfBizLgM, :XMP-tiff:XResolution 26.2636, :XMP-photoshop:ColorMode RGB, :XMP-exif:ExifImageWidth 155, :XMP-xmpMM:HistoryAction [created saved], :System:FileSize 17 kB, :PNG:ImageHeight 128, :XMP-xmpMM:HistoryWhen [2016:07:14 15:45:41+02:00 2016:07:14 15:49:02+02:00], :File:FileTypeExtension png, :XMP-xmp:MetadataDate 2016:07:14 15:49:02+02:00, :XMP-xmp:CreatorTool Adobe Photoshop CC 2015 (Macintosh), :File:FileType PNG, :PNG:BitDepth 8, :XMP-xmpMM:HistorySoftwareAgent [Adobe Photoshop CC 2015 (Macintosh) Adobe Photoshop CC 2015 (Macintosh)], :Composite:ImageSize 155x128, :XMP-xmp:ModifyDate 2016:07:14 15:49:02+02:00, :PNG:ColorType RGB with Alpha, :PNG:WhitePointX 0.31269, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 155, :File:MIMEType image/png, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :PNG:BlueY 0.05999, :XMP-xmpMM:HistoryChanged /, :SourceFile /tmp/tmp.qSpfBizLgM/bulb12323.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG:RedX 0.63999, :PNG:GreenY 0.71, :PNG:BlueX 0.14999, :PNG:RedY 0.33, :PNG-pHYs:PixelsPerUnitX 1034, :System:FileName bulb12323.png, :XMP-tiff:YResolution 26.2636, :PNG-pHYs:PixelUnits meters, :XMP-xmpMM:OriginalDocumentID xmp.did:d9d91f94-2644-4852-800a-2e0690e7ec33, :PNG:Filter Adaptive, :XMP-dc:Format image/png}}
2023-12-12T11:31:25.499Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "dda588f4-660c-573c-a2ff-944ae93ad42e"]
>debug 4
>debug 5 {:id #uuid "2b07eb8a-4174-5257-83eb-920d536cc44a", :name Betriebseinrichtungen und Fahrzeuge}
>debug 5a id #uuid "2b07eb8a-4174-5257-83eb-920d536cc44a"
2023-12-12T11:31:25.499Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "2b07eb8a-4174-5257-83eb-920d536cc44a"]
>debug 5b {:main_category_id #uuid "2b07eb8a-4174-5257-83eb-920d536cc44a", :content iVBORw0KGgoAAAANSUhEUgAAAGwAAACACAYAAADu4Iw0AAAABHNCSVQICAgI
fAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAABE1JREFUeJzt3U+PFEUcxvHv
7AoriPEkckFI1JGErBtfAQgniJD4JtCIWRKPxkO/CfTgichJEz0QzoYEr7Ig
ARJOIokHCBDQXcLCjofaCaRpuqu6q7q6ap5P8ktIhqmpp5+dfzs7MyAiIiIi
IiIiIiIiIiIiIiIiIiIikrd9wHlgDZjM+KwB54BxpyMa0D7gPvEP1NDmHjCe
73BgQzkDLMbexABtA/aMYu+iwhrweuxNDNTqEAubxN7AkM3F3oC4UWGJUWGJ
UWGJUWGJUWGJUWGJUWGJUWGJUWGJUWGJCVXYCPgE+AG4Caxj/zKC9OwgcIn4
rx/lOl59M4BAuY83xQDCzMJ4UQwgyKxMZ8UAQszSdFIMIMCsTWvFADY/i9NK
4XABF4E9DmvHPiBDH2eFw+IXgTcd1499QIY+TgqHhduURaCQOY21wmHRtmUR
KGROY6VwWLBLWQQKmdM0KhwW61oWgULmNLUKh4V8lEWgkDnNK33rsIivsggY
NJepdNhhAZ9lETBoLvOSeeCq5Zl9l0XAoLnMS45ZnjFEWXgOl91U/YnAZxYH
9XfgCPDI4v+KR1WFfdRwHpUVUdUb+v4BdtWcZy/wV5DdGJW302KUCxsBT4DX
HM7jmwqrUb5J3EZ9WRJZuRybsnQNiKh8DXsWZRdirVzY0yi7EGsqLDFVj/h0
HzVgevdKYlRYYlRYYlRYYlRYYlRYYlRYYlRYYlRYYlRYYlRYYlRYYlRYYlRY
YlRYYlRYYlRYYlRYYlRYYqaFvfh9Xb5dAk4A7wNbgQXgA+Bz4HKAy+tb7/lC
fV/XE+Ak9dfiOWAZtw/AHMrEysf5QGGO1AQpO+o5VB9lxcoX5GsLTzqEmVoO
sI9QEzOf95/sP2j3YGYOuOJ5LyEmZr7Hc8BKiwuv8z2w0eJ8G8B3nvcSQsx8
KwCHgP/w9xP4XocNjT3uI9TEyvcvcODFhX4FbtP9JnJLh0ALHS+7j+kz3zqm
k18wTxsqjYDtmC8Orfrb+42GC9kaMFAfb4eKnW+EOfbbqTj+VXeeE2AVeLz5
77KHDZt6127vlfY2nP6gw9q2YuebYI79KhXHv82jnVsNpx9qsebU4YbT/+6w
tq3s8p2l/mq9QrsfBJtP4Pmx495tDDpfmwu+0HD6EvBVi3VPAfsb/s9vLdZ1
lV2+dzDv1Gx6dHPUYc1PLdd820uCelnm+7nhwqcbWKb+WjwPfE1zmAnwU4Ac
r5JdviWaH/5O5wrwBea53sLmfAh8if2nxj0DFkMGKsky32nLzfiY06HDVMgu
3w7geg9hrgFv9BGoJMt8Y+BuwDB3MK/expJlvo8JE+rO5tqxZZlvDNxo2KDr
zUTMa1ZZlvl28Py1orZBNjB3wDHus5pkm28J8zzG5rnHdNYxz0P6fOjeVtR8
IT+scidwHPOts4vAbuCtzdMeYH7R+Sfm1zHnMLfpKck9n4iIiIiIiIiIiIiI
iEjv/gec0agwRiP7+AAAAABJRU5ErkJggg==
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 1195, :content_type image/png, :filename fahrzeuge.png, :id #uuid "3d6cbe63-c327-5c6b-b7fa-48e6c52f2cdc", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:01+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.014, :System:Directory /tmp/tmp.qSpfBizLgM, :System:FileSize 1195 bytes, :PNG:ImageHeight 128, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 108x128, :PNG:ColorType RGB with Alpha, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 108, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:01+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/fahrzeuge.png, :System:FileAccessDate 2018:11:14 17:31:01+00:00, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName fahrzeuge.png, :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-12T11:31:25.500Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "2b07eb8a-4174-5257-83eb-920d536cc44a"]
>debug 4
>debug 5 {:id #uuid "f6827594-33a6-5760-ac41-f94ceefacfab", :name Bühnentechnik}
>debug 5a id #uuid "f6827594-33a6-5760-ac41-f94ceefacfab"
2023-12-12T11:31:25.501Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "f6827594-33a6-5760-ac41-f94ceefacfab"]
>debug 5b {:main_category_id #uuid "f6827594-33a6-5760-ac41-f94ceefacfab", :content iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAA3NCSVQICAjb
4U/gAAAACXBIWXMAAAG7AAABuwE67OPiAAAAGXRFWHRTb2Z0d2FyZQB3d3cu
aW5rc2NhcGUub3Jnm+48GgAAAM9QTFRF////AAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAA+q0M9gAAAER0Uk5TAAQGBwgJCwwQFBUbISIvMDIzNDU3ODtBREpP
UlNVVldpcXN7gIqTl6Chpqytv8PExsrS1uDj5Obo6evs7fLz9ff4/P3Djn9u
AAABnElEQVRYw+3XxXbDMBQE0AkzM3McZuY4/v9v6sKFKLEUPWXV085acxe2
9WQhNjR4mRcBACjOuUuGMfD7hnFwAYDrIFgyhCFKEgCSwiViIAUAqX/glwNx
AIi/AQQBIPgG4AEAjzpwMTfTRRlYmMBCGRiYwEAZqJlATRlImEBCFTjaTMB2
VAQ0fEZTBMJfQFgNmOA7EyWg/AOUVYAR7jKiA7fIPRC5kQENTDQqMHOzgHtG
Aw4hPCR0oAB6Fk/J6vLAtQCLFK6ywDEDy2SOcsAyCk6iSxmg6wU33u5LYJOH
MPmNEFjX3XgRd33NB5oOSMTR5AK7igxQ2QmeQd//qu7vix/iriTul3YvX2NL
1G/JfEhVfr8q9SXqOV4/p8vthVPEuh85ye7GVcCqH1jJz4OeFdCjDJTgcz+o
U0Za+xlok2bi2ffY951pU7n5CDSJY33vZPvOPfVgeZhrUfLJVGaBMhlosECD
DHRYoEMGxiwwJgNbFtjSfzDs9327wh8K8yE4/ybAnFIOPsC7fE/Z1zjlXr45
1/9JmgXSE871/wOnFjUuRak9PwAAAABJRU5ErkJggg==
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 841, :content_type image/png, :filename curtain-2.png, :id #uuid "9a8cba78-10ab-585b-a4c2-9d8e7f0818ee", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 443, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.004, :System:Directory /tmp/tmp.qSpfBizLgM, :PNG:Palette (Binary data 207 bytes, use -b option to extract), :System:FileSize 841 bytes, :PNG:ImageHeight 64, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 64x64, :PNG:ColorType Palette, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 64, :PNG:Software www.inkscape.org, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/curtain-2.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitX 443, :System:FileName curtain-2.png, :PNG:Transparency (Binary data 68 bytes, use -b option to extract), :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-12T11:31:25.502Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "f6827594-33a6-5760-ac41-f94ceefacfab"]
>debug 4
>debug 5 {:id #uuid "517b82ae-2b7e-4822-9aeb-0d4753dec821", :name Darlehen}
>debug 5a id #uuid "517b82ae-2b7e-4822-9aeb-0d4753dec821"
2023-12-12T11:31:25.502Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "517b82ae-2b7e-4822-9aeb-0d4753dec821"]
>debug 5b nil
2023-12-12T11:31:25.506Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "517b82ae-2b7e-4822-9aeb-0d4753dec821"]
>debug 4
>debug 5 {:id #uuid "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da", :name Fotografie}
>debug 5a id #uuid "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da"
2023-12-12T11:31:25.507Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da"]
>debug 5b {:main_category_id #uuid "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da", :content iVBORw0KGgoAAAANSUhEUgAAAGAAAACACAYAAAD03Gy6AAAABHNCSVQICAgI
fAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAABvdJREFUeJztnWuIVVUUx3/3
OpPaQ6d8ZKI9TM0sKyGnB72ozNKIisjqY0RQQVBQH0PqS4UZmSFB+EkqKMqi
l2JPCCwRGaWyzDzO5GPyEfmYcXzM9GHNhUHHe/a6d92zz51ZP9gg45q9197/
c+7es/ba+4LjOI7jOI7jOI7jOI7jOI7jOAOdQsr/jwbmA7OBK4DxwNBaO1Xn
HAV2Ai3AKuB9YI+2kpHAIqAT6PFSVTkMvN47pkFcA7TmwPGBVlqB5rTBnwN0
5MDZgVo6e8e4X67FP3KyEmFWadBLk3ATsBGYcCp1HFNagRnA/iG9P3gFWek4
2TASOA1YVQDGAG348jJrDgMTisBD+ODHYBgwvwjcEduTQczsAjIhTIztSY5o
B9YDXYrfGYGsIocr20oAjhB/aZaHchx4BmhQDmKJc4Dlyja7yEHH81KeVg/5
yRSBFZp2C73/GOy0ApOQt6BaLgE2hRoXDRocCKzBZvABfkcR/XQBhE7j+g6F
GroAkXEBIuMCRMYFiIwLEBkXIDIuQGRcgMi4AJFxAYQh6SYqgiOqLoAw1bCu
kcB5ocYugNBMQNJUIE+iHNfYcfi8lFZgmmbg+uF+lBtc9bQfkADfAeuAzcAu
4CDi/xnAWOBi4CrgZmB6BW10Ae8CPyNZCyEUkLyqOZTJeitH7CevXDkAvAnM
JD2T+0QmAy8ie7yx+1GuRHegv3IUWAiMUg56f5wOPAfsz0G/6kKADchZBGsm
IPn6sfuXawHeQ57YWlEEXspBP3MpwGKyWxY/nlGf6kaAt9BPstXyhJHvdS/A
F9iHAkJZGOjjgBVgBzYrnUppBH7qx69BI8B9VQ9h9VwGHGMQCvAD2X/un4ql
RBoHTSiiDfgmxaYZuDSwvrnAl4G2teZCYAthq7B24KsUmweQ8EgQoWqtCKjr
x8C6EvIXif2CMN//JX3RkATW1WM5CGciZ4xD+AjoNmzbgg8D7ZqQ2JQJlgJc
Tfhy8mvDdq1YrbANfdBSsRTgcoXtOsN2rWgDdgfamsWqLAWYHGh3EJnI8kYP
8GegbWhfU7EUYHygXSk+n0d2BdqF9jUVSwFCbwPpMGzTmtC8/iarBi0FCD1r
nLflZ19CFxHDrBq0HIzQIz7B9+ZEINQ3syW0pQChm9jjqPwoaK0JPS8dfAQp
DUsB9gXaNWCbCGVFI+F+7bVq1FKA7Qrb6wzbtWIm4fOYpq9lsRTgL4XtXYbt
WjFXYfuHVaOWAmxU2M4DzjZsu1oKwCMK+xarhi0FWI/k84QwDHjMsO1quROY
orBfY9m4ZTj6e0V9/yC3jMSmCKwl3O/tpG8kJaH1Wf9R9LnCdgySOhibR5FI
biifYhxKsXwDLlLU14P8QXObXVfUTAL+68evcuWmgHoTRX2mAoDE+jUd2o0I
lzVnIZOpxtfNhM2bSWidtYjLLFbajwZWojhVYsBw5IHSxvUXU4OdPOs3oIgs
STVPVunpyuJNaAK+rcC/XYTnrSaKes0FALi7gg72ICujWxXtaJkO/Fahb08p
2kkU9dZEgALwWYUd7QZeQzb5rWgAnqXyq5k3oAsgJoq6ayIASGRRu8LoW3Yg
B960NxH2pQH5/oNfq/DjOPoDfImi/poJAPCgov5Tlb1I9vTthInRiAT7Xsbm
Gv4FFfQ7Ca1fkxn3CXBvBc4sQq6DtOAo8AsyYe9EzpD1IB9X5yKH9GZQ3VvT
l9VImEJ7n1wCXBBqXMs3AORjQHWVY07KJuQu0EpIQtvJYn/2GPAw6XmleaIN
udI5dJOpYrLaIO8E7kEOyeWdrcAtyPxRc7LMUDiEiLA8wza1rAWuR7e5VDW1
ngNOpAA8j0xssT/n+5Z3sJu8E0W7mQtQ4gbkSYs98HuQ5bIliaL9aAKALB8X
IsvLrAe+G1iGBAOtSRR+RBWgxFTkG+e6Ff5UUz4GrqxhfxKFL7kQoMQU4A1k
+Wc96PuAJYQfoaqGROFXrgQoMRTJnHgbSRmvdNC39NYxD/nWoqxIQn3Ma4pg
F7K/XNpjHovcAzQN+RN/HBLXH4ospQ8jgb92pPObkCyNPJ5DOIk8vgH1TkLg
uOY5VXxQ4AJERiNAlpNYvaM6wBE6B7Qjmx1OeSahW6mpjBdk1o36pAHlXngB
uedS82QvQ7YIE/J32j0Wjchf1i8ANyp+70gB2AacXwuvnFS2FjHMdXfUtBSp
j12qgcrKAhKO/Rv/TuGs6QQmFpENiaWRnRmMLAH2lk56jEQSav17hbNhG5K/
dKDvD5upPHfSS3jpoMyJnDkuQs0HP/Ur5Gchr0hsZwdaSVCcRRuBbJb721B9
6QBeRY5EnUTacctRSHr3bGRHajweFU3jCHKUtQU5evUBhndLOI7jOI7jOI7j
OI7jOI7jOI5Tf/wPcYhVe1hRfeIAAAAASUVORK5CYII=
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 1877, :content_type image/png, :filename fotografie.png, :id #uuid "07a33b4c-d274-54e5-a2ce-11f26d57be05", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.012, :System:Directory /tmp/tmp.qSpfBizLgM, :System:FileSize 1877 bytes, :PNG:ImageHeight 128, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 96x128, :PNG:ColorType RGB with Alpha, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 96, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/fotografie.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName fotografie.png, :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-12T11:31:25.507Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da"]
>debug 4
>debug 5 {:id #uuid "2ea39047-e663-50d5-9080-838b75883704", :name IT & Elektronik}
>debug 5a id #uuid "2ea39047-e663-50d5-9080-838b75883704"
2023-12-12T11:31:25.508Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "2ea39047-e663-50d5-9080-838b75883704"]
>debug 5b {:main_category_id #uuid "2ea39047-e663-50d5-9080-838b75883704", :content iVBORw0KGgoAAAANSUhEUgAAAHgAAACACAYAAADApa2mAAAABHNCSVQICAgI
fAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAr5JREFUeJzt3b9qU2Ech/En
0UVbFAernQRHQZy8AtFNdJQWCgq6633oUCzeRi3qoHgBDiIugosglNY6Vq1L
/zicgC2kiel5k5N8fT7wLm15c/g9bU/+kQOSJEmSJEmSJEmSJEmSJEmSpG6m
gQfAK2AN2AH2XAfWTmc2L4H7wNSRJj1iLWAB+E7zA5y0tQHMDz7y0WkDz2h+
UJO+ljqzHCstjFtyPR1s/MO3QPNDSVtzAxU4RKvAHtPAF+Bsgb301wZwEdiq
s0mJ//VzGHcYzgF36m5SIvDtAnuou7GY7Rq9zyXL+BfezQywQu/ZrTZ2dPv0
exLDuIc7T+/Zbde9gRJ3svZGcBvJhjq/sXtArbIMHM7A4QwczsDhDBzOwOEM
HM7A4QwczsDhDBzOwOEMHM7A4QwczsDhDBzOwOEMHM7A4QwczsDhDBzOwOEM
HM7A4QwczsDhDBzOwOEMHM7A4QwczsDhDBzOwOEMHM7A4QwczsDhDBzOwOFK
BN7t8/2ZAreRarbP93dGchR99Ps44RWqT1XVQbPAC4b8ccLH624AfKD3b+JN
YL3A7fyP3tfdoMS/6OUCe6i72rMt8VnOU1QX5fBcW9Y3qoty/K6zSYm/4F/A
owL76KCH1Ixb2hLNX2soZS0OOPuRaFNdsavp4Uz6WmTMn5+Yozp/ND2oSVvr
FLhO0qicBO5RPQZepbp6SNMDHLe13ZnNc+AucOJIk5YkSWOpRXXCV6ixfryl
+gwczsDhkgNforqP8S/rckPHOHTJgY8N6WcnSgvYwqfJUm21gbdNH4WG5nWL
6lz1Dphu+GBU1g/gahv4BNzAN8YlWQOuA5/3f/EM8ITqLThNv5TmOtr6CTzu
tAS6v+nuNHALuAZcAS4Ap8i+xz2JdoFN4CvwEXhD9fr7ZpMHJUmSJEmSJEmS
JEmSJEmSJEml/QGym5SaY0sX5gAAAABJRU5ErkJggg==
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 796, :content_type image/png, :filename laptop.png, :id #uuid "1464e46c-e726-54a9-a42b-f937a0342d22", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:01+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.015, :System:Directory /tmp/tmp.qSpfBizLgM, :System:FileSize 796 bytes, :PNG:ImageHeight 128, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 120x128, :PNG:ColorType RGB with Alpha, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 120, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:01+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/laptop.png, :System:FileAccessDate 2018:11:14 17:31:01+00:00, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName laptop.png, :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-12T11:31:25.509Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "2ea39047-e663-50d5-9080-838b75883704"]
>debug 4
>debug 5 {:id #uuid "f6885671-3bf3-56f2-8e92-b5112d0f703f", :name Musikinstrumente}
>debug 5a id #uuid "f6885671-3bf3-56f2-8e92-b5112d0f703f"
2023-12-12T11:31:25.510Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "f6885671-3bf3-56f2-8e92-b5112d0f703f"]
>debug 5b {:main_category_id #uuid "f6885671-3bf3-56f2-8e92-b5112d0f703f", :content iVBORw0KGgoAAAANSUhEUgAAAI4AAACACAYAAADd91F4AAAACXBIWXMAAAsT
AAALEwEAmpwYAAA59GlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFj
a2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQi
Pz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0
az0iQWRvYmUgWE1QIENvcmUgNS42LWMxMTEgNzkuMTU4MzI1LCAyMDE1LzA5
LzEwLTAxOjEwOjIwICAgICAgICAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9
Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMi
PgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAg
ICAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8i
CiAgICAgICAgICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxl
bWVudHMvMS4xLyIKICAgICAgICAgICAgeG1sbnM6cGhvdG9zaG9wPSJodHRw
Oi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIgogICAgICAgICAgICB4
bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIK
ICAgICAgICAgICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20v
eGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgICAgICAgICAgeG1s
bnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAg
ICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8x
LjAvIj4KICAgICAgICAgPHhtcDpDcmVhdG9yVG9vbD5BZG9iZSBQaG90b3No
b3AgQ0MgMjAxNSAoTWFjaW50b3NoKTwveG1wOkNyZWF0b3JUb29sPgogICAg
ICAgICA8eG1wOkNyZWF0ZURhdGU+MjAxNi0wNy0xNFQxNTo0NjoxMSswMjow
MDwveG1wOkNyZWF0ZURhdGU+CiAgICAgICAgIDx4bXA6TW9kaWZ5RGF0ZT4y
MDE2LTA3LTE0VDE1OjQ5OjI4KzAyOjAwPC94bXA6TW9kaWZ5RGF0ZT4KICAg
ICAgICAgPHhtcDpNZXRhZGF0YURhdGU+MjAxNi0wNy0xNFQxNTo0OToyOCsw
MjowMDwveG1wOk1ldGFkYXRhRGF0ZT4KICAgICAgICAgPGRjOmZvcm1hdD5p
bWFnZS9wbmc8L2RjOmZvcm1hdD4KICAgICAgICAgPHBob3Rvc2hvcDpDb2xv
ck1vZGU+MzwvcGhvdG9zaG9wOkNvbG9yTW9kZT4KICAgICAgICAgPHhtcE1N
Okluc3RhbmNlSUQ+eG1wLmlpZDo2YzA4N2NiZS0xZjhlLTQ4YmUtYTU1YS00
ZmRmYzVkOTI2OWE8L3htcE1NOkluc3RhbmNlSUQ+CiAgICAgICAgIDx4bXBN
TTpEb2N1bWVudElEPmFkb2JlOmRvY2lkOnBob3Rvc2hvcDoyZTNiY2U2NC04
YTU4LTExNzktOGVmNS04OTFkYzJiZDEwY2Y8L3htcE1NOkRvY3VtZW50SUQ+
CiAgICAgICAgIDx4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ+eG1wLmRpZDo1
MzMwNmRlYi01NjAzLTQyZTEtOTBiMy04Nzc0MmQ2ODdhMDc8L3htcE1NOk9y
aWdpbmFsRG9jdW1lbnRJRD4KICAgICAgICAgPHhtcE1NOkhpc3Rvcnk+CiAg
ICAgICAgICAgIDxyZGY6U2VxPgogICAgICAgICAgICAgICA8cmRmOmxpIHJk
ZjpwYXJzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgICAgICAgPHN0
RXZ0OmFjdGlvbj5jcmVhdGVkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAg
ICAgICAgIDxzdEV2dDppbnN0YW5jZUlEPnhtcC5paWQ6NTMzMDZkZWItNTYw
My00MmUxLTkwYjMtODc3NDJkNjg3YTA3PC9zdEV2dDppbnN0YW5jZUlEPgog
ICAgICAgICAgICAgICAgICA8c3RFdnQ6d2hlbj4yMDE2LTA3LTE0VDE1OjQ2
OjExKzAyOjAwPC9zdEV2dDp3aGVuPgogICAgICAgICAgICAgICAgICA8c3RF
dnQ6c29mdHdhcmVBZ2VudD5BZG9iZSBQaG90b3Nob3AgQ0MgMjAxNSAoTWFj
aW50b3NoKTwvc3RFdnQ6c29mdHdhcmVBZ2VudD4KICAgICAgICAgICAgICAg
PC9yZGY6bGk+CiAgICAgICAgICAgICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlw
ZT0iUmVzb3VyY2UiPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6YWN0aW9u
PnNhdmVkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAgICAgICAgIDxzdEV2
dDppbnN0YW5jZUlEPnhtcC5paWQ6NmMwODdjYmUtMWY4ZS00OGJlLWE1NWEt
NGZkZmM1ZDkyNjlhPC9zdEV2dDppbnN0YW5jZUlEPgogICAgICAgICAgICAg
ICAgICA8c3RFdnQ6d2hlbj4yMDE2LTA3LTE0VDE1OjQ5OjI4KzAyOjAwPC9z
dEV2dDp3aGVuPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6c29mdHdhcmVB
Z2VudD5BZG9iZSBQaG90b3Nob3AgQ0MgMjAxNSAoTWFjaW50b3NoKTwvc3RF
dnQ6c29mdHdhcmVBZ2VudD4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OmNo
YW5nZWQ+Lzwvc3RFdnQ6Y2hhbmdlZD4KICAgICAgICAgICAgICAgPC9yZGY6
bGk+CiAgICAgICAgICAgIDwvcmRmOlNlcT4KICAgICAgICAgPC94bXBNTTpI
aXN0b3J5PgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9y
aWVudGF0aW9uPgogICAgICAgICA8dGlmZjpYUmVzb2x1dGlvbj43MjAwMDAv
MTAwMDA8L3RpZmY6WFJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOllSZXNv
bHV0aW9uPjcyMDAwMC8xMDAwMDwvdGlmZjpZUmVzb2x1dGlvbj4KICAgICAg
ICAgPHRpZmY6UmVzb2x1dGlvblVuaXQ+MjwvdGlmZjpSZXNvbHV0aW9uVW5p
dD4KICAgICAgICAgPGV4aWY6Q29sb3JTcGFjZT42NTUzNTwvZXhpZjpDb2xv
clNwYWNlPgogICAgICAgICA8ZXhpZjpQaXhlbFhEaW1lbnNpb24+MTQyPC9l
eGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGlt
ZW5zaW9uPjEyODwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgIDwvcmRm
OkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAo8P3hwYWNrZXQgZW5kPSJ3
Ij8+x0kGyQAAACBjSFJNAAB6JQAAgIMAAPn/AACA6AAAUggAARVYAAA6lwAA
F2/XWh+QAAAERklEQVR42uzdy4tOcRzH8ffIfUoYK7nGnlIuJZRSYutW4h+Q
+4KVUoSlUiSXWSgSFsrGJSJ2bpH7NSk7uYWZ8Vich9Bg5jyX8z3nvL/1qWma
xfk9vZrzPef5nt+hUqlgTG/jh2CEY4RjhGOEY4xwjHCMcIxwjHCMEY6JBMdq
SPUBpgHbgdtAJ9BR/Xkz0PrjD4VjDQQWAPuA10DlH7kHjBNOeasNWAGcAD78
B0t3eAYLpzw1AVgPXAK6eonlz2wSTjn6lbs1QvkzN4VT3n6llnwRTrn7ldQR
jv2KcOxXhCOc5vUrwrFfEU6Z4GTerwjHfkU4BYMTul8Rjv2KcHIKJ5f9inCy
Ow1tBO4UGYpw6lsjSYacKmWLcNLXAOB6GdEIp7ZaV1Y0wqmtbghHOGnqq3CE
k6YqwhGOcIQjHOEIRzjCEY5whCMc4QhHOMIRjnCEIxzhlAbOV+EIp6d5CxwB
FgNDhCOcf+UFsBuYC/TrzfqEUz4414EtwGSgJe36hFN8OB3AWWAVMKZe6xNO
MeG8A44Cy4ChjVifcIoD5xWwB5gH9G/0+oSTbzi3gK3AlP/0K8IpOZxO4AKw
Bhif5fqEEx/Oe+A4sBwYHmV9wokJ5zWwF5hP8qRouPUJJw6cO8A2YCrJViih
1yec7OB0kWxOsB6YSLwSTiA4H4GTwEpgBLFLOBnDeQPsBxYCg8hPCScjODuA
GUH6FeHkCE7eSzjCEY5whCMc4QhHOMIRjnCEIxzhCEc4whGOcIQjHOEIRzjC
EY5whCMc4QhHOMIpM5xWYA7Ju7PagavAS+DTL8f0mWQi8TZwGtgFLKX7Z8qF
U2A4Y4ENJEPvtb5b4gGwE5gknGLC6U+ymcBFGvdc1zXhFAdOC8nTnC/APQCF
07MaAZwBN48UTu/6mMcE21ZFOLHhtAGPCLh5k3BiwzlJ0F2/hBMXziwCbxcn
nLhw2oUjnDT1TDjCSVNdwhFOmuoMDKdDOJ6q0uSxcOLCORwYzgHhxIUzMzCc
6WWC09R5lTrhPBEQzTGAosPJbF6ljl85PAyE5gHVvZaLCCfEvEodT4ljguC5
D4z++e+2QHBCzavUuZ9qq546s1rLKWDYb+fpgsAJN6/SoEGupcDTJq7hCbCI
bl4wUgQ4IedVGng11w9YApxv0HF/I3kx2hKg718vKXMOJ+y8SpNuCYwG1gLn
gC81HOvnKpbVwKge3YvIOZyw8yoZ3FcaBMyuXkUeAq4Az0nePvOtmvfV310G
DpK8DmAWKTbuzjOc0PMqFLzyDKddOMJJA+eZcISTBk6XcISTBk7oeRXheKpK
Na8inLhwQs+rCCcunNDzKsKJfQMw7LyKcOJ/5RByXkU48b/kDDmvIpx8jFWE
m1cRTr4GucLMqwgnf6OjIeZVhJPvYfXM5lWEU5zHY5o6ryKcoHBMueKHYIRj
hGOEY4RjjHCMcIxwjHCMcIwRjqlDvg8A5/TdLBe62ugAAAAASUVORK5CYII=
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 16064, :content_type image/png, :filename music3213.png, :id #uuid "3a52eb87-b5fe-5df0-98b1-43e80f28d2dc", :metadata {:XMP-tiff:ResolutionUnit inches, :PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :XMP-exif:ExifImageHeight 128, :XMP-xmpMM:HistoryInstanceID [xmp.iid:53306deb-5603-42e1-90b3-87742d687a07 xmp.iid:6c087cbe-1f8e-48be-a55a-4fdfc5d9269a], :XMP-xmpMM:DocumentID adobe:docid:photoshop:2e3bce64-8a58-1179-8ef5-891dc2bd10cf, :XMP-xmpMM:InstanceID xmp.iid:6c087cbe-1f8e-48be-a55a-4fdfc5d9269a, :PNG:GreenX 0.21, :ExifTool:ExifToolVersion 10.4, :XMP-exif:ColorSpace Uncalibrated, :XMP-xmp:CreateDate 2016:07:14 15:46:11+02:00, :Composite:Megapixels 0.018, :XMP-tiff:Orientation Horizontal (normal), :PNG:WhitePointY 0.32899, :XMP-x:XMPToolkit Adobe XMP Core 5.6-c111 79.158325, 2015/09/10-01:10:20        , :System:Directory /tmp/tmp.qSpfBizLgM, :XMP-tiff:XResolution 72, :XMP-photoshop:ColorMode RGB, :XMP-exif:ExifImageWidth 142, :XMP-xmpMM:HistoryAction [created saved], :System:FileSize 16 kB, :PNG:ImageHeight 128, :XMP-xmpMM:HistoryWhen [2016:07:14 15:46:11+02:00 2016:07:14 15:49:28+02:00], :File:FileTypeExtension png, :XMP-xmp:MetadataDate 2016:07:14 15:49:28+02:00, :XMP-xmp:CreatorTool Adobe Photoshop CC 2015 (Macintosh), :File:FileType PNG, :PNG:BitDepth 8, :XMP-xmpMM:HistorySoftwareAgent [Adobe Photoshop CC 2015 (Macintosh) Adobe Photoshop CC 2015 (Macintosh)], :Composite:ImageSize 142x128, :XMP-xmp:ModifyDate 2016:07:14 15:49:28+02:00, :PNG:ColorType RGB with Alpha, :PNG:WhitePointX 0.31269, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 142, :File:MIMEType image/png, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :PNG:BlueY 0.05999, :XMP-xmpMM:HistoryChanged /, :SourceFile /tmp/tmp.qSpfBizLgM/music3213.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG:RedX 0.63999, :PNG:GreenY 0.71, :PNG:BlueX 0.14999, :PNG:RedY 0.33, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName music3213.png, :XMP-tiff:YResolution 72, :PNG-pHYs:PixelUnits meters, :XMP-xmpMM:OriginalDocumentID xmp.did:53306deb-5603-42e1-90b3-87742d687a07, :PNG:Filter Adaptive, :XMP-dc:Format image/png}}
2023-12-12T11:31:25.540Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "f6885671-3bf3-56f2-8e92-b5112d0f703f"]
>debug 4
>debug 5 {:id #uuid "6c8a0d77-6711-5156-a59a-12425ba01cff", :name Werkstatt-Technik}
>debug 5a id #uuid "6c8a0d77-6711-5156-a59a-12425ba01cff"
2023-12-12T11:31:25.541Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "6c8a0d77-6711-5156-a59a-12425ba01cff"]
>debug 5b {:main_category_id #uuid "6c8a0d77-6711-5156-a59a-12425ba01cff", :content iVBORw0KGgoAAAANSUhEUgAAAGYAAACACAYAAAD5whz9AAAABHNCSVQICAgI
fAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAABrVJREFUeJztnVmMVEUUhr9p
GpdhlBmGYZ8BFByJGwGNoMYlPiku8UFNiMTlQU2MRk1QYkz0QY1riNEYE8WM
4oY8EaOGoAYVFRRE2TeHYRjAiAuiYByQ8eFQ0vTC9F2qqqvnfMn/AN1dt6r+
O/d2nzp1LiiKoiiKoiiKoiiKoiiKoiiKoig2qfHdgQqiP3AuMBU4GxgPjAIa
gROBDHAA+B3YAWwB1gLLga8O/7+SElngauAdYC/QE1OHgGXAQ8BYpyOoMuqA
B4DtxDfjWPoQuNjZaKqAfsAdwM/YMSRf7wOjnYwsYFqBr3FjSK5+A8Y5GF+Q
zAD24d4Uo1n2hxgWGeA5/BliNM32QEOiP/A2fg3ZA9xpe6AhkQXew58hh4CX
gSbbAw2JGmAO/kz5HJhofZQBMgs/hnQCN6DRlKJcjlxGXBryN/AoUGt/eGHS
gMSwXJryLtDiYnAh4/K+shINuZTFebgxZDdwOxLaUcpgEXYNOQDMRi6XSpnY
/mtZCExwNpoq4nXsGLIFWavRr78xOAnYjx1jrnI4jgIyPg+eAtOQZd+qI3Rj
rvTdAVuEbswlvjtgi5CNaaKKf3WHbMyZvjtgk5CNqeo0oZCNGeG7AzYJ2Zh6
3x2wScjGHOe7AzbJ+u6A8j+DkMSNJuDZkI3p9t2BlKgF7gMeREJMAJNCNib0
7PoaJEfgGaA577UpIRuzy3cHEjAReAG4qMTr+x32JXUuxe46zI/A9aQb9m8A
XqL3hJEVKR7TOU3YNcboS2BKwr5mgFspf5fBnITH804HbszpQTJi4kQbzgKW
RDzWLTGOU1HYWr0spX+Qm3U5P24HAE8BB2McJ/ioxo24NcboF+BuJHG9GNcA
22K2vSzZlFQGdfjd97IRuJYjXxBagAUJ27w/venxSxv+jDFajKTJJj1JuoEh
Kc6NU+ry/j0Z/8akpTeST48fJgCbOBK6MCzE/6Qm1SHgjMQz5IHTgZ+QQdyb
99pk3Gf5p603E8+QB1qREIwZxA4K05Zewd+kJtVfSBWOoGgFdlI4mJl576sH
uoq8LwTdk3SSXHMaxU3pQUqMDM97/2XAvyXeX6laRGALluPpfSPS/CKfm9nL
ZypJnQT29Xgc5V+Wpud9toYw7jd7kDhaMJxKtOI7e5H7UC5ZYF6ENlzrT+CC
hPPklKimGK2nMLCYBd6K0ZZt/Qqcn3CenHIKcs2NO+BPgePz2swATydoM21t
QL7QBMNY4kdjc7WA4mlN05HfCj5NmQcMTDJJrhlDOqYYfUDxPffjgS9SPE65
2o2cGEHtTBuDnVXIpcDQIsfLALdxdBTBlrqB55F8saAYDWzF3sR0AReWOLbJ
5UrzL9VoH/AictIFRwvQjv2z9iDwCKXTafsBVwBzkTy1uMc5AHyC1AA4OcnE
GHxc91qQhSWX2yjWAHchlZFKkQUmcXR532bkUlSLmNgN/IGEidqB1chS8BLk
t0mwNCP5Wrb/UkppAVqyqoBRyN55X6bk6iPgHLvDDYORVI4pPUg12VTuBSEz
EtiMfzOMlhLYDz0bjETW6H2bYbQMNYURSN6VbzOMvqHKtweWw3Aqy5RvUVMY
hkRRfZthtBytM8YwZG3EtxlGK1BTGAqsw78ZRt8RYAAxbYYiTx/ybYbRStQU
hlB5pjRaHXEANCEBQt9mGH2PmkITEl31bYbRD8BgqyMOgMHAKvybYbQKNYXB
yNnp2wyj1ejjQGhEruO+zTBaQ2AppjZoRL7x+DZDTclhEPKDzbcZRmtRUyrO
lHUUT03qUzQg8SbfZhitR+JxfZoGJDLr2wyjDRRuVOpz1CNrGL7NUFNyqEdW
+3ybYbQRNYWByLp4lIl7Fdk4lEHyxh4nvX2Qm6iCgjdJGYhkkESZuMdKtDUj
YjvFtBlJ5ujTDCD6k7s7OXYV2sUR28vVFgLc926DuUSfvN7qnjwco0015TAZ
ZJPmTTE+ayMhvR3Zq99loe3gaCPemb2d0oXUAD6L2F47VfzYkThsJf694IkS
bd4csR01pQhxajbmqg0p55RF9rw8SbSvy1uR3WVKHkmNSaIOAt0S54IO/Jiy
DTXlmLgukWtMqeonJqXBVNya0olUwVDK4DXcmLIdqRejlMkJwMfYNaULNSUW
tSSLb/VmyjhnI6lC6pCnP6Rpyg5kz7ySkDhrMqW0EzUlVRpInhmzk8Bqc4VC
I/Hzk3dRWA5RSZEhRN8ltgupKq5YZjjlJ5F3IfX3FUcMAGYj1YdKmTIfzZBM
jairkMOA65DyUY1IKai1SFWjjel2TVEURVEURVEURVGUxPwHYcurS2vCftQA
AAAASUVORK5CYII=
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 1811, :content_type image/png, :filename werkzeug.png, :id #uuid "f4e1f230-df2e-5e95-bf89-827f7a6b4b3b", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.013, :System:Directory /tmp/tmp.qSpfBizLgM, :System:FileSize 1811 bytes, :PNG:ImageHeight 128, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 102x128, :PNG:ColorType RGB with Alpha, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 102, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/werkzeug.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName werkzeug.png, :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-12T11:31:25.543Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "6c8a0d77-6711-5156-a59a-12425ba01cff"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.545Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.545Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.545Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete3
2023-12-12T11:31:25.547Z NX-41294 DEBUG [leihs.procurement.resources.main-category:?] - (sql-format (sql/select (vector [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] :result))) => ["SELECT NOT EXISTS (SELECT TRUE FROM procurement_requests AS pr INNER JOIN procurement_categories AS pc ON pc.id = pr.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AND NOT EXISTS (SELECT TRUE FROM procurement_templates AS pt INNER JOIN procurement_categories AS pc ON pc.id = pt.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AS result" #uuid "519f7a95-9ca7-5256-bf63-142cfc23dc62" #uuid "519f7a95-9ca7-5256-bf63-142cfc23dc62"]
2023-12-12T11:31:25.548Z NX-41294 DEBUG [leihs.procurement.resources.main-category:154] - (-> (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format spy)) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.548Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.549Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.549Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.549Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.550Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.550Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.550Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.550Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.551Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "4e48b48c-e1bf-50d7-ab2d-9aa438c638de"]
2023-12-12T11:31:25.553Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"} {:id #uuid "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc", :firstname "Stefan", :lastname "Weinmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.555Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.555Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.555Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "4e48b48c-e1bf-50d7-ab2d-9aa438c638de"]
2023-12-12T11:31:25.555Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "4e48b48c-e1bf-50d7-ab2d-9aa438c638de"]
>o> inspector? {:result false}
2023-12-12T11:31:25.559Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "4e48b48c-e1bf-50d7-ab2d-9aa438c638de"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.561Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.561Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.561Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.562Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.562Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.562Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.562Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.562Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.563Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "a1727606-c7c8-54a2-aaa1-ceff7a7d4b40"]
2023-12-12T11:31:25.563Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"} {:id #uuid "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc", :firstname "Stefan", :lastname "Weinmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.564Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.564Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.565Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "a1727606-c7c8-54a2-aaa1-ceff7a7d4b40"]
2023-12-12T11:31:25.565Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "a1727606-c7c8-54a2-aaa1-ceff7a7d4b40"]
>o> inspector? {:result false}
2023-12-12T11:31:25.566Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "a1727606-c7c8-54a2-aaa1-ceff7a7d4b40"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.567Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.567Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.567Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.568Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.568Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.569Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.569Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.569Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.569Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "00382e27-a87a-5313-b31b-a369dad6c5f8"]
2023-12-12T11:31:25.570Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"} {:id #uuid "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc", :firstname "Stefan", :lastname "Weinmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.572Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.572Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.573Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "00382e27-a87a-5313-b31b-a369dad6c5f8"]
2023-12-12T11:31:25.573Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "00382e27-a87a-5313-b31b-a369dad6c5f8"]
>o> inspector? {:result false}
2023-12-12T11:31:25.573Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "00382e27-a87a-5313-b31b-a369dad6c5f8"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.575Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.575Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.576Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.576Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.576Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.577Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.577Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.578Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.578Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "ce5424cc-ce77-5e67-8201-333ec20963eb"]
2023-12-12T11:31:25.579Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"} {:id #uuid "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc", :firstname "Stefan", :lastname "Weinmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.581Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.581Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.581Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "ce5424cc-ce77-5e67-8201-333ec20963eb"]
2023-12-12T11:31:25.581Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "ce5424cc-ce77-5e67-8201-333ec20963eb"]
>o> inspector? {:result false}
2023-12-12T11:31:25.582Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "ce5424cc-ce77-5e67-8201-333ec20963eb"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.583Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.583Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.583Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.584Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.584Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.584Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.584Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.584Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.584Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "ce0812d7-080b-5f49-8530-dd4a821c57b6"]
2023-12-12T11:31:25.585Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"} {:id #uuid "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc", :firstname "Stefan", :lastname "Weinmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.586Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.586Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.586Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "ce0812d7-080b-5f49-8530-dd4a821c57b6"]
2023-12-12T11:31:25.586Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "ce0812d7-080b-5f49-8530-dd4a821c57b6"]
>o> inspector? {:result false}
2023-12-12T11:31:25.587Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "ce0812d7-080b-5f49-8530-dd4a821c57b6"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.588Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.588Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.588Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.589Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.589Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.589Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.589Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.589Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.590Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "67e5fc60-6fe3-53bb-9495-3669b917038a"]
2023-12-12T11:31:25.590Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"} {:id #uuid "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc", :firstname "Stefan", :lastname "Weinmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.591Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.591Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.592Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "67e5fc60-6fe3-53bb-9495-3669b917038a"]
2023-12-12T11:31:25.592Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "67e5fc60-6fe3-53bb-9495-3669b917038a"]
>o> inspector? {:result false}
2023-12-12T11:31:25.593Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "67e5fc60-6fe3-53bb-9495-3669b917038a"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.593Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.593Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.594Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.594Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.594Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.594Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.595Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.595Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.595Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "f94f72e8-ff65-5bad-b1f9-81ddd8fa7c0c"]
2023-12-12T11:31:25.596Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"} {:id #uuid "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc", :firstname "Stefan", :lastname "Weinmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.597Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.597Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.597Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "f94f72e8-ff65-5bad-b1f9-81ddd8fa7c0c"]
2023-12-12T11:31:25.597Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "f94f72e8-ff65-5bad-b1f9-81ddd8fa7c0c"]
>o> inspector? {:result false}
2023-12-12T11:31:25.598Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "f94f72e8-ff65-5bad-b1f9-81ddd8fa7c0c"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.599Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.600Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.600Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.601Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.601Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.601Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.601Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.602Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.602Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "89e4a22f-7d6c-5006-b26a-3ef6f8f19630"]
2023-12-12T11:31:25.602Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"} {:id #uuid "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc", :firstname "Stefan", :lastname "Weinmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.604Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.604Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.604Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "89e4a22f-7d6c-5006-b26a-3ef6f8f19630"]
2023-12-12T11:31:25.604Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "89e4a22f-7d6c-5006-b26a-3ef6f8f19630"]
>o> inspector? {:result false}
2023-12-12T11:31:25.605Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "89e4a22f-7d6c-5006-b26a-3ef6f8f19630"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.605Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.605Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.606Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.606Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.607Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.607Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.607Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.607Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.607Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "1fb59e17-a703-5abc-8a80-fc7a9c20ee1d"]
2023-12-12T11:31:25.608Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"} {:id #uuid "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc", :firstname "Stefan", :lastname "Weinmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.609Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.609Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.609Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "1fb59e17-a703-5abc-8a80-fc7a9c20ee1d"]
2023-12-12T11:31:25.609Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "1fb59e17-a703-5abc-8a80-fc7a9c20ee1d"]
>o> inspector? {:result false}
2023-12-12T11:31:25.610Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "1fb59e17-a703-5abc-8a80-fc7a9c20ee1d"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.610Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.610Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.611Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.611Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.611Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.611Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.612Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.612Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.612Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "c17698c1-5d5d-51ea-927f-b6ca96431a50"]
2023-12-12T11:31:25.612Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"} {:id #uuid "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc", :firstname "Stefan", :lastname "Weinmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.613Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.613Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.614Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "c17698c1-5d5d-51ea-927f-b6ca96431a50"]
2023-12-12T11:31:25.614Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "c17698c1-5d5d-51ea-927f-b6ca96431a50"]
>o> inspector? {:result false}
2023-12-12T11:31:25.615Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "c17698c1-5d5d-51ea-927f-b6ca96431a50"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.616Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.616Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.616Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.617Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.617Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.617Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.617Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.617Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.618Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "fabe3b8c-58b5-5009-8873-cc3e945a7c0d"]
2023-12-12T11:31:25.618Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"} {:id #uuid "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc", :firstname "Stefan", :lastname "Weinmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.620Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.620Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.622Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "fabe3b8c-58b5-5009-8873-cc3e945a7c0d"]
2023-12-12T11:31:25.622Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "fabe3b8c-58b5-5009-8873-cc3e945a7c0d"]
>o> inspector? {:result false}
2023-12-12T11:31:25.623Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "fabe3b8c-58b5-5009-8873-cc3e945a7c0d"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.623Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.623Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.623Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.624Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.624Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.624Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.624Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.625Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.625Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "ebb12585-ce23-5cbe-8f4f-41a42d60a656"]
2023-12-12T11:31:25.625Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "c0777d74-668b-5e01-abb5-f8277baa0ea8", :firstname "Matus", :lastname "Kmit"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "8a9d832a-cf4c-5253-bcaa-385ef03565c1", :firstname "Nadja", :lastname "Weisskopf-Admin"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"} {:id #uuid "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc", :firstname "Stefan", :lastname "Weinmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.626Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.626Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.626Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "ebb12585-ce23-5cbe-8f4f-41a42d60a656"]
2023-12-12T11:31:25.626Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "ebb12585-ce23-5cbe-8f4f-41a42d60a656"]
>o> inspector? {:result false}
2023-12-12T11:31:25.627Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "ebb12585-ce23-5cbe-8f4f-41a42d60a656"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.628Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.628Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.628Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete3
2023-12-12T11:31:25.628Z NX-41294 DEBUG [leihs.procurement.resources.main-category:?] - (sql-format (sql/select (vector [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] :result))) => ["SELECT NOT EXISTS (SELECT TRUE FROM procurement_requests AS pr INNER JOIN procurement_categories AS pc ON pc.id = pr.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AND NOT EXISTS (SELECT TRUE FROM procurement_templates AS pt INNER JOIN procurement_categories AS pc ON pc.id = pt.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AS result" #uuid "1a047acd-dc98-52c2-99d3-dc6332adc1e0" #uuid "1a047acd-dc98-52c2-99d3-dc6332adc1e0"]
2023-12-12T11:31:25.629Z NX-41294 DEBUG [leihs.procurement.resources.main-category:154] - (-> (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format spy)) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.629Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.629Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.629Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.630Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.630Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.630Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.630Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.630Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.631Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "0a082661-cc1c-5b49-baab-f4db926faa7e"]
2023-12-12T11:31:25.631Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "797264c9-a2c2-5642-9c1a-d45b01f4fdc5", :firstname "Heike", :lastname "Heldt"} {:id #uuid "2c1de10b-6145-56d6-a76e-3c207cfc35a1", :firstname "Marco", :lastname "Castellano"} {:id #uuid "57bb6aaa-95fb-435f-8dd9-d0b853bf2279", :firstname "Pascale", :lastname "Gisel"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.631Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.631Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.631Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "0a082661-cc1c-5b49-baab-f4db926faa7e"]
2023-12-12T11:31:25.632Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "0a082661-cc1c-5b49-baab-f4db926faa7e"]
>o> inspector? {:result false}
2023-12-12T11:31:25.632Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "0a082661-cc1c-5b49-baab-f4db926faa7e"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.632Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.632Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.633Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.633Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.633Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.633Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.634Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.634Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.634Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "42cc2d9a-cc45-5d77-85d3-0f21270d7a35"]
2023-12-12T11:31:25.635Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "797264c9-a2c2-5642-9c1a-d45b01f4fdc5", :firstname "Heike", :lastname "Heldt"} {:id #uuid "2c1de10b-6145-56d6-a76e-3c207cfc35a1", :firstname "Marco", :lastname "Castellano"} {:id #uuid "57bb6aaa-95fb-435f-8dd9-d0b853bf2279", :firstname "Pascale", :lastname "Gisel"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.636Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.636Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.639Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "42cc2d9a-cc45-5d77-85d3-0f21270d7a35"]
2023-12-12T11:31:25.639Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "42cc2d9a-cc45-5d77-85d3-0f21270d7a35"]
>o> inspector? {:result false}
2023-12-12T11:31:25.640Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "42cc2d9a-cc45-5d77-85d3-0f21270d7a35"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.641Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.642Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.642Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.642Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.643Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.643Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.643Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.643Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.643Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "56aaec64-8d65-50b3-bd81-f788d477b927"]
2023-12-12T11:31:25.644Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "797264c9-a2c2-5642-9c1a-d45b01f4fdc5", :firstname "Heike", :lastname "Heldt"} {:id #uuid "2c1de10b-6145-56d6-a76e-3c207cfc35a1", :firstname "Marco", :lastname "Castellano"} {:id #uuid "57bb6aaa-95fb-435f-8dd9-d0b853bf2279", :firstname "Pascale", :lastname "Gisel"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.644Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.644Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.644Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "56aaec64-8d65-50b3-bd81-f788d477b927"]
2023-12-12T11:31:25.644Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "56aaec64-8d65-50b3-bd81-f788d477b927"]
>o> inspector? {:result false}
2023-12-12T11:31:25.645Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "56aaec64-8d65-50b3-bd81-f788d477b927"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.645Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.645Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.646Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.646Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.646Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.647Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.647Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.647Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.647Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "483ac871-b632-5dcd-9d37-789d65f4c424"]
2023-12-12T11:31:25.647Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "797264c9-a2c2-5642-9c1a-d45b01f4fdc5", :firstname "Heike", :lastname "Heldt"} {:id #uuid "2c1de10b-6145-56d6-a76e-3c207cfc35a1", :firstname "Marco", :lastname "Castellano"} {:id #uuid "57bb6aaa-95fb-435f-8dd9-d0b853bf2279", :firstname "Pascale", :lastname "Gisel"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.648Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.648Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.648Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "483ac871-b632-5dcd-9d37-789d65f4c424"]
2023-12-12T11:31:25.648Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "483ac871-b632-5dcd-9d37-789d65f4c424"]
>o> inspector? {:result false}
2023-12-12T11:31:25.649Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "483ac871-b632-5dcd-9d37-789d65f4c424"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.649Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.649Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.650Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.651Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.651Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.651Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.651Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.651Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.651Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "2b3749a2-6a59-5a25-9b9f-32f5e485e635"]
2023-12-12T11:31:25.652Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "797264c9-a2c2-5642-9c1a-d45b01f4fdc5", :firstname "Heike", :lastname "Heldt"} {:id #uuid "2c1de10b-6145-56d6-a76e-3c207cfc35a1", :firstname "Marco", :lastname "Castellano"} {:id #uuid "57bb6aaa-95fb-435f-8dd9-d0b853bf2279", :firstname "Pascale", :lastname "Gisel"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.652Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.652Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.652Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "2b3749a2-6a59-5a25-9b9f-32f5e485e635"]
2023-12-12T11:31:25.658Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "2b3749a2-6a59-5a25-9b9f-32f5e485e635"]
>o> inspector? {:result false}
2023-12-12T11:31:25.659Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "2b3749a2-6a59-5a25-9b9f-32f5e485e635"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.660Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.660Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.660Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.661Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.661Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.661Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.661Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.662Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.662Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "fad911e4-8c69-535c-a138-f3e2544519ba"]
2023-12-12T11:31:25.663Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "797264c9-a2c2-5642-9c1a-d45b01f4fdc5", :firstname "Heike", :lastname "Heldt"} {:id #uuid "2c1de10b-6145-56d6-a76e-3c207cfc35a1", :firstname "Marco", :lastname "Castellano"} {:id #uuid "57bb6aaa-95fb-435f-8dd9-d0b853bf2279", :firstname "Pascale", :lastname "Gisel"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.664Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.664Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.664Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "fad911e4-8c69-535c-a138-f3e2544519ba"]
2023-12-12T11:31:25.664Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "fad911e4-8c69-535c-a138-f3e2544519ba"]
>o> inspector? {:result false}
2023-12-12T11:31:25.665Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "fad911e4-8c69-535c-a138-f3e2544519ba"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.665Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.665Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.666Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.666Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.666Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.666Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.667Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.667Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.668Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "c3f14f79-931c-52c8-a847-ed77449ce9a6"]
2023-12-12T11:31:25.668Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "797264c9-a2c2-5642-9c1a-d45b01f4fdc5", :firstname "Heike", :lastname "Heldt"} {:id #uuid "2c1de10b-6145-56d6-a76e-3c207cfc35a1", :firstname "Marco", :lastname "Castellano"} {:id #uuid "57bb6aaa-95fb-435f-8dd9-d0b853bf2279", :firstname "Pascale", :lastname "Gisel"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.672Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.673Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.673Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "c3f14f79-931c-52c8-a847-ed77449ce9a6"]
2023-12-12T11:31:25.673Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "c3f14f79-931c-52c8-a847-ed77449ce9a6"]
>o> inspector? {:result false}
2023-12-12T11:31:25.674Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "c3f14f79-931c-52c8-a847-ed77449ce9a6"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.677Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.677Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.677Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete3
2023-12-12T11:31:25.678Z NX-41294 DEBUG [leihs.procurement.resources.main-category:?] - (sql-format (sql/select (vector [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] :result))) => ["SELECT NOT EXISTS (SELECT TRUE FROM procurement_requests AS pr INNER JOIN procurement_categories AS pc ON pc.id = pr.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AND NOT EXISTS (SELECT TRUE FROM procurement_templates AS pt INNER JOIN procurement_categories AS pc ON pc.id = pt.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AS result" #uuid "dda588f4-660c-573c-a2ff-944ae93ad42e" #uuid "dda588f4-660c-573c-a2ff-944ae93ad42e"]
2023-12-12T11:31:25.678Z NX-41294 DEBUG [leihs.procurement.resources.main-category:154] - (-> (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format spy)) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.679Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.679Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.679Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.679Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.680Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.680Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.680Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.680Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.680Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "b9e4f492-55e3-57e4-9467-91c81bfe2325"]
2023-12-12T11:31:25.681Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.681Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.681Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.681Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "b9e4f492-55e3-57e4-9467-91c81bfe2325"]
2023-12-12T11:31:25.682Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "b9e4f492-55e3-57e4-9467-91c81bfe2325"]
>o> inspector? {:result false}
2023-12-12T11:31:25.682Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "b9e4f492-55e3-57e4-9467-91c81bfe2325"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.683Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.683Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.683Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.685Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.685Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.685Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.685Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.685Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.686Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "a7cca5a4-e265-5f36-b794-1024c8aacc3e"]
2023-12-12T11:31:25.686Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.686Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.686Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.687Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "a7cca5a4-e265-5f36-b794-1024c8aacc3e"]
2023-12-12T11:31:25.689Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "a7cca5a4-e265-5f36-b794-1024c8aacc3e"]
>o> inspector? {:result false}
2023-12-12T11:31:25.689Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "a7cca5a4-e265-5f36-b794-1024c8aacc3e"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.691Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.691Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.691Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.692Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.692Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.693Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.693Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.693Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.693Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "79822b89-0edb-588c-b9e5-65b7722ac50b"]
2023-12-12T11:31:25.694Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.694Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.694Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.694Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "79822b89-0edb-588c-b9e5-65b7722ac50b"]
2023-12-12T11:31:25.695Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "79822b89-0edb-588c-b9e5-65b7722ac50b"]
>o> inspector? {:result false}
2023-12-12T11:31:25.695Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "79822b89-0edb-588c-b9e5-65b7722ac50b"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.696Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.696Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.696Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.697Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.697Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.697Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.697Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.697Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.697Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "ab911807-6431-5ca7-890a-3573737bb4d3"]
2023-12-12T11:31:25.698Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "2c1de10b-6145-56d6-a76e-3c207cfc35a1", :firstname "Marco", :lastname "Castellano"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.698Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.698Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.698Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "ab911807-6431-5ca7-890a-3573737bb4d3"]
2023-12-12T11:31:25.698Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "ab911807-6431-5ca7-890a-3573737bb4d3"]
>o> inspector? {:result false}
2023-12-12T11:31:25.699Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "ab911807-6431-5ca7-890a-3573737bb4d3"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.700Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.700Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.700Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.701Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.701Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.701Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.701Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.701Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.702Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "64c6f8ad-a1b7-530b-946a-ebb1644ac897"]
2023-12-12T11:31:25.702Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.703Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.703Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.703Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "64c6f8ad-a1b7-530b-946a-ebb1644ac897"]
2023-12-12T11:31:25.703Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "64c6f8ad-a1b7-530b-946a-ebb1644ac897"]
>o> inspector? {:result false}
2023-12-12T11:31:25.704Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "64c6f8ad-a1b7-530b-946a-ebb1644ac897"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.704Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.705Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.705Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.706Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.706Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.706Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.706Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.706Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.707Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "f2bb3f23-bb5b-5855-b03f-0166bd19fc0c"]
2023-12-12T11:31:25.707Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.707Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.707Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.709Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "f2bb3f23-bb5b-5855-b03f-0166bd19fc0c"]
2023-12-12T11:31:25.709Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "f2bb3f23-bb5b-5855-b03f-0166bd19fc0c"]
>o> inspector? {:result false}
2023-12-12T11:31:25.710Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "f2bb3f23-bb5b-5855-b03f-0166bd19fc0c"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.710Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.710Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.710Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete3
2023-12-12T11:31:25.711Z NX-41294 DEBUG [leihs.procurement.resources.main-category:?] - (sql-format (sql/select (vector [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] :result))) => ["SELECT NOT EXISTS (SELECT TRUE FROM procurement_requests AS pr INNER JOIN procurement_categories AS pc ON pc.id = pr.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AND NOT EXISTS (SELECT TRUE FROM procurement_templates AS pt INNER JOIN procurement_categories AS pc ON pc.id = pt.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AS result" #uuid "2b07eb8a-4174-5257-83eb-920d536cc44a" #uuid "2b07eb8a-4174-5257-83eb-920d536cc44a"]
2023-12-12T11:31:25.711Z NX-41294 DEBUG [leihs.procurement.resources.main-category:154] - (-> (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format spy)) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.712Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.712Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.712Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.712Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.712Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.713Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.713Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.713Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.713Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "5d8639a3-4569-5009-af28-f63f2af5209d"]
2023-12-12T11:31:25.713Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "2c1de10b-6145-56d6-a76e-3c207cfc35a1", :firstname "Marco", :lastname "Castellano"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.714Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.714Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.714Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "5d8639a3-4569-5009-af28-f63f2af5209d"]
2023-12-12T11:31:25.714Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "5d8639a3-4569-5009-af28-f63f2af5209d"]
>o> inspector? {:result false}
2023-12-12T11:31:25.714Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "5d8639a3-4569-5009-af28-f63f2af5209d"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.715Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.715Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.715Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.715Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.715Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.716Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.716Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.716Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.716Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "b34f1cbb-4ac7-59a0-81f2-3ca7ecc94e71"]
2023-12-12T11:31:25.716Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "2c1de10b-6145-56d6-a76e-3c207cfc35a1", :firstname "Marco", :lastname "Castellano"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.717Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.717Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.717Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "b34f1cbb-4ac7-59a0-81f2-3ca7ecc94e71"]
2023-12-12T11:31:25.717Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "b34f1cbb-4ac7-59a0-81f2-3ca7ecc94e71"]
>o> inspector? {:result false}
2023-12-12T11:31:25.717Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "b34f1cbb-4ac7-59a0-81f2-3ca7ecc94e71"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.718Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.718Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.718Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.718Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.719Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.719Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.719Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.719Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.719Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "73e97867-43ea-5bee-b46b-d7c74fbf873b"]
2023-12-12T11:31:25.719Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "2c1de10b-6145-56d6-a76e-3c207cfc35a1", :firstname "Marco", :lastname "Castellano"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.720Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.720Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.720Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "73e97867-43ea-5bee-b46b-d7c74fbf873b"]
2023-12-12T11:31:25.720Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "73e97867-43ea-5bee-b46b-d7c74fbf873b"]
>o> inspector? {:result false}
2023-12-12T11:31:25.721Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "73e97867-43ea-5bee-b46b-d7c74fbf873b"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.721Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.721Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.722Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.722Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.722Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.723Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.723Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.724Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.724Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "b6601a86-b5d3-5682-88b6-cff956b00d7b"]
2023-12-12T11:31:25.724Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "2c1de10b-6145-56d6-a76e-3c207cfc35a1", :firstname "Marco", :lastname "Castellano"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.724Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.725Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.725Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "b6601a86-b5d3-5682-88b6-cff956b00d7b"]
2023-12-12T11:31:25.725Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "b6601a86-b5d3-5682-88b6-cff956b00d7b"]
>o> inspector? {:result false}
2023-12-12T11:31:25.725Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "b6601a86-b5d3-5682-88b6-cff956b00d7b"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.726Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.726Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.726Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete3
2023-12-12T11:31:25.726Z NX-41294 DEBUG [leihs.procurement.resources.main-category:?] - (sql-format (sql/select (vector [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] :result))) => ["SELECT NOT EXISTS (SELECT TRUE FROM procurement_requests AS pr INNER JOIN procurement_categories AS pc ON pc.id = pr.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AND NOT EXISTS (SELECT TRUE FROM procurement_templates AS pt INNER JOIN procurement_categories AS pc ON pc.id = pt.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AS result" #uuid "f6827594-33a6-5760-ac41-f94ceefacfab" #uuid "f6827594-33a6-5760-ac41-f94ceefacfab"]
2023-12-12T11:31:25.728Z NX-41294 DEBUG [leihs.procurement.resources.main-category:154] - (-> (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format spy)) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.728Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.728Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.728Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.729Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.729Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.729Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.729Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.729Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.729Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "455bc6dc-afbd-579d-a621-6d75e0fca9ea"]
2023-12-12T11:31:25.730Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "428a72a9-36df-52fa-880f-64db35843013", :firstname "Dominik", :lastname "Fedier"} {:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "8448b7b2-f5d9-4590-8355-2295b50bba40", :firstname "Sergej", :lastname "Tratar Baamonde"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.730Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.730Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.730Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "455bc6dc-afbd-579d-a621-6d75e0fca9ea"]
2023-12-12T11:31:25.730Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "455bc6dc-afbd-579d-a621-6d75e0fca9ea"]
>o> inspector? {:result false}
2023-12-12T11:31:25.731Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "455bc6dc-afbd-579d-a621-6d75e0fca9ea"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.732Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.732Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.732Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.733Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.733Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.734Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.734Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.735Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.735Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "747b6b21-9fad-4a01-acd9-cd8983aed286"]
2023-12-12T11:31:25.736Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "428a72a9-36df-52fa-880f-64db35843013", :firstname "Dominik", :lastname "Fedier"} {:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.736Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.736Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.736Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "747b6b21-9fad-4a01-acd9-cd8983aed286"]
2023-12-12T11:31:25.736Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "747b6b21-9fad-4a01-acd9-cd8983aed286"]
>o> inspector? {:result false}
2023-12-12T11:31:25.737Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "747b6b21-9fad-4a01-acd9-cd8983aed286"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.737Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.737Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.738Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.738Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.738Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.738Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.738Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.739Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.739Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "07a6af37-e127-5f4b-94ec-698a5698d98c"]
2023-12-12T11:31:25.739Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "428a72a9-36df-52fa-880f-64db35843013", :firstname "Dominik", :lastname "Fedier"} {:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "8448b7b2-f5d9-4590-8355-2295b50bba40", :firstname "Sergej", :lastname "Tratar Baamonde"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.739Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.740Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.740Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "07a6af37-e127-5f4b-94ec-698a5698d98c"]
2023-12-12T11:31:25.740Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "07a6af37-e127-5f4b-94ec-698a5698d98c"]
>o> inspector? {:result false}
2023-12-12T11:31:25.741Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "07a6af37-e127-5f4b-94ec-698a5698d98c"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.741Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.741Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.742Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete3
2023-12-12T11:31:25.742Z NX-41294 DEBUG [leihs.procurement.resources.main-category:?] - (sql-format (sql/select (vector [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] :result))) => ["SELECT NOT EXISTS (SELECT TRUE FROM procurement_requests AS pr INNER JOIN procurement_categories AS pc ON pc.id = pr.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AND NOT EXISTS (SELECT TRUE FROM procurement_templates AS pt INNER JOIN procurement_categories AS pc ON pc.id = pt.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AS result" #uuid "517b82ae-2b7e-4822-9aeb-0d4753dec821" #uuid "517b82ae-2b7e-4822-9aeb-0d4753dec821"]
2023-12-12T11:31:25.743Z NX-41294 DEBUG [leihs.procurement.resources.main-category:154] - (-> (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format spy)) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.743Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.743Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.743Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.744Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.744Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.744Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.744Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.744Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.744Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "671ab85c-b8c1-4659-9c6e-9ebe2f122a59"]
2023-12-12T11:31:25.745Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "b610f5bd-6da8-5122-94f0-c0bbf1b7ed73", :firstname "Daniel", :lastname "Fischer"} {:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.745Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.745Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.745Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "671ab85c-b8c1-4659-9c6e-9ebe2f122a59"]
2023-12-12T11:31:25.746Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "671ab85c-b8c1-4659-9c6e-9ebe2f122a59"]
>o> inspector? {:result false}
2023-12-12T11:31:25.747Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "671ab85c-b8c1-4659-9c6e-9ebe2f122a59"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.747Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.747Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.748Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete3
2023-12-12T11:31:25.748Z NX-41294 DEBUG [leihs.procurement.resources.main-category:?] - (sql-format (sql/select (vector [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] :result))) => ["SELECT NOT EXISTS (SELECT TRUE FROM procurement_requests AS pr INNER JOIN procurement_categories AS pc ON pc.id = pr.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AND NOT EXISTS (SELECT TRUE FROM procurement_templates AS pt INNER JOIN procurement_categories AS pc ON pc.id = pt.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AS result" #uuid "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da" #uuid "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da"]
2023-12-12T11:31:25.750Z NX-41294 DEBUG [leihs.procurement.resources.main-category:154] - (-> (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format spy)) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.750Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.750Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.751Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.751Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.752Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.752Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.752Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.753Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.753Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "e1b4cad8-0416-5cf7-9e4a-dde208d0abad"]
2023-12-12T11:31:25.753Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.754Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.754Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.755Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "e1b4cad8-0416-5cf7-9e4a-dde208d0abad"]
2023-12-12T11:31:25.756Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "e1b4cad8-0416-5cf7-9e4a-dde208d0abad"]
>o> inspector? {:result false}
2023-12-12T11:31:25.756Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "e1b4cad8-0416-5cf7-9e4a-dde208d0abad"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.757Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.757Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.757Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.758Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.758Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.758Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.758Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.758Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.758Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "011ff3f3-09fa-59e1-9713-52466786adf8"]
2023-12-12T11:31:25.759Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.760Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.760Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.760Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "011ff3f3-09fa-59e1-9713-52466786adf8"]
2023-12-12T11:31:25.761Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "011ff3f3-09fa-59e1-9713-52466786adf8"]
>o> inspector? {:result false}
2023-12-12T11:31:25.761Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "011ff3f3-09fa-59e1-9713-52466786adf8"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.761Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.761Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.761Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.762Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.762Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.764Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.764Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.764Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.764Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "54b87eb0-061c-5a97-96ad-e9b6da605184"]
2023-12-12T11:31:25.764Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.765Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.765Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.765Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "54b87eb0-061c-5a97-96ad-e9b6da605184"]
2023-12-12T11:31:25.765Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "54b87eb0-061c-5a97-96ad-e9b6da605184"]
>o> inspector? {:result false}
2023-12-12T11:31:25.765Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "54b87eb0-061c-5a97-96ad-e9b6da605184"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.768Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.768Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.768Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.770Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.770Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.770Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.770Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.771Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.771Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "5858ec5d-5f01-50fb-bc96-4b4766bd7799"]
2023-12-12T11:31:25.774Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.775Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.775Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.775Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "5858ec5d-5f01-50fb-bc96-4b4766bd7799"]
2023-12-12T11:31:25.775Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "5858ec5d-5f01-50fb-bc96-4b4766bd7799"]
>o> inspector? {:result false}
2023-12-12T11:31:25.776Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "5858ec5d-5f01-50fb-bc96-4b4766bd7799"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.776Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.776Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.777Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.777Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.777Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.777Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.777Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.777Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.777Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "ba5b41a7-4317-5160-9b82-b0931a48aec0"]
2023-12-12T11:31:25.778Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.778Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.778Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.778Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "ba5b41a7-4317-5160-9b82-b0931a48aec0"]
2023-12-12T11:31:25.778Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "ba5b41a7-4317-5160-9b82-b0931a48aec0"]
>o> inspector? {:result false}
2023-12-12T11:31:25.779Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "ba5b41a7-4317-5160-9b82-b0931a48aec0"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.780Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.780Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.781Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.781Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.781Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.782Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.782Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.782Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.782Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "9df68a66-4523-5072-aa31-1df9abeaa1c7"]
2023-12-12T11:31:25.783Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.784Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.784Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.785Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "9df68a66-4523-5072-aa31-1df9abeaa1c7"]
2023-12-12T11:31:25.785Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "9df68a66-4523-5072-aa31-1df9abeaa1c7"]
>o> inspector? {:result false}
2023-12-12T11:31:25.785Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "9df68a66-4523-5072-aa31-1df9abeaa1c7"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.786Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.786Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.787Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete3
2023-12-12T11:31:25.787Z NX-41294 DEBUG [leihs.procurement.resources.main-category:?] - (sql-format (sql/select (vector [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] :result))) => ["SELECT NOT EXISTS (SELECT TRUE FROM procurement_requests AS pr INNER JOIN procurement_categories AS pc ON pc.id = pr.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AND NOT EXISTS (SELECT TRUE FROM procurement_templates AS pt INNER JOIN procurement_categories AS pc ON pc.id = pt.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AS result" #uuid "2ea39047-e663-50d5-9080-838b75883704" #uuid "2ea39047-e663-50d5-9080-838b75883704"]
2023-12-12T11:31:25.788Z NX-41294 DEBUG [leihs.procurement.resources.main-category:154] - (-> (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format spy)) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.788Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.788Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.789Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.789Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.789Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.789Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.789Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.790Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.790Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "f2531d7e-d9ff-5c3e-9e88-6d3a16a89aa1"]
2023-12-12T11:31:25.790Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "e9656e43-9f35-502d-b495-eec36093208e", :firstname "Christian", :lastname "Wildhaber"} {:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "28552e7e-f8be-5019-bdad-846babd8c642", :firstname "Hugo", :lastname "Vögtle"} {:id #uuid "301988e6-5e0e-43a9-bcb6-3d0022b7ca99", :firstname "Lars", :lastname "Gnädinger"} {:id #uuid "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d", :firstname "Lenny Ron", :lastname "Frei"} {:id #uuid "b5d09795-0b94-423d-a645-bae0aed895ce", :firstname "Lukas", :lastname "Brupbacher"} {:id #uuid "b41e6486-ec39-4855-8d8a-c03aa83af233", :firstname "Matthias", :lastname "Daniels"} {:id #uuid "8a9d832a-cf4c-5253-bcaa-385ef03565c1", :firstname "Nadja", :lastname "Weisskopf-Admin"} {:id #uuid "4884241c-8104-5c10-a393-0e21dcd1a46e", :firstname "Patrice", :lastname "Huber"} {:id #uuid "52c2d39d-7f53-592f-8142-824afbaf59d3", :firstname "Tilo", :lastname "Seiring"} {:id #uuid "96c5a731-ae34-5ede-917c-90a42dc66a1e", :firstname "Ugo", :lastname "De Vito"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.791Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.792Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.793Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "f2531d7e-d9ff-5c3e-9e88-6d3a16a89aa1"]
2023-12-12T11:31:25.793Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "f2531d7e-d9ff-5c3e-9e88-6d3a16a89aa1"]
>o> inspector? {:result false}
2023-12-12T11:31:25.794Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "f2531d7e-d9ff-5c3e-9e88-6d3a16a89aa1"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.795Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.795Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.795Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.795Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.795Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.797Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.797Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.797Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.798Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "1af3a7f2-b16a-4203-b6ac-f2c7be612d74"]
2023-12-12T11:31:25.798Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "e9656e43-9f35-502d-b495-eec36093208e", :firstname "Christian", :lastname "Wildhaber"} {:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "28552e7e-f8be-5019-bdad-846babd8c642", :firstname "Hugo", :lastname "Vögtle"} {:id #uuid "301988e6-5e0e-43a9-bcb6-3d0022b7ca99", :firstname "Lars", :lastname "Gnädinger"} {:id #uuid "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d", :firstname "Lenny Ron", :lastname "Frei"} {:id #uuid "b5d09795-0b94-423d-a645-bae0aed895ce", :firstname "Lukas", :lastname "Brupbacher"} {:id #uuid "b41e6486-ec39-4855-8d8a-c03aa83af233", :firstname "Matthias", :lastname "Daniels"} {:id #uuid "4884241c-8104-5c10-a393-0e21dcd1a46e", :firstname "Patrice", :lastname "Huber"} {:id #uuid "52c2d39d-7f53-592f-8142-824afbaf59d3", :firstname "Tilo", :lastname "Seiring"} {:id #uuid "96c5a731-ae34-5ede-917c-90a42dc66a1e", :firstname "Ugo", :lastname "De Vito"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.799Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.799Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.799Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "1af3a7f2-b16a-4203-b6ac-f2c7be612d74"]
2023-12-12T11:31:25.799Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "1af3a7f2-b16a-4203-b6ac-f2c7be612d74"]
>o> inspector? {:result false}
2023-12-12T11:31:25.800Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "1af3a7f2-b16a-4203-b6ac-f2c7be612d74"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.803Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.803Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.804Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.804Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.804Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.805Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.805Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.807Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.807Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "ccab158d-79c7-5c28-a8a2-47cb4925f101"]
2023-12-12T11:31:25.808Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "e9656e43-9f35-502d-b495-eec36093208e", :firstname "Christian", :lastname "Wildhaber"} {:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "28552e7e-f8be-5019-bdad-846babd8c642", :firstname "Hugo", :lastname "Vögtle"} {:id #uuid "301988e6-5e0e-43a9-bcb6-3d0022b7ca99", :firstname "Lars", :lastname "Gnädinger"} {:id #uuid "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d", :firstname "Lenny Ron", :lastname "Frei"} {:id #uuid "b41e6486-ec39-4855-8d8a-c03aa83af233", :firstname "Matthias", :lastname "Daniels"} {:id #uuid "4884241c-8104-5c10-a393-0e21dcd1a46e", :firstname "Patrice", :lastname "Huber"} {:id #uuid "52c2d39d-7f53-592f-8142-824afbaf59d3", :firstname "Tilo", :lastname "Seiring"} {:id #uuid "96c5a731-ae34-5ede-917c-90a42dc66a1e", :firstname "Ugo", :lastname "De Vito"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.808Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.808Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.809Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "ccab158d-79c7-5c28-a8a2-47cb4925f101"]
2023-12-12T11:31:25.809Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "ccab158d-79c7-5c28-a8a2-47cb4925f101"]
>o> inspector? {:result false}
2023-12-12T11:31:25.809Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "ccab158d-79c7-5c28-a8a2-47cb4925f101"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.810Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.810Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.810Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.812Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.812Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.812Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.812Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.812Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.812Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "eb1e7bef-80c6-4958-b16e-35555735ce61"]
2023-12-12T11:31:25.813Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "3651eeeb-0fb1-4840-80dd-6c739bda6c57", :firstname "Christian", :lastname "Schneider"} {:id #uuid "301988e6-5e0e-43a9-bcb6-3d0022b7ca99", :firstname "Lars", :lastname "Gnädinger"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.813Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.813Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.813Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "eb1e7bef-80c6-4958-b16e-35555735ce61"]
2023-12-12T11:31:25.813Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "eb1e7bef-80c6-4958-b16e-35555735ce61"]
>o> inspector? {:result false}
2023-12-12T11:31:25.814Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "eb1e7bef-80c6-4958-b16e-35555735ce61"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.814Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.814Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.814Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.815Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.815Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.815Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.815Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.815Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.815Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "4ecc9e97-2d12-5173-bd8c-781482c842e8"]
2023-12-12T11:31:25.816Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "e9656e43-9f35-502d-b495-eec36093208e", :firstname "Christian", :lastname "Wildhaber"} {:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "28552e7e-f8be-5019-bdad-846babd8c642", :firstname "Hugo", :lastname "Vögtle"} {:id #uuid "301988e6-5e0e-43a9-bcb6-3d0022b7ca99", :firstname "Lars", :lastname "Gnädinger"} {:id #uuid "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d", :firstname "Lenny Ron", :lastname "Frei"} {:id #uuid "b41e6486-ec39-4855-8d8a-c03aa83af233", :firstname "Matthias", :lastname "Daniels"} {:id #uuid "4884241c-8104-5c10-a393-0e21dcd1a46e", :firstname "Patrice", :lastname "Huber"} {:id #uuid "52c2d39d-7f53-592f-8142-824afbaf59d3", :firstname "Tilo", :lastname "Seiring"} {:id #uuid "96c5a731-ae34-5ede-917c-90a42dc66a1e", :firstname "Ugo", :lastname "De Vito"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.817Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.817Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.818Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "4ecc9e97-2d12-5173-bd8c-781482c842e8"]
2023-12-12T11:31:25.818Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "4ecc9e97-2d12-5173-bd8c-781482c842e8"]
>o> inspector? {:result false}
2023-12-12T11:31:25.818Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "4ecc9e97-2d12-5173-bd8c-781482c842e8"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.819Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.819Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.819Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.820Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.820Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.821Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.821Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.822Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.822Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "80226a51-c17a-5fd8-93db-40aef5b03491"]
2023-12-12T11:31:25.823Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "e9656e43-9f35-502d-b495-eec36093208e", :firstname "Christian", :lastname "Wildhaber"} {:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "28552e7e-f8be-5019-bdad-846babd8c642", :firstname "Hugo", :lastname "Vögtle"} {:id #uuid "301988e6-5e0e-43a9-bcb6-3d0022b7ca99", :firstname "Lars", :lastname "Gnädinger"} {:id #uuid "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d", :firstname "Lenny Ron", :lastname "Frei"} {:id #uuid "b41e6486-ec39-4855-8d8a-c03aa83af233", :firstname "Matthias", :lastname "Daniels"} {:id #uuid "4884241c-8104-5c10-a393-0e21dcd1a46e", :firstname "Patrice", :lastname "Huber"} {:id #uuid "52c2d39d-7f53-592f-8142-824afbaf59d3", :firstname "Tilo", :lastname "Seiring"} {:id #uuid "96c5a731-ae34-5ede-917c-90a42dc66a1e", :firstname "Ugo", :lastname "De Vito"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.823Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.823Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.824Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "80226a51-c17a-5fd8-93db-40aef5b03491"]
2023-12-12T11:31:25.824Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "80226a51-c17a-5fd8-93db-40aef5b03491"]
>o> inspector? {:result false}
2023-12-12T11:31:25.824Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "80226a51-c17a-5fd8-93db-40aef5b03491"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.825Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.825Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.825Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.825Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.825Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.826Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.826Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.826Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.826Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "fe602c35-1097-52d0-acd0-40579d295f00"]
2023-12-12T11:31:25.826Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "e9656e43-9f35-502d-b495-eec36093208e", :firstname "Christian", :lastname "Wildhaber"} {:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "28552e7e-f8be-5019-bdad-846babd8c642", :firstname "Hugo", :lastname "Vögtle"} {:id #uuid "301988e6-5e0e-43a9-bcb6-3d0022b7ca99", :firstname "Lars", :lastname "Gnädinger"} {:id #uuid "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d", :firstname "Lenny Ron", :lastname "Frei"} {:id #uuid "b41e6486-ec39-4855-8d8a-c03aa83af233", :firstname "Matthias", :lastname "Daniels"} {:id #uuid "4884241c-8104-5c10-a393-0e21dcd1a46e", :firstname "Patrice", :lastname "Huber"} {:id #uuid "52c2d39d-7f53-592f-8142-824afbaf59d3", :firstname "Tilo", :lastname "Seiring"} {:id #uuid "96c5a731-ae34-5ede-917c-90a42dc66a1e", :firstname "Ugo", :lastname "De Vito"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.828Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.828Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.829Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "fe602c35-1097-52d0-acd0-40579d295f00"]
2023-12-12T11:31:25.829Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "fe602c35-1097-52d0-acd0-40579d295f00"]
>o> inspector? {:result false}
2023-12-12T11:31:25.829Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "fe602c35-1097-52d0-acd0-40579d295f00"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.829Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.832Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.833Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.836Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.836Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.837Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.837Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.837Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.837Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "56065d53-cd2f-5a39-9b66-532fd83ad2e6"]
2023-12-12T11:31:25.837Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "e9656e43-9f35-502d-b495-eec36093208e", :firstname "Christian", :lastname "Wildhaber"} {:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "28552e7e-f8be-5019-bdad-846babd8c642", :firstname "Hugo", :lastname "Vögtle"} {:id #uuid "301988e6-5e0e-43a9-bcb6-3d0022b7ca99", :firstname "Lars", :lastname "Gnädinger"} {:id #uuid "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d", :firstname "Lenny Ron", :lastname "Frei"} {:id #uuid "b41e6486-ec39-4855-8d8a-c03aa83af233", :firstname "Matthias", :lastname "Daniels"} {:id #uuid "4884241c-8104-5c10-a393-0e21dcd1a46e", :firstname "Patrice", :lastname "Huber"} {:id #uuid "52c2d39d-7f53-592f-8142-824afbaf59d3", :firstname "Tilo", :lastname "Seiring"} {:id #uuid "96c5a731-ae34-5ede-917c-90a42dc66a1e", :firstname "Ugo", :lastname "De Vito"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.838Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.838Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.839Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "56065d53-cd2f-5a39-9b66-532fd83ad2e6"]
2023-12-12T11:31:25.839Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "56065d53-cd2f-5a39-9b66-532fd83ad2e6"]
>o> inspector? {:result false}
2023-12-12T11:31:25.839Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "56065d53-cd2f-5a39-9b66-532fd83ad2e6"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.840Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.840Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.840Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.840Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.840Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.840Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.840Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.841Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.841Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "fc7bc38c-62f3-5576-802f-c874e06ee776"]
2023-12-12T11:31:25.841Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "e9656e43-9f35-502d-b495-eec36093208e", :firstname "Christian", :lastname "Wildhaber"} {:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "28552e7e-f8be-5019-bdad-846babd8c642", :firstname "Hugo", :lastname "Vögtle"} {:id #uuid "301988e6-5e0e-43a9-bcb6-3d0022b7ca99", :firstname "Lars", :lastname "Gnädinger"} {:id #uuid "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d", :firstname "Lenny Ron", :lastname "Frei"} {:id #uuid "b41e6486-ec39-4855-8d8a-c03aa83af233", :firstname "Matthias", :lastname "Daniels"} {:id #uuid "8a9d832a-cf4c-5253-bcaa-385ef03565c1", :firstname "Nadja", :lastname "Weisskopf-Admin"} {:id #uuid "4884241c-8104-5c10-a393-0e21dcd1a46e", :firstname "Patrice", :lastname "Huber"} {:id #uuid "52c2d39d-7f53-592f-8142-824afbaf59d3", :firstname "Tilo", :lastname "Seiring"} {:id #uuid "96c5a731-ae34-5ede-917c-90a42dc66a1e", :firstname "Ugo", :lastname "De Vito"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.842Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.842Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.842Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "fc7bc38c-62f3-5576-802f-c874e06ee776"]
2023-12-12T11:31:25.842Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "fc7bc38c-62f3-5576-802f-c874e06ee776"]
>o> inspector? {:result false}
2023-12-12T11:31:25.843Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "fc7bc38c-62f3-5576-802f-c874e06ee776"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.844Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.844Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.844Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.845Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.845Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.845Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.845Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.846Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.846Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "76fdca98-4a2a-5640-bc98-f33059d6ffa0"]
2023-12-12T11:31:25.846Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "e9656e43-9f35-502d-b495-eec36093208e", :firstname "Christian", :lastname "Wildhaber"} {:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "28552e7e-f8be-5019-bdad-846babd8c642", :firstname "Hugo", :lastname "Vögtle"} {:id #uuid "301988e6-5e0e-43a9-bcb6-3d0022b7ca99", :firstname "Lars", :lastname "Gnädinger"} {:id #uuid "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d", :firstname "Lenny Ron", :lastname "Frei"} {:id #uuid "b41e6486-ec39-4855-8d8a-c03aa83af233", :firstname "Matthias", :lastname "Daniels"} {:id #uuid "4884241c-8104-5c10-a393-0e21dcd1a46e", :firstname "Patrice", :lastname "Huber"} {:id #uuid "52c2d39d-7f53-592f-8142-824afbaf59d3", :firstname "Tilo", :lastname "Seiring"} {:id #uuid "96c5a731-ae34-5ede-917c-90a42dc66a1e", :firstname "Ugo", :lastname "De Vito"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.846Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.847Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.847Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "76fdca98-4a2a-5640-bc98-f33059d6ffa0"]
2023-12-12T11:31:25.847Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "76fdca98-4a2a-5640-bc98-f33059d6ffa0"]
>o> inspector? {:result false}
2023-12-12T11:31:25.847Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "76fdca98-4a2a-5640-bc98-f33059d6ffa0"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.849Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.849Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.849Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.850Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.850Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.850Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.850Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.850Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.851Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "77857566-03d9-58f4-8b0d-290227434aff"]
2023-12-12T11:31:25.851Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "e9656e43-9f35-502d-b495-eec36093208e", :firstname "Christian", :lastname "Wildhaber"} {:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "28552e7e-f8be-5019-bdad-846babd8c642", :firstname "Hugo", :lastname "Vögtle"} {:id #uuid "301988e6-5e0e-43a9-bcb6-3d0022b7ca99", :firstname "Lars", :lastname "Gnädinger"} {:id #uuid "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d", :firstname "Lenny Ron", :lastname "Frei"} {:id #uuid "b41e6486-ec39-4855-8d8a-c03aa83af233", :firstname "Matthias", :lastname "Daniels"} {:id #uuid "4884241c-8104-5c10-a393-0e21dcd1a46e", :firstname "Patrice", :lastname "Huber"} {:id #uuid "52c2d39d-7f53-592f-8142-824afbaf59d3", :firstname "Tilo", :lastname "Seiring"} {:id #uuid "96c5a731-ae34-5ede-917c-90a42dc66a1e", :firstname "Ugo", :lastname "De Vito"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.853Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.853Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.853Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "77857566-03d9-58f4-8b0d-290227434aff"]
2023-12-12T11:31:25.853Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "77857566-03d9-58f4-8b0d-290227434aff"]
>o> inspector? {:result false}
2023-12-12T11:31:25.854Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "77857566-03d9-58f4-8b0d-290227434aff"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.855Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.855Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.856Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.856Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.856Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.859Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.859Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.859Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.859Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "5059c4fc-d34c-5c9a-9efe-257c7ec6fb6b"]
2023-12-12T11:31:25.860Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "e9656e43-9f35-502d-b495-eec36093208e", :firstname "Christian", :lastname "Wildhaber"} {:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "28552e7e-f8be-5019-bdad-846babd8c642", :firstname "Hugo", :lastname "Vögtle"} {:id #uuid "301988e6-5e0e-43a9-bcb6-3d0022b7ca99", :firstname "Lars", :lastname "Gnädinger"} {:id #uuid "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d", :firstname "Lenny Ron", :lastname "Frei"} {:id #uuid "b41e6486-ec39-4855-8d8a-c03aa83af233", :firstname "Matthias", :lastname "Daniels"} {:id #uuid "4884241c-8104-5c10-a393-0e21dcd1a46e", :firstname "Patrice", :lastname "Huber"} {:id #uuid "52c2d39d-7f53-592f-8142-824afbaf59d3", :firstname "Tilo", :lastname "Seiring"} {:id #uuid "96c5a731-ae34-5ede-917c-90a42dc66a1e", :firstname "Ugo", :lastname "De Vito"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.860Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.861Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.861Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "5059c4fc-d34c-5c9a-9efe-257c7ec6fb6b"]
2023-12-12T11:31:25.861Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "5059c4fc-d34c-5c9a-9efe-257c7ec6fb6b"]
>o> inspector? {:result false}
2023-12-12T11:31:25.861Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "5059c4fc-d34c-5c9a-9efe-257c7ec6fb6b"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.862Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.862Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.863Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete3
2023-12-12T11:31:25.864Z NX-41294 DEBUG [leihs.procurement.resources.main-category:?] - (sql-format (sql/select (vector [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] :result))) => ["SELECT NOT EXISTS (SELECT TRUE FROM procurement_requests AS pr INNER JOIN procurement_categories AS pc ON pc.id = pr.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AND NOT EXISTS (SELECT TRUE FROM procurement_templates AS pt INNER JOIN procurement_categories AS pc ON pc.id = pt.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AS result" #uuid "f6885671-3bf3-56f2-8e92-b5112d0f703f" #uuid "f6885671-3bf3-56f2-8e92-b5112d0f703f"]
2023-12-12T11:31:25.864Z NX-41294 DEBUG [leihs.procurement.resources.main-category:154] - (-> (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format spy)) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.865Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.865Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.865Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.865Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.865Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.866Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.866Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.867Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.867Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "af3372a1-63a8-52dc-850e-c2ae91c1c078"]
2023-12-12T11:31:25.867Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "6eeeeb75-e3d8-56c9-b7b6-0c45b7795cb9", :firstname "Martin", :lastname "Weyermann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.867Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.867Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.868Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "af3372a1-63a8-52dc-850e-c2ae91c1c078"]
2023-12-12T11:31:25.868Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "af3372a1-63a8-52dc-850e-c2ae91c1c078"]
>o> inspector? {:result false}
2023-12-12T11:31:25.868Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "af3372a1-63a8-52dc-850e-c2ae91c1c078"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.870Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.870Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.870Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.871Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.871Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.871Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.871Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.871Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.871Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "17a52112-1986-5074-b1d9-0faff29a785b"]
2023-12-12T11:31:25.872Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "6eeeeb75-e3d8-56c9-b7b6-0c45b7795cb9", :firstname "Martin", :lastname "Weyermann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.872Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.873Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.875Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "17a52112-1986-5074-b1d9-0faff29a785b"]
2023-12-12T11:31:25.875Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "17a52112-1986-5074-b1d9-0faff29a785b"]
>o> inspector? {:result false}
2023-12-12T11:31:25.876Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "17a52112-1986-5074-b1d9-0faff29a785b"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.876Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.876Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.876Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete3
2023-12-12T11:31:25.877Z NX-41294 DEBUG [leihs.procurement.resources.main-category:?] - (sql-format (sql/select (vector [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] :result))) => ["SELECT NOT EXISTS (SELECT TRUE FROM procurement_requests AS pr INNER JOIN procurement_categories AS pc ON pc.id = pr.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AND NOT EXISTS (SELECT TRUE FROM procurement_templates AS pt INNER JOIN procurement_categories AS pc ON pc.id = pt.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AS result" #uuid "6c8a0d77-6711-5156-a59a-12425ba01cff" #uuid "6c8a0d77-6711-5156-a59a-12425ba01cff"]
2023-12-12T11:31:25.877Z NX-41294 DEBUG [leihs.procurement.resources.main-category:154] - (-> (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format spy)) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.878Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.878Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.878Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.878Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.878Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.878Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.878Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.879Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.879Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "6870a16c-9a71-5e60-b94a-f0b784398fec"]
2023-12-12T11:31:25.879Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "ad765b67-18f7-55a8-88b6-11a82cd0d0b4", :firstname "Adrian", :lastname "Brazerol"} {:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.879Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.882Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.883Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "6870a16c-9a71-5e60-b94a-f0b784398fec"]
2023-12-12T11:31:25.883Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "6870a16c-9a71-5e60-b94a-f0b784398fec"]
>o> inspector? {:result false}
2023-12-12T11:31:25.883Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "6870a16c-9a71-5e60-b94a-f0b784398fec"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.884Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.884Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.885Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.889Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.889Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.890Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.890Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.890Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.890Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "771fddcf-b19a-5e6b-8b6f-7266b6922c4f"]
2023-12-12T11:31:25.891Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "ad765b67-18f7-55a8-88b6-11a82cd0d0b4", :firstname "Adrian", :lastname "Brazerol"} {:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.891Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.891Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.892Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "771fddcf-b19a-5e6b-8b6f-7266b6922c4f"]
2023-12-12T11:31:25.892Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "771fddcf-b19a-5e6b-8b6f-7266b6922c4f"]
>o> inspector? {:result false}
2023-12-12T11:31:25.892Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "771fddcf-b19a-5e6b-8b6f-7266b6922c4f"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.893Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.893Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.893Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.893Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.893Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.894Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.894Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.894Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.894Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "c7ece4a6-2b5c-409f-96ea-e4fd6e8f9792"]
2023-12-12T11:31:25.894Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "ad765b67-18f7-55a8-88b6-11a82cd0d0b4", :firstname "Adrian", :lastname "Brazerol"} {:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.895Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.895Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.895Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "c7ece4a6-2b5c-409f-96ea-e4fd6e8f9792"]
2023-12-12T11:31:25.895Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "c7ece4a6-2b5c-409f-96ea-e4fd6e8f9792"]
>o> inspector? {:result false}
2023-12-12T11:31:25.896Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "c7ece4a6-2b5c-409f-96ea-e4fd6e8f9792"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.896Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.896Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.896Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:31:25.897Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:31:25.897Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.897Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.897Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.897Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:31:25.898Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "3eaad5d5-516a-5610-8caf-342cfdcaac62"]
2023-12-12T11:31:25.898Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "ad765b67-18f7-55a8-88b6-11a82cd0d0b4", :firstname "Adrian", :lastname "Brazerol"} {:id #uuid "cbcbc88f-e7b4-58fd-8dc2-e83be0d06475", :firstname "Claudia", :lastname "Bachmann"} {:id #uuid "da18869a-e4bd-4493-a4c9-2e6fe78c94e7", :firstname "Etienne", :lastname "Schudel"} {:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "6ecace30-0931-59f4-9032-cd412530256c", :firstname "Judith", :lastname "Richi"} {:id #uuid "de3d3911-8b37-4bfe-aa59-25ee8dac5b07", :firstname "Julio", :lastname "Barrantes Zunzunegui"} {:id #uuid "b1e54635-ec2a-444f-8edd-7186075b0760", :firstname "Nomce", :lastname "Tanaskoski"} {:id #uuid "8448b7b2-f5d9-4590-8355-2295b50bba40", :firstname "Sergej", :lastname "Tratar Baamonde"} {:id #uuid "48e259df-9b53-5e56-a03e-65ce562f231a", :firstname "Silvan", :lastname "Becchio"} {:id #uuid "d0853239-fe13-4540-9c16-4ec1656461d3", :firstname "Silvia", :lastname "Eichenberger"} {:id #uuid "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc", :firstname "Stefan", :lastname "Weinmann"} {:id #uuid "baa628c5-c7fc-4cce-bea7-d8093f78adca", :firstname "Zelda", :lastname "Keller"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:31:25.899Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:25.899Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:25.899Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "3eaad5d5-516a-5610-8caf-342cfdcaac62"]
2023-12-12T11:31:25.899Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "3eaad5d5-516a-5610-8caf-342cfdcaac62"]
>o> inspector? {:result false}
2023-12-12T11:31:25.900Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "3eaad5d5-516a-5610-8caf-342cfdcaac62"]

>request-grapql _> request {:leihs-user-language {:name Deutsch, :locale de-CH, :default true, :active true}, :authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 219b97e6-bb13-401e-92a7-2304bf206106}, leihs-user-session {:value d429c048-7118-407f-a7a9-b33da6f15b06}}, :remote-addr 127.0.0.1, :start-time 47991922096583, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type application/json, cookie leihs-anti-csrf-token=219b97e6-bb13-401e-92a7-2304bf206106; leihs-user-session=d429c048-7118-407f-a7a9-b33da6f15b06, content-length 595, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/admin/categories/dda588f4660c573ca2ff944ae93ad42e, connection keep-alive, pragma no-cache, x-csrf-token 219b97e6-bb13-401e-92a7-2304bf206106, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x4f7e6e09 /127.0.0.1:3230<->/127.0.0.1:53029], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x65dc1b71 HikariDataSource (db-pool)]}, :content-length 595, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:operationName MainCategories, :variables {}, :query query MainCategories {
  main_categories {
    ...MainCatProps
    __typename
  }
}

fragment MainCatProps on MainCategory {
  id
  name
  can_delete
  image_url
  categories {
    id
    name
    can_delete
    cost_center
    general_ledger_account
    procurement_account
    inspectors {
      ...UserProps
      __typename
    }
    viewers {
      ...UserProps
      __typename
    }
    __typename
  }
  __typename
}

fragment UserProps on User {
  id
  firstname
  lastname
  __typename
}
}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0xbde374d leihs.procurement.graphql$handler@bde374d], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>request-c-grapql _> request (json) {"leihs-user-language":{"name":"Deutsch","locale":"de-CH","default":true,"active":true},"authenticated-entity":{"email":"manuel.radl@zhdk.ch","contracts_count":1,"lastname":"Radl","org_id":"271682","scope_read":true,"is_admin":true,"authentication-method":"session","login":"mradl","scope_system_admin_write":true,"scope_write":true,"firstname":"Manuel","scope_admin_write":true,"user_session_created_at":"2023-12-12T11:17:19.570671Z","id":"a786135f-c159-4618-9dd3-0012ebb3d500","user_session_id":"463ca0ef-36e9-430c-b982-23371c7fc689","scope_system_admin_read":true,"access-rights":[{"role":"customer","inventory_pool_id":"3977012c-ce0e-501f-889b-8715fdb5d83b"},{"role":"customer","inventory_pool_id":"5863967f-9804-4909-a9b7-92254616d6b2"},{"role":"customer","inventory_pool_id":"5dd25b58-fa56-5095-bd97-2696d92c2fb1"},{"role":"customer","inventory_pool_id":"77e88ec8-9ff6-5435-818e-dc902fc631a6"},{"role":"inventory_manager","inventory_pool_id":"8bd16d45-056d-5590-bc7f-12849f034351"},{"role":"inventory_manager","inventory_pool_id":"a02b8163-9a16-5066-b48e-9eb74cf8b791"},{"role":"inventory_manager","inventory_pool_id":"b534b07c-d9bf-4572-840c-0a630b8cd8ed"},{"role":"customer","inventory_pool_id":"fc5a841e-36c6-5dc3-8207-1306c1fb89bf"},{"role":"customer","inventory_pool_id":"ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}],"user_id":"a786135f-c159-4618-9dd3-0012ebb3d500","is_system_admin":true,"external_sign_out_url":null,"language_locale":"de-CH","inventory_pool_roles_count":9,"scope_admin_read":true},"cookies":{"leihs-anti-csrf-token":{"value":"219b97e6-bb13-401e-92a7-2304bf206106"},"leihs-user-session":{"value":"d429c048-7118-407f-a7a9-b33da6f15b06"}},"remote-addr":"127.0.0.1","start-time":47991922096583,"params":{},"settings":{"email_sending_enabled":false,"sessions_max_lifetime_secs":432000,"smtp_default_from_address":"noreply@zhdk.ch","public_image_caching_enabled":true,"sessions_force_secure":false,"deliver_received_order_notifications":false,"external_base_url":"http:\/\/localhost:3200","sessions_force_uniqueness":false,"email_signature":"Das ZHdK-Ausleihe-Team"},"query-params-raw":{},"route-params":null,"headers":{"origin":"http:\/\/localhost:3230","sec-fetch-site":"same-origin","sec-ch-ua-mobile":"?0","host":"localhost:3230","user-agent":"Mozilla\/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit\/537.36 (KHTML, like Gecko) Chrome\/119.0.0.0 Safari\/537.36","content-type":"application\/json","cookie":"leihs-anti-csrf-token=219b97e6-bb13-401e-92a7-2304bf206106; leihs-user-session=d429c048-7118-407f-a7a9-b33da6f15b06","content-length":"595","sec-ch-ua":"\"Google Chrome\";v=\"119\", \"Chromium\";v=\"119\", \"Not?A_Brand\";v=\"24\"","sec-ch-ua-platform":"\"macOS\"","referer":"http:\/\/localhost:3230\/procure\/admin\/categories\/dda588f4660c573ca2ff944ae93ad42e","connection":"keep-alive","pragma":"no-cache","x-csrf-token":"219b97e6-bb13-401e-92a7-2304bf206106","accept":"application\/json","accept-language":"de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7","sec-fetch-dest":"empty","accept-encoding":"gzip, deflate, br","sec-fetch-mode":"cors","cache-control":"no-cache"},"server-port":3230,"params-raw":{},"content-length":595,"form-params":{},"websocket?":false,"query-params":{},"content-type":"application\/json","form-params-raw":{},"character-encoding":"utf8","uri":"\/procure\/graphql","server-name":"localhost","handler-key":"graphql","query-string":null,"body":{"operationName":"MainCategories","variables":{},"query":"query MainCategories {\n  main_categories {\n    ...MainCatProps\n    __typename\n  }\n}\n\nfragment MainCatProps on MainCategory {\n  id\n  name\n  can_delete\n  image_url\n  categories {\n    id\n    name\n    can_delete\n    cost_center\n    general_ledger_account\n    procurement_account\n    inspectors {\n      ...UserProps\n      __typename\n    }\n    viewers {\n      ...UserProps\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment UserProps on User {\n  id\n  firstname\n  lastname\n  __typename\n}\n"},"multipart-params":{},"scheme":"http","request-method":"post","accept":{"mime":"json","charset":null,"encoding":null,"language":null}}

>request-grapql _> result => {:data #ordered/map ([:main_categories [#ordered/map ([:id 519f7a95-9ca7-5256-bf63-142cfc23dc62] [:name Audio- und Videotechnik] [:can_delete false] [:image_url /procure/images/ee215167-b2c3-5fcc-90c3-098ad20d16ea] [:categories [#ordered/map ([:id 4e48b48c-e1bf-50d7-ab2d-9aa438c638de] [:name Beamer] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id a1727606-c7c8-54a2-aaa1-ceff7a7d4b40] [:name Funk-Strecken] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 00382e27-a87a-5313-b31b-a369dad6c5f8] [:name Lautsprecher] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id ce5424cc-ce77-5e67-8201-333ec20963eb] [:name Lautsprecherstative] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id ce0812d7-080b-5f49-8530-dd4a821c57b6] [:name Mikrofone] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 67e5fc60-6fe3-53bb-9495-3669b917038a] [:name Mikrofonstative] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id f94f72e8-ff65-5bad-b1f9-81ddd8fa7c0c] [:name Monitore / Screens] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 89e4a22f-7d6c-5006-b26a-3ef6f8f19630] [:name Schnittplatz / Mischpult / Regie] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 1fb59e17-a703-5abc-8a80-fc7a9c20ee1d] [:name Video/Film-Kameras] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id c17698c1-5d5d-51ea-927f-b6ca96431a50] [:name Video/Film-Stative] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id fabe3b8c-58b5-5009-8873-cc3e945a7c0d] [:name Video/Filmobjektive] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id ebb12585-ce23-5cbe-8f4f-41a42d60a656] [:name Zuteilung unbekannt - Audio- und Videotechnik] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id c0777d74-668b-5e01-abb5-f8277baa0ea8] [:firstname Matus] [:lastname Kmit] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 8a9d832a-cf4c-5253-bcaa-385ef03565c1] [:firstname Nadja] [:lastname Weisskopf-Admin] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id 1a047acd-dc98-52c2-99d3-dc6332adc1e0] [:name Bauliche Anpassungen und Mobiliar] [:can_delete false] [:image_url /procure/images/8e07c37e-d244-514d-bfa9-306158056160] [:categories [#ordered/map ([:id 0a082661-cc1c-5b49-baab-f4db926faa7e] [:name Bauprojekte] [:can_delete false] [:cost_center 11410210] [:general_ledger_account 5069097000] [:procurement_account 3119097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 797264c9-a2c2-5642-9c1a-d45b01f4fdc5] [:firstname Heike] [:lastname Heldt] [:__typename :User]) #ordered/map ([:id 2c1de10b-6145-56d6-a76e-3c207cfc35a1] [:firstname Marco] [:lastname Castellano] [:__typename :User]) #ordered/map ([:id 57bb6aaa-95fb-435f-8dd9-d0b853bf2279] [:firstname Pascale] [:lastname Gisel] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 42cc2d9a-cc45-5d77-85d3-0f21270d7a35] [:name Einrichtungsprojekte] [:can_delete false] [:cost_center 11410220] [:general_ledger_account 5069097000] [:procurement_account 3110097001] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 797264c9-a2c2-5642-9c1a-d45b01f4fdc5] [:firstname Heike] [:lastname Heldt] [:__typename :User]) #ordered/map ([:id 2c1de10b-6145-56d6-a76e-3c207cfc35a1] [:firstname Marco] [:lastname Castellano] [:__typename :User]) #ordered/map ([:id 57bb6aaa-95fb-435f-8dd9-d0b853bf2279] [:firstname Pascale] [:lastname Gisel] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 56aaec64-8d65-50b3-bd81-f788d477b927] [:name Mobiliarergänzungen] [:can_delete false] [:cost_center 11410220] [:general_ledger_account 5069097000] [:procurement_account 3110097001] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 797264c9-a2c2-5642-9c1a-d45b01f4fdc5] [:firstname Heike] [:lastname Heldt] [:__typename :User]) #ordered/map ([:id 2c1de10b-6145-56d6-a76e-3c207cfc35a1] [:firstname Marco] [:lastname Castellano] [:__typename :User]) #ordered/map ([:id 57bb6aaa-95fb-435f-8dd9-d0b853bf2279] [:firstname Pascale] [:lastname Gisel] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 483ac871-b632-5dcd-9d37-789d65f4c424] [:name Schliessanlagen und Türen] [:can_delete false] [:cost_center 11410210] [:general_ledger_account 5069097000] [:procurement_account 3119097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 797264c9-a2c2-5642-9c1a-d45b01f4fdc5] [:firstname Heike] [:lastname Heldt] [:__typename :User]) #ordered/map ([:id 2c1de10b-6145-56d6-a76e-3c207cfc35a1] [:firstname Marco] [:lastname Castellano] [:__typename :User]) #ordered/map ([:id 57bb6aaa-95fb-435f-8dd9-d0b853bf2279] [:firstname Pascale] [:lastname Gisel] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 2b3749a2-6a59-5a25-9b9f-32f5e485e635] [:name Signaletik] [:can_delete false] [:cost_center 11410210] [:general_ledger_account 5069097000] [:procurement_account 3119097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 797264c9-a2c2-5642-9c1a-d45b01f4fdc5] [:firstname Heike] [:lastname Heldt] [:__typename :User]) #ordered/map ([:id 2c1de10b-6145-56d6-a76e-3c207cfc35a1] [:firstname Marco] [:lastname Castellano] [:__typename :User]) #ordered/map ([:id 57bb6aaa-95fb-435f-8dd9-d0b853bf2279] [:firstname Pascale] [:lastname Gisel] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id fad911e4-8c69-535c-a138-f3e2544519ba] [:name Vorhänge] [:can_delete false] [:cost_center 11410210] [:general_ledger_account 5069097000] [:procurement_account 3119097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 797264c9-a2c2-5642-9c1a-d45b01f4fdc5] [:firstname Heike] [:lastname Heldt] [:__typename :User]) #ordered/map ([:id 2c1de10b-6145-56d6-a76e-3c207cfc35a1] [:firstname Marco] [:lastname Castellano] [:__typename :User]) #ordered/map ([:id 57bb6aaa-95fb-435f-8dd9-d0b853bf2279] [:firstname Pascale] [:lastname Gisel] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id c3f14f79-931c-52c8-a847-ed77449ce9a6] [:name Zuteilung unbekannt - Bauliche Anpassungen und Mobiliar] [:can_delete false] [:cost_center 11410220] [:general_ledger_account 5069097000] [:procurement_account 3119097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 797264c9-a2c2-5642-9c1a-d45b01f4fdc5] [:firstname Heike] [:lastname Heldt] [:__typename :User]) #ordered/map ([:id 2c1de10b-6145-56d6-a76e-3c207cfc35a1] [:firstname Marco] [:lastname Castellano] [:__typename :User]) #ordered/map ([:id 57bb6aaa-95fb-435f-8dd9-d0b853bf2279] [:firstname Pascale] [:lastname Gisel] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id dda588f4-660c-573c-a2ff-944ae93ad42e] [:name Beleuchtungstechnik] [:can_delete false] [:image_url /procure/images/8debe2ef-4a7e-58a1-bf4c-1622dead4579] [:categories [#ordered/map ([:id b9e4f492-55e3-57e4-9467-91c81bfe2325] [:name Bühnenlicht] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User])]] [:viewers [#ordered/map ([:id 8448b7b2-f5d9-4590-8355-2295b50bba40] [:firstname Sergej] [:lastname Tratar Baamonde] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id a7cca5a4-e265-5f36-b794-1024c8aacc3e] [:name Film-Beleuchtung] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User])]] [:viewers [#ordered/map ([:id 8448b7b2-f5d9-4590-8355-2295b50bba40] [:firstname Sergej] [:lastname Tratar Baamonde] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id 79822b89-0edb-588c-b9e5-65b7722ac50b] [:name Kameralicht] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User])]] [:viewers [#ordered/map ([:id 8448b7b2-f5d9-4590-8355-2295b50bba40] [:firstname Sergej] [:lastname Tratar Baamonde] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id ab911807-6431-5ca7-890a-3573737bb4d3] [:name Mobiles Raumlicht für Ausstellungen] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 2c1de10b-6145-56d6-a76e-3c207cfc35a1] [:firstname Marco] [:lastname Castellano] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 64c6f8ad-a1b7-530b-946a-ebb1644ac897] [:name Studio-Licht] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User])]] [:viewers [#ordered/map ([:id 8448b7b2-f5d9-4590-8355-2295b50bba40] [:firstname Sergej] [:lastname Tratar Baamonde] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id f2bb3f23-bb5b-5855-b03f-0166bd19fc0c] [:name Zuteilung unbekannt - Beleuchtungstechnik] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User])]] [:viewers [#ordered/map ([:id 8448b7b2-f5d9-4590-8355-2295b50bba40] [:firstname Sergej] [:lastname Tratar Baamonde] [:__typename :User])]] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id 2b07eb8a-4174-5257-83eb-920d536cc44a] [:name Betriebseinrichtungen und Fahrzeuge] [:can_delete false] [:image_url /procure/images/3d6cbe63-c327-5c6b-b7fa-48e6c52f2cdc] [:categories [#ordered/map ([:id 5d8639a3-4569-5009-af28-f63f2af5209d] [:name Betriebseinrichtungen] [:can_delete false] [:cost_center 11410200] [:general_ledger_account 5061097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 2c1de10b-6145-56d6-a76e-3c207cfc35a1] [:firstname Marco] [:lastname Castellano] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id b34f1cbb-4ac7-59a0-81f2-3ca7ecc94e71] [:name Fahrzeuge] [:can_delete false] [:cost_center 11410200] [:general_ledger_account 5061097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 2c1de10b-6145-56d6-a76e-3c207cfc35a1] [:firstname Marco] [:lastname Castellano] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 73e97867-43ea-5bee-b46b-d7c74fbf873b] [:name Hub- und Hebegeräte] [:can_delete false] [:cost_center 11410200] [:general_ledger_account 5061097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 2c1de10b-6145-56d6-a76e-3c207cfc35a1] [:firstname Marco] [:lastname Castellano] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id b6601a86-b5d3-5682-88b6-cff956b00d7b] [:name Zuteilung unbekannt - Betriebseinrichtungen und Fahrzeuge] [:can_delete false] [:cost_center 11410200] [:general_ledger_account 5061097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 2c1de10b-6145-56d6-a76e-3c207cfc35a1] [:firstname Marco] [:lastname Castellano] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id f6827594-33a6-5760-ac41-f94ceefacfab] [:name Bühnentechnik] [:can_delete false] [:image_url /procure/images/9a8cba78-10ab-585b-a4c2-9d8e7f0818ee] [:categories [#ordered/map ([:id 455bc6dc-afbd-579d-a621-6d75e0fca9ea] [:name Bühnentechnik] [:can_delete false] [:cost_center 11410500] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id 428a72a9-36df-52fa-880f-64db35843013] [:firstname Dominik] [:lastname Fedier] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 8448b7b2-f5d9-4590-8355-2295b50bba40] [:firstname Sergej] [:lastname Tratar Baamonde] [:__typename :User])]] [:viewers [#ordered/map ([:id 8448b7b2-f5d9-4590-8355-2295b50bba40] [:firstname Sergej] [:lastname Tratar Baamonde] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id 747b6b21-9fad-4a01-acd9-cd8983aed286] [:name Fundus] [:can_delete false] [:cost_center 11410500] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id 428a72a9-36df-52fa-880f-64db35843013] [:firstname Dominik] [:lastname Fedier] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User])]] [:viewers [#ordered/map ([:id 8448b7b2-f5d9-4590-8355-2295b50bba40] [:firstname Sergej] [:lastname Tratar Baamonde] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id 07a6af37-e127-5f4b-94ec-698a5698d98c] [:name Zuteilung unbekannt - Bühnentechnik] [:can_delete false] [:cost_center 11410500] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id 428a72a9-36df-52fa-880f-64db35843013] [:firstname Dominik] [:lastname Fedier] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 8448b7b2-f5d9-4590-8355-2295b50bba40] [:firstname Sergej] [:lastname Tratar Baamonde] [:__typename :User])]] [:viewers [#ordered/map ([:id 8448b7b2-f5d9-4590-8355-2295b50bba40] [:firstname Sergej] [:lastname Tratar Baamonde] [:__typename :User])]] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id 517b82ae-2b7e-4822-9aeb-0d4753dec821] [:name Darlehen] [:can_delete false] [:image_url nil] [:categories [#ordered/map ([:id 671ab85c-b8c1-4659-9c6e-9ebe2f122a59] [:name Darlehen] [:can_delete false] [:cost_center 11410101] [:general_ledger_account 5064097000] [:procurement_account ] [:inspectors [#ordered/map ([:id b610f5bd-6da8-5122-94f0-c0bbf1b7ed73] [:firstname Daniel] [:lastname Fischer] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id ca1d97ac-0ac4-597a-8edb-f9c466b1c7da] [:name Fotografie] [:can_delete false] [:image_url /procure/images/07a33b4c-d274-54e5-a2ce-11f26d57be05] [:categories [#ordered/map ([:id e1b4cad8-0416-5cf7-9e4a-dde208d0abad] [:name Blitzanlagen] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 011ff3f3-09fa-59e1-9713-52466786adf8] [:name Fotokameras] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 54b87eb0-061c-5a97-96ad-e9b6da605184] [:name Fotostative] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 5858ec5d-5f01-50fb-bc96-4b4766bd7799] [:name Kompakt-Blitze] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id ba5b41a7-4317-5160-9b82-b0931a48aec0] [:name Objektive] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 9df68a66-4523-5072-aa31-1df9abeaa1c7] [:name Zuteilung unbekannt - Fotografie] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id 2ea39047-e663-50d5-9080-838b75883704] [:name IT & Elektronik] [:can_delete false] [:image_url /procure/images/1464e46c-e726-54a9-a42b-f937a0342d22] [:categories [#ordered/map ([:id f2531d7e-d9ff-5c3e-9e88-6d3a16a89aa1] [:name Desktop] [:can_delete false] [:cost_center 11410660] [:general_ledger_account 5064097000] [:procurement_account 3113097000] [:inspectors [#ordered/map ([:id e9656e43-9f35-502d-b495-eec36093208e] [:firstname Christian] [:lastname Wildhaber] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 28552e7e-f8be-5019-bdad-846babd8c642] [:firstname Hugo] [:lastname Vögtle] [:__typename :User]) #ordered/map ([:id 301988e6-5e0e-43a9-bcb6-3d0022b7ca99] [:firstname Lars] [:lastname Gnädinger] [:__typename :User]) #ordered/map ([:id 0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d] [:firstname Lenny Ron] [:lastname Frei] [:__typename :User]) #ordered/map ([:id b5d09795-0b94-423d-a645-bae0aed895ce] [:firstname Lukas] [:lastname Brupbacher] [:__typename :User]) #ordered/map ([:id b41e6486-ec39-4855-8d8a-c03aa83af233] [:firstname Matthias] [:lastname Daniels] [:__typename :User]) #ordered/map ([:id 8a9d832a-cf4c-5253-bcaa-385ef03565c1] [:firstname Nadja] [:lastname Weisskopf-Admin] [:__typename :User]) #ordered/map ([:id 4884241c-8104-5c10-a393-0e21dcd1a46e] [:firstname Patrice] [:lastname Huber] [:__typename :User]) #ordered/map ([:id 52c2d39d-7f53-592f-8142-824afbaf59d3] [:firstname Tilo] [:lastname Seiring] [:__typename :User]) #ordered/map ([:id 96c5a731-ae34-5ede-917c-90a42dc66a1e] [:firstname Ugo] [:lastname De Vito] [:__typename :User])]] [:viewers [#ordered/map ([:id b363936a-fd9c-567a-82a4-f0b523dbb26b] [:firstname Beat] [:lastname Rohrer] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id 1af3a7f2-b16a-4203-b6ac-f2c7be612d74] [:name IT_Projekte] [:can_delete false] [:cost_center 11410650] [:general_ledger_account 5064097000] [:procurement_account 3118097000] [:inspectors [#ordered/map ([:id e9656e43-9f35-502d-b495-eec36093208e] [:firstname Christian] [:lastname Wildhaber] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 28552e7e-f8be-5019-bdad-846babd8c642] [:firstname Hugo] [:lastname Vögtle] [:__typename :User]) #ordered/map ([:id 301988e6-5e0e-43a9-bcb6-3d0022b7ca99] [:firstname Lars] [:lastname Gnädinger] [:__typename :User]) #ordered/map ([:id 0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d] [:firstname Lenny Ron] [:lastname Frei] [:__typename :User]) #ordered/map ([:id b5d09795-0b94-423d-a645-bae0aed895ce] [:firstname Lukas] [:lastname Brupbacher] [:__typename :User]) #ordered/map ([:id b41e6486-ec39-4855-8d8a-c03aa83af233] [:firstname Matthias] [:lastname Daniels] [:__typename :User]) #ordered/map ([:id 4884241c-8104-5c10-a393-0e21dcd1a46e] [:firstname Patrice] [:lastname Huber] [:__typename :User]) #ordered/map ([:id 52c2d39d-7f53-592f-8142-824afbaf59d3] [:firstname Tilo] [:lastname Seiring] [:__typename :User]) #ordered/map ([:id 96c5a731-ae34-5ede-917c-90a42dc66a1e] [:firstname Ugo] [:lastname De Vito] [:__typename :User])]] [:viewers [#ordered/map ([:id b363936a-fd9c-567a-82a4-f0b523dbb26b] [:firstname Beat] [:lastname Rohrer] [:__typename :User]) #ordered/map ([:id b5d09795-0b94-423d-a645-bae0aed895ce] [:firstname Lukas] [:lastname Brupbacher] [:__typename :User]) #ordered/map ([:id 233a038c-66fb-4036-9149-762c10a5b72e] [:firstname Maria] [:lastname Krause] [:__typename :User]) #ordered/map ([:id d65e52a5-0404-4069-b6a0-7e8ef60dc1e1] [:firstname Maurizio] [:lastname Mattiola] [:__typename :User]) #ordered/map ([:id 119a33c1-151f-4579-8c79-0d3225d4b9b6] [:firstname Michael] [:lastname Bozenicar] [:__typename :User]) #ordered/map ([:id 45b1cf11-1f50-5d8b-aedf-5d8b83b19a52] [:firstname Monika] [:lastname Petschen] [:__typename :User]) #ordered/map ([:id 8160a951-8900-448d-8c3e-e31ec60fd3f3] [:firstname Stefan] [:lastname Uhle] [:__typename :User]) #ordered/map ([:id a4d8f8c9-8f5e-444f-b2cf-67e53f7d3d0c] [:firstname Thomas] [:lastname Bickel] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id ccab158d-79c7-5c28-a8a2-47cb4925f101] [:name IT-Basisinfrastruktur] [:can_delete false] [:cost_center 11410640] [:general_ledger_account 5064097000] [:procurement_account 3113097000] [:inspectors [#ordered/map ([:id e9656e43-9f35-502d-b495-eec36093208e] [:firstname Christian] [:lastname Wildhaber] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 28552e7e-f8be-5019-bdad-846babd8c642] [:firstname Hugo] [:lastname Vögtle] [:__typename :User]) #ordered/map ([:id 301988e6-5e0e-43a9-bcb6-3d0022b7ca99] [:firstname Lars] [:lastname Gnädinger] [:__typename :User]) #ordered/map ([:id 0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d] [:firstname Lenny Ron] [:lastname Frei] [:__typename :User]) #ordered/map ([:id b41e6486-ec39-4855-8d8a-c03aa83af233] [:firstname Matthias] [:lastname Daniels] [:__typename :User]) #ordered/map ([:id 4884241c-8104-5c10-a393-0e21dcd1a46e] [:firstname Patrice] [:lastname Huber] [:__typename :User]) #ordered/map ([:id 52c2d39d-7f53-592f-8142-824afbaf59d3] [:firstname Tilo] [:lastname Seiring] [:__typename :User]) #ordered/map ([:id 96c5a731-ae34-5ede-917c-90a42dc66a1e] [:firstname Ugo] [:lastname De Vito] [:__typename :User])]] [:viewers [#ordered/map ([:id b363936a-fd9c-567a-82a4-f0b523dbb26b] [:firstname Beat] [:lastname Rohrer] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id eb1e7bef-80c6-4958-b16e-35555735ce61] [:name IT-Security] [:can_delete false] [:cost_center 11410600] [:general_ledger_account 5064097000] [:procurement_account 3113097000] [:inspectors [#ordered/map ([:id 3651eeeb-0fb1-4840-80dd-6c739bda6c57] [:firstname Christian] [:lastname Schneider] [:__typename :User]) #ordered/map ([:id 301988e6-5e0e-43a9-bcb6-3d0022b7ca99] [:firstname Lars] [:lastname Gnädinger] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 4ecc9e97-2d12-5173-bd8c-781482c842e8] [:name Laptops] [:can_delete false] [:cost_center 11410660] [:general_ledger_account 5064097000] [:procurement_account 3113097000] [:inspectors [#ordered/map ([:id e9656e43-9f35-502d-b495-eec36093208e] [:firstname Christian] [:lastname Wildhaber] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 28552e7e-f8be-5019-bdad-846babd8c642] [:firstname Hugo] [:lastname Vögtle] [:__typename :User]) #ordered/map ([:id 301988e6-5e0e-43a9-bcb6-3d0022b7ca99] [:firstname Lars] [:lastname Gnädinger] [:__typename :User]) #ordered/map ([:id 0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d] [:firstname Lenny Ron] [:lastname Frei] [:__typename :User]) #ordered/map ([:id b41e6486-ec39-4855-8d8a-c03aa83af233] [:firstname Matthias] [:lastname Daniels] [:__typename :User]) #ordered/map ([:id 4884241c-8104-5c10-a393-0e21dcd1a46e] [:firstname Patrice] [:lastname Huber] [:__typename :User]) #ordered/map ([:id 52c2d39d-7f53-592f-8142-824afbaf59d3] [:firstname Tilo] [:lastname Seiring] [:__typename :User]) #ordered/map ([:id 96c5a731-ae34-5ede-917c-90a42dc66a1e] [:firstname Ugo] [:lastname De Vito] [:__typename :User])]] [:viewers [#ordered/map ([:id b363936a-fd9c-567a-82a4-f0b523dbb26b] [:firstname Beat] [:lastname Rohrer] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id 80226a51-c17a-5fd8-93db-40aef5b03491] [:name Monitore] [:can_delete false] [:cost_center 11410660] [:general_ledger_account 5064097000] [:procurement_account 3113097000] [:inspectors [#ordered/map ([:id e9656e43-9f35-502d-b495-eec36093208e] [:firstname Christian] [:lastname Wildhaber] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 28552e7e-f8be-5019-bdad-846babd8c642] [:firstname Hugo] [:lastname Vögtle] [:__typename :User]) #ordered/map ([:id 301988e6-5e0e-43a9-bcb6-3d0022b7ca99] [:firstname Lars] [:lastname Gnädinger] [:__typename :User]) #ordered/map ([:id 0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d] [:firstname Lenny Ron] [:lastname Frei] [:__typename :User]) #ordered/map ([:id b41e6486-ec39-4855-8d8a-c03aa83af233] [:firstname Matthias] [:lastname Daniels] [:__typename :User]) #ordered/map ([:id 4884241c-8104-5c10-a393-0e21dcd1a46e] [:firstname Patrice] [:lastname Huber] [:__typename :User]) #ordered/map ([:id 52c2d39d-7f53-592f-8142-824afbaf59d3] [:firstname Tilo] [:lastname Seiring] [:__typename :User]) #ordered/map ([:id 96c5a731-ae34-5ede-917c-90a42dc66a1e] [:firstname Ugo] [:lastname De Vito] [:__typename :User])]] [:viewers [#ordered/map ([:id b363936a-fd9c-567a-82a4-f0b523dbb26b] [:firstname Beat] [:lastname Rohrer] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id fe602c35-1097-52d0-acd0-40579d295f00] [:name Scanner] [:can_delete false] [:cost_center 11410660] [:general_ledger_account 5064097000] [:procurement_account 3113097000] [:inspectors [#ordered/map ([:id e9656e43-9f35-502d-b495-eec36093208e] [:firstname Christian] [:lastname Wildhaber] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 28552e7e-f8be-5019-bdad-846babd8c642] [:firstname Hugo] [:lastname Vögtle] [:__typename :User]) #ordered/map ([:id 301988e6-5e0e-43a9-bcb6-3d0022b7ca99] [:firstname Lars] [:lastname Gnädinger] [:__typename :User]) #ordered/map ([:id 0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d] [:firstname Lenny Ron] [:lastname Frei] [:__typename :User]) #ordered/map ([:id b41e6486-ec39-4855-8d8a-c03aa83af233] [:firstname Matthias] [:lastname Daniels] [:__typename :User]) #ordered/map ([:id 4884241c-8104-5c10-a393-0e21dcd1a46e] [:firstname Patrice] [:lastname Huber] [:__typename :User]) #ordered/map ([:id 52c2d39d-7f53-592f-8142-824afbaf59d3] [:firstname Tilo] [:lastname Seiring] [:__typename :User]) #ordered/map ([:id 96c5a731-ae34-5ede-917c-90a42dc66a1e] [:firstname Ugo] [:lastname De Vito] [:__typename :User])]] [:viewers [#ordered/map ([:id b363936a-fd9c-567a-82a4-f0b523dbb26b] [:firstname Beat] [:lastname Rohrer] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id 56065d53-cd2f-5a39-9b66-532fd83ad2e6] [:name Schnittstellengeräte] [:can_delete false] [:cost_center 11410660] [:general_ledger_account 5064097000] [:procurement_account 3113097000] [:inspectors [#ordered/map ([:id e9656e43-9f35-502d-b495-eec36093208e] [:firstname Christian] [:lastname Wildhaber] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 28552e7e-f8be-5019-bdad-846babd8c642] [:firstname Hugo] [:lastname Vögtle] [:__typename :User]) #ordered/map ([:id 301988e6-5e0e-43a9-bcb6-3d0022b7ca99] [:firstname Lars] [:lastname Gnädinger] [:__typename :User]) #ordered/map ([:id 0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d] [:firstname Lenny Ron] [:lastname Frei] [:__typename :User]) #ordered/map ([:id b41e6486-ec39-4855-8d8a-c03aa83af233] [:firstname Matthias] [:lastname Daniels] [:__typename :User]) #ordered/map ([:id 4884241c-8104-5c10-a393-0e21dcd1a46e] [:firstname Patrice] [:lastname Huber] [:__typename :User]) #ordered/map ([:id 52c2d39d-7f53-592f-8142-824afbaf59d3] [:firstname Tilo] [:lastname Seiring] [:__typename :User]) #ordered/map ([:id 96c5a731-ae34-5ede-917c-90a42dc66a1e] [:firstname Ugo] [:lastname De Vito] [:__typename :User])]] [:viewers [#ordered/map ([:id b363936a-fd9c-567a-82a4-f0b523dbb26b] [:firstname Beat] [:lastname Rohrer] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id fc7bc38c-62f3-5576-802f-c874e06ee776] [:name Software] [:can_delete false] [:cost_center 11410660] [:general_ledger_account 5064097000] [:procurement_account 3118097000] [:inspectors [#ordered/map ([:id e9656e43-9f35-502d-b495-eec36093208e] [:firstname Christian] [:lastname Wildhaber] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 28552e7e-f8be-5019-bdad-846babd8c642] [:firstname Hugo] [:lastname Vögtle] [:__typename :User]) #ordered/map ([:id 301988e6-5e0e-43a9-bcb6-3d0022b7ca99] [:firstname Lars] [:lastname Gnädinger] [:__typename :User]) #ordered/map ([:id 0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d] [:firstname Lenny Ron] [:lastname Frei] [:__typename :User]) #ordered/map ([:id b41e6486-ec39-4855-8d8a-c03aa83af233] [:firstname Matthias] [:lastname Daniels] [:__typename :User]) #ordered/map ([:id 8a9d832a-cf4c-5253-bcaa-385ef03565c1] [:firstname Nadja] [:lastname Weisskopf-Admin] [:__typename :User]) #ordered/map ([:id 4884241c-8104-5c10-a393-0e21dcd1a46e] [:firstname Patrice] [:lastname Huber] [:__typename :User]) #ordered/map ([:id 52c2d39d-7f53-592f-8142-824afbaf59d3] [:firstname Tilo] [:lastname Seiring] [:__typename :User]) #ordered/map ([:id 96c5a731-ae34-5ede-917c-90a42dc66a1e] [:firstname Ugo] [:lastname De Vito] [:__typename :User])]] [:viewers [#ordered/map ([:id b363936a-fd9c-567a-82a4-f0b523dbb26b] [:firstname Beat] [:lastname Rohrer] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id 76fdca98-4a2a-5640-bc98-f33059d6ffa0] [:name Tablets] [:can_delete false] [:cost_center 11410660] [:general_ledger_account 5064097000] [:procurement_account 3113097000] [:inspectors [#ordered/map ([:id e9656e43-9f35-502d-b495-eec36093208e] [:firstname Christian] [:lastname Wildhaber] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 28552e7e-f8be-5019-bdad-846babd8c642] [:firstname Hugo] [:lastname Vögtle] [:__typename :User]) #ordered/map ([:id 301988e6-5e0e-43a9-bcb6-3d0022b7ca99] [:firstname Lars] [:lastname Gnädinger] [:__typename :User]) #ordered/map ([:id 0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d] [:firstname Lenny Ron] [:lastname Frei] [:__typename :User]) #ordered/map ([:id b41e6486-ec39-4855-8d8a-c03aa83af233] [:firstname Matthias] [:lastname Daniels] [:__typename :User]) #ordered/map ([:id 4884241c-8104-5c10-a393-0e21dcd1a46e] [:firstname Patrice] [:lastname Huber] [:__typename :User]) #ordered/map ([:id 52c2d39d-7f53-592f-8142-824afbaf59d3] [:firstname Tilo] [:lastname Seiring] [:__typename :User]) #ordered/map ([:id 96c5a731-ae34-5ede-917c-90a42dc66a1e] [:firstname Ugo] [:lastname De Vito] [:__typename :User])]] [:viewers [#ordered/map ([:id b363936a-fd9c-567a-82a4-f0b523dbb26b] [:firstname Beat] [:lastname Rohrer] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id 77857566-03d9-58f4-8b0d-290227434aff] [:name Telefon] [:can_delete false] [:cost_center 11410660] [:general_ledger_account 5064097000] [:procurement_account 3113097000] [:inspectors [#ordered/map ([:id e9656e43-9f35-502d-b495-eec36093208e] [:firstname Christian] [:lastname Wildhaber] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 28552e7e-f8be-5019-bdad-846babd8c642] [:firstname Hugo] [:lastname Vögtle] [:__typename :User]) #ordered/map ([:id 301988e6-5e0e-43a9-bcb6-3d0022b7ca99] [:firstname Lars] [:lastname Gnädinger] [:__typename :User]) #ordered/map ([:id 0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d] [:firstname Lenny Ron] [:lastname Frei] [:__typename :User]) #ordered/map ([:id b41e6486-ec39-4855-8d8a-c03aa83af233] [:firstname Matthias] [:lastname Daniels] [:__typename :User]) #ordered/map ([:id 4884241c-8104-5c10-a393-0e21dcd1a46e] [:firstname Patrice] [:lastname Huber] [:__typename :User]) #ordered/map ([:id 52c2d39d-7f53-592f-8142-824afbaf59d3] [:firstname Tilo] [:lastname Seiring] [:__typename :User]) #ordered/map ([:id 96c5a731-ae34-5ede-917c-90a42dc66a1e] [:firstname Ugo] [:lastname De Vito] [:__typename :User])]] [:viewers [#ordered/map ([:id b363936a-fd9c-567a-82a4-f0b523dbb26b] [:firstname Beat] [:lastname Rohrer] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id 5059c4fc-d34c-5c9a-9efe-257c7ec6fb6b] [:name Zuteilung unbekannt - IT & Elektronik] [:can_delete false] [:cost_center 11410600] [:general_ledger_account 5064097000] [:procurement_account 3113097000] [:inspectors [#ordered/map ([:id e9656e43-9f35-502d-b495-eec36093208e] [:firstname Christian] [:lastname Wildhaber] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 28552e7e-f8be-5019-bdad-846babd8c642] [:firstname Hugo] [:lastname Vögtle] [:__typename :User]) #ordered/map ([:id 301988e6-5e0e-43a9-bcb6-3d0022b7ca99] [:firstname Lars] [:lastname Gnädinger] [:__typename :User]) #ordered/map ([:id 0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d] [:firstname Lenny Ron] [:lastname Frei] [:__typename :User]) #ordered/map ([:id b41e6486-ec39-4855-8d8a-c03aa83af233] [:firstname Matthias] [:lastname Daniels] [:__typename :User]) #ordered/map ([:id 4884241c-8104-5c10-a393-0e21dcd1a46e] [:firstname Patrice] [:lastname Huber] [:__typename :User]) #ordered/map ([:id 52c2d39d-7f53-592f-8142-824afbaf59d3] [:firstname Tilo] [:lastname Seiring] [:__typename :User]) #ordered/map ([:id 96c5a731-ae34-5ede-917c-90a42dc66a1e] [:firstname Ugo] [:lastname De Vito] [:__typename :User])]] [:viewers [#ordered/map ([:id b363936a-fd9c-567a-82a4-f0b523dbb26b] [:firstname Beat] [:lastname Rohrer] [:__typename :User])]] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id f6885671-3bf3-56f2-8e92-b5112d0f703f] [:name Musikinstrumente] [:can_delete false] [:image_url /procure/images/3a52eb87-b5fe-5df0-98b1-43e80f28d2dc] [:categories [#ordered/map ([:id af3372a1-63a8-52dc-850e-c2ae91c1c078] [:name Musikinstrumente] [:can_delete false] [:cost_center 11410800] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 6eeeeb75-e3d8-56c9-b7b6-0c45b7795cb9] [:firstname Martin] [:lastname Weyermann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 17a52112-1986-5074-b1d9-0faff29a785b] [:name Zuteilung unbekannt - Musikinstrumente] [:can_delete false] [:cost_center 11410800] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 6eeeeb75-e3d8-56c9-b7b6-0c45b7795cb9] [:firstname Martin] [:lastname Weyermann] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id 6c8a0d77-6711-5156-a59a-12425ba01cff] [:name Werkstatt-Technik] [:can_delete false] [:image_url /procure/images/f4e1f230-df2e-5e95-bf89-827f7a6b4b3b] [:categories [#ordered/map ([:id 6870a16c-9a71-5e60-b94a-f0b784398fec] [:name Handwerkzeug] [:can_delete false] [:cost_center 11410400] [:general_ledger_account 5061097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id ad765b67-18f7-55a8-88b6-11a82cd0d0b4] [:firstname Adrian] [:lastname Brazerol] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 771fddcf-b19a-5e6b-8b6f-7266b6922c4f] [:name Maschinen] [:can_delete false] [:cost_center 11410400] [:general_ledger_account 5061097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id ad765b67-18f7-55a8-88b6-11a82cd0d0b4] [:firstname Adrian] [:lastname Brazerol] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id c7ece4a6-2b5c-409f-96ea-e4fd6e8f9792] [:name Sicherheit] [:can_delete false] [:cost_center 11410400] [:general_ledger_account 5061097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id ad765b67-18f7-55a8-88b6-11a82cd0d0b4] [:firstname Adrian] [:lastname Brazerol] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 3eaad5d5-516a-5610-8caf-342cfdcaac62] [:name Zuteilung unbekannt - Werkstatt-Technik] [:can_delete false] [:cost_center 11410400] [:general_ledger_account 5061097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id ad765b67-18f7-55a8-88b6-11a82cd0d0b4] [:firstname Adrian] [:lastname Brazerol] [:__typename :User]) #ordered/map ([:id cbcbc88f-e7b4-58fd-8dc2-e83be0d06475] [:firstname Claudia] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id da18869a-e4bd-4493-a4c9-2e6fe78c94e7] [:firstname Etienne] [:lastname Schudel] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 6ecace30-0931-59f4-9032-cd412530256c] [:firstname Judith] [:lastname Richi] [:__typename :User]) #ordered/map ([:id de3d3911-8b37-4bfe-aa59-25ee8dac5b07] [:firstname Julio] [:lastname Barrantes Zunzunegui] [:__typename :User]) #ordered/map ([:id b1e54635-ec2a-444f-8edd-7186075b0760] [:firstname Nomce] [:lastname Tanaskoski] [:__typename :User]) #ordered/map ([:id 8448b7b2-f5d9-4590-8355-2295b50bba40] [:firstname Sergej] [:lastname Tratar Baamonde] [:__typename :User]) #ordered/map ([:id 48e259df-9b53-5e56-a03e-65ce562f231a] [:firstname Silvan] [:lastname Becchio] [:__typename :User]) #ordered/map ([:id d0853239-fe13-4540-9c16-4ec1656461d3] [:firstname Silvia] [:lastname Eichenberger] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User]) #ordered/map ([:id baa628c5-c7fc-4cce-bea7-d8093f78adca] [:firstname Zelda] [:lastname Keller] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory])]])}
2023-12-12T11:31:25.931Z NX-41294 DEBUG [leihs.procurement.graphql:86] - result => {:data #ordered/map ([:main_categories [#ordered/map ([:id "519f7a95-9ca7-5256-bf63-142cfc23dc62"] [:name "Audio- und Videotechnik"] [:can_delete false] [:image_url "/procure/images/ee215167-b2c3-5fcc-90c3-098ad20d16ea"] [:categories [#ordered/map ([:id "4e48b48c-e1bf-50d7-ab2d-9aa438c638de"] [:name "Beamer"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "a1727606-c7c8-54a2-aaa1-ceff7a7d4b40"] [:name "Funk-Strecken"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "00382e27-a87a-5313-b31b-a369dad6c5f8"] [:name "Lautsprecher"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "ce5424cc-ce77-5e67-8201-333ec20963eb"] [:name "Lautsprecherstative"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "ce0812d7-080b-5f49-8530-dd4a821c57b6"] [:name "Mikrofone"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "67e5fc60-6fe3-53bb-9495-3669b917038a"] [:name "Mikrofonstative"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "f94f72e8-ff65-5bad-b1f9-81ddd8fa7c0c"] [:name "Monitore / Screens"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "89e4a22f-7d6c-5006-b26a-3ef6f8f19630"] [:name "Schnittplatz / Mischpult / Regie"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "1fb59e17-a703-5abc-8a80-fc7a9c20ee1d"] [:name "Video/Film-Kameras"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "c17698c1-5d5d-51ea-927f-b6ca96431a50"] [:name "Video/Film-Stative"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "fabe3b8c-58b5-5009-8873-cc3e945a7c0d"] [:name "Video/Filmobjektive"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "ebb12585-ce23-5cbe-8f4f-41a42d60a656"] [:name "Zuteilung unbekannt - Audio- und Videotechnik"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "c0777d74-668b-5e01-abb5-f8277baa0ea8"] [:firstname "Matus"] [:lastname "Kmit"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "8a9d832a-cf4c-5253-bcaa-385ef03565c1"] [:firstname "Nadja"] [:lastname "Weisskopf-Admin"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "1a047acd-dc98-52c2-99d3-dc6332adc1e0"] [:name "Bauliche Anpassungen und Mobiliar"] [:can_delete false] [:image_url "/procure/images/8e07c37e-d244-514d-bfa9-306158056160"] [:categories [#ordered/map ([:id "0a082661-cc1c-5b49-baab-f4db926faa7e"] [:name "Bauprojekte"] [:can_delete false] [:cost_center "11410210"] [:general_ledger_account "5069097000"] [:procurement_account "3119097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "797264c9-a2c2-5642-9c1a-d45b01f4fdc5"] [:firstname "Heike"] [:lastname "Heldt"] [:__typename :User]) #ordered/map ([:id "2c1de10b-6145-56d6-a76e-3c207cfc35a1"] [:firstname "Marco"] [:lastname "Castellano"] [:__typename :User]) #ordered/map ([:id "57bb6aaa-95fb-435f-8dd9-d0b853bf2279"] [:firstname "Pascale"] [:lastname "Gisel"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "42cc2d9a-cc45-5d77-85d3-0f21270d7a35"] [:name "Einrichtungsprojekte"] [:can_delete false] [:cost_center "11410220"] [:general_ledger_account "5069097000"] [:procurement_account "3110097001"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "797264c9-a2c2-5642-9c1a-d45b01f4fdc5"] [:firstname "Heike"] [:lastname "Heldt"] [:__typename :User]) #ordered/map ([:id "2c1de10b-6145-56d6-a76e-3c207cfc35a1"] [:firstname "Marco"] [:lastname "Castellano"] [:__typename :User]) #ordered/map ([:id "57bb6aaa-95fb-435f-8dd9-d0b853bf2279"] [:firstname "Pascale"] [:lastname "Gisel"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "56aaec64-8d65-50b3-bd81-f788d477b927"] [:name "Mobiliarergänzungen"] [:can_delete false] [:cost_center "11410220"] [:general_ledger_account "5069097000"] [:procurement_account "3110097001"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "797264c9-a2c2-5642-9c1a-d45b01f4fdc5"] [:firstname "Heike"] [:lastname "Heldt"] [:__typename :User]) #ordered/map ([:id "2c1de10b-6145-56d6-a76e-3c207cfc35a1"] [:firstname "Marco"] [:lastname "Castellano"] [:__typename :User]) #ordered/map ([:id "57bb6aaa-95fb-435f-8dd9-d0b853bf2279"] [:firstname "Pascale"] [:lastname "Gisel"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "483ac871-b632-5dcd-9d37-789d65f4c424"] [:name "Schliessanlagen und Türen"] [:can_delete false] [:cost_center "11410210"] [:general_ledger_account "5069097000"] [:procurement_account "3119097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "797264c9-a2c2-5642-9c1a-d45b01f4fdc5"] [:firstname "Heike"] [:lastname "Heldt"] [:__typename :User]) #ordered/map ([:id "2c1de10b-6145-56d6-a76e-3c207cfc35a1"] [:firstname "Marco"] [:lastname "Castellano"] [:__typename :User]) #ordered/map ([:id "57bb6aaa-95fb-435f-8dd9-d0b853bf2279"] [:firstname "Pascale"] [:lastname "Gisel"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "2b3749a2-6a59-5a25-9b9f-32f5e485e635"] [:name "Signaletik"] [:can_delete false] [:cost_center "11410210"] [:general_ledger_account "5069097000"] [:procurement_account "3119097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "797264c9-a2c2-5642-9c1a-d45b01f4fdc5"] [:firstname "Heike"] [:lastname "Heldt"] [:__typename :User]) #ordered/map ([:id "2c1de10b-6145-56d6-a76e-3c207cfc35a1"] [:firstname "Marco"] [:lastname "Castellano"] [:__typename :User]) #ordered/map ([:id "57bb6aaa-95fb-435f-8dd9-d0b853bf2279"] [:firstname "Pascale"] [:lastname "Gisel"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "fad911e4-8c69-535c-a138-f3e2544519ba"] [:name "Vorhänge"] [:can_delete false] [:cost_center "11410210"] [:general_ledger_account "5069097000"] [:procurement_account "3119097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "797264c9-a2c2-5642-9c1a-d45b01f4fdc5"] [:firstname "Heike"] [:lastname "Heldt"] [:__typename :User]) #ordered/map ([:id "2c1de10b-6145-56d6-a76e-3c207cfc35a1"] [:firstname "Marco"] [:lastname "Castellano"] [:__typename :User]) #ordered/map ([:id "57bb6aaa-95fb-435f-8dd9-d0b853bf2279"] [:firstname "Pascale"] [:lastname "Gisel"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "c3f14f79-931c-52c8-a847-ed77449ce9a6"] [:name "Zuteilung unbekannt - Bauliche Anpassungen und Mobiliar"] [:can_delete false] [:cost_center "11410220"] [:general_ledger_account "5069097000"] [:procurement_account "3119097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "797264c9-a2c2-5642-9c1a-d45b01f4fdc5"] [:firstname "Heike"] [:lastname "Heldt"] [:__typename :User]) #ordered/map ([:id "2c1de10b-6145-56d6-a76e-3c207cfc35a1"] [:firstname "Marco"] [:lastname "Castellano"] [:__typename :User]) #ordered/map ([:id "57bb6aaa-95fb-435f-8dd9-d0b853bf2279"] [:firstname "Pascale"] [:lastname "Gisel"] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "dda588f4-660c-573c-a2ff-944ae93ad42e"] [:name "Beleuchtungstechnik"] [:can_delete false] [:image_url "/procure/images/8debe2ef-4a7e-58a1-bf4c-1622dead4579"] [:categories [#ordered/map ([:id "b9e4f492-55e3-57e4-9467-91c81bfe2325"] [:name "Bühnenlicht"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User])]] [:viewers [#ordered/map ([:id "8448b7b2-f5d9-4590-8355-2295b50bba40"] [:firstname "Sergej"] [:lastname "Tratar Baamonde"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "a7cca5a4-e265-5f36-b794-1024c8aacc3e"] [:name "Film-Beleuchtung"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User])]] [:viewers [#ordered/map ([:id "8448b7b2-f5d9-4590-8355-2295b50bba40"] [:firstname "Sergej"] [:lastname "Tratar Baamonde"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "79822b89-0edb-588c-b9e5-65b7722ac50b"] [:name "Kameralicht"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User])]] [:viewers [#ordered/map ([:id "8448b7b2-f5d9-4590-8355-2295b50bba40"] [:firstname "Sergej"] [:lastname "Tratar Baamonde"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "ab911807-6431-5ca7-890a-3573737bb4d3"] [:name "Mobiles Raumlicht für Ausstellungen"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "2c1de10b-6145-56d6-a76e-3c207cfc35a1"] [:firstname "Marco"] [:lastname "Castellano"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "64c6f8ad-a1b7-530b-946a-ebb1644ac897"] [:name "Studio-Licht"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User])]] [:viewers [#ordered/map ([:id "8448b7b2-f5d9-4590-8355-2295b50bba40"] [:firstname "Sergej"] [:lastname "Tratar Baamonde"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "f2bb3f23-bb5b-5855-b03f-0166bd19fc0c"] [:name "Zuteilung unbekannt - Beleuchtungstechnik"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User])]] [:viewers [#ordered/map ([:id "8448b7b2-f5d9-4590-8355-2295b50bba40"] [:firstname "Sergej"] [:lastname "Tratar Baamonde"] [:__typename :User])]] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "2b07eb8a-4174-5257-83eb-920d536cc44a"] [:name "Betriebseinrichtungen und Fahrzeuge"] [:can_delete false] [:image_url "/procure/images/3d6cbe63-c327-5c6b-b7fa-48e6c52f2cdc"] [:categories [#ordered/map ([:id "5d8639a3-4569-5009-af28-f63f2af5209d"] [:name "Betriebseinrichtungen"] [:can_delete false] [:cost_center "11410200"] [:general_ledger_account "5061097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "2c1de10b-6145-56d6-a76e-3c207cfc35a1"] [:firstname "Marco"] [:lastname "Castellano"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "b34f1cbb-4ac7-59a0-81f2-3ca7ecc94e71"] [:name "Fahrzeuge"] [:can_delete false] [:cost_center "11410200"] [:general_ledger_account "5061097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "2c1de10b-6145-56d6-a76e-3c207cfc35a1"] [:firstname "Marco"] [:lastname "Castellano"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "73e97867-43ea-5bee-b46b-d7c74fbf873b"] [:name "Hub- und Hebegeräte"] [:can_delete false] [:cost_center "11410200"] [:general_ledger_account "5061097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "2c1de10b-6145-56d6-a76e-3c207cfc35a1"] [:firstname "Marco"] [:lastname "Castellano"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "b6601a86-b5d3-5682-88b6-cff956b00d7b"] [:name "Zuteilung unbekannt - Betriebseinrichtungen und Fahrzeuge"] [:can_delete false] [:cost_center "11410200"] [:general_ledger_account "5061097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "2c1de10b-6145-56d6-a76e-3c207cfc35a1"] [:firstname "Marco"] [:lastname "Castellano"] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "f6827594-33a6-5760-ac41-f94ceefacfab"] [:name "Bühnentechnik"] [:can_delete false] [:image_url "/procure/images/9a8cba78-10ab-585b-a4c2-9d8e7f0818ee"] [:categories [#ordered/map ([:id "455bc6dc-afbd-579d-a621-6d75e0fca9ea"] [:name "Bühnentechnik"] [:can_delete false] [:cost_center "11410500"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "428a72a9-36df-52fa-880f-64db35843013"] [:firstname "Dominik"] [:lastname "Fedier"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "8448b7b2-f5d9-4590-8355-2295b50bba40"] [:firstname "Sergej"] [:lastname "Tratar Baamonde"] [:__typename :User])]] [:viewers [#ordered/map ([:id "8448b7b2-f5d9-4590-8355-2295b50bba40"] [:firstname "Sergej"] [:lastname "Tratar Baamonde"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "747b6b21-9fad-4a01-acd9-cd8983aed286"] [:name "Fundus"] [:can_delete false] [:cost_center "11410500"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "428a72a9-36df-52fa-880f-64db35843013"] [:firstname "Dominik"] [:lastname "Fedier"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User])]] [:viewers [#ordered/map ([:id "8448b7b2-f5d9-4590-8355-2295b50bba40"] [:firstname "Sergej"] [:lastname "Tratar Baamonde"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "07a6af37-e127-5f4b-94ec-698a5698d98c"] [:name "Zuteilung unbekannt - Bühnentechnik"] [:can_delete false] [:cost_center "11410500"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "428a72a9-36df-52fa-880f-64db35843013"] [:firstname "Dominik"] [:lastname "Fedier"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "8448b7b2-f5d9-4590-8355-2295b50bba40"] [:firstname "Sergej"] [:lastname "Tratar Baamonde"] [:__typename :User])]] [:viewers [#ordered/map ([:id "8448b7b2-f5d9-4590-8355-2295b50bba40"] [:firstname "Sergej"] [:lastname "Tratar Baamonde"] [:__typename :User])]] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "517b82ae-2b7e-4822-9aeb-0d4753dec821"] [:name "Darlehen"] [:can_delete false] [:image_url nil] [:categories [#ordered/map ([:id "671ab85c-b8c1-4659-9c6e-9ebe2f122a59"] [:name "Darlehen"] [:can_delete false] [:cost_center "11410101"] [:general_ledger_account "5064097000"] [:procurement_account ""] [:inspectors [#ordered/map ([:id "b610f5bd-6da8-5122-94f0-c0bbf1b7ed73"] [:firstname "Daniel"] [:lastname "Fischer"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da"] [:name "Fotografie"] [:can_delete false] [:image_url "/procure/images/07a33b4c-d274-54e5-a2ce-11f26d57be05"] [:categories [#ordered/map ([:id "e1b4cad8-0416-5cf7-9e4a-dde208d0abad"] [:name "Blitzanlagen"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "011ff3f3-09fa-59e1-9713-52466786adf8"] [:name "Fotokameras"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "54b87eb0-061c-5a97-96ad-e9b6da605184"] [:name "Fotostative"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "5858ec5d-5f01-50fb-bc96-4b4766bd7799"] [:name "Kompakt-Blitze"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "ba5b41a7-4317-5160-9b82-b0931a48aec0"] [:name "Objektive"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "9df68a66-4523-5072-aa31-1df9abeaa1c7"] [:name "Zuteilung unbekannt - Fotografie"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "2ea39047-e663-50d5-9080-838b75883704"] [:name "IT & Elektronik"] [:can_delete false] [:image_url "/procure/images/1464e46c-e726-54a9-a42b-f937a0342d22"] [:categories [#ordered/map ([:id "f2531d7e-d9ff-5c3e-9e88-6d3a16a89aa1"] [:name "Desktop"] [:can_delete false] [:cost_center "11410660"] [:general_ledger_account "5064097000"] [:procurement_account "3113097000"] [:inspectors [#ordered/map ([:id "e9656e43-9f35-502d-b495-eec36093208e"] [:firstname "Christian"] [:lastname "Wildhaber"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "28552e7e-f8be-5019-bdad-846babd8c642"] [:firstname "Hugo"] [:lastname "Vögtle"] [:__typename :User]) #ordered/map ([:id "301988e6-5e0e-43a9-bcb6-3d0022b7ca99"] [:firstname "Lars"] [:lastname "Gnädinger"] [:__typename :User]) #ordered/map ([:id "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d"] [:firstname "Lenny Ron"] [:lastname "Frei"] [:__typename :User]) #ordered/map ([:id "b5d09795-0b94-423d-a645-bae0aed895ce"] [:firstname "Lukas"] [:lastname "Brupbacher"] [:__typename :User]) #ordered/map ([:id "b41e6486-ec39-4855-8d8a-c03aa83af233"] [:firstname "Matthias"] [:lastname "Daniels"] [:__typename :User]) #ordered/map ([:id "8a9d832a-cf4c-5253-bcaa-385ef03565c1"] [:firstname "Nadja"] [:lastname "Weisskopf-Admin"] [:__typename :User]) #ordered/map ([:id "4884241c-8104-5c10-a393-0e21dcd1a46e"] [:firstname "Patrice"] [:lastname "Huber"] [:__typename :User]) #ordered/map ([:id "52c2d39d-7f53-592f-8142-824afbaf59d3"] [:firstname "Tilo"] [:lastname "Seiring"] [:__typename :User]) #ordered/map ([:id "96c5a731-ae34-5ede-917c-90a42dc66a1e"] [:firstname "Ugo"] [:lastname "De Vito"] [:__typename :User])]] [:viewers [#ordered/map ([:id "b363936a-fd9c-567a-82a4-f0b523dbb26b"] [:firstname "Beat"] [:lastname "Rohrer"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "1af3a7f2-b16a-4203-b6ac-f2c7be612d74"] [:name "IT_Projekte"] [:can_delete false] [:cost_center "11410650"] [:general_ledger_account "5064097000"] [:procurement_account "3118097000"] [:inspectors [#ordered/map ([:id "e9656e43-9f35-502d-b495-eec36093208e"] [:firstname "Christian"] [:lastname "Wildhaber"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "28552e7e-f8be-5019-bdad-846babd8c642"] [:firstname "Hugo"] [:lastname "Vögtle"] [:__typename :User]) #ordered/map ([:id "301988e6-5e0e-43a9-bcb6-3d0022b7ca99"] [:firstname "Lars"] [:lastname "Gnädinger"] [:__typename :User]) #ordered/map ([:id "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d"] [:firstname "Lenny Ron"] [:lastname "Frei"] [:__typename :User]) #ordered/map ([:id "b5d09795-0b94-423d-a645-bae0aed895ce"] [:firstname "Lukas"] [:lastname "Brupbacher"] [:__typename :User]) #ordered/map ([:id "b41e6486-ec39-4855-8d8a-c03aa83af233"] [:firstname "Matthias"] [:lastname "Daniels"] [:__typename :User]) #ordered/map ([:id "4884241c-8104-5c10-a393-0e21dcd1a46e"] [:firstname "Patrice"] [:lastname "Huber"] [:__typename :User]) #ordered/map ([:id "52c2d39d-7f53-592f-8142-824afbaf59d3"] [:firstname "Tilo"] [:lastname "Seiring"] [:__typename :User]) #ordered/map ([:id "96c5a731-ae34-5ede-917c-90a42dc66a1e"] [:firstname "Ugo"] [:lastname "De Vito"] [:__typename :User])]] [:viewers [#ordered/map ([:id "b363936a-fd9c-567a-82a4-f0b523dbb26b"] [:firstname "Beat"] [:lastname "Rohrer"] [:__typename :User]) #ordered/map ([:id "b5d09795-0b94-423d-a645-bae0aed895ce"] [:firstname "Lukas"] [:lastname "Brupbacher"] [:__typename :User]) #ordered/map ([:id "233a038c-66fb-4036-9149-762c10a5b72e"] [:firstname "Maria"] [:lastname "Krause"] [:__typename :User]) #ordered/map ([:id "d65e52a5-0404-4069-b6a0-7e8ef60dc1e1"] [:firstname "Maurizio"] [:lastname "Mattiola"] [:__typename :User]) #ordered/map ([:id "119a33c1-151f-4579-8c79-0d3225d4b9b6"] [:firstname "Michael"] [:lastname "Bozenicar"] [:__typename :User]) #ordered/map ([:id "45b1cf11-1f50-5d8b-aedf-5d8b83b19a52"] [:firstname "Monika"] [:lastname "Petschen"] [:__typename :User]) #ordered/map ([:id "8160a951-8900-448d-8c3e-e31ec60fd3f3"] [:firstname "Stefan"] [:lastname "Uhle"] [:__typename :User]) #ordered/map ([:id "a4d8f8c9-8f5e-444f-b2cf-67e53f7d3d0c"] [:firstname "Thomas"] [:lastname "Bickel"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "ccab158d-79c7-5c28-a8a2-47cb4925f101"] [:name "IT-Basisinfrastruktur"] [:can_delete false] [:cost_center "11410640"] [:general_ledger_account "5064097000"] [:procurement_account "3113097000"] [:inspectors [#ordered/map ([:id "e9656e43-9f35-502d-b495-eec36093208e"] [:firstname "Christian"] [:lastname "Wildhaber"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "28552e7e-f8be-5019-bdad-846babd8c642"] [:firstname "Hugo"] [:lastname "Vögtle"] [:__typename :User]) #ordered/map ([:id "301988e6-5e0e-43a9-bcb6-3d0022b7ca99"] [:firstname "Lars"] [:lastname "Gnädinger"] [:__typename :User]) #ordered/map ([:id "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d"] [:firstname "Lenny Ron"] [:lastname "Frei"] [:__typename :User]) #ordered/map ([:id "b41e6486-ec39-4855-8d8a-c03aa83af233"] [:firstname "Matthias"] [:lastname "Daniels"] [:__typename :User]) #ordered/map ([:id "4884241c-8104-5c10-a393-0e21dcd1a46e"] [:firstname "Patrice"] [:lastname "Huber"] [:__typename :User]) #ordered/map ([:id "52c2d39d-7f53-592f-8142-824afbaf59d3"] [:firstname "Tilo"] [:lastname "Seiring"] [:__typename :User]) #ordered/map ([:id "96c5a731-ae34-5ede-917c-90a42dc66a1e"] [:firstname "Ugo"] [:lastname "De Vito"] [:__typename :User])]] [:viewers [#ordered/map ([:id "b363936a-fd9c-567a-82a4-f0b523dbb26b"] [:firstname "Beat"] [:lastname "Rohrer"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "eb1e7bef-80c6-4958-b16e-35555735ce61"] [:name "IT-Security"] [:can_delete false] [:cost_center "11410600"] [:general_ledger_account "5064097000"] [:procurement_account "3113097000"] [:inspectors [#ordered/map ([:id "3651eeeb-0fb1-4840-80dd-6c739bda6c57"] [:firstname "Christian"] [:lastname "Schneider"] [:__typename :User]) #ordered/map ([:id "301988e6-5e0e-43a9-bcb6-3d0022b7ca99"] [:firstname "Lars"] [:lastname "Gnädinger"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "4ecc9e97-2d12-5173-bd8c-781482c842e8"] [:name "Laptops"] [:can_delete false] [:cost_center "11410660"] [:general_ledger_account "5064097000"] [:procurement_account "3113097000"] [:inspectors [#ordered/map ([:id "e9656e43-9f35-502d-b495-eec36093208e"] [:firstname "Christian"] [:lastname "Wildhaber"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "28552e7e-f8be-5019-bdad-846babd8c642"] [:firstname "Hugo"] [:lastname "Vögtle"] [:__typename :User]) #ordered/map ([:id "301988e6-5e0e-43a9-bcb6-3d0022b7ca99"] [:firstname "Lars"] [:lastname "Gnädinger"] [:__typename :User]) #ordered/map ([:id "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d"] [:firstname "Lenny Ron"] [:lastname "Frei"] [:__typename :User]) #ordered/map ([:id "b41e6486-ec39-4855-8d8a-c03aa83af233"] [:firstname "Matthias"] [:lastname "Daniels"] [:__typename :User]) #ordered/map ([:id "4884241c-8104-5c10-a393-0e21dcd1a46e"] [:firstname "Patrice"] [:lastname "Huber"] [:__typename :User]) #ordered/map ([:id "52c2d39d-7f53-592f-8142-824afbaf59d3"] [:firstname "Tilo"] [:lastname "Seiring"] [:__typename :User]) #ordered/map ([:id "96c5a731-ae34-5ede-917c-90a42dc66a1e"] [:firstname "Ugo"] [:lastname "De Vito"] [:__typename :User])]] [:viewers [#ordered/map ([:id "b363936a-fd9c-567a-82a4-f0b523dbb26b"] [:firstname "Beat"] [:lastname "Rohrer"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "80226a51-c17a-5fd8-93db-40aef5b03491"] [:name "Monitore"] [:can_delete false] [:cost_center "11410660"] [:general_ledger_account "5064097000"] [:procurement_account "3113097000"] [:inspectors [#ordered/map ([:id "e9656e43-9f35-502d-b495-eec36093208e"] [:firstname "Christian"] [:lastname "Wildhaber"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "28552e7e-f8be-5019-bdad-846babd8c642"] [:firstname "Hugo"] [:lastname "Vögtle"] [:__typename :User]) #ordered/map ([:id "301988e6-5e0e-43a9-bcb6-3d0022b7ca99"] [:firstname "Lars"] [:lastname "Gnädinger"] [:__typename :User]) #ordered/map ([:id "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d"] [:firstname "Lenny Ron"] [:lastname "Frei"] [:__typename :User]) #ordered/map ([:id "b41e6486-ec39-4855-8d8a-c03aa83af233"] [:firstname "Matthias"] [:lastname "Daniels"] [:__typename :User]) #ordered/map ([:id "4884241c-8104-5c10-a393-0e21dcd1a46e"] [:firstname "Patrice"] [:lastname "Huber"] [:__typename :User]) #ordered/map ([:id "52c2d39d-7f53-592f-8142-824afbaf59d3"] [:firstname "Tilo"] [:lastname "Seiring"] [:__typename :User]) #ordered/map ([:id "96c5a731-ae34-5ede-917c-90a42dc66a1e"] [:firstname "Ugo"] [:lastname "De Vito"] [:__typename :User])]] [:viewers [#ordered/map ([:id "b363936a-fd9c-567a-82a4-f0b523dbb26b"] [:firstname "Beat"] [:lastname "Rohrer"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "fe602c35-1097-52d0-acd0-40579d295f00"] [:name "Scanner"] [:can_delete false] [:cost_center "11410660"] [:general_ledger_account "5064097000"] [:procurement_account "3113097000"] [:inspectors [#ordered/map ([:id "e9656e43-9f35-502d-b495-eec36093208e"] [:firstname "Christian"] [:lastname "Wildhaber"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "28552e7e-f8be-5019-bdad-846babd8c642"] [:firstname "Hugo"] [:lastname "Vögtle"] [:__typename :User]) #ordered/map ([:id "301988e6-5e0e-43a9-bcb6-3d0022b7ca99"] [:firstname "Lars"] [:lastname "Gnädinger"] [:__typename :User]) #ordered/map ([:id "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d"] [:firstname "Lenny Ron"] [:lastname "Frei"] [:__typename :User]) #ordered/map ([:id "b41e6486-ec39-4855-8d8a-c03aa83af233"] [:firstname "Matthias"] [:lastname "Daniels"] [:__typename :User]) #ordered/map ([:id "4884241c-8104-5c10-a393-0e21dcd1a46e"] [:firstname "Patrice"] [:lastname "Huber"] [:__typename :User]) #ordered/map ([:id "52c2d39d-7f53-592f-8142-824afbaf59d3"] [:firstname "Tilo"] [:lastname "Seiring"] [:__typename :User]) #ordered/map ([:id "96c5a731-ae34-5ede-917c-90a42dc66a1e"] [:firstname "Ugo"] [:lastname "De Vito"] [:__typename :User])]] [:viewers [#ordered/map ([:id "b363936a-fd9c-567a-82a4-f0b523dbb26b"] [:firstname "Beat"] [:lastname "Rohrer"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "56065d53-cd2f-5a39-9b66-532fd83ad2e6"] [:name "Schnittstellengeräte"] [:can_delete false] [:cost_center "11410660"] [:general_ledger_account "5064097000"] [:procurement_account "3113097000"] [:inspectors [#ordered/map ([:id "e9656e43-9f35-502d-b495-eec36093208e"] [:firstname "Christian"] [:lastname "Wildhaber"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "28552e7e-f8be-5019-bdad-846babd8c642"] [:firstname "Hugo"] [:lastname "Vögtle"] [:__typename :User]) #ordered/map ([:id "301988e6-5e0e-43a9-bcb6-3d0022b7ca99"] [:firstname "Lars"] [:lastname "Gnädinger"] [:__typename :User]) #ordered/map ([:id "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d"] [:firstname "Lenny Ron"] [:lastname "Frei"] [:__typename :User]) #ordered/map ([:id "b41e6486-ec39-4855-8d8a-c03aa83af233"] [:firstname "Matthias"] [:lastname "Daniels"] [:__typename :User]) #ordered/map ([:id "4884241c-8104-5c10-a393-0e21dcd1a46e"] [:firstname "Patrice"] [:lastname "Huber"] [:__typename :User]) #ordered/map ([:id "52c2d39d-7f53-592f-8142-824afbaf59d3"] [:firstname "Tilo"] [:lastname "Seiring"] [:__typename :User]) #ordered/map ([:id "96c5a731-ae34-5ede-917c-90a42dc66a1e"] [:firstname "Ugo"] [:lastname "De Vito"] [:__typename :User])]] [:viewers [#ordered/map ([:id "b363936a-fd9c-567a-82a4-f0b523dbb26b"] [:firstname "Beat"] [:lastname "Rohrer"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "fc7bc38c-62f3-5576-802f-c874e06ee776"] [:name "Software"] [:can_delete false] [:cost_center "11410660"] [:general_ledger_account "5064097000"] [:procurement_account "3118097000"] [:inspectors [#ordered/map ([:id "e9656e43-9f35-502d-b495-eec36093208e"] [:firstname "Christian"] [:lastname "Wildhaber"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "28552e7e-f8be-5019-bdad-846babd8c642"] [:firstname "Hugo"] [:lastname "Vögtle"] [:__typename :User]) #ordered/map ([:id "301988e6-5e0e-43a9-bcb6-3d0022b7ca99"] [:firstname "Lars"] [:lastname "Gnädinger"] [:__typename :User]) #ordered/map ([:id "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d"] [:firstname "Lenny Ron"] [:lastname "Frei"] [:__typename :User]) #ordered/map ([:id "b41e6486-ec39-4855-8d8a-c03aa83af233"] [:firstname "Matthias"] [:lastname "Daniels"] [:__typename :User]) #ordered/map ([:id "8a9d832a-cf4c-5253-bcaa-385ef03565c1"] [:firstname "Nadja"] [:lastname "Weisskopf-Admin"] [:__typename :User]) #ordered/map ([:id "4884241c-8104-5c10-a393-0e21dcd1a46e"] [:firstname "Patrice"] [:lastname "Huber"] [:__typename :User]) #ordered/map ([:id "52c2d39d-7f53-592f-8142-824afbaf59d3"] [:firstname "Tilo"] [:lastname "Seiring"] [:__typename :User]) #ordered/map ([:id "96c5a731-ae34-5ede-917c-90a42dc66a1e"] [:firstname "Ugo"] [:lastname "De Vito"] [:__typename :User])]] [:viewers [#ordered/map ([:id "b363936a-fd9c-567a-82a4-f0b523dbb26b"] [:firstname "Beat"] [:lastname "Rohrer"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "76fdca98-4a2a-5640-bc98-f33059d6ffa0"] [:name "Tablets"] [:can_delete false] [:cost_center "11410660"] [:general_ledger_account "5064097000"] [:procurement_account "3113097000"] [:inspectors [#ordered/map ([:id "e9656e43-9f35-502d-b495-eec36093208e"] [:firstname "Christian"] [:lastname "Wildhaber"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "28552e7e-f8be-5019-bdad-846babd8c642"] [:firstname "Hugo"] [:lastname "Vögtle"] [:__typename :User]) #ordered/map ([:id "301988e6-5e0e-43a9-bcb6-3d0022b7ca99"] [:firstname "Lars"] [:lastname "Gnädinger"] [:__typename :User]) #ordered/map ([:id "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d"] [:firstname "Lenny Ron"] [:lastname "Frei"] [:__typename :User]) #ordered/map ([:id "b41e6486-ec39-4855-8d8a-c03aa83af233"] [:firstname "Matthias"] [:lastname "Daniels"] [:__typename :User]) #ordered/map ([:id "4884241c-8104-5c10-a393-0e21dcd1a46e"] [:firstname "Patrice"] [:lastname "Huber"] [:__typename :User]) #ordered/map ([:id "52c2d39d-7f53-592f-8142-824afbaf59d3"] [:firstname "Tilo"] [:lastname "Seiring"] [:__typename :User]) #ordered/map ([:id "96c5a731-ae34-5ede-917c-90a42dc66a1e"] [:firstname "Ugo"] [:lastname "De Vito"] [:__typename :User])]] [:viewers [#ordered/map ([:id "b363936a-fd9c-567a-82a4-f0b523dbb26b"] [:firstname "Beat"] [:lastname "Rohrer"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "77857566-03d9-58f4-8b0d-290227434aff"] [:name "Telefon"] [:can_delete false] [:cost_center "11410660"] [:general_ledger_account "5064097000"] [:procurement_account "3113097000"] [:inspectors [#ordered/map ([:id "e9656e43-9f35-502d-b495-eec36093208e"] [:firstname "Christian"] [:lastname "Wildhaber"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "28552e7e-f8be-5019-bdad-846babd8c642"] [:firstname "Hugo"] [:lastname "Vögtle"] [:__typename :User]) #ordered/map ([:id "301988e6-5e0e-43a9-bcb6-3d0022b7ca99"] [:firstname "Lars"] [:lastname "Gnädinger"] [:__typename :User]) #ordered/map ([:id "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d"] [:firstname "Lenny Ron"] [:lastname "Frei"] [:__typename :User]) #ordered/map ([:id "b41e6486-ec39-4855-8d8a-c03aa83af233"] [:firstname "Matthias"] [:lastname "Daniels"] [:__typename :User]) #ordered/map ([:id "4884241c-8104-5c10-a393-0e21dcd1a46e"] [:firstname "Patrice"] [:lastname "Huber"] [:__typename :User]) #ordered/map ([:id "52c2d39d-7f53-592f-8142-824afbaf59d3"] [:firstname "Tilo"] [:lastname "Seiring"] [:__typename :User]) #ordered/map ([:id "96c5a731-ae34-5ede-917c-90a42dc66a1e"] [:firstname "Ugo"] [:lastname "De Vito"] [:__typename :User])]] [:viewers [#ordered/map ([:id "b363936a-fd9c-567a-82a4-f0b523dbb26b"] [:firstname "Beat"] [:lastname "Rohrer"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "5059c4fc-d34c-5c9a-9efe-257c7ec6fb6b"] [:name "Zuteilung unbekannt - IT & Elektronik"] [:can_delete false] [:cost_center "11410600"] [:general_ledger_account "5064097000"] [:procurement_account "3113097000"] [:inspectors [#ordered/map ([:id "e9656e43-9f35-502d-b495-eec36093208e"] [:firstname "Christian"] [:lastname "Wildhaber"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "28552e7e-f8be-5019-bdad-846babd8c642"] [:firstname "Hugo"] [:lastname "Vögtle"] [:__typename :User]) #ordered/map ([:id "301988e6-5e0e-43a9-bcb6-3d0022b7ca99"] [:firstname "Lars"] [:lastname "Gnädinger"] [:__typename :User]) #ordered/map ([:id "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d"] [:firstname "Lenny Ron"] [:lastname "Frei"] [:__typename :User]) #ordered/map ([:id "b41e6486-ec39-4855-8d8a-c03aa83af233"] [:firstname "Matthias"] [:lastname "Daniels"] [:__typename :User]) #ordered/map ([:id "4884241c-8104-5c10-a393-0e21dcd1a46e"] [:firstname "Patrice"] [:lastname "Huber"] [:__typename :User]) #ordered/map ([:id "52c2d39d-7f53-592f-8142-824afbaf59d3"] [:firstname "Tilo"] [:lastname "Seiring"] [:__typename :User]) #ordered/map ([:id "96c5a731-ae34-5ede-917c-90a42dc66a1e"] [:firstname "Ugo"] [:lastname "De Vito"] [:__typename :User])]] [:viewers [#ordered/map ([:id "b363936a-fd9c-567a-82a4-f0b523dbb26b"] [:firstname "Beat"] [:lastname "Rohrer"] [:__typename :User])]] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "f6885671-3bf3-56f2-8e92-b5112d0f703f"] [:name "Musikinstrumente"] [:can_delete false] [:image_url "/procure/images/3a52eb87-b5fe-5df0-98b1-43e80f28d2dc"] [:categories [#ordered/map ([:id "af3372a1-63a8-52dc-850e-c2ae91c1c078"] [:name "Musikinstrumente"] [:can_delete false] [:cost_center "11410800"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "6eeeeb75-e3d8-56c9-b7b6-0c45b7795cb9"] [:firstname "Martin"] [:lastname "Weyermann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "17a52112-1986-5074-b1d9-0faff29a785b"] [:name "Zuteilung unbekannt - Musikinstrumente"] [:can_delete false] [:cost_center "11410800"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "6eeeeb75-e3d8-56c9-b7b6-0c45b7795cb9"] [:firstname "Martin"] [:lastname "Weyermann"] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "6c8a0d77-6711-5156-a59a-12425ba01cff"] [:name "Werkstatt-Technik"] [:can_delete false] [:image_url "/procure/images/f4e1f230-df2e-5e95-bf89-827f7a6b4b3b"] [:categories [#ordered/map ([:id "6870a16c-9a71-5e60-b94a-f0b784398fec"] [:name "Handwerkzeug"] [:can_delete false] [:cost_center "11410400"] [:general_ledger_account "5061097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "ad765b67-18f7-55a8-88b6-11a82cd0d0b4"] [:firstname "Adrian"] [:lastname "Brazerol"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "771fddcf-b19a-5e6b-8b6f-7266b6922c4f"] [:name "Maschinen"] [:can_delete false] [:cost_center "11410400"] [:general_ledger_account "5061097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "ad765b67-18f7-55a8-88b6-11a82cd0d0b4"] [:firstname "Adrian"] [:lastname "Brazerol"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "c7ece4a6-2b5c-409f-96ea-e4fd6e8f9792"] [:name "Sicherheit"] [:can_delete false] [:cost_center "11410400"] [:general_ledger_account "5061097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "ad765b67-18f7-55a8-88b6-11a82cd0d0b4"] [:firstname "Adrian"] [:lastname "Brazerol"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "3eaad5d5-516a-5610-8caf-342cfdcaac62"] [:name "Zuteilung unbekannt - Werkstatt-Technik"] [:can_delete false] [:cost_center "11410400"] [:general_ledger_account "5061097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "ad765b67-18f7-55a8-88b6-11a82cd0d0b4"] [:firstname "Adrian"] [:lastname "Brazerol"] [:__typename :User]) #ordered/map ([:id "cbcbc88f-e7b4-58fd-8dc2-e83be0d06475"] [:firstname "Claudia"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "da18869a-e4bd-4493-a4c9-2e6fe78c94e7"] [:firstname "Etienne"] [:lastname "Schudel"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "6ecace30-0931-59f4-9032-cd412530256c"] [:firstname "Judith"] [:lastname "Richi"] [:__typename :User]) #ordered/map ([:id "de3d3911-8b37-4bfe-aa59-25ee8dac5b07"] [:firstname "Julio"] [:lastname "Barrantes Zunzunegui"] [:__typename :User]) #ordered/map ([:id "b1e54635-ec2a-444f-8edd-7186075b0760"] [:firstname "Nomce"] [:lastname "Tanaskoski"] [:__typename :User]) #ordered/map ([:id "8448b7b2-f5d9-4590-8355-2295b50bba40"] [:firstname "Sergej"] [:lastname "Tratar Baamonde"] [:__typename :User]) #ordered/map ([:id "48e259df-9b53-5e56-a03e-65ce562f231a"] [:firstname "Silvan"] [:lastname "Becchio"] [:__typename :User]) #ordered/map ([:id "d0853239-fe13-4540-9c16-4ec1656461d3"] [:firstname "Silvia"] [:lastname "Eichenberger"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User]) #ordered/map ([:id "baa628c5-c7fc-4cce-bea7-d8093f78adca"] [:firstname "Zelda"] [:lastname "Keller"] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory])]])}
>>> authenticate::skip= true  handler-key= :image
>>> authenticate::authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}

>> authorize >

>> authorize::handler > #object[leihs.core.locale$wrap$fn__45159 0x55069a5c leihs.core.locale$wrap$fn__45159@55069a5c]

>> authorize::request > {:authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 219b97e6-bb13-401e-92a7-2304bf206106}, leihs-user-session {:value d429c048-7118-407f-a7a9-b33da6f15b06}}, :remote-addr 127.0.0.1, :start-time 47992558342333, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}, :query-params-raw {}, :route-params {:image-id 8debe2ef-4a7e-58a1-bf4c-1622dead4579}, :headers {sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, cookie leihs-anti-csrf-token=219b97e6-bb13-401e-92a7-2304bf206106; leihs-user-session=d429c048-7118-407f-a7a9-b33da6f15b06, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/admin/categories/dda588f4660c573ca2ff944ae93ad42e, connection keep-alive, pragma no-cache, accept image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest image, accept-encoding gzip, deflate, br, sec-fetch-mode no-cors, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x68b6a715 /127.0.0.1:3230<->/127.0.0.1:53029], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x65dc1b71 HikariDataSource (db-pool)]}, :content-length 0, :form-params {}, :websocket? false, :query-params {}, :content-type nil, :form-params-raw {}, :character-encoding utf8, :uri /procure/images/8debe2ef-4a7e-58a1-bf4c-1622dead4579, :server-name localhost, :handler-key :image, :query-string nil, :body nil, :graphql-schema #CompiledSchema<>, :handler #object[compojure.core$routes$fn__27950 0x42c6e004 compojure.core$routes$fn__27950@42c6e004], :multipart-params {}, :scheme :http, :request-method :get, :accept {:mime :apng, :charset nil, :encoding nil, :language nil}}

>> authorize::handler-key >> :image
>myprint>  authEnt? {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>myprint>  txn #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
2023-12-12T11:31:26.117Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:26.117Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:26.118Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>myprint>  admin true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:26.118Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> inspector? {:result false}
>myprint>  inspector false
>o> viewer? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:26.127Z NX-41294 DEBUG [leihs.procurement.permissions.user:85] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> viewer? {:result false}
>myprint>  viewer false
>o> requester?? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:26.127Z NX-41294 DEBUG [leihs.procurement.permissions.user:169] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> requester?? {:exists false}
2023-12-12T11:31:26.128Z NX-41294 DEBUG [leihs.procurement.permissions.user:173] - (:exists result) => false
>myprint>  requester false

> 1 anti-csrf-token >  219b97e6-bb13-401e-92a7-2304bf206106

> 1 anti-csrf-token class >  java.lang.String

> 2 anti-csrf-token-new >  nil
>>> authenticate::skip= true  handler-key= :upload
>>> authenticate::authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}

>> authorize >

>> authorize::handler > #object[leihs.core.locale$wrap$fn__45159 0x55069a5c leihs.core.locale$wrap$fn__45159@55069a5c]

>> authorize::request > {:authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 219b97e6-bb13-401e-92a7-2304bf206106}, leihs-user-session {:value d429c048-7118-407f-a7a9-b33da6f15b06}}, :remote-addr 127.0.0.1, :start-time 47997995920125, :params {:files {:filename thx.png, :content-type image/png, :tempfile #object[java.io.File 0x1fa87a69 /var/folders/jl/49spzkdd2v3cdz37fgmp0ddr6cj76v/T/ring-multipart-7475320541688143884.tmp], :size 1669}}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.pool.HikariProxyConnection 0x14c80450 HikariProxyConnection@348652624 wrapping org.postgresql.jdbc.PgConnection@6f737354], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type multipart/form-data; boundary=----WebKitFormBoundaryXA8QRfb6XYVfPjBe, cookie leihs-anti-csrf-token=219b97e6-bb13-401e-92a7-2304bf206106; leihs-user-session=d429c048-7118-407f-a7a9-b33da6f15b06, content-length 1850, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/admin/categories/dda588f4660c573ca2ff944ae93ad42e, connection keep-alive, pragma no-cache, x-csrf-token 219b97e6-bb13-401e-92a7-2304bf206106, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x7f7ba351 /127.0.0.1:3230<->/127.0.0.1:53029], :server-port 3230, :params-raw {:files {:filename thx.png, :content-type image/png, :tempfile #object[java.io.File 0x1fa87a69 /var/folders/jl/49spzkdd2v3cdz37fgmp0ddr6cj76v/T/ring-multipart-7475320541688143884.tmp], :size 1669}}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x65dc1b71 HikariDataSource (db-pool)], :connection #object[com.zaxxer.hikari.pool.HikariProxyConnection 0x456545fc HikariProxyConnection@1164264956 wrapping org.postgresql.jdbc.PgConnection@2bfe7fef], :level 1, :rollback #object[clojure.lang.Atom 0x2fea85c8 {:status :ready, :val false}]}, :content-length 1850, :form-params {}, :websocket? false, :query-params {}, :content-type multipart/form-data; boundary=----WebKitFormBoundaryXA8QRfb6XYVfPjBe, :form-params-raw {}, :character-encoding utf8, :uri /procure/upload, :server-name localhost, :handler-key :upload, :query-string nil, :body #object[org.httpkit.BytesInputStream 0x3542cf61 BytesInputStream[len=1850]], :graphql-schema #CompiledSchema<>, :handler #object[compojure.core$routes$fn__27950 0x36e85cd6 compojure.core$routes$fn__27950@36e85cd6], :multipart-params {files {:filename thx.png, :content-type image/png, :tempfile #object[java.io.File 0x1fa87a69 /var/folders/jl/49spzkdd2v3cdz37fgmp0ddr6cj76v/T/ring-multipart-7475320541688143884.tmp], :size 1669}}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>> authorize::handler-key >> :upload
>myprint>  authEnt? {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>myprint>  txn #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.pool.HikariProxyConnection 0x14c80450 HikariProxyConnection@348652624 wrapping org.postgresql.jdbc.PgConnection@6f737354], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
2023-12-12T11:31:31.595Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:31.595Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:31:31.596Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>myprint>  admin true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:31.596Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> inspector? {:result false}
>myprint>  inspector false
>o> viewer? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:31.597Z NX-41294 DEBUG [leihs.procurement.permissions.user:85] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> viewer? {:result false}
>myprint>  viewer false
>o> requester?? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:31:31.597Z NX-41294 DEBUG [leihs.procurement.permissions.user:169] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> requester?? {:exists false}
2023-12-12T11:31:31.597Z NX-41294 DEBUG [leihs.procurement.permissions.user:173] - (:exists result) => false
>myprint>  requester false

> 1 anti-csrf-token >  219b97e6-bb13-401e-92a7-2304bf206106

> 1 anti-csrf-token class >  java.lang.String

> 2 anti-csrf-token-new >  nil
>o> m {:filename thx.png, :content-type image/png, :size 1669, :content iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAGTElEQVR4nO2d63HjNhDHkcw1wBZY
Qngl2CUoJUgF5INcgvUhBVglRCWcSghTgkoIS0iGM4AOhkEC+wAJUf/fjOZsHQHjsdhdLB40AAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGrll3u5/vlzrSI2xpjWGNMT
0rwEv49pB8Xy7Oy/46czxlzt/12J5VwaV17jlfkrv/1x/+obs4G6yHdt5nPhdz43Y8zFGHO2P4e8
G2P2Np+Qk/1wBaHx8g/xBW5s2LeKBKG1Zd5F+iDVnrMaoLEZd7YBYo1ekjfboY6xc46JvzdW9ndG
mcY6/iDUcRSy1wqE4GjbJYeTbdNPGuDXSMLGZvyvzXy3QueboMNfMjrf2LLmPOfTEDvfMNKMA+lv
Y8x/wecjMmpz+SB0vrHt8hF+GQpAaytGybgk754myoXyrGsYjoDnluvDfmKmzwnGnFmcypNaT/f3
PqXzBcBJNbUwpensyM6lJXYoJe+QlLY5ZnQUtd13zM7309/xBWAvUEcl4ZQptzFbYZ1TTm1uR435
/JUpuKra2ReAcGpVCyX9Dw2BnysfJf82Q2Binr6ImBNYE7XPu01CA1CnpCl/RKL6HZ/as2YBGOy0
pTafhMJ0MCbOnGP5oqSlL/4vvgBQC1uSMXDx/QFGfwpOm05pAer0NsYlbFM/EngWTIm4XO1Id6Hc
W2WCKOUSm3sncBHJg/dYqzD6h3sgyONb8MArIyhCoffCqLn2scaZic9cPQY7sKi2e28jdy58qzH6
T7FwcOgD9Fb1lhqFjTfqcyk5DdRYQIrG2D3OzHxdp+fMDlJcg7D6ndhi0M1qArcG0AUaoffU9g9i
QWobzUv4GL39UJ1ZpwWko38IzMkn5lYD+w04YbVwZvgCxvoCUtt/mNNStccBzINPAx0XprmRLsRd
wmlfiEQAluqY0rOSlA3XYEh1RKG/Oan6HRIB4HbMGkvLcywhAGbKCSvIIUfrrGECKJqjNmGRsGSM
45SrcWr3AR7B/lM0yBJm4EbRNhIBqD1Ak4t0VFIE4Ky4eXWKLNXvWMMHeHZK+gInqkBv1QTUbDpK
mYE+FutPUbsTyKVm7XQrJATJKV8MmIB1op3aAsA+p1B7IGirfsZFMf7QS/wKTAPXg7tK6DMwD8Lc
eYS1gNJIRqIkrYYARNf4KWzVCaSwlgAMQiEYNKaUEgHgLlNS7PpWgk1TSJxB6ompKLWbgK0LgNQR
FO/hfGYfYGw4t9V6qRXBEOluH/F2Mc79AI+Av4u28/5tFI6DafGidNDjKFlj4AqAxJHLbXzJVqiW
sV9xaTR2+hrPF2A5hFwTILE7W7frOeyVz2KyfQHEAWRwfIdGcfT7ebLMSc0C8AiagiMApY7hs7QA
VwCW6JwtrgO0BUa/o+HcHbCGD6CR/lEpffaSrF3WMgFbXuSZQmval4KkYWr2AWq9sYRLKdUfQtIC
a5mAZ0N72pciW9i4AvCMKpxLiWlfin1uH9UcCpZqmX5mtW2ITOE4kcOc8Otat6+921Pes6wlAF3G
9mWplnlb4CROKg6wxuh3uIWu2TZAJLAs7wJNpnGAJCl8XAHYmoduCmiLTjjtIx/yiJC8WaxWDbAF
J1Nyo6fbLqZximhWC9QqAI8+zdwJtaS7UELjosxZLYBI4E80D21K7/M9T/zMZfJ6mrUEoMYRrnVC
SDrtC0f95Ns+CLRTt6KvJQBr7cHTJlYP6bQvFrvQ0AIQgAKE9eiEo3/qrIDGvQKqAvAIHUhtMA0f
QOrbTI10lUMgMeHkCoB0fpqyt9L8B4ZN1xBqqW8zp+o1tMCX8nEFQCKNQ2YHS5wyjgBR08TKJz0r
OJdeqgWig0JiAriFyU0ncXy4aSnpYs4a9R5kR27nZt/+NZH2CxIn8I3R0JTo1plZWckiUO6LJ/uJ
umddzhhJ80rQHgeGdpwqr3gWcCDcS3NiNA61siehmrxl3LKVeuZC6NAb4wWUTmBy63m1z0fLq/Xu
4HYm/HlVuBHjmNhQeVVaPHG0E5sqrkRnzLVJ6+XV27aYHJXEcu4iN7q7ssZDyd6bQ2t4eTQFV9HO
29Sh+eLo58ATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA9WOM+R9FIkVy
7JSO3AAAAABJRU5ErkJggg==, :metadata :json, :exiftool_version 12.70, :exiftool_options -j -s -a -u -G1}
>o> :metadata :json
2023-12-12T11:31:31.728Z NX-41294 DEBUG [leihs.procurement.resources.upload:92] - m => {:filename "thx.png", :content-type "image/png", :size 1669, :content "iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAGTElEQVR4nO2d63HjNhDHkcw1wBZY\r\nQngl2CUoJUgF5INcgvUhBVglRCWcSghTgkoIS0iGM4AOhkEC+wAJUf/fjOZsHQHjsdhdLB40AAAA\r\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGrll3u5/vlzrSI2xpjWGNMT\r\n0rwEv49pB8Xy7Oy/46czxlzt/12J5VwaV17jlfkrv/1x/+obs4G6yHdt5nPhdz43Y8zFGHO2P4e8\r\nG2P2Np+Qk/1wBaHx8g/xBW5s2LeKBKG1Zd5F+iDVnrMaoLEZd7YBYo1ekjfboY6xc46JvzdW9ndG\r\nmcY6/iDUcRSy1wqE4GjbJYeTbdNPGuDXSMLGZvyvzXy3QueboMNfMjrf2LLmPOfTEDvfMNKMA+lv\r\nY8x/wecjMmpz+SB0vrHt8hF+GQpAaytGybgk754myoXyrGsYjoDnluvDfmKmzwnGnFmcypNaT/f3\r\nPqXzBcBJNbUwpensyM6lJXYoJe+QlLY5ZnQUtd13zM7309/xBWAvUEcl4ZQptzFbYZ1TTm1uR435\r\n/JUpuKra2ReAcGpVCyX9Dw2BnysfJf82Q2Binr6ImBNYE7XPu01CA1CnpCl/RKL6HZ/as2YBGOy0\r\npTafhMJ0MCbOnGP5oqSlL/4vvgBQC1uSMXDx/QFGfwpOm05pAer0NsYlbFM/EngWTIm4XO1Id6Hc\r\nW2WCKOUSm3sncBHJg/dYqzD6h3sgyONb8MArIyhCoffCqLn2scaZic9cPQY7sKi2e28jdy58qzH6\r\nT7FwcOgD9Fb1lhqFjTfqcyk5DdRYQIrG2D3OzHxdp+fMDlJcg7D6ndhi0M1qArcG0AUaoffU9g9i\r\nQWobzUv4GL39UJ1ZpwWko38IzMkn5lYD+w04YbVwZvgCxvoCUtt/mNNStccBzINPAx0XprmRLsRd\r\nwmlfiEQAluqY0rOSlA3XYEh1RKG/Oan6HRIB4HbMGkvLcywhAGbKCSvIIUfrrGECKJqjNmGRsGSM\r\n45SrcWr3AR7B/lM0yBJm4EbRNhIBqD1Ak4t0VFIE4Ky4eXWKLNXvWMMHeHZK+gInqkBv1QTUbDpK\r\nmYE+FutPUbsTyKVm7XQrJATJKV8MmIB1op3aAsA+p1B7IGirfsZFMf7QS/wKTAPXg7tK6DMwD8Lc\r\neYS1gNJIRqIkrYYARNf4KWzVCaSwlgAMQiEYNKaUEgHgLlNS7PpWgk1TSJxB6ompKLWbgK0LgNQR\r\nFO/hfGYfYGw4t9V6qRXBEOluH/F2Mc79AI+Av4u28/5tFI6DafGidNDjKFlj4AqAxJHLbXzJVqiW\r\nsV9xaTR2+hrPF2A5hFwTILE7W7frOeyVz2KyfQHEAWRwfIdGcfT7ebLMSc0C8AiagiMApY7hs7QA\r\nVwCW6JwtrgO0BUa/o+HcHbCGD6CR/lEpffaSrF3WMgFbXuSZQmval4KkYWr2AWq9sYRLKdUfQtIC\r\na5mAZ0N72pciW9i4AvCMKpxLiWlfin1uH9UcCpZqmX5mtW2ITOE4kcOc8Otat6+921Pes6wlAF3G\r\n9mWplnlb4CROKg6wxuh3uIWu2TZAJLAs7wJNpnGAJCl8XAHYmoduCmiLTjjtIx/yiJC8WaxWDbAF\r\nJ1Nyo6fbLqZximhWC9QqAI8+zdwJtaS7UELjosxZLYBI4E80D21K7/M9T/zMZfJ6mrUEoMYRrnVC\r\nSDrtC0f95Ns+CLRTt6KvJQBr7cHTJlYP6bQvFrvQ0AIQgAKE9eiEo3/qrIDGvQKqAvAIHUhtMA0f\r\nQOrbTI10lUMgMeHkCoB0fpqyt9L8B4ZN1xBqqW8zp+o1tMCX8nEFQCKNQ2YHS5wyjgBR08TKJz0r\r\nOJdeqgWig0JiAriFyU0ncXy4aSnpYs4a9R5kR27nZt/+NZH2CxIn8I3R0JTo1plZWckiUO6LJ/uJ\r\numddzhhJ80rQHgeGdpwqr3gWcCDcS3NiNA61siehmrxl3LKVeuZC6NAb4wWUTmBy63m1z0fLq/Xu\r\n4HYm/HlVuBHjmNhQeVVaPHG0E5sqrkRnzLVJ6+XV27aYHJXEcu4iN7q7ssZDyd6bQ2t4eTQFV9HO\r\n29Sh+eLo58ATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA9WOM+R9FIkVy\r\n7JSO3AAAAABJRU5ErkJggg==", :metadata :json, :exiftool_version "12.70", :exiftool_options "-j -s -a -u -G1"}
2023-12-12T11:31:31.731Z NX-41294 DEBUG [leihs.procurement.resources.upload:?] - (sql-format (sql/values (sql/insert-into :procurement_uploads) [(spy m)])) => ["INSERT INTO procurement_uploads (filename, content_type, size, content, metadata, exiftool_version, exiftool_options) VALUES (?, ?, ?, ?, json, ?, ?)" "thx.png" "image/png" 1669 "iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAGTElEQVR4nO2d63HjNhDHkcw1wBZY\r\nQngl2CUoJUgF5INcgvUhBVglRCWcSghTgkoIS0iGM4AOhkEC+wAJUf/fjOZsHQHjsdhdLB40AAAA\r\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGrll3u5/vlzrSI2xpjWGNMT\r\n0rwEv49pB8Xy7Oy/46czxlzt/12J5VwaV17jlfkrv/1x/+obs4G6yHdt5nPhdz43Y8zFGHO2P4e8\r\nG2P2Np+Qk/1wBaHx8g/xBW5s2LeKBKG1Zd5F+iDVnrMaoLEZd7YBYo1ekjfboY6xc46JvzdW9ndG\r\nmcY6/iDUcRSy1wqE4GjbJYeTbdNPGuDXSMLGZvyvzXy3QueboMNfMjrf2LLmPOfTEDvfMNKMA+lv\r\nY8x/wecjMmpz+SB0vrHt8hF+GQpAaytGybgk754myoXyrGsYjoDnluvDfmKmzwnGnFmcypNaT/f3\r\nPqXzBcBJNbUwpensyM6lJXYoJe+QlLY5ZnQUtd13zM7309/xBWAvUEcl4ZQptzFbYZ1TTm1uR435\r\n/JUpuKra2ReAcGpVCyX9Dw2BnysfJf82Q2Binr6ImBNYE7XPu01CA1CnpCl/RKL6HZ/as2YBGOy0\r\npTafhMJ0MCbOnGP5oqSlL/4vvgBQC1uSMXDx/QFGfwpOm05pAer0NsYlbFM/EngWTIm4XO1Id6Hc\r\nW2WCKOUSm3sncBHJg/dYqzD6h3sgyONb8MArIyhCoffCqLn2scaZic9cPQY7sKi2e28jdy58qzH6\r\nT7FwcOgD9Fb1lhqFjTfqcyk5DdRYQIrG2D3OzHxdp+fMDlJcg7D6ndhi0M1qArcG0AUaoffU9g9i\r\nQWobzUv4GL39UJ1ZpwWko38IzMkn5lYD+w04YbVwZvgCxvoCUtt/mNNStccBzINPAx0XprmRLsRd\r\nwmlfiEQAluqY0rOSlA3XYEh1RKG/Oan6HRIB4HbMGkvLcywhAGbKCSvIIUfrrGECKJqjNmGRsGSM\r\n45SrcWr3AR7B/lM0yBJm4EbRNhIBqD1Ak4t0VFIE4Ky4eXWKLNXvWMMHeHZK+gInqkBv1QTUbDpK\r\nmYE+FutPUbsTyKVm7XQrJATJKV8MmIB1op3aAsA+p1B7IGirfsZFMf7QS/wKTAPXg7tK6DMwD8Lc\r\neYS1gNJIRqIkrYYARNf4KWzVCaSwlgAMQiEYNKaUEgHgLlNS7PpWgk1TSJxB6ompKLWbgK0LgNQR\r\nFO/hfGYfYGw4t9V6qRXBEOluH/F2Mc79AI+Av4u28/5tFI6DafGidNDjKFlj4AqAxJHLbXzJVqiW\r\nsV9xaTR2+hrPF2A5hFwTILE7W7frOeyVz2KyfQHEAWRwfIdGcfT7ebLMSc0C8AiagiMApY7hs7QA\r\nVwCW6JwtrgO0BUa/o+HcHbCGD6CR/lEpffaSrF3WMgFbXuSZQmval4KkYWr2AWq9sYRLKdUfQtIC\r\na5mAZ0N72pciW9i4AvCMKpxLiWlfin1uH9UcCpZqmX5mtW2ITOE4kcOc8Otat6+921Pes6wlAF3G\r\n9mWplnlb4CROKg6wxuh3uIWu2TZAJLAs7wJNpnGAJCl8XAHYmoduCmiLTjjtIx/yiJC8WaxWDbAF\r\nJ1Nyo6fbLqZximhWC9QqAI8+zdwJtaS7UELjosxZLYBI4E80D21K7/M9T/zMZfJ6mrUEoMYRrnVC\r\nSDrtC0f95Ns+CLRTt6KvJQBr7cHTJlYP6bQvFrvQ0AIQgAKE9eiEo3/qrIDGvQKqAvAIHUhtMA0f\r\nQOrbTI10lUMgMeHkCoB0fpqyt9L8B4ZN1xBqqW8zp+o1tMCX8nEFQCKNQ2YHS5wyjgBR08TKJz0r\r\nOJdeqgWig0JiAriFyU0ncXy4aSnpYs4a9R5kR27nZt/+NZH2CxIn8I3R0JTo1plZWckiUO6LJ/uJ\r\numddzhhJ80rQHgeGdpwqr3gWcCDcS3NiNA61siehmrxl3LKVeuZC6NAb4wWUTmBy63m1z0fLq/Xu\r\n4HYm/HlVuBHjmNhQeVVaPHG0E5sqrkRnzLVJ6+XV27aYHJXEcu4iN7q7ssZDyd6bQ2t4eTQFV9HO\r\n29Sh+eLo58ATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA9WOM+R9FIkVy\r\n7JSO3AAAAABJRU5ErkJggg==" "12.70" "-j -s -a -u -G1"]
2023-12-12T11:31:31.737Z NX-41294 WARN [leihs.core.db:205] - Rolling back transaction because of  ERROR: column "json" does not exist
  Position: 143
2023-12-12T11:31:31.741Z NX-41294 WARN [leihs.procurement.utils.ring-exception:326] -   THROWABLE: org.postgresql.util.PSQLException: ERROR: column "json" does not exist
  Position: 143
2023-12-12T11:31:31.742Z NX-41294 DEBUG [leihs.procurement.utils.ring-exception:326] - #error {
 :cause ERROR: column "json" does not exist
  Position: 143
 :via
 [{:type org.postgresql.util.PSQLException
   :message ERROR: column "json" does not exist
  Position: 143
   :at [org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse QueryExecutorImpl.java 2533]}]
 :trace
 [[org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse QueryExecutorImpl.java 2533]
  [org.postgresql.core.v3.QueryExecutorImpl processResults QueryExecutorImpl.java 2268]
  [org.postgresql.core.v3.QueryExecutorImpl execute QueryExecutorImpl.java 313]
  [org.postgresql.jdbc.PgStatement executeInternal PgStatement.java 448]
  [org.postgresql.jdbc.PgStatement execute PgStatement.java 369]
  [org.postgresql.jdbc.PgPreparedStatement executeWithFlags PgPreparedStatement.java 159]
  [org.postgresql.jdbc.PgPreparedStatement execute PgPreparedStatement.java 148]
  [com.zaxxer.hikari.pool.ProxyPreparedStatement execute ProxyPreparedStatement.java 44]
  [com.zaxxer.hikari.pool.HikariProxyPreparedStatement execute HikariProxyPreparedStatement.java -1]
  [next.jdbc.result_set$stmt__GT_result_set invokeStatic result_set.clj 669]
  [next.jdbc.result_set$stmt__GT_result_set invoke result_set.clj 664]
  [next.jdbc.result_set$eval11828$fn__11836 invoke result_set.clj 897]
  [next.jdbc.protocols$eval10723$fn__10754$G__10714__10763 invoke protocols.clj 34]
  [next.jdbc.default_options$eval11019$fn__11024 invoke default_options.clj 31]
  [next.jdbc.protocols$eval10723$fn__10754$G__10714__10763 invoke protocols.clj 34]
  [next.jdbc$execute_BANG_ invokeStatic jdbc.clj 251]
  [next.jdbc$execute_BANG_ invoke jdbc.clj 238]
  [leihs.procurement.resources.upload$insert_file_upload_BANG_ invokeStatic upload.clj 90]
  [leihs.procurement.resources.upload$insert_file_upload_BANG_ invoke upload.clj 81]
  [leihs.procurement.resources.upload$upload invokeStatic upload.clj 138]
  [leihs.procurement.resources.upload$upload invoke upload.clj 131]
  [compojure.response$eval26095$fn__26096 invoke response.clj 47]
  [compojure.response$eval26017$fn__26018$G__26008__26025 invoke response.clj 7]
  [compojure.response$eval26103$fn__26104 invoke response.clj 51]
  [compojure.response$eval26017$fn__26018$G__26008__26025 invoke response.clj 7]
  [compojure.core$wrap_response$fn__27938 invoke core.clj 158]
  [compojure.core$wrap_route_middleware$fn__27922 invoke core.clj 128]
  [compojure.core$wrap_route_info$fn__27927 invoke core.clj 137]
  [compojure.core$wrap_route_matches$fn__27931 invoke core.clj 146]
  [compojure.core$routing$fn__27946 invoke core.clj 185]
  [clojure.core$some invokeStatic core.clj 2705]
  [clojure.core$some invoke core.clj 2696]
  [compojure.core$routing invokeStatic core.clj 185]
  [compojure.core$routing doInvoke core.clj 182]
  [clojure.lang.RestFn applyTo RestFn.java 139]
  [clojure.core$apply invokeStatic core.clj 669]
  [clojure.core$apply invoke core.clj 662]
  [compojure.core$routes$fn__27950 invoke core.clj 192]
  [leihs.procurement.routes$dispatch_to_handler invokeStatic routes.clj 65]
  [leihs.procurement.routes$dispatch_to_handler invoke routes.clj 62]
  [leihs.core.anti_csrf.back$wrap$fn__45107 invoke back.clj 95]
  [leihs.core.locale$wrap$fn__45159 invoke locale.clj 140]
  [leihs.procurement.authorization$authorize invokeStatic authorization.clj 147]
  [leihs.procurement.authorization$authorize invoke authorization.clj 115]
  [leihs.procurement.authorization$wrap_authorize$fn__39368 invoke authorization.clj 156]
  [leihs.procurement.authorization$authenticate invokeStatic authorization.clj 92]
  [leihs.procurement.authorization$authenticate invoke authorization.clj 85]
  [leihs.procurement.authorization$wrap_authenticate$fn__39360 invoke authorization.clj 111]
  [leihs.core.auth.session$wrap_authenticate$fn__38138 invoke session.clj 93]
  [ring.middleware.cookies$wrap_cookies$fn__48441 invoke cookies.clj 214]
  [leihs.core.settings$wrap invokeStatic settings.clj 47]
  [leihs.core.settings$wrap invoke settings.clj 42]
  [leihs.core.settings$wrap$fn__46230 invoke settings.clj 45]
  [leihs.core.status$wrap$fn__28078 invoke status.clj 78]
  [leihs.core.db$wrap_tx$fn__25321$fn__25322$fn__25323 invoke db.clj 191]
  [next.jdbc.transaction$transact_STAR_ invokeStatic transaction.clj 72]
  [next.jdbc.transaction$transact_STAR_ invoke transaction.clj 51]
  [next.jdbc.transaction$eval12027$fn__12028 invoke transaction.clj 141]
  [next.jdbc.protocols$eval10813$fn__10814$G__10804__10823 invoke protocols.clj 58]
  [next.jdbc.default_options$eval11031$fn__11032 invoke default_options.clj 43]
  [next.jdbc.protocols$eval10813$fn__10814$G__10804__10823 invoke protocols.clj 58]
  [next.jdbc$transact invokeStatic jdbc.clj 420]
  [next.jdbc$transact invoke jdbc.clj 412]
  [leihs.core.db$wrap_tx$fn__25321$fn__25322 invoke db.clj 187]
  [clojure.java.jdbc$db_transaction_STAR_ invokeStatic jdbc.clj 807]
  [clojure.java.jdbc$db_transaction_STAR_ invoke jdbc.clj 776]
  [clojure.java.jdbc$db_transaction_STAR_ invokeStatic jdbc.clj 852]
  [clojure.java.jdbc$db_transaction_STAR_ invoke jdbc.clj 776]
  [clojure.java.jdbc$db_transaction_STAR_ invokeStatic jdbc.clj 789]
  [clojure.java.jdbc$db_transaction_STAR_ invoke jdbc.clj 776]
  [leihs.core.db$wrap_tx$fn__25321 invoke db.clj 186]
  [ring.middleware.json$wrap_json_response$fn__48607 invoke json.clj 143]
  [ring.middleware.json$wrap_json_body$fn__48556 invoke json.clj 60]
  [leihs.procurement.routes$wrap_empty$fn__49352 invoke routes.clj 97]
  [leihs.core.graphql$wrap_with_schema$fn__17899 invoke graphql.clj 80]
  [leihs.core.routing.back$wrap_canonicalize_params_maps$fn__47806 invoke back.clj 74]
  [ring.middleware.params$wrap_params$fn__48772 invoke params.clj 75]
  [ring.middleware.multipart_params$handle_request_and_errors$fn__48729$fn__48730 invoke multipart_params.clj 135]
  [ring.middleware.multipart_params$handle_request_and_errors invokeStatic multipart_params.clj 133]
  [ring.middleware.multipart_params$handle_request_and_errors invoke multipart_params.clj 132]
  [ring.middleware.multipart_params$wrap_multipart_params$fn__48735 invoke multipart_params.clj 187]
  [leihs.core.http_cache_buster2$wrap_resource$fn__45528 invoke http_cache_buster2.clj 117]
  [leihs.procurement.routes$wrap_rewrite_uri_for_static_paths$fn__49359 invoke routes.clj 116]
  [leihs.procurement.routes$wrap_resolve_handler invokeStatic routes.clj 90]
  [leihs.procurement.routes$wrap_resolve_handler invoke routes.clj 82]
  [leihs.procurement.routes$wrap_resolve_handler$fn__49347 invoke routes.clj 83]
  [ring.middleware.accept$wrap_accept$fn__48242 invoke accept.clj 125]
  [ring.middleware.content_type$wrap_content_type$fn__47496 invoke content_type.clj 34]
  [leihs.procurement.utils.ring_exception$wrap$fn__45335 invoke ring_exception.clj 22]
  [org.httpkit.server.HttpHandler run RingHandler.java 123]
  [java.util.concurrent.Executors$RunnableAdapter call Executors.java 515]
  [java.util.concurrent.FutureTask run FutureTask.java 264]
  [java.util.concurrent.ThreadPoolExecutor runWorker ThreadPoolExecutor.java 1128]
  [java.util.concurrent.ThreadPoolExecutor$Worker run ThreadPoolExecutor.java 628]
  [java.lang.Thread run Thread.java 829]]}
error #error {
 :cause ERROR: column "json" does not exist
  Position: 143
 :via
 [{:type org.postgresql.util.PSQLException
   :message ERROR: column "json" does not exist
  Position: 143
   :at [org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse QueryExecutorImpl.java 2533]}]
 :trace
 [[org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse QueryExecutorImpl.java 2533]
  [org.postgresql.core.v3.QueryExecutorImpl processResults QueryExecutorImpl.java 2268]
  [org.postgresql.core.v3.QueryExecutorImpl execute QueryExecutorImpl.java 313]
  [org.postgresql.jdbc.PgStatement executeInternal PgStatement.java 448]
  [org.postgresql.jdbc.PgStatement execute PgStatement.java 369]
  [org.postgresql.jdbc.PgPreparedStatement executeWithFlags PgPreparedStatement.java 159]
  [org.postgresql.jdbc.PgPreparedStatement execute PgPreparedStatement.java 148]
  [com.zaxxer.hikari.pool.ProxyPreparedStatement execute ProxyPreparedStatement.java 44]
  [com.zaxxer.hikari.pool.HikariProxyPreparedStatement execute HikariProxyPreparedStatement.java -1]
  [next.jdbc.result_set$stmt__GT_result_set invokeStatic result_set.clj 669]
  [next.jdbc.result_set$stmt__GT_result_set invoke result_set.clj 664]
  [next.jdbc.result_set$eval11828$fn__11836 invoke result_set.clj 897]
  [next.jdbc.protocols$eval10723$fn__10754$G__10714__10763 invoke protocols.clj 34]
  [next.jdbc.default_options$eval11019$fn__11024 invoke default_options.clj 31]
  [next.jdbc.protocols$eval10723$fn__10754$G__10714__10763 invoke protocols.clj 34]
  [next.jdbc$execute_BANG_ invokeStatic jdbc.clj 251]
  [next.jdbc$execute_BANG_ invoke jdbc.clj 238]
  [leihs.procurement.resources.upload$insert_file_upload_BANG_ invokeStatic upload.clj 90]
  [leihs.procurement.resources.upload$insert_file_upload_BANG_ invoke upload.clj 81]
  [leihs.procurement.resources.upload$upload invokeStatic upload.clj 138]
  [leihs.procurement.resources.upload$upload invoke upload.clj 131]
  [compojure.response$eval26095$fn__26096 invoke response.clj 47]
  [compojure.response$eval26017$fn__26018$G__26008__26025 invoke response.clj 7]
  [compojure.response$eval26103$fn__26104 invoke response.clj 51]
  [compojure.response$eval26017$fn__26018$G__26008__26025 invoke response.clj 7]
  [compojure.core$wrap_response$fn__27938 invoke core.clj 158]
  [compojure.core$wrap_route_middleware$fn__27922 invoke core.clj 128]
  [compojure.core$wrap_route_info$fn__27927 invoke core.clj 137]
  [compojure.core$wrap_route_matches$fn__27931 invoke core.clj 146]
  [compojure.core$routing$fn__27946 invoke core.clj 185]
  [clojure.core$some invokeStatic core.clj 2705]
  [clojure.core$some invoke core.clj 2696]
  [compojure.core$routing invokeStatic core.clj 185]
  [compojure.core$routing doInvoke core.clj 182]
  [clojure.lang.RestFn applyTo RestFn.java 139]
  [clojure.core$apply invokeStatic core.clj 669]
  [clojure.core$apply invoke core.clj 662]
  [compojure.core$routes$fn__27950 invoke core.clj 192]
  [leihs.procurement.routes$dispatch_to_handler invokeStatic routes.clj 65]
  [leihs.procurement.routes$dispatch_to_handler invoke routes.clj 62]
  [leihs.core.anti_csrf.back$wrap$fn__45107 invoke back.clj 95]
  [leihs.core.locale$wrap$fn__45159 invoke locale.clj 140]
  [leihs.procurement.authorization$authorize invokeStatic authorization.clj 147]
  [leihs.procurement.authorization$authorize invoke authorization.clj 115]
  [leihs.procurement.authorization$wrap_authorize$fn__39368 invoke authorization.clj 156]
  [leihs.procurement.authorization$authenticate invokeStatic authorization.clj 92]
  [leihs.procurement.authorization$authenticate invoke authorization.clj 85]
  [leihs.procurement.authorization$wrap_authenticate$fn__39360 invoke authorization.clj 111]
  [leihs.core.auth.session$wrap_authenticate$fn__38138 invoke session.clj 93]
  [ring.middleware.cookies$wrap_cookies$fn__48441 invoke cookies.clj 214]
  [leihs.core.settings$wrap invokeStatic settings.clj 47]
  [leihs.core.settings$wrap invoke settings.clj 42]
  [leihs.core.settings$wrap$fn__46230 invoke settings.clj 45]
  [leihs.core.status$wrap$fn__28078 invoke status.clj 78]
  [leihs.core.db$wrap_tx$fn__25321$fn__25322$fn__25323 invoke db.clj 191]
  [next.jdbc.transaction$transact_STAR_ invokeStatic transaction.clj 72]
  [next.jdbc.transaction$transact_STAR_ invoke transaction.clj 51]
  [next.jdbc.transaction$eval12027$fn__12028 invoke transaction.clj 141]
  [next.jdbc.protocols$eval10813$fn__10814$G__10804__10823 invoke protocols.clj 58]
  [next.jdbc.default_options$eval11031$fn__11032 invoke default_options.clj 43]
  [next.jdbc.protocols$eval10813$fn__10814$G__10804__10823 invoke protocols.clj 58]
  [next.jdbc$transact invokeStatic jdbc.clj 420]
  [next.jdbc$transact invoke jdbc.clj 412]
  [leihs.core.db$wrap_tx$fn__25321$fn__25322 invoke db.clj 187]
  [clojure.java.jdbc$db_transaction_STAR_ invokeStatic jdbc.clj 807]
  [clojure.java.jdbc$db_transaction_STAR_ invoke jdbc.clj 776]
  [clojure.java.jdbc$db_transaction_STAR_ invokeStatic jdbc.clj 852]
  [clojure.java.jdbc$db_transaction_STAR_ invoke jdbc.clj 776]
  [clojure.java.jdbc$db_transaction_STAR_ invokeStatic jdbc.clj 789]
  [clojure.java.jdbc$db_transaction_STAR_ invoke jdbc.clj 776]
  [leihs.core.db$wrap_tx$fn__25321 invoke db.clj 186]
  [ring.middleware.json$wrap_json_response$fn__48607 invoke json.clj 143]
  [ring.middleware.json$wrap_json_body$fn__48556 invoke json.clj 60]
  [leihs.procurement.routes$wrap_empty$fn__49352 invoke routes.clj 97]
  [leihs.core.graphql$wrap_with_schema$fn__17899 invoke graphql.clj 80]
  [leihs.core.routing.back$wrap_canonicalize_params_maps$fn__47806 invoke back.clj 74]
  [ring.middleware.params$wrap_params$fn__48772 invoke params.clj 75]
  [ring.middleware.multipart_params$handle_request_and_errors$fn__48729$fn__48730 invoke multipart_params.clj 135]
  [ring.middleware.multipart_params$handle_request_and_errors invokeStatic multipart_params.clj 133]
  [ring.middleware.multipart_params$handle_request_and_errors invoke multipart_params.clj 132]
  [ring.middleware.multipart_params$wrap_multipart_params$fn__48735 invoke multipart_params.clj 187]
  [leihs.core.http_cache_buster2$wrap_resource$fn__45528 invoke http_cache_buster2.clj 117]
  [leihs.procurement.routes$wrap_rewrite_uri_for_static_paths$fn__49359 invoke routes.clj 116]
  [leihs.procurement.routes$wrap_resolve_handler invokeStatic routes.clj 90]
  [leihs.procurement.routes$wrap_resolve_handler invoke routes.clj 82]
  [leihs.procurement.routes$wrap_resolve_handler$fn__49347 invoke routes.clj 83]
  [ring.middleware.accept$wrap_accept$fn__48242 invoke accept.clj 125]
  [ring.middleware.content_type$wrap_content_type$fn__47496 invoke content_type.clj 34]
  [leihs.procurement.utils.ring_exception$wrap$fn__45335 invoke ring_exception.clj 22]
  [org.httpkit.server.HttpHandler run RingHandler.java 123]
  [java.util.concurrent.Executors$RunnableAdapter call Executors.java 515]
  [java.util.concurrent.FutureTask run FutureTask.java 264]
  [java.util.concurrent.ThreadPoolExecutor runWorker ThreadPoolExecutor.java 1128]
  [java.util.concurrent.ThreadPoolExecutor$Worker run ThreadPoolExecutor.java 628]
  [java.lang.Thread run Thread.java 829]]}
error2 #error {
 :cause ERROR: column "json" does not exist
  Position: 143
 :via
 [{:type org.postgresql.util.PSQLException
   :message ERROR: column "json" does not exist
  Position: 143
   :at [org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse QueryExecutorImpl.java 2533]}]
 :trace
 [[org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse QueryExecutorImpl.java 2533]
  [org.postgresql.core.v3.QueryExecutorImpl processResults QueryExecutorImpl.java 2268]
  [org.postgresql.core.v3.QueryExecutorImpl execute QueryExecutorImpl.java 313]
  [org.postgresql.jdbc.PgStatement executeInternal PgStatement.java 448]
  [org.postgresql.jdbc.PgStatement execute PgStatement.java 369]
  [org.postgresql.jdbc.PgPreparedStatement executeWithFlags PgPreparedStatement.java 159]
  [org.postgresql.jdbc.PgPreparedStatement execute PgPreparedStatement.java 148]
  [com.zaxxer.hikari.pool.ProxyPreparedStatement execute ProxyPreparedStatement.java 44]
  [com.zaxxer.hikari.pool.HikariProxyPreparedStatement execute HikariProxyPreparedStatement.java -1]
  [next.jdbc.result_set$stmt__GT_result_set invokeStatic result_set.clj 669]
  [next.jdbc.result_set$stmt__GT_result_set invoke result_set.clj 664]
  [next.jdbc.result_set$eval11828$fn__11836 invoke result_set.clj 897]
  [next.jdbc.protocols$eval10723$fn__10754$G__10714__10763 invoke protocols.clj 34]
  [next.jdbc.default_options$eval11019$fn__11024 invoke default_options.clj 31]
  [next.jdbc.protocols$eval10723$fn__10754$G__10714__10763 invoke protocols.clj 34]
  [next.jdbc$execute_BANG_ invokeStatic jdbc.clj 251]
  [next.jdbc$execute_BANG_ invoke jdbc.clj 238]
  [leihs.procurement.resources.upload$insert_file_upload_BANG_ invokeStatic upload.clj 90]
  [leihs.procurement.resources.upload$insert_file_upload_BANG_ invoke upload.clj 81]
  [leihs.procurement.resources.upload$upload invokeStatic upload.clj 138]
  [leihs.procurement.resources.upload$upload invoke upload.clj 131]
  [compojure.response$eval26095$fn__26096 invoke response.clj 47]
  [compojure.response$eval26017$fn__26018$G__26008__26025 invoke response.clj 7]
  [compojure.response$eval26103$fn__26104 invoke response.clj 51]
  [compojure.response$eval26017$fn__26018$G__26008__26025 invoke response.clj 7]
  [compojure.core$wrap_response$fn__27938 invoke core.clj 158]
  [compojure.core$wrap_route_middleware$fn__27922 invoke core.clj 128]
  [compojure.core$wrap_route_info$fn__27927 invoke core.clj 137]
  [compojure.core$wrap_route_matches$fn__27931 invoke core.clj 146]
  [compojure.core$routing$fn__27946 invoke core.clj 185]
  [clojure.core$some invokeStatic core.clj 2705]
  [clojure.core$some invoke core.clj 2696]
  [compojure.core$routing invokeStatic core.clj 185]
  [compojure.core$routing doInvoke core.clj 182]
  [clojure.lang.RestFn applyTo RestFn.java 139]
  [clojure.core$apply invokeStatic core.clj 669]
  [clojure.core$apply invoke core.clj 662]
  [compojure.core$routes$fn__27950 invoke core.clj 192]
  [leihs.procurement.routes$dispatch_to_handler invokeStatic routes.clj 65]
  [leihs.procurement.routes$dispatch_to_handler invoke routes.clj 62]
  [leihs.core.anti_csrf.back$wrap$fn__45107 invoke back.clj 95]
  [leihs.core.locale$wrap$fn__45159 invoke locale.clj 140]
  [leihs.procurement.authorization$authorize invokeStatic authorization.clj 147]
  [leihs.procurement.authorization$authorize invoke authorization.clj 115]
  [leihs.procurement.authorization$wrap_authorize$fn__39368 invoke authorization.clj 156]
  [leihs.procurement.authorization$authenticate invokeStatic authorization.clj 92]
  [leihs.procurement.authorization$authenticate invoke authorization.clj 85]
  [leihs.procurement.authorization$wrap_authenticate$fn__39360 invoke authorization.clj 111]
  [leihs.core.auth.session$wrap_authenticate$fn__38138 invoke session.clj 93]
  [ring.middleware.cookies$wrap_cookies$fn__48441 invoke cookies.clj 214]
  [leihs.core.settings$wrap invokeStatic settings.clj 47]
  [leihs.core.settings$wrap invoke settings.clj 42]
  [leihs.core.settings$wrap$fn__46230 invoke settings.clj 45]
  [leihs.core.status$wrap$fn__28078 invoke status.clj 78]
  [leihs.core.db$wrap_tx$fn__25321$fn__25322$fn__25323 invoke db.clj 191]
  [next.jdbc.transaction$transact_STAR_ invokeStatic transaction.clj 72]
  [next.jdbc.transaction$transact_STAR_ invoke transaction.clj 51]
  [next.jdbc.transaction$eval12027$fn__12028 invoke transaction.clj 141]
  [next.jdbc.protocols$eval10813$fn__10814$G__10804__10823 invoke protocols.clj 58]
  [next.jdbc.default_options$eval11031$fn__11032 invoke default_options.clj 43]
  [next.jdbc.protocols$eval10813$fn__10814$G__10804__10823 invoke protocols.clj 58]
  [next.jdbc$transact invokeStatic jdbc.clj 420]
  [next.jdbc$transact invoke jdbc.clj 412]
  [leihs.core.db$wrap_tx$fn__25321$fn__25322 invoke db.clj 187]
  [clojure.java.jdbc$db_transaction_STAR_ invokeStatic jdbc.clj 807]
  [clojure.java.jdbc$db_transaction_STAR_ invoke jdbc.clj 776]
  [clojure.java.jdbc$db_transaction_STAR_ invokeStatic jdbc.clj 852]
  [clojure.java.jdbc$db_transaction_STAR_ invoke jdbc.clj 776]
  [clojure.java.jdbc$db_transaction_STAR_ invokeStatic jdbc.clj 789]
  [clojure.java.jdbc$db_transaction_STAR_ invoke jdbc.clj 776]
  [leihs.core.db$wrap_tx$fn__25321 invoke db.clj 186]
  [ring.middleware.json$wrap_json_response$fn__48607 invoke json.clj 143]
  [ring.middleware.json$wrap_json_body$fn__48556 invoke json.clj 60]
  [leihs.procurement.routes$wrap_empty$fn__49352 invoke routes.clj 97]
  [leihs.core.graphql$wrap_with_schema$fn__17899 invoke graphql.clj 80]
  [leihs.core.routing.back$wrap_canonicalize_params_maps$fn__47806 invoke back.clj 74]
  [ring.middleware.params$wrap_params$fn__48772 invoke params.clj 75]
  [ring.middleware.multipart_params$handle_request_and_errors$fn__48729$fn__48730 invoke multipart_params.clj 135]
  [ring.middleware.multipart_params$handle_request_and_errors invokeStatic multipart_params.clj 133]
  [ring.middleware.multipart_params$handle_request_and_errors invoke multipart_params.clj 132]
  [ring.middleware.multipart_params$wrap_multipart_params$fn__48735 invoke multipart_params.clj 187]
  [leihs.core.http_cache_buster2$wrap_resource$fn__45528 invoke http_cache_buster2.clj 117]
  [leihs.procurement.routes$wrap_rewrite_uri_for_static_paths$fn__49359 invoke routes.clj 116]
  [leihs.procurement.routes$wrap_resolve_handler invokeStatic routes.clj 90]
  [leihs.procurement.routes$wrap_resolve_handler invoke routes.clj 82]
  [leihs.procurement.routes$wrap_resolve_handler$fn__49347 invoke routes.clj 83]
  [ring.middleware.accept$wrap_accept$fn__48242 invoke accept.clj 125]
  [ring.middleware.content_type$wrap_content_type$fn__47496 invoke content_type.clj 34]
  [leihs.procurement.utils.ring_exception$wrap$fn__45335 invoke ring_exception.clj 22]
  [org.httpkit.server.HttpHandler run RingHandler.java 123]
  [java.util.concurrent.Executors$RunnableAdapter call Executors.java 515]
  [java.util.concurrent.FutureTask run FutureTask.java 264]
  [java.util.concurrent.ThreadPoolExecutor runWorker ThreadPoolExecutor.java 1128]
  [java.util.concurrent.ThreadPoolExecutor$Worker run ThreadPoolExecutor.java 628]
  [java.lang.Thread run Thread.java 829]]}
>>> authenticate::skip= nil  handler-key= :not-found
>>> authenticate::authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}

>> authorize >

>> authorize::handler > #object[leihs.core.locale$wrap$fn__45159 0x55069a5c leihs.core.locale$wrap$fn__45159@55069a5c]

>> authorize::request > {:authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 219b97e6-bb13-401e-92a7-2304bf206106}, leihs-user-session {:value d429c048-7118-407f-a7a9-b33da6f15b06}}, :remote-addr 127.0.0.1, :start-time 48742090106041, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}, :query-params-raw {}, :route-params nil, :headers {sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, cookie leihs-anti-csrf-token=219b97e6-bb13-401e-92a7-2304bf206106; leihs-user-session=d429c048-7118-407f-a7a9-b33da6f15b06, sec-fetch-user ?1, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/admin/budget-periods, connection keep-alive, upgrade-insecure-requests 1, pragma no-cache, accept text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest document, accept-encoding gzip, deflate, br, sec-fetch-mode navigate, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x6f2dd66c /127.0.0.1:3230<->/127.0.0.1:56137], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x65dc1b71 HikariDataSource (db-pool)]}, :content-length 0, :form-params {}, :websocket? false, :query-params {}, :content-type nil, :form-params-raw {}, :character-encoding utf8, :uri /procure/admin/categories/dda588f4660c573ca2ff944ae93ad42e, :server-name localhost, :handler-key :not-found, :query-string nil, :body nil, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.backend.html$not_found_handler 0x51c7ef79 leihs.procurement.backend.html$not_found_handler@51c7ef79], :multipart-params {}, :scheme :http, :request-method :get, :accept {:mime :html, :charset nil, :encoding nil, :language nil}}

>> authorize::handler-key >> :not-found
>myprint>  authEnt? {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>myprint>  txn #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
2023-12-12T11:43:55.609Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.633Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.634Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>myprint>  admin true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.636Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> inspector? {:result false}
>myprint>  inspector false
>o> viewer? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.637Z NX-41294 DEBUG [leihs.procurement.permissions.user:85] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> viewer? {:result false}
>myprint>  viewer false
>o> requester?? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.638Z NX-41294 DEBUG [leihs.procurement.permissions.user:169] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> requester?? {:exists false}
2023-12-12T11:43:55.639Z NX-41294 DEBUG [leihs.procurement.permissions.user:173] - (:exists result) => false
>myprint>  requester false
2023-12-12T11:43:55.639Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.639Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.640Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.641Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> inspector? {:result false}
>o> viewer? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.642Z NX-41294 DEBUG [leihs.procurement.permissions.user:85] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> viewer? {:result false}
>o> requester?? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.643Z NX-41294 DEBUG [leihs.procurement.permissions.user:169] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> requester?? {:exists false}
2023-12-12T11:43:55.644Z NX-41294 DEBUG [leihs.procurement.permissions.user:173] - (:exists result) => false

> 1 anti-csrf-token >  219b97e6-bb13-401e-92a7-2304bf206106

> 1 anti-csrf-token class >  java.lang.String

> 2 anti-csrf-token-new >  nil
>>> authenticate::skip= nil  handler-key= :graphql
>>> authenticate::authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}

>> authorize >

>> authorize::handler > #object[leihs.core.locale$wrap$fn__45159 0x55069a5c leihs.core.locale$wrap$fn__45159@55069a5c]

>> authorize::request > {:authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 219b97e6-bb13-401e-92a7-2304bf206106}, leihs-user-session {:value d429c048-7118-407f-a7a9-b33da6f15b06}}, :remote-addr 127.0.0.1, :start-time 48742301722416, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type application/json, cookie leihs-anti-csrf-token=219b97e6-bb13-401e-92a7-2304bf206106; leihs-user-session=d429c048-7118-407f-a7a9-b33da6f15b06, content-length 502, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/admin/categories/dda588f4660c573ca2ff944ae93ad42e, connection keep-alive, pragma no-cache, x-csrf-token 219b97e6-bb13-401e-92a7-2304bf206106, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x26f521fc /127.0.0.1:3230<->/127.0.0.1:56143], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x65dc1b71 HikariDataSource (db-pool)]}, :content-length 502, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:operationName me, :variables {}, :query query me {
  current_user {
    navbarProps
    user {
      id
      firstname
      lastname
      permissions {
        isAdmin
        isRequester
        isInspectorForCategories {
          id
          __typename
        }
        isViewerForCategories {
          id
          __typename
        }
        __typename
      }
      __typename
    }
    __typename
  }
  settings {
    contact_url
    __typename
  }
}
}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0xbde374d leihs.procurement.graphql$handler@bde374d], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>> authorize::handler-key >> :graphql
>myprint>  authEnt? {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>myprint>  txn #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
2023-12-12T11:43:55.816Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.816Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.817Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>myprint>  admin true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.817Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> inspector? {:result false}
>myprint>  inspector false
>o> viewer? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.818Z NX-41294 DEBUG [leihs.procurement.permissions.user:85] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> viewer? {:result false}
>myprint>  viewer false
>o> requester?? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.818Z NX-41294 DEBUG [leihs.procurement.permissions.user:169] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> requester?? {:exists false}
2023-12-12T11:43:55.818Z NX-41294 DEBUG [leihs.procurement.permissions.user:173] - (:exists result) => false
>myprint>  requester false
2023-12-12T11:43:55.819Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.819Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.819Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.819Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> inspector? {:result false}
>o> viewer? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.819Z NX-41294 DEBUG [leihs.procurement.permissions.user:85] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> viewer? {:result false}
>o> requester?? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.820Z NX-41294 DEBUG [leihs.procurement.permissions.user:169] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> requester?? {:exists false}
2023-12-12T11:43:55.820Z NX-41294 DEBUG [leihs.procurement.permissions.user:173] - (:exists result) => false

> 1 anti-csrf-token >  219b97e6-bb13-401e-92a7-2304bf206106

> 1 anti-csrf-token class >  java.lang.String

> 2 anti-csrf-token-new >  nil
pure-handler >> 2
2023-12-12T11:43:55.822Z NX-41294 DEBUG [leihs.procurement.graphql:46] - graphql query query me {
  current_user {
    navbarProps
    user {
      id
      firstname
      lastname
      permissions {
        isAdmin
        isRequester
        isInspectorForCategories {
          id
          __typename
        }
        isViewerForCategories {
          id
          __typename
        }
        __typename
      }
      __typename
    }
    __typename
  }
  settings {
    contact_url
    __typename
  }
}
 with variables {}
>oo> vars from graphQL-Requst nil nil nil {}
>>>1 #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"
>oo >tocheck user2
2023-12-12T11:43:55.824Z NX-41294 DEBUG [leihs.procurement.resources.user:85] - id => #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"
>o> >tocheck>
2023-12-12T11:43:55.824Z NX-41294 DEBUG [leihs.procurement.resources.user:?] - (sql-format (sql/where user-base-query [:= :id [:cast id :uuid]])) => ["SELECT id, firstname, lastname FROM users WHERE id = CAST(? AS UUID)" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>>>2 {:id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :firstname Manuel, :lastname Radl}
>>oida>> #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"
2023-12-12T11:43:55.825Z NX-41294 DEBUG [leihs.procurement.resources.saved-filters:19] - (-> (sql/select :*) (sql/from :procurement_users_filters) (sql/where [:= :user_id [:cast user-id :uuid]]) sql-format) => ["SELECT * FROM procurement_users_filters WHERE user_id = CAST(? AS UUID)" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>>>3 nil
2023-12-12T11:43:55.834Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.834Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.835Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> requester?? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.835Z NX-41294 DEBUG [leihs.procurement.permissions.user:169] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> requester?? {:exists false}
2023-12-12T11:43:55.835Z NX-41294 DEBUG [leihs.procurement.permissions.user:173] - (:exists result) => false

>request-grapql _> request {:leihs-user-language {:name Deutsch, :locale de-CH, :default true, :active true}, :authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 219b97e6-bb13-401e-92a7-2304bf206106}, leihs-user-session {:value d429c048-7118-407f-a7a9-b33da6f15b06}}, :remote-addr 127.0.0.1, :start-time 48742301722416, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type application/json, cookie leihs-anti-csrf-token=219b97e6-bb13-401e-92a7-2304bf206106; leihs-user-session=d429c048-7118-407f-a7a9-b33da6f15b06, content-length 502, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/admin/categories/dda588f4660c573ca2ff944ae93ad42e, connection keep-alive, pragma no-cache, x-csrf-token 219b97e6-bb13-401e-92a7-2304bf206106, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x26f521fc /127.0.0.1:3230<->/127.0.0.1:56143], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x65dc1b71 HikariDataSource (db-pool)]}, :content-length 502, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:operationName me, :variables {}, :query query me {
  current_user {
    navbarProps
    user {
      id
      firstname
      lastname
      permissions {
        isAdmin
        isRequester
        isInspectorForCategories {
          id
          __typename
        }
        isViewerForCategories {
          id
          __typename
        }
        __typename
      }
      __typename
    }
    __typename
  }
  settings {
    contact_url
    __typename
  }
}
}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0xbde374d leihs.procurement.graphql$handler@bde374d], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>request-c-grapql _> request (json) {"leihs-user-language":{"name":"Deutsch","locale":"de-CH","default":true,"active":true},"authenticated-entity":{"email":"manuel.radl@zhdk.ch","contracts_count":1,"lastname":"Radl","org_id":"271682","scope_read":true,"is_admin":true,"authentication-method":"session","login":"mradl","scope_system_admin_write":true,"scope_write":true,"firstname":"Manuel","scope_admin_write":true,"user_session_created_at":"2023-12-12T11:17:19.570671Z","id":"a786135f-c159-4618-9dd3-0012ebb3d500","user_session_id":"463ca0ef-36e9-430c-b982-23371c7fc689","scope_system_admin_read":true,"access-rights":[{"role":"customer","inventory_pool_id":"3977012c-ce0e-501f-889b-8715fdb5d83b"},{"role":"customer","inventory_pool_id":"5863967f-9804-4909-a9b7-92254616d6b2"},{"role":"customer","inventory_pool_id":"5dd25b58-fa56-5095-bd97-2696d92c2fb1"},{"role":"customer","inventory_pool_id":"77e88ec8-9ff6-5435-818e-dc902fc631a6"},{"role":"inventory_manager","inventory_pool_id":"8bd16d45-056d-5590-bc7f-12849f034351"},{"role":"inventory_manager","inventory_pool_id":"a02b8163-9a16-5066-b48e-9eb74cf8b791"},{"role":"inventory_manager","inventory_pool_id":"b534b07c-d9bf-4572-840c-0a630b8cd8ed"},{"role":"customer","inventory_pool_id":"fc5a841e-36c6-5dc3-8207-1306c1fb89bf"},{"role":"customer","inventory_pool_id":"ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}],"user_id":"a786135f-c159-4618-9dd3-0012ebb3d500","is_system_admin":true,"external_sign_out_url":null,"language_locale":"de-CH","inventory_pool_roles_count":9,"scope_admin_read":true},"cookies":{"leihs-anti-csrf-token":{"value":"219b97e6-bb13-401e-92a7-2304bf206106"},"leihs-user-session":{"value":"d429c048-7118-407f-a7a9-b33da6f15b06"}},"remote-addr":"127.0.0.1","start-time":48742301722416,"params":{},"settings":{"email_sending_enabled":false,"sessions_max_lifetime_secs":432000,"smtp_default_from_address":"noreply@zhdk.ch","public_image_caching_enabled":true,"sessions_force_secure":false,"deliver_received_order_notifications":false,"external_base_url":"http:\/\/localhost:3200","sessions_force_uniqueness":false,"email_signature":"Das ZHdK-Ausleihe-Team"},"query-params-raw":{},"route-params":null,"headers":{"origin":"http:\/\/localhost:3230","sec-fetch-site":"same-origin","sec-ch-ua-mobile":"?0","host":"localhost:3230","user-agent":"Mozilla\/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit\/537.36 (KHTML, like Gecko) Chrome\/119.0.0.0 Safari\/537.36","content-type":"application\/json","cookie":"leihs-anti-csrf-token=219b97e6-bb13-401e-92a7-2304bf206106; leihs-user-session=d429c048-7118-407f-a7a9-b33da6f15b06","content-length":"502","sec-ch-ua":"\"Google Chrome\";v=\"119\", \"Chromium\";v=\"119\", \"Not?A_Brand\";v=\"24\"","sec-ch-ua-platform":"\"macOS\"","referer":"http:\/\/localhost:3230\/procure\/admin\/categories\/dda588f4660c573ca2ff944ae93ad42e","connection":"keep-alive","pragma":"no-cache","x-csrf-token":"219b97e6-bb13-401e-92a7-2304bf206106","accept":"application\/json","accept-language":"de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7","sec-fetch-dest":"empty","accept-encoding":"gzip, deflate, br","sec-fetch-mode":"cors","cache-control":"no-cache"},"server-port":3230,"params-raw":{},"content-length":502,"form-params":{},"websocket?":false,"query-params":{},"content-type":"application\/json","form-params-raw":{},"character-encoding":"utf8","uri":"\/procure\/graphql","server-name":"localhost","handler-key":"graphql","query-string":null,"body":{"operationName":"me","variables":{},"query":"query me {\n  current_user {\n    navbarProps\n    user {\n      id\n      firstname\n      lastname\n      permissions {\n        isAdmin\n        isRequester\n        isInspectorForCategories {\n          id\n          __typename\n        }\n        isViewerForCategories {\n          id\n          __typename\n        }\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  settings {\n    contact_url\n    __typename\n  }\n}\n"},"multipart-params":{},"scheme":"http","request-method":"post","accept":{"mime":"json","charset":null,"encoding":null,"language":null}}

>request-grapql _> result => {:data #ordered/map ([:current_user #ordered/map ([:navbarProps {"csrfToken":{"value":"219b97e6-bb13-401e-92a7-2304bf206106","name":"csrf-token"},"config":{"appTitle":"leihs","appColor":"gray","me":{"user":{"id":"a786135f-c159-4618-9dd3-0012ebb3d500","firstname":"Manuel","lastname":"Radl","login":"mradl","email":"manuel.radl@zhdk.ch"}},"subApps":{"borrow":true,"admin":true,"procure":false,"manage":[{"name":"Ausleihe Toni-Areal","href":"/manage/8bd16d45-056d-5590-bc7f-12849f034351/daily"},{"name":"AVS-Museum/Ausstellungen","href":"/manage/b534b07c-d9bf-4572-840c-0a630b8cd8ed/daily"},{"name":"Kostüm- und Kleinrequisitenfundus DDK","href":"/manage/a02b8163-9a16-5066-b48e-9eb74cf8b791/daily"}]},"locales":[{"name":"Deutsch","locale":"de-CH","active":true,"isDefault":true,"isSelected":true},{"name":"English","locale":"en-GB","active":true,"isDefault":false,"isSelected":false},{"name":"Castellano","locale":"es","active":true,"isDefault":false,"isSelected":false},{"name":"Züritüütsch","locale":"gsw-CH","active":true,"isDefault":false,"isSelected":false}]}}] [:user #ordered/map ([:id a786135f-c159-4618-9dd3-0012ebb3d500] [:firstname Manuel] [:lastname Radl] [:permissions #ordered/map ([:isAdmin true] [:isRequester false] [:isInspectorForCategories []] [:isViewerForCategories []] [:__typename :UserPermissions])] [:__typename :User])] [:__typename :CurrentUser])] [:settings #ordered/map ([:contact_url https://intern.zhdk.ch/index.php?id=leihs_bedarfsermittlung] [:__typename :ProcurementSettings])])}
2023-12-12T11:43:55.838Z NX-41294 DEBUG [leihs.procurement.graphql:86] - result => {:data #ordered/map ([:current_user #ordered/map ([:navbarProps "{\"csrfToken\":{\"value\":\"219b97e6-bb13-401e-92a7-2304bf206106\",\"name\":\"csrf-token\"},\"config\":{\"appTitle\":\"leihs\",\"appColor\":\"gray\",\"me\":{\"user\":{\"id\":\"a786135f-c159-4618-9dd3-0012ebb3d500\",\"firstname\":\"Manuel\",\"lastname\":\"Radl\",\"login\":\"mradl\",\"email\":\"manuel.radl@zhdk.ch\"}},\"subApps\":{\"borrow\":true,\"admin\":true,\"procure\":false,\"manage\":[{\"name\":\"Ausleihe Toni-Areal\",\"href\":\"/manage/8bd16d45-056d-5590-bc7f-12849f034351/daily\"},{\"name\":\"AVS-Museum/Ausstellungen\",\"href\":\"/manage/b534b07c-d9bf-4572-840c-0a630b8cd8ed/daily\"},{\"name\":\"Kostüm- und Kleinrequisitenfundus DDK\",\"href\":\"/manage/a02b8163-9a16-5066-b48e-9eb74cf8b791/daily\"}]},\"locales\":[{\"name\":\"Deutsch\",\"locale\":\"de-CH\",\"active\":true,\"isDefault\":true,\"isSelected\":true},{\"name\":\"English\",\"locale\":\"en-GB\",\"active\":true,\"isDefault\":false,\"isSelected\":false},{\"name\":\"Castellano\",\"locale\":\"es\",\"active\":true,\"isDefault\":false,\"isSelected\":false},{\"name\":\"Züritüütsch\",\"locale\":\"gsw-CH\",\"active\":true,\"isDefault\":false,\"isSelected\":false}]}}"] [:user #ordered/map ([:id "a786135f-c159-4618-9dd3-0012ebb3d500"] [:firstname "Manuel"] [:lastname "Radl"] [:permissions #ordered/map ([:isAdmin true] [:isRequester false] [:isInspectorForCategories []] [:isViewerForCategories []] [:__typename :UserPermissions])] [:__typename :User])] [:__typename :CurrentUser])] [:settings #ordered/map ([:contact_url "https://intern.zhdk.ch/index.php?id=leihs_bedarfsermittlung"] [:__typename :ProcurementSettings])])}
>>> authenticate::skip= nil  handler-key= :graphql
>>> authenticate::authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}

>> authorize >

>> authorize::handler > #object[leihs.core.locale$wrap$fn__45159 0x55069a5c leihs.core.locale$wrap$fn__45159@55069a5c]

>> authorize::request > {:authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 219b97e6-bb13-401e-92a7-2304bf206106}, leihs-user-session {:value d429c048-7118-407f-a7a9-b33da6f15b06}}, :remote-addr 127.0.0.1, :start-time 48742353554708, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type application/json, cookie leihs-anti-csrf-token=219b97e6-bb13-401e-92a7-2304bf206106; leihs-user-session=d429c048-7118-407f-a7a9-b33da6f15b06, content-length 255, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/admin/categories/dda588f4660c573ca2ff944ae93ad42e, connection keep-alive, pragma no-cache, x-csrf-token 219b97e6-bb13-401e-92a7-2304bf206106, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0xe214599 /127.0.0.1:3230<->/127.0.0.1:56143], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x65dc1b71 HikariDataSource (db-pool)]}, :content-length 255, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:operationName MainCategoriesIndex, :variables {}, :query query MainCategoriesIndex {
  main_categories {
    id
    name
    image_url
    categories {
      id
      name
      can_delete
      __typename
    }
    __typename
  }
}
}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0xbde374d leihs.procurement.graphql$handler@bde374d], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>> authorize::handler-key >> :graphql
>myprint>  authEnt? {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>myprint>  txn #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
2023-12-12T11:43:55.865Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.865Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.865Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>myprint>  admin true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.866Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> inspector? {:result false}
>myprint>  inspector false
>o> viewer? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.866Z NX-41294 DEBUG [leihs.procurement.permissions.user:85] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> viewer? {:result false}
>myprint>  viewer false
>o> requester?? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.867Z NX-41294 DEBUG [leihs.procurement.permissions.user:169] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> requester?? {:exists false}
2023-12-12T11:43:55.867Z NX-41294 DEBUG [leihs.procurement.permissions.user:173] - (:exists result) => false
>myprint>  requester false
2023-12-12T11:43:55.867Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.868Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.868Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.868Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> inspector? {:result false}
>o> viewer? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.868Z NX-41294 DEBUG [leihs.procurement.permissions.user:85] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> viewer? {:result false}
>o> requester?? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.869Z NX-41294 DEBUG [leihs.procurement.permissions.user:169] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> requester?? {:exists false}
2023-12-12T11:43:55.869Z NX-41294 DEBUG [leihs.procurement.permissions.user:173] - (:exists result) => false

> 1 anti-csrf-token >  219b97e6-bb13-401e-92a7-2304bf206106

> 1 anti-csrf-token class >  java.lang.String

> 2 anti-csrf-token-new >  nil
pure-handler >> 2
2023-12-12T11:43:55.871Z NX-41294 DEBUG [leihs.procurement.graphql:46] - graphql query query MainCategoriesIndex {
  main_categories {
    id
    name
    image_url
    categories {
      id
      name
      can_delete
      __typename
    }
    __typename
  }
}
 with variables {}
>oo> vars from graphQL-Requst nil nil nil {}
>debug 2
>debug 3
2023-12-12T11:43:55.872Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format main-categories-base-query) => ["SELECT procurement_main_categories.* FROM procurement_main_categories ORDER BY procurement_main_categories.name ASC"]
>debug 4
>debug 5 {:id #uuid "519f7a95-9ca7-5256-bf63-142cfc23dc62", :name Audio- und Videotechnik}
>debug 5a id #uuid "519f7a95-9ca7-5256-bf63-142cfc23dc62"
2023-12-12T11:43:55.872Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "519f7a95-9ca7-5256-bf63-142cfc23dc62"]
>debug 5b {:main_category_id #uuid "519f7a95-9ca7-5256-bf63-142cfc23dc62", :content iVBORw0KGgoAAAANSUhEUgAAAHAAAACACAYAAADTcu1SAAAABHNCSVQICAgI
fAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAAA9tJREFUeJzt3U1rVFcAgOE3
Y6maVJeK/gIpbWmtJtaPneCqiOBfKLTgv3EtVPAPCEKroGsVEYpYu5LSYpd+
tDXtKtPFyQRTJ7lzzz0fOZn3gbNy7szNeefeTO7FOSBJkiRJkiRJkiRJkiRJ
kqTdYCHi8V8AF4AV4BhwBDgQ8Vy1jYG/gD+AX4AHwI/AT+v/tqvsB64QftDx
Lh8/A98B+5LM3A5wGfid+hNbevwGXEowfyl8TDg7/AusAreAz7o2WgJuUH8i
a4/rwGLXZGX0JfBqyn6tAstbbXQYeDxlo3kdj9bnpLQTTI83GfembXQYeLbN
RvM6ngGHOqc8na54Y+Cf/2+0hEfeduMRZU6ns8SbjE38ndc9vu+a/YFOAq97
7M+GyxE/zLyOi90dovSNtxFwP/P5p0Ls+BXY292jl2X6x9sIeKXSRLQ8vu1u
MrPYeGMIl8Dm4QpL6vGUNJcPl4E3A/aD4ztgMlodnVdDOqwwLN54RLgwrThD
5m4FuAMcHLIDo/UnUpxTA7YbHA/gA8ItIcWJmbtJvAMpdmBEuJ+nOEd7Pj5p
PAifotZo72bsTrEG7JnxsV8Bt0kYD0K4cconnEOzvPlPE+7nJY0H4RSqvLLF
g/AhRvmcJpw2P8r1Ah6B+WSPBwbM5QwF4oEBczhL+J2XPR4YMLWzwA8Uigd+
iElpcuQtlXxRj8A0zlEhHhgwhXOE02bxeOCVmBTeUikeGLB5nkIbZ8DGGbBx
BmycARtnwMYZsHEGbJwBG2fAxhmwcQZsnAEbZ8DGGbBxBmycARtnwMYZsHEG
bJwBG2fA4V7VfHEDDneeihENONxjKkY0YBrVIhownSoRDZhW8YgGTK9oRAPm
USyiAfMpEtGAeWWPaMD8skYc4X/wHGJtxsdlizgiLMGmOH/2eGyWiCPC+nmK
86Ln45NHHBG+sV5xYuYuacQRYeVKxbkfuV3SiJ9T/+v7Wx2fRMz3u44DLwfu
AwuEZUdrT0Zr4wlpvqp6UMTJnxFXE+zIvLnK+hEwUJLT6T7CmrG139WtjOfA
h1EzvbXYI3HDpYIT0Pr4uqtGpJiIm1xP8MPt9nGtI8JQfSNuskhYZrT2JO3U
8ZCw1mJufSK+x0WQp4/SiyDPEvG9RZAnDuGR+O54SNl4E10R72638SJhwd/a
k1d7XKPMaXMrW0V8S1hzt9NFwpqxtSey9HhOvk+bfR0DbgGrwN/ATXpeBdpL
WDP2KfUnNvd4AnxD+r/zsuh7KWgB+JSwcuUpwjvjKGEhw9bu7q8R7ue9INxV
uE/44vLJm1SSJEmSJEmSJEmSJEmSJEkq5j8E8YerHU6LEAAAAABJRU5ErkJg
gg==
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 1081, :content_type image/png, :filename video.png, :id #uuid "ee215167-b2c3-5fcc-90c3-098ad20d16ea", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.014, :System:Directory /tmp/tmp.qSpfBizLgM, :System:FileSize 1081 bytes, :PNG:ImageHeight 128, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 112x128, :PNG:ColorType RGB with Alpha, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 112, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/video.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName video.png, :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-12T11:43:55.873Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "519f7a95-9ca7-5256-bf63-142cfc23dc62"]
>debug 4
>debug 5 {:id #uuid "1a047acd-dc98-52c2-99d3-dc6332adc1e0", :name Bauliche Anpassungen und Mobiliar}
>debug 5a id #uuid "1a047acd-dc98-52c2-99d3-dc6332adc1e0"
2023-12-12T11:43:55.874Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "1a047acd-dc98-52c2-99d3-dc6332adc1e0"]
>debug 5b {:main_category_id #uuid "1a047acd-dc98-52c2-99d3-dc6332adc1e0", :content iVBORw0KGgoAAAANSUhEUgAAAGQAAACACAYAAAD9N8zAAAAABHNCSVQICAgI
fAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAABiNJREFUeJztnXmoVVUUh7+r
PvVpZebLHDJDsGywMiuLioSIIsMsMiqpoIIgqEwKLYUiqCAaoD+KlCQblKKR
BopSG0xJyyJKmp2liTSnJn32x763nqd97rD2uffu897vgwXCO2etvffv3Lv3
XnudKwghhBBCCCGEEEIIIYQQQgghhBBCCCFyTqHZDciAfsCw4r/XA781sS1d
lm7AFcAKYE/ClgNTCH/Y7gB+9/ivZKuAwwJj54r+wJtUHpjXcJ8eC0Or8F/O
5hrj5o6RwFdUPzBfACMMcY6uIYbPXrJ0Lm+MB36l9sH5GTitxlgSpALXAH9j
H6A/cXNOtUiQFLoD9xM2OB3tLtyCoBISxMO+wCtkJ0bJngP6VIgtQRIMBz4j
ezFK9hEwpEz8pglSzce30ZyC20uMrmOMscUYY+oYw0RsgkwBFgMDGxBrKLAE
mNSAWLmjG3An9q+Ir4tmubcdmM7eO/suPYf0AZ7F3vmFwAFFWxTgZy7Qs9im
LivIEPz5qGrtUaClg7+ewJwAf+8CbXRRQY4HNmDr8G5gKv4EYgG4CfdVZPH9
LXCR8d7cCnIBsANbZ7cCE6qIcR6wzRgjJCuQK0EKwAzsHV1DbcvhY4C1AfE6
tSC9gHnYO7kU/3K4BXi4aC2evx8ELAuI2ykFORB4H3sHnwJ6e/wOYO+VVWnF
laQ38HRA/E4lyFHA99g7dxv+yfsI3AScvP4bYJTn+gIwK6AdnUKQc3Bn3JZO
7cStdix+twBnp9w7GdvRbK4FKQA34Janlg5tBE5I8XtjlX53F6/1fbpOBDYZ
25Y7QVqAR7B35mNcnimJddM3m/924B05GPgkoJ25EKQ/8Bb2jjwP9PX4bcPt
oq1+38EtAJL0BV4M8Bu1ICOBL7F3Iu00L3RRULLvgCM9/rsB92TgPypBxmMr
QNiDO+++PMXvBNzOPKuB2gqcmxLrSuCvjOI0VZCrsacafgJO9fgsADdjz0eV
s93ANPyT/enALxnEaIog3YH7DI0t2efAoR6/vXCp8KyFSNpj+Cf7Ebjqw1wJ
ElqA8Dqwn8fvQMJ29LXae7gsQpJ+wBsBflcCrRVHMSOGE1aA8CDQw+N3NC55
2CgxSrYad/6RpAfwUIDf5cDg8kMZzsnAj8YG7gKuTfE7EXuqPAvbhkvX+7iu
2HaL3/XUsZDiMuAPY8M2A2d6fJbS8fWYvGu1duAW/JP9Wbh0jMXvDjIupMii
AOFwj9/ewBMBfutlj+MWFklG4U9mVmszyOB9nNAChEX40+GDaPwZRS32Af6z
lwGEZQzm4Re7KgbjJiZr8Nn4D4yOA9YF+G2UrcWdOCbpiVsyW/0uwVB3NgZ7
AUI7rsjA9/G8EPtZejNsO3C+px+hG9fV+Fd2XiYFDNo2/AUIBWBmHQasEdYO
3Ir/AZuIEy3Lsdpr0KZjV30N/gKEVmB+Ewc0K3sS/zHysdi/gttJSeP0wq0u
rI1diismSDKEsHkoNluGW5AkGQR8GOB3Dh3SOPUqQBiLfR6K2dbh3+y1AgsC
/C6meGYTIsZM/N+tk3Fn4s0evHrZDtwCJUkBuD3A70KwTeBpBQihDcqbzcL/
QF6CrZBiC9RevLYJfwFCH+CZCAap0TYff2Z3HPBDjb7mgDtXXlnlDStxxQFJ
huJeE2v24DTLluN/Re4Q4NMqfaygg7DDqKzmC/gLEE6iviU1ebENuIVMkn2A
lyvcuxGPoONIz+bejb8A4VLqX3SWJ9uJW9Ak6Q7cW+Ye3xQAuHf8Ol5c7oX7
qREMQKx2fcqYXcX/CykuTrn2X6bhyjRXUf4nKV6NoOOxWrkz9TNwafzNpAtn
QoLYBClLbK9Fd3kkSGRIkMiQIJEhQSJDgkSGBIkMX0lnrJSOli0UyMnDlydB
BlA8LzDQhvsxzOjJxVPTlZAgkSFBIkOCRIYEiQwJEhkSJDIkSGRIkMiQIJEh
QSJDgkSGBIkMCRIZEiQyJEhkSJDIkCCRIUEiI0SQnZm1ovOx3XpjiCBvB9zb
2WnK2LTQ2J/j2z+grW0NbOcimljN0xd4APeO4a46W6gg9W7fRtxra5X+00oh
hBBCCCGEEEIIIYQQQgghhBBCCCGEEA3kH1vl9UN9mBbVAAAAAElFTkSuQmCC
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 1665, :content_type image/png, :filename bauprojekte.png, :id #uuid "8e07c37e-d244-514d-bfa9-306158056160", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.013, :System:Directory /tmp/tmp.qSpfBizLgM, :System:FileSize 1665 bytes, :PNG:ImageHeight 128, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 100x128, :PNG:ColorType RGB with Alpha, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 100, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/bauprojekte.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName bauprojekte.png, :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-12T11:43:55.876Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "1a047acd-dc98-52c2-99d3-dc6332adc1e0"]
>debug 4
>debug 5 {:id #uuid "dda588f4-660c-573c-a2ff-944ae93ad42e", :name Beleuchtungstechnik}
>debug 5a id #uuid "dda588f4-660c-573c-a2ff-944ae93ad42e"
2023-12-12T11:43:55.876Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "dda588f4-660c-573c-a2ff-944ae93ad42e"]
>debug 5b {:main_category_id #uuid "dda588f4-660c-573c-a2ff-944ae93ad42e", :content iVBORw0KGgoAAAANSUhEUgAAAJsAAACACAYAAAAccBvUAAAACXBIWXMAAAQK
AAAECgFCV1GHAAA59GlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFj
a2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQi
Pz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0
az0iQWRvYmUgWE1QIENvcmUgNS42LWMxMTEgNzkuMTU4MzI1LCAyMDE1LzA5
LzEwLTAxOjEwOjIwICAgICAgICAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9
Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMi
PgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAg
ICAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8i
CiAgICAgICAgICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxl
bWVudHMvMS4xLyIKICAgICAgICAgICAgeG1sbnM6cGhvdG9zaG9wPSJodHRw
Oi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIgogICAgICAgICAgICB4
bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIK
ICAgICAgICAgICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20v
eGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgICAgICAgICAgeG1s
bnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAg
ICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8x
LjAvIj4KICAgICAgICAgPHhtcDpDcmVhdG9yVG9vbD5BZG9iZSBQaG90b3No
b3AgQ0MgMjAxNSAoTWFjaW50b3NoKTwveG1wOkNyZWF0b3JUb29sPgogICAg
ICAgICA8eG1wOkNyZWF0ZURhdGU+MjAxNi0wNy0xNFQxNTo0NTo0MSswMjow
MDwveG1wOkNyZWF0ZURhdGU+CiAgICAgICAgIDx4bXA6TW9kaWZ5RGF0ZT4y
MDE2LTA3LTE0VDE1OjQ5OjAyKzAyOjAwPC94bXA6TW9kaWZ5RGF0ZT4KICAg
ICAgICAgPHhtcDpNZXRhZGF0YURhdGU+MjAxNi0wNy0xNFQxNTo0OTowMisw
MjowMDwveG1wOk1ldGFkYXRhRGF0ZT4KICAgICAgICAgPGRjOmZvcm1hdD5p
bWFnZS9wbmc8L2RjOmZvcm1hdD4KICAgICAgICAgPHBob3Rvc2hvcDpDb2xv
ck1vZGU+MzwvcGhvdG9zaG9wOkNvbG9yTW9kZT4KICAgICAgICAgPHhtcE1N
Okluc3RhbmNlSUQ+eG1wLmlpZDozMTMzODRjNi0zYzM5LTQzNjgtODE5OS01
OWJhZDM3ODBkNGQ8L3htcE1NOkluc3RhbmNlSUQ+CiAgICAgICAgIDx4bXBN
TTpEb2N1bWVudElEPmFkb2JlOmRvY2lkOnBob3Rvc2hvcDoxYTU3ZjVjYy04
YTU4LTExNzktOGVmNS04OTFkYzJiZDEwY2Y8L3htcE1NOkRvY3VtZW50SUQ+
CiAgICAgICAgIDx4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ+eG1wLmRpZDpk
OWQ5MWY5NC0yNjQ0LTQ4NTItODAwYS0yZTA2OTBlN2VjMzM8L3htcE1NOk9y
aWdpbmFsRG9jdW1lbnRJRD4KICAgICAgICAgPHhtcE1NOkhpc3Rvcnk+CiAg
ICAgICAgICAgIDxyZGY6U2VxPgogICAgICAgICAgICAgICA8cmRmOmxpIHJk
ZjpwYXJzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgICAgICAgPHN0
RXZ0OmFjdGlvbj5jcmVhdGVkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAg
ICAgICAgIDxzdEV2dDppbnN0YW5jZUlEPnhtcC5paWQ6ZDlkOTFmOTQtMjY0
NC00ODUyLTgwMGEtMmUwNjkwZTdlYzMzPC9zdEV2dDppbnN0YW5jZUlEPgog
ICAgICAgICAgICAgICAgICA8c3RFdnQ6d2hlbj4yMDE2LTA3LTE0VDE1OjQ1
OjQxKzAyOjAwPC9zdEV2dDp3aGVuPgogICAgICAgICAgICAgICAgICA8c3RF
dnQ6c29mdHdhcmVBZ2VudD5BZG9iZSBQaG90b3Nob3AgQ0MgMjAxNSAoTWFj
aW50b3NoKTwvc3RFdnQ6c29mdHdhcmVBZ2VudD4KICAgICAgICAgICAgICAg
PC9yZGY6bGk+CiAgICAgICAgICAgICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlw
ZT0iUmVzb3VyY2UiPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6YWN0aW9u
PnNhdmVkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAgICAgICAgIDxzdEV2
dDppbnN0YW5jZUlEPnhtcC5paWQ6MzEzMzg0YzYtM2MzOS00MzY4LTgxOTkt
NTliYWQzNzgwZDRkPC9zdEV2dDppbnN0YW5jZUlEPgogICAgICAgICAgICAg
ICAgICA8c3RFdnQ6d2hlbj4yMDE2LTA3LTE0VDE1OjQ5OjAyKzAyOjAwPC9z
dEV2dDp3aGVuPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6c29mdHdhcmVB
Z2VudD5BZG9iZSBQaG90b3Nob3AgQ0MgMjAxNSAoTWFjaW50b3NoKTwvc3RF
dnQ6c29mdHdhcmVBZ2VudD4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OmNo
YW5nZWQ+Lzwvc3RFdnQ6Y2hhbmdlZD4KICAgICAgICAgICAgICAgPC9yZGY6
bGk+CiAgICAgICAgICAgIDwvcmRmOlNlcT4KICAgICAgICAgPC94bXBNTTpI
aXN0b3J5PgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9y
aWVudGF0aW9uPgogICAgICAgICA8dGlmZjpYUmVzb2x1dGlvbj4yNjI2MzYv
MTAwMDA8L3RpZmY6WFJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOllSZXNv
bHV0aW9uPjI2MjYzNi8xMDAwMDwvdGlmZjpZUmVzb2x1dGlvbj4KICAgICAg
ICAgPHRpZmY6UmVzb2x1dGlvblVuaXQ+MjwvdGlmZjpSZXNvbHV0aW9uVW5p
dD4KICAgICAgICAgPGV4aWY6Q29sb3JTcGFjZT42NTUzNTwvZXhpZjpDb2xv
clNwYWNlPgogICAgICAgICA8ZXhpZjpQaXhlbFhEaW1lbnNpb24+MTU1PC9l
eGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGlt
ZW5zaW9uPjEyODwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgIDwvcmRm
OkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAo8P3hwYWNrZXQgZW5kPSJ3
Ij8+W7LKAQAAACBjSFJNAAB6JQAAgIMAAPn/AACA6AAAUggAARVYAAA6lwAA
F2/XWh+QAAAJGElEQVR42uyda4hVVRTHf75GxJEhmxlFHEFHApEmicgnGppI
iJWSOlghGvghS8QQRpRQVOjlo4JUUkILH6SJiUJJfagsUjH9oCgOpuAjx5Ss
NEdzpg/toZA7M2fte869Z+2zPmyQ8c7Ze/33b+7Za+2916K5uRlr/zWgGpgO
zANWAB8Ce4AfgLPAn66ddT/b4z6zwv3OdKDatMyhrcFFJVALbAR+Bppjaj+7
Z9YClQZbBmEDOgDjgVXAcaApRsBaa02ur1Wu7w4GW9iQdQdeBk4XAK722mk3
lu4GW1iQVQFvAtdTANn97bobW5XBphuyx4HtwN0UQnZ/u+vG+rjBpguyB4CP
FADWWvsIeMBgSz9ozwCXFIPW0i4Bzxhs6YSswr2GmgNr24EKgy09oNUCVwME
raVdBWoNtuLHy9YVaMJvAPVux+Bz135wP7tRoDGs0x6f0wpaR2BTgsHXd4HJ
LmxSEmE8Je6zk93vJhUs3gR0NNgKB1on4OMYJ/B3YD3wLNAzxnH2dM9c7/qI
a7wfA50MtuRB6xyjI3ASmAv0KMC4e7i+TsboOHQ22JKbsC7Azhgm6jNgbBHt
GOvGkK8dO4EuBlsyk7Qjz8k5DoxKkT2j3JjysWmHwRb/xDyfpyc5P43rHLf+
nJ+nR/u8wRbfhPQCrvn+5QO9FdjYO49v7mtAL4MtnonY5TkJSxV62ks9bd1l
sOUv/jQP4f8G5igOVs9xNkjtnmaw+YteDjQIBb8FPB3AFtzTzhaJ7Q1AucHm
J7g0ntaYJm8zJm+1URp/M9jkQg/2eI0sDPBs3kIPHQYbbDKR3xYK/LXmPcN2
9oC/FmrxtsEmiz1dFp7j71ugsb0AHAJuAueAw8A+4D3guSRCEEBf4f2Jy2nd
O00jbBPT6IUBD0cczyngnTgvsXh45RMNtmjCfioQ9asCjustj0ssW4CamPr/
StD3pwZbtGM5jWmMLQGT8thSWh/lXFyM326NcR6XChW2uQJBrxTy1INbrO8C
7nkC910+W2fu1MsVQX9zDba2BZV4Xm8UaYwDXJR/ObDZjTnqja4LwGN59P2G
xEM32NoW85zg+HZ1isbdwQVhP4hw+eYy8GAeGZaiHjc/Z7C1/ZqKenv925Sf
Jn4K+DGJc2jAtwIHpaPBllvEPoJXxAYlt79mA3+1YsN0z+duEOjUx2DLLeIw
gYiLFO0CPNnKpvpFz+ctEug0zGDLLeJUgYgzlG07LW7Fjr4ez5oh0GmqwZZb
xAUCEUcozA33Rw47Jnk8a4RApwUGW24R12hdi0S0L5fD8HrCa9s1BltuETcL
RCxRCNv7OexY7fGcEoFOmw223CKuFojYWyFsuTbyH/a8HBNVp9UGW24R6wQi
1miD7b4jSoeAFzyfUSPQqc5gyy3ibIGI40JOB9qOTuMEOs022PI/VTErw7DN
Eug0yWDLLeJQSSafDMMmyeA01GBr/fhzVBF/yWLhCrcF9otAp74GW+tinhUI
OSSDsA0R6HPWTn20LaYkbenKDMK2UpIW1WBrW8zJAjF/A8oyBFqZszmqPpMN
tvYFleS5WJIh2JYI852UGWzti3pQIOqvQGkGQCt1tkbV5aDdroom7GvSm0sZ
gG29UJPXDLbof8XSIhpTAgZtikeRjlKDLZl90pYUDFUBglblUbqyLrX2pHiN
Iv12+x7oFhBo3ZxNQXyrpT0/W53HReD92tK1t3Eheb+H/XWptivlHtgVD8G3
qS658++Vxm0edl9Ju2eeduEneKY7WKcYNp/ib/eACam3TYH4yzxzayxXCNpy
T1uXqbBPyWvlgOckzFME2jxPGw9oWTZomYgKl5TFJ039Ewrse8IzHf0FTZWW
Nb1iRnpkz26pt16ZYrsqPevaNwIjVS0TlK1pZnq+ar5M46vGLRG+9LRppro1
aYYW0YsVpWUIzvnRClsHYKvn+m10iuwY7blO26r1SLzWWFRXlzZUOlEX07Cg
dg7PRc9UqV3VxhAVBz/LgXqNBWE9yz3Wp702VbCwuUl7yLMW6agijnmUZ03R
h9Tv+QawaT3GIyRypBjrHrfePOIR4hgTxEmWQI7jLNMQOvAM3SwLYY5Cgq0r
cNrDWehewDF293AKTmt2CIKEzU3m2DTHqzzjg2ODOnkc2DHqLR6VlysKFOqQ
VkbeEtwx98Bgq/DwTucXYFzzPbzPCoMt/cC9JJzYYwUY0zHhmF4K8qZYoJl+
vhFO7iMJjucR4Vi+CTVDU6h3LQcBd9KQVVuYBf0OMCjYO7ABX+79RDDJDUnc
ynK3pBoE4/gk6Jv9AcM2vNilrj1KkA832PQCd1Qw0SsS6H+FoP+jwecsCRw2
iWe6L4H+92XdA80SbN2Am1G3rxLoP+r21M2QUkdkEjY34ZJDlpUx9lspORQZ
+jxkBba1gkmfEGO/EwT9rjXYwoDtRUlhMaA2piYp/PaiwRYGbDWeN5gK2WoM
Nv2gDfTYlyxGOwYMNNj0glbtkbWxmO06UG2w6QOtBDiuCLSWdlxj4d6swzZV
IWgtbarBpgu2vYph22uw6YKtXjFs9QabLthuKYbtlsGmC7ZTimE7ZbDpgm27
Yti2G2y6YHtFMWyvGGy6YOsCnFAI2okQioZkcQdhBNCkCLQmYITtIBhsBpvB
Zq9Rg80cBHMQLPRhoQ+DzYK6FtS17SrbrjLY2oftjGLYzhhsumDbrRi23Qab
LtimKIZtisGmL852RCFoRyzOphO4/sBVRaBdBfrbDoJe4AYo2Uk4AQywq3z6
gXtVAWyv2iXlMGA7qQC2kwZbGOs2LWu2/gabbtjGK4JtvMGmG7YximAbY7Dp
hq1MyQHKJqDMYLMLy3Yx2WBLJPNksZplngwEtq7A4RSDdjikmqKZhs0B109Y
aaVQrQHol4U5yAxsDrhyYBVwOwWQ3XZjKc+K/pmC7X/QVQFLgR3AT4I6Cfm0
m66vHa7vqqzpnknYcsBXCpxPELTzQGnWdTbY/gNuYoKwTTSNDbb7gduWAGjb
TFuDrTUH4miMoB3NmgNgsMmA6wF8EQNoXwA9TFODrT3gOgMb8wBtI9DZtDTY
JNA96kIV9yIAds999lHTzmDLB7qBLja2FTjkKrFcd//e6v5voGnVfvtnAC9c
0Cv54m27AAAAAElFTkSuQmCC
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 17298, :content_type image/png, :filename bulb12323.png, :id #uuid "8debe2ef-4a7e-58a1-bf4c-1622dead4579", :metadata {:XMP-tiff:ResolutionUnit inches, :PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 1034, :XMP-exif:ExifImageHeight 128, :XMP-xmpMM:HistoryInstanceID [xmp.iid:d9d91f94-2644-4852-800a-2e0690e7ec33 xmp.iid:313384c6-3c39-4368-8199-59bad3780d4d], :XMP-xmpMM:DocumentID adobe:docid:photoshop:1a57f5cc-8a58-1179-8ef5-891dc2bd10cf, :XMP-xmpMM:InstanceID xmp.iid:313384c6-3c39-4368-8199-59bad3780d4d, :PNG:GreenX 0.21, :ExifTool:ExifToolVersion 10.4, :XMP-exif:ColorSpace Uncalibrated, :XMP-xmp:CreateDate 2016:07:14 15:45:41+02:00, :Composite:Megapixels 0.02, :XMP-tiff:Orientation Horizontal (normal), :PNG:WhitePointY 0.32899, :XMP-x:XMPToolkit Adobe XMP Core 5.6-c111 79.158325, 2015/09/10-01:10:20        , :System:Directory /tmp/tmp.qSpfBizLgM, :XMP-tiff:XResolution 26.2636, :XMP-photoshop:ColorMode RGB, :XMP-exif:ExifImageWidth 155, :XMP-xmpMM:HistoryAction [created saved], :System:FileSize 17 kB, :PNG:ImageHeight 128, :XMP-xmpMM:HistoryWhen [2016:07:14 15:45:41+02:00 2016:07:14 15:49:02+02:00], :File:FileTypeExtension png, :XMP-xmp:MetadataDate 2016:07:14 15:49:02+02:00, :XMP-xmp:CreatorTool Adobe Photoshop CC 2015 (Macintosh), :File:FileType PNG, :PNG:BitDepth 8, :XMP-xmpMM:HistorySoftwareAgent [Adobe Photoshop CC 2015 (Macintosh) Adobe Photoshop CC 2015 (Macintosh)], :Composite:ImageSize 155x128, :XMP-xmp:ModifyDate 2016:07:14 15:49:02+02:00, :PNG:ColorType RGB with Alpha, :PNG:WhitePointX 0.31269, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 155, :File:MIMEType image/png, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :PNG:BlueY 0.05999, :XMP-xmpMM:HistoryChanged /, :SourceFile /tmp/tmp.qSpfBizLgM/bulb12323.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG:RedX 0.63999, :PNG:GreenY 0.71, :PNG:BlueX 0.14999, :PNG:RedY 0.33, :PNG-pHYs:PixelsPerUnitX 1034, :System:FileName bulb12323.png, :XMP-tiff:YResolution 26.2636, :PNG-pHYs:PixelUnits meters, :XMP-xmpMM:OriginalDocumentID xmp.did:d9d91f94-2644-4852-800a-2e0690e7ec33, :PNG:Filter Adaptive, :XMP-dc:Format image/png}}
2023-12-12T11:43:55.877Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "dda588f4-660c-573c-a2ff-944ae93ad42e"]
>debug 4
>debug 5 {:id #uuid "2b07eb8a-4174-5257-83eb-920d536cc44a", :name Betriebseinrichtungen und Fahrzeuge}
>debug 5a id #uuid "2b07eb8a-4174-5257-83eb-920d536cc44a"
2023-12-12T11:43:55.878Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "2b07eb8a-4174-5257-83eb-920d536cc44a"]
>debug 5b {:main_category_id #uuid "2b07eb8a-4174-5257-83eb-920d536cc44a", :content iVBORw0KGgoAAAANSUhEUgAAAGwAAACACAYAAADu4Iw0AAAABHNCSVQICAgI
fAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAABE1JREFUeJzt3U+PFEUcxvHv
7AoriPEkckFI1JGErBtfAQgniJD4JtCIWRKPxkO/CfTgichJEz0QzoYEr7Ig
ARJOIokHCBDQXcLCjofaCaRpuqu6q7q6ap5P8ktIhqmpp5+dfzs7MyAiIiIi
IiIiIiIiIiIiIiIiIiIikrd9wHlgDZjM+KwB54BxpyMa0D7gPvEP1NDmHjCe
73BgQzkDLMbexABtA/aMYu+iwhrweuxNDNTqEAubxN7AkM3F3oC4UWGJUWGJ
UWGJUWGJUWGJUWGJUWGJUWGJUWGJUWGJCVXYCPgE+AG4Caxj/zKC9OwgcIn4
rx/lOl59M4BAuY83xQDCzMJ4UQwgyKxMZ8UAQszSdFIMIMCsTWvFADY/i9NK
4XABF4E9DmvHPiBDH2eFw+IXgTcd1499QIY+TgqHhduURaCQOY21wmHRtmUR
KGROY6VwWLBLWQQKmdM0KhwW61oWgULmNLUKh4V8lEWgkDnNK33rsIivsggY
NJepdNhhAZ9lETBoLvOSeeCq5Zl9l0XAoLnMS45ZnjFEWXgOl91U/YnAZxYH
9XfgCPDI4v+KR1WFfdRwHpUVUdUb+v4BdtWcZy/wV5DdGJW302KUCxsBT4DX
HM7jmwqrUb5J3EZ9WRJZuRybsnQNiKh8DXsWZRdirVzY0yi7EGsqLDFVj/h0
HzVgevdKYlRYYlRYYlRYYlRYYlRYYlRYYlRYYlRYYlRYYlRYYlRYYlRYYlRY
YlRYYlRYYlRYYlRYYlRYYqaFvfh9Xb5dAk4A7wNbgQXgA+Bz4HKAy+tb7/lC
fV/XE+Ak9dfiOWAZtw/AHMrEysf5QGGO1AQpO+o5VB9lxcoX5GsLTzqEmVoO
sI9QEzOf95/sP2j3YGYOuOJ5LyEmZr7Hc8BKiwuv8z2w0eJ8G8B3nvcSQsx8
KwCHgP/w9xP4XocNjT3uI9TEyvcvcODFhX4FbtP9JnJLh0ALHS+7j+kz3zqm
k18wTxsqjYDtmC8Orfrb+42GC9kaMFAfb4eKnW+EOfbbqTj+VXeeE2AVeLz5
77KHDZt6127vlfY2nP6gw9q2YuebYI79KhXHv82jnVsNpx9qsebU4YbT/+6w
tq3s8p2l/mq9QrsfBJtP4Pmx495tDDpfmwu+0HD6EvBVi3VPAfsb/s9vLdZ1
lV2+dzDv1Gx6dHPUYc1PLdd820uCelnm+7nhwqcbWKb+WjwPfE1zmAnwU4Ac
r5JdviWaH/5O5wrwBea53sLmfAh8if2nxj0DFkMGKsky32nLzfiY06HDVMgu
3w7geg9hrgFv9BGoJMt8Y+BuwDB3MK/expJlvo8JE+rO5tqxZZlvDNxo2KDr
zUTMa1ZZlvl28Py1orZBNjB3wDHus5pkm28J8zzG5rnHdNYxz0P6fOjeVtR8
IT+scidwHPOts4vAbuCtzdMeYH7R+Sfm1zHnMLfpKck9n4iIiIiIiIiIiIiI
iEjv/gec0agwRiP7+AAAAABJRU5ErkJggg==
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 1195, :content_type image/png, :filename fahrzeuge.png, :id #uuid "3d6cbe63-c327-5c6b-b7fa-48e6c52f2cdc", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:01+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.014, :System:Directory /tmp/tmp.qSpfBizLgM, :System:FileSize 1195 bytes, :PNG:ImageHeight 128, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 108x128, :PNG:ColorType RGB with Alpha, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 108, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:01+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/fahrzeuge.png, :System:FileAccessDate 2018:11:14 17:31:01+00:00, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName fahrzeuge.png, :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-12T11:43:55.878Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "2b07eb8a-4174-5257-83eb-920d536cc44a"]
>debug 4
>debug 5 {:id #uuid "f6827594-33a6-5760-ac41-f94ceefacfab", :name Bühnentechnik}
>debug 5a id #uuid "f6827594-33a6-5760-ac41-f94ceefacfab"
2023-12-12T11:43:55.879Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "f6827594-33a6-5760-ac41-f94ceefacfab"]
>debug 5b {:main_category_id #uuid "f6827594-33a6-5760-ac41-f94ceefacfab", :content iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAA3NCSVQICAjb
4U/gAAAACXBIWXMAAAG7AAABuwE67OPiAAAAGXRFWHRTb2Z0d2FyZQB3d3cu
aW5rc2NhcGUub3Jnm+48GgAAAM9QTFRF////AAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAA+q0M9gAAAER0Uk5TAAQGBwgJCwwQFBUbISIvMDIzNDU3ODtBREpP
UlNVVldpcXN7gIqTl6Chpqytv8PExsrS1uDj5Obo6evs7fLz9ff4/P3Djn9u
AAABnElEQVRYw+3XxXbDMBQE0AkzM3McZuY4/v9v6sKFKLEUPWXV085acxe2
9WQhNjR4mRcBACjOuUuGMfD7hnFwAYDrIFgyhCFKEgCSwiViIAUAqX/glwNx
AIi/AQQBIPgG4AEAjzpwMTfTRRlYmMBCGRiYwEAZqJlATRlImEBCFTjaTMB2
VAQ0fEZTBMJfQFgNmOA7EyWg/AOUVYAR7jKiA7fIPRC5kQENTDQqMHOzgHtG
Aw4hPCR0oAB6Fk/J6vLAtQCLFK6ywDEDy2SOcsAyCk6iSxmg6wU33u5LYJOH
MPmNEFjX3XgRd33NB5oOSMTR5AK7igxQ2QmeQd//qu7vix/iriTul3YvX2NL
1G/JfEhVfr8q9SXqOV4/p8vthVPEuh85ye7GVcCqH1jJz4OeFdCjDJTgcz+o
U0Za+xlok2bi2ffY951pU7n5CDSJY33vZPvOPfVgeZhrUfLJVGaBMhlosECD
DHRYoEMGxiwwJgNbFtjSfzDs9327wh8K8yE4/ybAnFIOPsC7fE/Z1zjlXr45
1/9JmgXSE871/wOnFjUuRak9PwAAAABJRU5ErkJggg==
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 841, :content_type image/png, :filename curtain-2.png, :id #uuid "9a8cba78-10ab-585b-a4c2-9d8e7f0818ee", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 443, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.004, :System:Directory /tmp/tmp.qSpfBizLgM, :PNG:Palette (Binary data 207 bytes, use -b option to extract), :System:FileSize 841 bytes, :PNG:ImageHeight 64, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 64x64, :PNG:ColorType Palette, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 64, :PNG:Software www.inkscape.org, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/curtain-2.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitX 443, :System:FileName curtain-2.png, :PNG:Transparency (Binary data 68 bytes, use -b option to extract), :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-12T11:43:55.880Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "f6827594-33a6-5760-ac41-f94ceefacfab"]
>debug 4
>debug 5 {:id #uuid "517b82ae-2b7e-4822-9aeb-0d4753dec821", :name Darlehen}
>debug 5a id #uuid "517b82ae-2b7e-4822-9aeb-0d4753dec821"
2023-12-12T11:43:55.880Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "517b82ae-2b7e-4822-9aeb-0d4753dec821"]
>debug 5b nil
2023-12-12T11:43:55.881Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "517b82ae-2b7e-4822-9aeb-0d4753dec821"]
>debug 4
>debug 5 {:id #uuid "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da", :name Fotografie}
>debug 5a id #uuid "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da"
2023-12-12T11:43:55.881Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da"]
>debug 5b {:main_category_id #uuid "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da", :content iVBORw0KGgoAAAANSUhEUgAAAGAAAACACAYAAAD03Gy6AAAABHNCSVQICAgI
fAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAABvdJREFUeJztnWuIVVUUx3/3
OpPaQ6d8ZKI9TM0sKyGnB72ozNKIisjqY0RQQVBQH0PqS4UZmSFB+EkqKMqi
l2JPCCwRGaWyzDzO5GPyEfmYcXzM9GHNhUHHe/a6d92zz51ZP9gg45q9197/
c+7es/ba+4LjOI7jOI7jOI7jOI7jOI7jOAOdQsr/jwbmA7OBK4DxwNBaO1Xn
HAV2Ai3AKuB9YI+2kpHAIqAT6PFSVTkMvN47pkFcA7TmwPGBVlqB5rTBnwN0
5MDZgVo6e8e4X67FP3KyEmFWadBLk3ATsBGYcCp1HFNagRnA/iG9P3gFWek4
2TASOA1YVQDGAG348jJrDgMTisBD+ODHYBgwvwjcEduTQczsAjIhTIztSY5o
B9YDXYrfGYGsIocr20oAjhB/aZaHchx4BmhQDmKJc4Dlyja7yEHH81KeVg/5
yRSBFZp2C73/GOy0ApOQt6BaLgE2hRoXDRocCKzBZvABfkcR/XQBhE7j+g6F
GroAkXEBIuMCRMYFiIwLEBkXIDIuQGRcgMi4AJFxAYQh6SYqgiOqLoAw1bCu
kcB5ocYugNBMQNJUIE+iHNfYcfi8lFZgmmbg+uF+lBtc9bQfkADfAeuAzcAu
4CDi/xnAWOBi4CrgZmB6BW10Ae8CPyNZCyEUkLyqOZTJeitH7CevXDkAvAnM
JD2T+0QmAy8ie7yx+1GuRHegv3IUWAiMUg56f5wOPAfsz0G/6kKADchZBGsm
IPn6sfuXawHeQ57YWlEEXspBP3MpwGKyWxY/nlGf6kaAt9BPstXyhJHvdS/A
F9iHAkJZGOjjgBVgBzYrnUppBH7qx69BI8B9VQ9h9VwGHGMQCvAD2X/un4ql
RBoHTSiiDfgmxaYZuDSwvrnAl4G2teZCYAthq7B24KsUmweQ8EgQoWqtCKjr
x8C6EvIXif2CMN//JX3RkATW1WM5CGciZ4xD+AjoNmzbgg8D7ZqQ2JQJlgJc
Tfhy8mvDdq1YrbANfdBSsRTgcoXtOsN2rWgDdgfamsWqLAWYHGh3EJnI8kYP
8GegbWhfU7EUYHygXSk+n0d2BdqF9jUVSwFCbwPpMGzTmtC8/iarBi0FCD1r
nLflZ19CFxHDrBq0HIzQIz7B9+ZEINQ3syW0pQChm9jjqPwoaK0JPS8dfAQp
DUsB9gXaNWCbCGVFI+F+7bVq1FKA7Qrb6wzbtWIm4fOYpq9lsRTgL4XtXYbt
WjFXYfuHVaOWAmxU2M4DzjZsu1oKwCMK+xarhi0FWI/k84QwDHjMsO1quROY
orBfY9m4ZTj6e0V9/yC3jMSmCKwl3O/tpG8kJaH1Wf9R9LnCdgySOhibR5FI
biifYhxKsXwDLlLU14P8QXObXVfUTAL+68evcuWmgHoTRX2mAoDE+jUd2o0I
lzVnIZOpxtfNhM2bSWidtYjLLFbajwZWojhVYsBw5IHSxvUXU4OdPOs3oIgs
STVPVunpyuJNaAK+rcC/XYTnrSaKes0FALi7gg72ICujWxXtaJkO/Fahb08p
2kkU9dZEgALwWYUd7QZeQzb5rWgAnqXyq5k3oAsgJoq6ayIASGRRu8LoW3Yg
B960NxH2pQH5/oNfq/DjOPoDfImi/poJAPCgov5Tlb1I9vTthInRiAT7Xsbm
Gv4FFfQ7Ca1fkxn3CXBvBc4sQq6DtOAo8AsyYe9EzpD1IB9X5yKH9GZQ3VvT
l9VImEJ7n1wCXBBqXMs3AORjQHWVY07KJuQu0EpIQtvJYn/2GPAw6XmleaIN
udI5dJOpYrLaIO8E7kEOyeWdrcAtyPxRc7LMUDiEiLA8wza1rAWuR7e5VDW1
ngNOpAA8j0xssT/n+5Z3sJu8E0W7mQtQ4gbkSYs98HuQ5bIliaL9aAKALB8X
IsvLrAe+G1iGBAOtSRR+RBWgxFTkG+e6Ff5UUz4GrqxhfxKFL7kQoMQU4A1k
+Wc96PuAJYQfoaqGROFXrgQoMRTJnHgbSRmvdNC39NYxD/nWoqxIQn3Ma4pg
F7K/XNpjHovcAzQN+RN/HBLXH4ospQ8jgb92pPObkCyNPJ5DOIk8vgH1TkLg
uOY5VXxQ4AJERiNAlpNYvaM6wBE6B7Qjmx1OeSahW6mpjBdk1o36pAHlXngB
uedS82QvQ7YIE/J32j0Wjchf1i8ANyp+70gB2AacXwuvnFS2FjHMdXfUtBSp
j12qgcrKAhKO/Rv/TuGs6QQmFpENiaWRnRmMLAH2lk56jEQSav17hbNhG5K/
dKDvD5upPHfSS3jpoMyJnDkuQs0HP/Ur5Gchr0hsZwdaSVCcRRuBbJb721B9
6QBeRY5EnUTacctRSHr3bGRHajweFU3jCHKUtQU5evUBhndLOI7jOI7jOI7j
OI7jOI7jOI5Tf/wPcYhVe1hRfeIAAAAASUVORK5CYII=
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 1877, :content_type image/png, :filename fotografie.png, :id #uuid "07a33b4c-d274-54e5-a2ce-11f26d57be05", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.012, :System:Directory /tmp/tmp.qSpfBizLgM, :System:FileSize 1877 bytes, :PNG:ImageHeight 128, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 96x128, :PNG:ColorType RGB with Alpha, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 96, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/fotografie.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName fotografie.png, :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-12T11:43:55.882Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da"]
>debug 4
>debug 5 {:id #uuid "2ea39047-e663-50d5-9080-838b75883704", :name IT & Elektronik}
>debug 5a id #uuid "2ea39047-e663-50d5-9080-838b75883704"
2023-12-12T11:43:55.882Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "2ea39047-e663-50d5-9080-838b75883704"]
>debug 5b {:main_category_id #uuid "2ea39047-e663-50d5-9080-838b75883704", :content iVBORw0KGgoAAAANSUhEUgAAAHgAAACACAYAAADApa2mAAAABHNCSVQICAgI
fAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAr5JREFUeJzt3b9qU2Ech/En
0UVbFAernQRHQZy8AtFNdJQWCgq6633oUCzeRi3qoHgBDiIugosglNY6Vq1L
/zicgC2kiel5k5N8fT7wLm15c/g9bU/+kQOSJEmSJEmSJEmSJEmSJEmSpG6m
gQfAK2AN2AH2XAfWTmc2L4H7wNSRJj1iLWAB+E7zA5y0tQHMDz7y0WkDz2h+
UJO+ljqzHCstjFtyPR1s/MO3QPNDSVtzAxU4RKvAHtPAF+Bsgb301wZwEdiq
s0mJ//VzGHcYzgF36m5SIvDtAnuou7GY7Rq9zyXL+BfezQywQu/ZrTZ2dPv0
exLDuIc7T+/Zbde9gRJ3svZGcBvJhjq/sXtArbIMHM7A4QwczsDhDBzOwOEM
HM7A4QwczsDhDBzOwOEMHM7A4QwczsDhDBzOwOEMHM7A4QwczsDhDBzOwOEM
HM7A4QwczsDhDBzOwOEMHM7A4QwczsDhDBzOwOEMHM7A4QwczsDhDBzOwOFK
BN7t8/2ZAreRarbP93dGchR99Ps44RWqT1XVQbPAC4b8ccLH624AfKD3b+JN
YL3A7fyP3tfdoMS/6OUCe6i72rMt8VnOU1QX5fBcW9Y3qoty/K6zSYm/4F/A
owL76KCH1Ixb2hLNX2soZS0OOPuRaFNdsavp4Uz6WmTMn5+Yozp/ND2oSVvr
FLhO0qicBO5RPQZepbp6SNMDHLe13ZnNc+AucOJIk5YkSWOpRXXCV6ixfryl
+gwczsDhkgNforqP8S/rckPHOHTJgY8N6WcnSgvYwqfJUm21gbdNH4WG5nWL
6lz1Dphu+GBU1g/gahv4BNzAN8YlWQOuA5/3f/EM8ITqLThNv5TmOtr6CTzu
tAS6v+nuNHALuAZcAS4Ap8i+xz2JdoFN4CvwEXhD9fr7ZpMHJUmSJEmSJEmS
JEmSJEmSJEml/QGym5SaY0sX5gAAAABJRU5ErkJggg==
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 796, :content_type image/png, :filename laptop.png, :id #uuid "1464e46c-e726-54a9-a42b-f937a0342d22", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:01+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.015, :System:Directory /tmp/tmp.qSpfBizLgM, :System:FileSize 796 bytes, :PNG:ImageHeight 128, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 120x128, :PNG:ColorType RGB with Alpha, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 120, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:01+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/laptop.png, :System:FileAccessDate 2018:11:14 17:31:01+00:00, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName laptop.png, :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-12T11:43:55.882Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "2ea39047-e663-50d5-9080-838b75883704"]
>debug 4
>debug 5 {:id #uuid "f6885671-3bf3-56f2-8e92-b5112d0f703f", :name Musikinstrumente}
>debug 5a id #uuid "f6885671-3bf3-56f2-8e92-b5112d0f703f"
2023-12-12T11:43:55.883Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "f6885671-3bf3-56f2-8e92-b5112d0f703f"]
>debug 5b {:main_category_id #uuid "f6885671-3bf3-56f2-8e92-b5112d0f703f", :content iVBORw0KGgoAAAANSUhEUgAAAI4AAACACAYAAADd91F4AAAACXBIWXMAAAsT
AAALEwEAmpwYAAA59GlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFj
a2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQi
Pz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0
az0iQWRvYmUgWE1QIENvcmUgNS42LWMxMTEgNzkuMTU4MzI1LCAyMDE1LzA5
LzEwLTAxOjEwOjIwICAgICAgICAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9
Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMi
PgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAg
ICAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8i
CiAgICAgICAgICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxl
bWVudHMvMS4xLyIKICAgICAgICAgICAgeG1sbnM6cGhvdG9zaG9wPSJodHRw
Oi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIgogICAgICAgICAgICB4
bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIK
ICAgICAgICAgICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20v
eGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgICAgICAgICAgeG1s
bnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAg
ICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8x
LjAvIj4KICAgICAgICAgPHhtcDpDcmVhdG9yVG9vbD5BZG9iZSBQaG90b3No
b3AgQ0MgMjAxNSAoTWFjaW50b3NoKTwveG1wOkNyZWF0b3JUb29sPgogICAg
ICAgICA8eG1wOkNyZWF0ZURhdGU+MjAxNi0wNy0xNFQxNTo0NjoxMSswMjow
MDwveG1wOkNyZWF0ZURhdGU+CiAgICAgICAgIDx4bXA6TW9kaWZ5RGF0ZT4y
MDE2LTA3LTE0VDE1OjQ5OjI4KzAyOjAwPC94bXA6TW9kaWZ5RGF0ZT4KICAg
ICAgICAgPHhtcDpNZXRhZGF0YURhdGU+MjAxNi0wNy0xNFQxNTo0OToyOCsw
MjowMDwveG1wOk1ldGFkYXRhRGF0ZT4KICAgICAgICAgPGRjOmZvcm1hdD5p
bWFnZS9wbmc8L2RjOmZvcm1hdD4KICAgICAgICAgPHBob3Rvc2hvcDpDb2xv
ck1vZGU+MzwvcGhvdG9zaG9wOkNvbG9yTW9kZT4KICAgICAgICAgPHhtcE1N
Okluc3RhbmNlSUQ+eG1wLmlpZDo2YzA4N2NiZS0xZjhlLTQ4YmUtYTU1YS00
ZmRmYzVkOTI2OWE8L3htcE1NOkluc3RhbmNlSUQ+CiAgICAgICAgIDx4bXBN
TTpEb2N1bWVudElEPmFkb2JlOmRvY2lkOnBob3Rvc2hvcDoyZTNiY2U2NC04
YTU4LTExNzktOGVmNS04OTFkYzJiZDEwY2Y8L3htcE1NOkRvY3VtZW50SUQ+
CiAgICAgICAgIDx4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ+eG1wLmRpZDo1
MzMwNmRlYi01NjAzLTQyZTEtOTBiMy04Nzc0MmQ2ODdhMDc8L3htcE1NOk9y
aWdpbmFsRG9jdW1lbnRJRD4KICAgICAgICAgPHhtcE1NOkhpc3Rvcnk+CiAg
ICAgICAgICAgIDxyZGY6U2VxPgogICAgICAgICAgICAgICA8cmRmOmxpIHJk
ZjpwYXJzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgICAgICAgPHN0
RXZ0OmFjdGlvbj5jcmVhdGVkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAg
ICAgICAgIDxzdEV2dDppbnN0YW5jZUlEPnhtcC5paWQ6NTMzMDZkZWItNTYw
My00MmUxLTkwYjMtODc3NDJkNjg3YTA3PC9zdEV2dDppbnN0YW5jZUlEPgog
ICAgICAgICAgICAgICAgICA8c3RFdnQ6d2hlbj4yMDE2LTA3LTE0VDE1OjQ2
OjExKzAyOjAwPC9zdEV2dDp3aGVuPgogICAgICAgICAgICAgICAgICA8c3RF
dnQ6c29mdHdhcmVBZ2VudD5BZG9iZSBQaG90b3Nob3AgQ0MgMjAxNSAoTWFj
aW50b3NoKTwvc3RFdnQ6c29mdHdhcmVBZ2VudD4KICAgICAgICAgICAgICAg
PC9yZGY6bGk+CiAgICAgICAgICAgICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlw
ZT0iUmVzb3VyY2UiPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6YWN0aW9u
PnNhdmVkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAgICAgICAgIDxzdEV2
dDppbnN0YW5jZUlEPnhtcC5paWQ6NmMwODdjYmUtMWY4ZS00OGJlLWE1NWEt
NGZkZmM1ZDkyNjlhPC9zdEV2dDppbnN0YW5jZUlEPgogICAgICAgICAgICAg
ICAgICA8c3RFdnQ6d2hlbj4yMDE2LTA3LTE0VDE1OjQ5OjI4KzAyOjAwPC9z
dEV2dDp3aGVuPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6c29mdHdhcmVB
Z2VudD5BZG9iZSBQaG90b3Nob3AgQ0MgMjAxNSAoTWFjaW50b3NoKTwvc3RF
dnQ6c29mdHdhcmVBZ2VudD4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OmNo
YW5nZWQ+Lzwvc3RFdnQ6Y2hhbmdlZD4KICAgICAgICAgICAgICAgPC9yZGY6
bGk+CiAgICAgICAgICAgIDwvcmRmOlNlcT4KICAgICAgICAgPC94bXBNTTpI
aXN0b3J5PgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9y
aWVudGF0aW9uPgogICAgICAgICA8dGlmZjpYUmVzb2x1dGlvbj43MjAwMDAv
MTAwMDA8L3RpZmY6WFJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOllSZXNv
bHV0aW9uPjcyMDAwMC8xMDAwMDwvdGlmZjpZUmVzb2x1dGlvbj4KICAgICAg
ICAgPHRpZmY6UmVzb2x1dGlvblVuaXQ+MjwvdGlmZjpSZXNvbHV0aW9uVW5p
dD4KICAgICAgICAgPGV4aWY6Q29sb3JTcGFjZT42NTUzNTwvZXhpZjpDb2xv
clNwYWNlPgogICAgICAgICA8ZXhpZjpQaXhlbFhEaW1lbnNpb24+MTQyPC9l
eGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGlt
ZW5zaW9uPjEyODwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgIDwvcmRm
OkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAo8P3hwYWNrZXQgZW5kPSJ3
Ij8+x0kGyQAAACBjSFJNAAB6JQAAgIMAAPn/AACA6AAAUggAARVYAAA6lwAA
F2/XWh+QAAAERklEQVR42uzdy4tOcRzH8ffIfUoYK7nGnlIuJZRSYutW4h+Q
+4KVUoSlUiSXWSgSFsrGJSJ2bpH7NSk7uYWZ8Vich9Bg5jyX8z3nvL/1qWma
xfk9vZrzPef5nt+hUqlgTG/jh2CEY4RjhGOEY4xwjHCMcIxwjHCMEY6JBMdq
SPUBpgHbgdtAJ9BR/Xkz0PrjD4VjDQQWAPuA10DlH7kHjBNOeasNWAGcAD78
B0t3eAYLpzw1AVgPXAK6eonlz2wSTjn6lbs1QvkzN4VT3n6llnwRTrn7ldQR
jv2KcOxXhCOc5vUrwrFfEU6Z4GTerwjHfkU4BYMTul8Rjv2KcHIKJ5f9inCy
Ow1tBO4UGYpw6lsjSYacKmWLcNLXAOB6GdEIp7ZaV1Y0wqmtbghHOGnqq3CE
k6YqwhGOcIQjHOEIRzjCEY5whCMc4QhHOMIRjnCEIxzhlAbOV+EIp6d5CxwB
FgNDhCOcf+UFsBuYC/TrzfqEUz4414EtwGSgJe36hFN8OB3AWWAVMKZe6xNO
MeG8A44Cy4ChjVifcIoD5xWwB5gH9G/0+oSTbzi3gK3AlP/0K8IpOZxO4AKw
Bhif5fqEEx/Oe+A4sBwYHmV9wokJ5zWwF5hP8qRouPUJJw6cO8A2YCrJViih
1yec7OB0kWxOsB6YSLwSTiA4H4GTwEpgBLFLOBnDeQPsBxYCg8hPCScjODuA
GUH6FeHkCE7eSzjCEY5whCMc4QhHOMIRjnCEIxzhCEc4whGOcIQjHOEIRzjC
EY5whCMc4QhHOMIpM5xWYA7Ju7PagavAS+DTL8f0mWQi8TZwGtgFLKX7Z8qF
U2A4Y4ENJEPvtb5b4gGwE5gknGLC6U+ymcBFGvdc1zXhFAdOC8nTnC/APQCF
07MaAZwBN48UTu/6mMcE21ZFOLHhtAGPCLh5k3BiwzlJ0F2/hBMXziwCbxcn
nLhw2oUjnDT1TDjCSVNdwhFOmuoMDKdDOJ6q0uSxcOLCORwYzgHhxIUzMzCc
6WWC09R5lTrhPBEQzTGAosPJbF6ljl85PAyE5gHVvZaLCCfEvEodT4ljguC5
D4z++e+2QHBCzavUuZ9qq546s1rLKWDYb+fpgsAJN6/SoEGupcDTJq7hCbCI
bl4wUgQ4IedVGng11w9YApxv0HF/I3kx2hKg718vKXMOJ+y8SpNuCYwG1gLn
gC81HOvnKpbVwKge3YvIOZyw8yoZ3FcaBMyuXkUeAq4Az0nePvOtmvfV310G
DpK8DmAWKTbuzjOc0PMqFLzyDKddOMJJA+eZcISTBk6XcISTBk7oeRXheKpK
Na8inLhwQs+rCCcunNDzKsKJfQMw7LyKcOJ/5RByXkU48b/kDDmvIpx8jFWE
m1cRTr4GucLMqwgnf6OjIeZVhJPvYfXM5lWEU5zHY5o6ryKcoHBMueKHYIRj
hGOEY4RjjHCMcIxwjHCMcIwRjqlDvg8A5/TdLBe62ugAAAAASUVORK5CYII=
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 16064, :content_type image/png, :filename music3213.png, :id #uuid "3a52eb87-b5fe-5df0-98b1-43e80f28d2dc", :metadata {:XMP-tiff:ResolutionUnit inches, :PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :XMP-exif:ExifImageHeight 128, :XMP-xmpMM:HistoryInstanceID [xmp.iid:53306deb-5603-42e1-90b3-87742d687a07 xmp.iid:6c087cbe-1f8e-48be-a55a-4fdfc5d9269a], :XMP-xmpMM:DocumentID adobe:docid:photoshop:2e3bce64-8a58-1179-8ef5-891dc2bd10cf, :XMP-xmpMM:InstanceID xmp.iid:6c087cbe-1f8e-48be-a55a-4fdfc5d9269a, :PNG:GreenX 0.21, :ExifTool:ExifToolVersion 10.4, :XMP-exif:ColorSpace Uncalibrated, :XMP-xmp:CreateDate 2016:07:14 15:46:11+02:00, :Composite:Megapixels 0.018, :XMP-tiff:Orientation Horizontal (normal), :PNG:WhitePointY 0.32899, :XMP-x:XMPToolkit Adobe XMP Core 5.6-c111 79.158325, 2015/09/10-01:10:20        , :System:Directory /tmp/tmp.qSpfBizLgM, :XMP-tiff:XResolution 72, :XMP-photoshop:ColorMode RGB, :XMP-exif:ExifImageWidth 142, :XMP-xmpMM:HistoryAction [created saved], :System:FileSize 16 kB, :PNG:ImageHeight 128, :XMP-xmpMM:HistoryWhen [2016:07:14 15:46:11+02:00 2016:07:14 15:49:28+02:00], :File:FileTypeExtension png, :XMP-xmp:MetadataDate 2016:07:14 15:49:28+02:00, :XMP-xmp:CreatorTool Adobe Photoshop CC 2015 (Macintosh), :File:FileType PNG, :PNG:BitDepth 8, :XMP-xmpMM:HistorySoftwareAgent [Adobe Photoshop CC 2015 (Macintosh) Adobe Photoshop CC 2015 (Macintosh)], :Composite:ImageSize 142x128, :XMP-xmp:ModifyDate 2016:07:14 15:49:28+02:00, :PNG:ColorType RGB with Alpha, :PNG:WhitePointX 0.31269, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 142, :File:MIMEType image/png, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :PNG:BlueY 0.05999, :XMP-xmpMM:HistoryChanged /, :SourceFile /tmp/tmp.qSpfBizLgM/music3213.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG:RedX 0.63999, :PNG:GreenY 0.71, :PNG:BlueX 0.14999, :PNG:RedY 0.33, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName music3213.png, :XMP-tiff:YResolution 72, :PNG-pHYs:PixelUnits meters, :XMP-xmpMM:OriginalDocumentID xmp.did:53306deb-5603-42e1-90b3-87742d687a07, :PNG:Filter Adaptive, :XMP-dc:Format image/png}}
2023-12-12T11:43:55.884Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "f6885671-3bf3-56f2-8e92-b5112d0f703f"]
>debug 4
>debug 5 {:id #uuid "6c8a0d77-6711-5156-a59a-12425ba01cff", :name Werkstatt-Technik}
>debug 5a id #uuid "6c8a0d77-6711-5156-a59a-12425ba01cff"
2023-12-12T11:43:55.884Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "6c8a0d77-6711-5156-a59a-12425ba01cff"]
>debug 5b {:main_category_id #uuid "6c8a0d77-6711-5156-a59a-12425ba01cff", :content iVBORw0KGgoAAAANSUhEUgAAAGYAAACACAYAAAD5whz9AAAABHNCSVQICAgI
fAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAABrVJREFUeJztnVmMVEUUhr9p
GpdhlBmGYZ8BFByJGwGNoMYlPiku8UFNiMTlQU2MRk1QYkz0QY1riNEYE8WM
4oY8EaOGoAYVFRRE2TeHYRjAiAuiYByQ8eFQ0vTC9F2qqqvnfMn/AN1dt6r+
O/d2nzp1LiiKoiiKoiiKoiiKoiiKoiiKoig2qfHdgQqiP3AuMBU4GxgPjAIa
gROBDHAA+B3YAWwB1gLLga8O/7+SElngauAdYC/QE1OHgGXAQ8BYpyOoMuqA
B4DtxDfjWPoQuNjZaKqAfsAdwM/YMSRf7wOjnYwsYFqBr3FjSK5+A8Y5GF+Q
zAD24d4Uo1n2hxgWGeA5/BliNM32QEOiP/A2fg3ZA9xpe6AhkQXew58hh4CX
gSbbAw2JGmAO/kz5HJhofZQBMgs/hnQCN6DRlKJcjlxGXBryN/AoUGt/eGHS
gMSwXJryLtDiYnAh4/K+shINuZTFebgxZDdwOxLaUcpgEXYNOQDMRi6XSpnY
/mtZCExwNpoq4nXsGLIFWavRr78xOAnYjx1jrnI4jgIyPg+eAtOQZd+qI3Rj
rvTdAVuEbswlvjtgi5CNaaKKf3WHbMyZvjtgk5CNqeo0oZCNGeG7AzYJ2Zh6
3x2wScjGHOe7AzbJ+u6A8j+DkMSNJuDZkI3p9t2BlKgF7gMeREJMAJNCNib0
7PoaJEfgGaA577UpIRuzy3cHEjAReAG4qMTr+x32JXUuxe46zI/A9aQb9m8A
XqL3hJEVKR7TOU3YNcboS2BKwr5mgFspf5fBnITH804HbszpQTJi4kQbzgKW
RDzWLTGOU1HYWr0spX+Qm3U5P24HAE8BB2McJ/ioxo24NcboF+BuJHG9GNcA
22K2vSzZlFQGdfjd97IRuJYjXxBagAUJ27w/venxSxv+jDFajKTJJj1JuoEh
Kc6NU+ry/j0Z/8akpTeST48fJgCbOBK6MCzE/6Qm1SHgjMQz5IHTgZ+QQdyb
99pk3Gf5p603E8+QB1qREIwZxA4K05Zewd+kJtVfSBWOoGgFdlI4mJl576sH
uoq8LwTdk3SSXHMaxU3pQUqMDM97/2XAvyXeX6laRGALluPpfSPS/CKfm9nL
ZypJnQT29Xgc5V+Wpud9toYw7jd7kDhaMJxKtOI7e5H7UC5ZYF6ENlzrT+CC
hPPklKimGK2nMLCYBd6K0ZZt/Qqcn3CenHIKcs2NO+BPgePz2swATydoM21t
QL7QBMNY4kdjc7WA4mlN05HfCj5NmQcMTDJJrhlDOqYYfUDxPffjgS9SPE65
2o2cGEHtTBuDnVXIpcDQIsfLALdxdBTBlrqB55F8saAYDWzF3sR0AReWOLbJ
5UrzL9VoH/AictIFRwvQjv2z9iDwCKXTafsBVwBzkTy1uMc5AHyC1AA4OcnE
GHxc91qQhSWX2yjWAHchlZFKkQUmcXR532bkUlSLmNgN/IGEidqB1chS8BLk
t0mwNCP5Wrb/UkppAVqyqoBRyN55X6bk6iPgHLvDDYORVI4pPUg12VTuBSEz
EtiMfzOMlhLYDz0bjETW6H2bYbQMNYURSN6VbzOMvqHKtweWw3Aqy5RvUVMY
hkRRfZthtBytM8YwZG3EtxlGK1BTGAqsw78ZRt8RYAAxbYYiTx/ybYbRStQU
hlB5pjRaHXEANCEBQt9mGH2PmkITEl31bYbRD8BgqyMOgMHAKvybYbQKNYXB
yNnp2wyj1ejjQGhEruO+zTBaQ2AppjZoRL7x+DZDTclhEPKDzbcZRmtRUyrO
lHUUT03qUzQg8SbfZhitR+JxfZoGJDLr2wyjDRRuVOpz1CNrGL7NUFNyqEdW
+3ybYbQRNYWByLp4lIl7Fdk4lEHyxh4nvX2Qm6iCgjdJGYhkkESZuMdKtDUj
YjvFtBlJ5ujTDCD6k7s7OXYV2sUR28vVFgLc926DuUSfvN7qnjwco0015TAZ
ZJPmTTE+ayMhvR3Zq99loe3gaCPemb2d0oXUAD6L2F47VfzYkThsJf694IkS
bd4csR01pQhxajbmqg0p55RF9rw8SbSvy1uR3WVKHkmNSaIOAt0S54IO/Jiy
DTXlmLgukWtMqeonJqXBVNya0olUwVDK4DXcmLIdqRejlMkJwMfYNaULNSUW
tSSLb/VmyjhnI6lC6pCnP6Rpyg5kz7ySkDhrMqW0EzUlVRpInhmzk8Bqc4VC
I/Hzk3dRWA5RSZEhRN8ltgupKq5YZjjlJ5F3IfX3FUcMAGYj1YdKmTIfzZBM
jairkMOA65DyUY1IKai1SFWjjel2TVEURVEURVEURVGUxPwHYcurS2vCftQA
AAAASUVORK5CYII=
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 1811, :content_type image/png, :filename werkzeug.png, :id #uuid "f4e1f230-df2e-5e95-bf89-827f7a6b4b3b", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.013, :System:Directory /tmp/tmp.qSpfBizLgM, :System:FileSize 1811 bytes, :PNG:ImageHeight 128, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 102x128, :PNG:ColorType RGB with Alpha, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 102, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/werkzeug.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName werkzeug.png, :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-12T11:43:55.885Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "6c8a0d77-6711-5156-a59a-12425ba01cff"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.886Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.886Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.887Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.887Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.887Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.888Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.888Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.888Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.888Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.888Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.889Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.889Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.889Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.889Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.889Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.890Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.890Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.890Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.890Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.891Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.891Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.891Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.891Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.891Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.891Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.892Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.892Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.892Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.892Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.892Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.892Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.892Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.893Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.893Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.893Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.896Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.896Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.896Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.897Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.897Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.897Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.897Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.897Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.897Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.897Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.898Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.903Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.903Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.904Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.905Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.906Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.906Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.906Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.906Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.907Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.907Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.907Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.907Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.908Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.908Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.909Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.909Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.909Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.909Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.909Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.909Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.909Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.910Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.910Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.910Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.911Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.912Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.912Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.912Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.912Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.913Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.913Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.913Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.913Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.913Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.915Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.915Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.916Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.917Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.917Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.917Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.917Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.917Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.918Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.918Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.920Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.920Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.921Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.921Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.922Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.922Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.922Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.923Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.923Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.924Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.924Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.924Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.924Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.925Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.925Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.925Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.925Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.925Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.926Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.926Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.926Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.926Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.927Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.928Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.928Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.928Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.929Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.929Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.929Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.929Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.929Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.930Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.930Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.930Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.930Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.934Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.934Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.934Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.935Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.935Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.935Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.935Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.935Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.936Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.936Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.937Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.937Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.937Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.938Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.938Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.938Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.938Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.938Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.939Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.939Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.941Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.941Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.941Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.941Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.941Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.941Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.941Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.942Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.942Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.942Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.942Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.944Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.945Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.945Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.945Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.946Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.946Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.946Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.946Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.946Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.947Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.947Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.947Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.947Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.948Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.948Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.948Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.949Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.949Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.949Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.949Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.949Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.950Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.951Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.951Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.954Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.954Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.954Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.955Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.955Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.955Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.955Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.956Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.957Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.957Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.957Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.957Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.958Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.958Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.958Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.958Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.958Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.959Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.959Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.959Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.961Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.961Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.961Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.962Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.962Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.962Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.962Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.963Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.963Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.963Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.963Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.965Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.965Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.967Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.967Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.967Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.967Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.967Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.968Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.968Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.968Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.968Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.968Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.969Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.969Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.970Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.970Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.970Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.971Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.971Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.971Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.971Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.971Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.971Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.971Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.974Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.974Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.975Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.975Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.975Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.975Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.975Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.975Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.976Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.976Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.978Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.978Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.978Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.978Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.979Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.979Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.979Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.979Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.980Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.980Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.981Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.981Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.982Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.982Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.982Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.982Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.982Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.983Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.983Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.983Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.983Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.985Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.986Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.986Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.986Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.986Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.986Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.987Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.987Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.987Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.987Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.987Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.988Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.988Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.989Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:55.989Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:55.989Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:55.989Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:55.990Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:55.990Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false

>request-grapql _> request {:leihs-user-language {:name Deutsch, :locale de-CH, :default true, :active true}, :authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 219b97e6-bb13-401e-92a7-2304bf206106}, leihs-user-session {:value d429c048-7118-407f-a7a9-b33da6f15b06}}, :remote-addr 127.0.0.1, :start-time 48742353554708, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type application/json, cookie leihs-anti-csrf-token=219b97e6-bb13-401e-92a7-2304bf206106; leihs-user-session=d429c048-7118-407f-a7a9-b33da6f15b06, content-length 255, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/admin/categories/dda588f4660c573ca2ff944ae93ad42e, connection keep-alive, pragma no-cache, x-csrf-token 219b97e6-bb13-401e-92a7-2304bf206106, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0xe214599 /127.0.0.1:3230<->/127.0.0.1:56143], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x65dc1b71 HikariDataSource (db-pool)]}, :content-length 255, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:operationName MainCategoriesIndex, :variables {}, :query query MainCategoriesIndex {
  main_categories {
    id
    name
    image_url
    categories {
      id
      name
      can_delete
      __typename
    }
    __typename
  }
}
}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0xbde374d leihs.procurement.graphql$handler@bde374d], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>request-c-grapql _> request (json) {"leihs-user-language":{"name":"Deutsch","locale":"de-CH","default":true,"active":true},"authenticated-entity":{"email":"manuel.radl@zhdk.ch","contracts_count":1,"lastname":"Radl","org_id":"271682","scope_read":true,"is_admin":true,"authentication-method":"session","login":"mradl","scope_system_admin_write":true,"scope_write":true,"firstname":"Manuel","scope_admin_write":true,"user_session_created_at":"2023-12-12T11:17:19.570671Z","id":"a786135f-c159-4618-9dd3-0012ebb3d500","user_session_id":"463ca0ef-36e9-430c-b982-23371c7fc689","scope_system_admin_read":true,"access-rights":[{"role":"customer","inventory_pool_id":"3977012c-ce0e-501f-889b-8715fdb5d83b"},{"role":"customer","inventory_pool_id":"5863967f-9804-4909-a9b7-92254616d6b2"},{"role":"customer","inventory_pool_id":"5dd25b58-fa56-5095-bd97-2696d92c2fb1"},{"role":"customer","inventory_pool_id":"77e88ec8-9ff6-5435-818e-dc902fc631a6"},{"role":"inventory_manager","inventory_pool_id":"8bd16d45-056d-5590-bc7f-12849f034351"},{"role":"inventory_manager","inventory_pool_id":"a02b8163-9a16-5066-b48e-9eb74cf8b791"},{"role":"inventory_manager","inventory_pool_id":"b534b07c-d9bf-4572-840c-0a630b8cd8ed"},{"role":"customer","inventory_pool_id":"fc5a841e-36c6-5dc3-8207-1306c1fb89bf"},{"role":"customer","inventory_pool_id":"ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}],"user_id":"a786135f-c159-4618-9dd3-0012ebb3d500","is_system_admin":true,"external_sign_out_url":null,"language_locale":"de-CH","inventory_pool_roles_count":9,"scope_admin_read":true},"cookies":{"leihs-anti-csrf-token":{"value":"219b97e6-bb13-401e-92a7-2304bf206106"},"leihs-user-session":{"value":"d429c048-7118-407f-a7a9-b33da6f15b06"}},"remote-addr":"127.0.0.1","start-time":48742353554708,"params":{},"settings":{"email_sending_enabled":false,"sessions_max_lifetime_secs":432000,"smtp_default_from_address":"noreply@zhdk.ch","public_image_caching_enabled":true,"sessions_force_secure":false,"deliver_received_order_notifications":false,"external_base_url":"http:\/\/localhost:3200","sessions_force_uniqueness":false,"email_signature":"Das ZHdK-Ausleihe-Team"},"query-params-raw":{},"route-params":null,"headers":{"origin":"http:\/\/localhost:3230","sec-fetch-site":"same-origin","sec-ch-ua-mobile":"?0","host":"localhost:3230","user-agent":"Mozilla\/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit\/537.36 (KHTML, like Gecko) Chrome\/119.0.0.0 Safari\/537.36","content-type":"application\/json","cookie":"leihs-anti-csrf-token=219b97e6-bb13-401e-92a7-2304bf206106; leihs-user-session=d429c048-7118-407f-a7a9-b33da6f15b06","content-length":"255","sec-ch-ua":"\"Google Chrome\";v=\"119\", \"Chromium\";v=\"119\", \"Not?A_Brand\";v=\"24\"","sec-ch-ua-platform":"\"macOS\"","referer":"http:\/\/localhost:3230\/procure\/admin\/categories\/dda588f4660c573ca2ff944ae93ad42e","connection":"keep-alive","pragma":"no-cache","x-csrf-token":"219b97e6-bb13-401e-92a7-2304bf206106","accept":"application\/json","accept-language":"de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7","sec-fetch-dest":"empty","accept-encoding":"gzip, deflate, br","sec-fetch-mode":"cors","cache-control":"no-cache"},"server-port":3230,"params-raw":{},"content-length":255,"form-params":{},"websocket?":false,"query-params":{},"content-type":"application\/json","form-params-raw":{},"character-encoding":"utf8","uri":"\/procure\/graphql","server-name":"localhost","handler-key":"graphql","query-string":null,"body":{"operationName":"MainCategoriesIndex","variables":{},"query":"query MainCategoriesIndex {\n  main_categories {\n    id\n    name\n    image_url\n    categories {\n      id\n      name\n      can_delete\n      __typename\n    }\n    __typename\n  }\n}\n"},"multipart-params":{},"scheme":"http","request-method":"post","accept":{"mime":"json","charset":null,"encoding":null,"language":null}}

>request-grapql _> result => {:data #ordered/map ([:main_categories [#ordered/map ([:id 519f7a95-9ca7-5256-bf63-142cfc23dc62] [:name Audio- und Videotechnik] [:image_url /procure/images/ee215167-b2c3-5fcc-90c3-098ad20d16ea] [:categories [#ordered/map ([:id 4e48b48c-e1bf-50d7-ab2d-9aa438c638de] [:name Beamer] [:can_delete false] [:__typename :Category]) #ordered/map ([:id a1727606-c7c8-54a2-aaa1-ceff7a7d4b40] [:name Funk-Strecken] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 00382e27-a87a-5313-b31b-a369dad6c5f8] [:name Lautsprecher] [:can_delete false] [:__typename :Category]) #ordered/map ([:id ce5424cc-ce77-5e67-8201-333ec20963eb] [:name Lautsprecherstative] [:can_delete false] [:__typename :Category]) #ordered/map ([:id ce0812d7-080b-5f49-8530-dd4a821c57b6] [:name Mikrofone] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 67e5fc60-6fe3-53bb-9495-3669b917038a] [:name Mikrofonstative] [:can_delete false] [:__typename :Category]) #ordered/map ([:id f94f72e8-ff65-5bad-b1f9-81ddd8fa7c0c] [:name Monitore / Screens] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 89e4a22f-7d6c-5006-b26a-3ef6f8f19630] [:name Schnittplatz / Mischpult / Regie] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 1fb59e17-a703-5abc-8a80-fc7a9c20ee1d] [:name Video/Film-Kameras] [:can_delete false] [:__typename :Category]) #ordered/map ([:id c17698c1-5d5d-51ea-927f-b6ca96431a50] [:name Video/Film-Stative] [:can_delete false] [:__typename :Category]) #ordered/map ([:id fabe3b8c-58b5-5009-8873-cc3e945a7c0d] [:name Video/Filmobjektive] [:can_delete false] [:__typename :Category]) #ordered/map ([:id ebb12585-ce23-5cbe-8f4f-41a42d60a656] [:name Zuteilung unbekannt - Audio- und Videotechnik] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id 1a047acd-dc98-52c2-99d3-dc6332adc1e0] [:name Bauliche Anpassungen und Mobiliar] [:image_url /procure/images/8e07c37e-d244-514d-bfa9-306158056160] [:categories [#ordered/map ([:id 0a082661-cc1c-5b49-baab-f4db926faa7e] [:name Bauprojekte] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 42cc2d9a-cc45-5d77-85d3-0f21270d7a35] [:name Einrichtungsprojekte] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 56aaec64-8d65-50b3-bd81-f788d477b927] [:name Mobiliarergänzungen] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 483ac871-b632-5dcd-9d37-789d65f4c424] [:name Schliessanlagen und Türen] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 2b3749a2-6a59-5a25-9b9f-32f5e485e635] [:name Signaletik] [:can_delete false] [:__typename :Category]) #ordered/map ([:id fad911e4-8c69-535c-a138-f3e2544519ba] [:name Vorhänge] [:can_delete false] [:__typename :Category]) #ordered/map ([:id c3f14f79-931c-52c8-a847-ed77449ce9a6] [:name Zuteilung unbekannt - Bauliche Anpassungen und Mobiliar] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id dda588f4-660c-573c-a2ff-944ae93ad42e] [:name Beleuchtungstechnik] [:image_url /procure/images/8debe2ef-4a7e-58a1-bf4c-1622dead4579] [:categories [#ordered/map ([:id b9e4f492-55e3-57e4-9467-91c81bfe2325] [:name Bühnenlicht] [:can_delete false] [:__typename :Category]) #ordered/map ([:id a7cca5a4-e265-5f36-b794-1024c8aacc3e] [:name Film-Beleuchtung] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 79822b89-0edb-588c-b9e5-65b7722ac50b] [:name Kameralicht] [:can_delete false] [:__typename :Category]) #ordered/map ([:id ab911807-6431-5ca7-890a-3573737bb4d3] [:name Mobiles Raumlicht für Ausstellungen] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 64c6f8ad-a1b7-530b-946a-ebb1644ac897] [:name Studio-Licht] [:can_delete false] [:__typename :Category]) #ordered/map ([:id f2bb3f23-bb5b-5855-b03f-0166bd19fc0c] [:name Zuteilung unbekannt - Beleuchtungstechnik] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id 2b07eb8a-4174-5257-83eb-920d536cc44a] [:name Betriebseinrichtungen und Fahrzeuge] [:image_url /procure/images/3d6cbe63-c327-5c6b-b7fa-48e6c52f2cdc] [:categories [#ordered/map ([:id 5d8639a3-4569-5009-af28-f63f2af5209d] [:name Betriebseinrichtungen] [:can_delete false] [:__typename :Category]) #ordered/map ([:id b34f1cbb-4ac7-59a0-81f2-3ca7ecc94e71] [:name Fahrzeuge] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 73e97867-43ea-5bee-b46b-d7c74fbf873b] [:name Hub- und Hebegeräte] [:can_delete false] [:__typename :Category]) #ordered/map ([:id b6601a86-b5d3-5682-88b6-cff956b00d7b] [:name Zuteilung unbekannt - Betriebseinrichtungen und Fahrzeuge] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id f6827594-33a6-5760-ac41-f94ceefacfab] [:name Bühnentechnik] [:image_url /procure/images/9a8cba78-10ab-585b-a4c2-9d8e7f0818ee] [:categories [#ordered/map ([:id 455bc6dc-afbd-579d-a621-6d75e0fca9ea] [:name Bühnentechnik] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 747b6b21-9fad-4a01-acd9-cd8983aed286] [:name Fundus] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 07a6af37-e127-5f4b-94ec-698a5698d98c] [:name Zuteilung unbekannt - Bühnentechnik] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id 517b82ae-2b7e-4822-9aeb-0d4753dec821] [:name Darlehen] [:image_url nil] [:categories [#ordered/map ([:id 671ab85c-b8c1-4659-9c6e-9ebe2f122a59] [:name Darlehen] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id ca1d97ac-0ac4-597a-8edb-f9c466b1c7da] [:name Fotografie] [:image_url /procure/images/07a33b4c-d274-54e5-a2ce-11f26d57be05] [:categories [#ordered/map ([:id e1b4cad8-0416-5cf7-9e4a-dde208d0abad] [:name Blitzanlagen] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 011ff3f3-09fa-59e1-9713-52466786adf8] [:name Fotokameras] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 54b87eb0-061c-5a97-96ad-e9b6da605184] [:name Fotostative] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 5858ec5d-5f01-50fb-bc96-4b4766bd7799] [:name Kompakt-Blitze] [:can_delete false] [:__typename :Category]) #ordered/map ([:id ba5b41a7-4317-5160-9b82-b0931a48aec0] [:name Objektive] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 9df68a66-4523-5072-aa31-1df9abeaa1c7] [:name Zuteilung unbekannt - Fotografie] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id 2ea39047-e663-50d5-9080-838b75883704] [:name IT & Elektronik] [:image_url /procure/images/1464e46c-e726-54a9-a42b-f937a0342d22] [:categories [#ordered/map ([:id f2531d7e-d9ff-5c3e-9e88-6d3a16a89aa1] [:name Desktop] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 1af3a7f2-b16a-4203-b6ac-f2c7be612d74] [:name IT_Projekte] [:can_delete false] [:__typename :Category]) #ordered/map ([:id ccab158d-79c7-5c28-a8a2-47cb4925f101] [:name IT-Basisinfrastruktur] [:can_delete false] [:__typename :Category]) #ordered/map ([:id eb1e7bef-80c6-4958-b16e-35555735ce61] [:name IT-Security] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 4ecc9e97-2d12-5173-bd8c-781482c842e8] [:name Laptops] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 80226a51-c17a-5fd8-93db-40aef5b03491] [:name Monitore] [:can_delete false] [:__typename :Category]) #ordered/map ([:id fe602c35-1097-52d0-acd0-40579d295f00] [:name Scanner] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 56065d53-cd2f-5a39-9b66-532fd83ad2e6] [:name Schnittstellengeräte] [:can_delete false] [:__typename :Category]) #ordered/map ([:id fc7bc38c-62f3-5576-802f-c874e06ee776] [:name Software] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 76fdca98-4a2a-5640-bc98-f33059d6ffa0] [:name Tablets] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 77857566-03d9-58f4-8b0d-290227434aff] [:name Telefon] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 5059c4fc-d34c-5c9a-9efe-257c7ec6fb6b] [:name Zuteilung unbekannt - IT & Elektronik] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id f6885671-3bf3-56f2-8e92-b5112d0f703f] [:name Musikinstrumente] [:image_url /procure/images/3a52eb87-b5fe-5df0-98b1-43e80f28d2dc] [:categories [#ordered/map ([:id af3372a1-63a8-52dc-850e-c2ae91c1c078] [:name Musikinstrumente] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 17a52112-1986-5074-b1d9-0faff29a785b] [:name Zuteilung unbekannt - Musikinstrumente] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id 6c8a0d77-6711-5156-a59a-12425ba01cff] [:name Werkstatt-Technik] [:image_url /procure/images/f4e1f230-df2e-5e95-bf89-827f7a6b4b3b] [:categories [#ordered/map ([:id 6870a16c-9a71-5e60-b94a-f0b784398fec] [:name Handwerkzeug] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 771fddcf-b19a-5e6b-8b6f-7266b6922c4f] [:name Maschinen] [:can_delete false] [:__typename :Category]) #ordered/map ([:id c7ece4a6-2b5c-409f-96ea-e4fd6e8f9792] [:name Sicherheit] [:can_delete false] [:__typename :Category]) #ordered/map ([:id 3eaad5d5-516a-5610-8caf-342cfdcaac62] [:name Zuteilung unbekannt - Werkstatt-Technik] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory])]])}
2023-12-12T11:43:55.998Z NX-41294 DEBUG [leihs.procurement.graphql:86] - result => {:data #ordered/map ([:main_categories [#ordered/map ([:id "519f7a95-9ca7-5256-bf63-142cfc23dc62"] [:name "Audio- und Videotechnik"] [:image_url "/procure/images/ee215167-b2c3-5fcc-90c3-098ad20d16ea"] [:categories [#ordered/map ([:id "4e48b48c-e1bf-50d7-ab2d-9aa438c638de"] [:name "Beamer"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "a1727606-c7c8-54a2-aaa1-ceff7a7d4b40"] [:name "Funk-Strecken"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "00382e27-a87a-5313-b31b-a369dad6c5f8"] [:name "Lautsprecher"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "ce5424cc-ce77-5e67-8201-333ec20963eb"] [:name "Lautsprecherstative"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "ce0812d7-080b-5f49-8530-dd4a821c57b6"] [:name "Mikrofone"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "67e5fc60-6fe3-53bb-9495-3669b917038a"] [:name "Mikrofonstative"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "f94f72e8-ff65-5bad-b1f9-81ddd8fa7c0c"] [:name "Monitore / Screens"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "89e4a22f-7d6c-5006-b26a-3ef6f8f19630"] [:name "Schnittplatz / Mischpult / Regie"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "1fb59e17-a703-5abc-8a80-fc7a9c20ee1d"] [:name "Video/Film-Kameras"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "c17698c1-5d5d-51ea-927f-b6ca96431a50"] [:name "Video/Film-Stative"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "fabe3b8c-58b5-5009-8873-cc3e945a7c0d"] [:name "Video/Filmobjektive"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "ebb12585-ce23-5cbe-8f4f-41a42d60a656"] [:name "Zuteilung unbekannt - Audio- und Videotechnik"] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "1a047acd-dc98-52c2-99d3-dc6332adc1e0"] [:name "Bauliche Anpassungen und Mobiliar"] [:image_url "/procure/images/8e07c37e-d244-514d-bfa9-306158056160"] [:categories [#ordered/map ([:id "0a082661-cc1c-5b49-baab-f4db926faa7e"] [:name "Bauprojekte"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "42cc2d9a-cc45-5d77-85d3-0f21270d7a35"] [:name "Einrichtungsprojekte"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "56aaec64-8d65-50b3-bd81-f788d477b927"] [:name "Mobiliarergänzungen"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "483ac871-b632-5dcd-9d37-789d65f4c424"] [:name "Schliessanlagen und Türen"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "2b3749a2-6a59-5a25-9b9f-32f5e485e635"] [:name "Signaletik"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "fad911e4-8c69-535c-a138-f3e2544519ba"] [:name "Vorhänge"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "c3f14f79-931c-52c8-a847-ed77449ce9a6"] [:name "Zuteilung unbekannt - Bauliche Anpassungen und Mobiliar"] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "dda588f4-660c-573c-a2ff-944ae93ad42e"] [:name "Beleuchtungstechnik"] [:image_url "/procure/images/8debe2ef-4a7e-58a1-bf4c-1622dead4579"] [:categories [#ordered/map ([:id "b9e4f492-55e3-57e4-9467-91c81bfe2325"] [:name "Bühnenlicht"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "a7cca5a4-e265-5f36-b794-1024c8aacc3e"] [:name "Film-Beleuchtung"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "79822b89-0edb-588c-b9e5-65b7722ac50b"] [:name "Kameralicht"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "ab911807-6431-5ca7-890a-3573737bb4d3"] [:name "Mobiles Raumlicht für Ausstellungen"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "64c6f8ad-a1b7-530b-946a-ebb1644ac897"] [:name "Studio-Licht"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "f2bb3f23-bb5b-5855-b03f-0166bd19fc0c"] [:name "Zuteilung unbekannt - Beleuchtungstechnik"] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "2b07eb8a-4174-5257-83eb-920d536cc44a"] [:name "Betriebseinrichtungen und Fahrzeuge"] [:image_url "/procure/images/3d6cbe63-c327-5c6b-b7fa-48e6c52f2cdc"] [:categories [#ordered/map ([:id "5d8639a3-4569-5009-af28-f63f2af5209d"] [:name "Betriebseinrichtungen"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "b34f1cbb-4ac7-59a0-81f2-3ca7ecc94e71"] [:name "Fahrzeuge"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "73e97867-43ea-5bee-b46b-d7c74fbf873b"] [:name "Hub- und Hebegeräte"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "b6601a86-b5d3-5682-88b6-cff956b00d7b"] [:name "Zuteilung unbekannt - Betriebseinrichtungen und Fahrzeuge"] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "f6827594-33a6-5760-ac41-f94ceefacfab"] [:name "Bühnentechnik"] [:image_url "/procure/images/9a8cba78-10ab-585b-a4c2-9d8e7f0818ee"] [:categories [#ordered/map ([:id "455bc6dc-afbd-579d-a621-6d75e0fca9ea"] [:name "Bühnentechnik"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "747b6b21-9fad-4a01-acd9-cd8983aed286"] [:name "Fundus"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "07a6af37-e127-5f4b-94ec-698a5698d98c"] [:name "Zuteilung unbekannt - Bühnentechnik"] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "517b82ae-2b7e-4822-9aeb-0d4753dec821"] [:name "Darlehen"] [:image_url nil] [:categories [#ordered/map ([:id "671ab85c-b8c1-4659-9c6e-9ebe2f122a59"] [:name "Darlehen"] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da"] [:name "Fotografie"] [:image_url "/procure/images/07a33b4c-d274-54e5-a2ce-11f26d57be05"] [:categories [#ordered/map ([:id "e1b4cad8-0416-5cf7-9e4a-dde208d0abad"] [:name "Blitzanlagen"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "011ff3f3-09fa-59e1-9713-52466786adf8"] [:name "Fotokameras"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "54b87eb0-061c-5a97-96ad-e9b6da605184"] [:name "Fotostative"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "5858ec5d-5f01-50fb-bc96-4b4766bd7799"] [:name "Kompakt-Blitze"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "ba5b41a7-4317-5160-9b82-b0931a48aec0"] [:name "Objektive"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "9df68a66-4523-5072-aa31-1df9abeaa1c7"] [:name "Zuteilung unbekannt - Fotografie"] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "2ea39047-e663-50d5-9080-838b75883704"] [:name "IT & Elektronik"] [:image_url "/procure/images/1464e46c-e726-54a9-a42b-f937a0342d22"] [:categories [#ordered/map ([:id "f2531d7e-d9ff-5c3e-9e88-6d3a16a89aa1"] [:name "Desktop"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "1af3a7f2-b16a-4203-b6ac-f2c7be612d74"] [:name "IT_Projekte"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "ccab158d-79c7-5c28-a8a2-47cb4925f101"] [:name "IT-Basisinfrastruktur"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "eb1e7bef-80c6-4958-b16e-35555735ce61"] [:name "IT-Security"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "4ecc9e97-2d12-5173-bd8c-781482c842e8"] [:name "Laptops"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "80226a51-c17a-5fd8-93db-40aef5b03491"] [:name "Monitore"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "fe602c35-1097-52d0-acd0-40579d295f00"] [:name "Scanner"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "56065d53-cd2f-5a39-9b66-532fd83ad2e6"] [:name "Schnittstellengeräte"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "fc7bc38c-62f3-5576-802f-c874e06ee776"] [:name "Software"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "76fdca98-4a2a-5640-bc98-f33059d6ffa0"] [:name "Tablets"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "77857566-03d9-58f4-8b0d-290227434aff"] [:name "Telefon"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "5059c4fc-d34c-5c9a-9efe-257c7ec6fb6b"] [:name "Zuteilung unbekannt - IT & Elektronik"] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "f6885671-3bf3-56f2-8e92-b5112d0f703f"] [:name "Musikinstrumente"] [:image_url "/procure/images/3a52eb87-b5fe-5df0-98b1-43e80f28d2dc"] [:categories [#ordered/map ([:id "af3372a1-63a8-52dc-850e-c2ae91c1c078"] [:name "Musikinstrumente"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "17a52112-1986-5074-b1d9-0faff29a785b"] [:name "Zuteilung unbekannt - Musikinstrumente"] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "6c8a0d77-6711-5156-a59a-12425ba01cff"] [:name "Werkstatt-Technik"] [:image_url "/procure/images/f4e1f230-df2e-5e95-bf89-827f7a6b4b3b"] [:categories [#ordered/map ([:id "6870a16c-9a71-5e60-b94a-f0b784398fec"] [:name "Handwerkzeug"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "771fddcf-b19a-5e6b-8b6f-7266b6922c4f"] [:name "Maschinen"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "c7ece4a6-2b5c-409f-96ea-e4fd6e8f9792"] [:name "Sicherheit"] [:can_delete false] [:__typename :Category]) #ordered/map ([:id "3eaad5d5-516a-5610-8caf-342cfdcaac62"] [:name "Zuteilung unbekannt - Werkstatt-Technik"] [:can_delete false] [:__typename :Category])]] [:__typename :MainCategory])]])}
>>> authenticate::skip= nil  handler-key= :graphql
>>> authenticate::authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}

>> authorize >

>> authorize::handler > #object[leihs.core.locale$wrap$fn__45159 0x55069a5c leihs.core.locale$wrap$fn__45159@55069a5c]

>> authorize::request > {:authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 219b97e6-bb13-401e-92a7-2304bf206106}, leihs-user-session {:value d429c048-7118-407f-a7a9-b33da6f15b06}}, :remote-addr 127.0.0.1, :start-time 48742518587708, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type application/json, cookie leihs-anti-csrf-token=219b97e6-bb13-401e-92a7-2304bf206106; leihs-user-session=d429c048-7118-407f-a7a9-b33da6f15b06, content-length 595, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/admin/categories/dda588f4660c573ca2ff944ae93ad42e, connection keep-alive, pragma no-cache, x-csrf-token 219b97e6-bb13-401e-92a7-2304bf206106, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x5b509e0f /127.0.0.1:3230<->/127.0.0.1:56143], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x65dc1b71 HikariDataSource (db-pool)]}, :content-length 595, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:operationName MainCategories, :variables {}, :query query MainCategories {
  main_categories {
    ...MainCatProps
    __typename
  }
}

fragment MainCatProps on MainCategory {
  id
  name
  can_delete
  image_url
  categories {
    id
    name
    can_delete
    cost_center
    general_ledger_account
    procurement_account
    inspectors {
      ...UserProps
      __typename
    }
    viewers {
      ...UserProps
      __typename
    }
    __typename
  }
  __typename
}

fragment UserProps on User {
  id
  firstname
  lastname
  __typename
}
}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0xbde374d leihs.procurement.graphql$handler@bde374d], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>> authorize::handler-key >> :graphql
>myprint>  authEnt? {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>myprint>  txn #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
2023-12-12T11:43:56.031Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.032Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.032Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>myprint>  admin true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.032Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> inspector? {:result false}
>myprint>  inspector false
>o> viewer? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.032Z NX-41294 DEBUG [leihs.procurement.permissions.user:85] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> viewer? {:result false}
>myprint>  viewer false
>o> requester?? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.032Z NX-41294 DEBUG [leihs.procurement.permissions.user:169] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> requester?? {:exists false}
2023-12-12T11:43:56.033Z NX-41294 DEBUG [leihs.procurement.permissions.user:173] - (:exists result) => false
>myprint>  requester false
2023-12-12T11:43:56.033Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.033Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.033Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.033Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> inspector? {:result false}
>o> viewer? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.034Z NX-41294 DEBUG [leihs.procurement.permissions.user:85] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> viewer? {:result false}
>o> requester?? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.034Z NX-41294 DEBUG [leihs.procurement.permissions.user:169] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> requester?? {:exists false}
2023-12-12T11:43:56.034Z NX-41294 DEBUG [leihs.procurement.permissions.user:173] - (:exists result) => false

> 1 anti-csrf-token >  219b97e6-bb13-401e-92a7-2304bf206106

> 1 anti-csrf-token class >  java.lang.String

> 2 anti-csrf-token-new >  nil
pure-handler >> 2
2023-12-12T11:43:56.037Z NX-41294 DEBUG [leihs.procurement.graphql:46] - graphql query query MainCategories {
  main_categories {
    ...MainCatProps
    __typename
  }
}

fragment MainCatProps on MainCategory {
  id
  name
  can_delete
  image_url
  categories {
    id
    name
    can_delete
    cost_center
    general_ledger_account
    procurement_account
    inspectors {
      ...UserProps
      __typename
    }
    viewers {
      ...UserProps
      __typename
    }
    __typename
  }
  __typename
}

fragment UserProps on User {
  id
  firstname
  lastname
  __typename
}
 with variables {}
>oo> vars from graphQL-Requst nil nil nil {}
>debug 2
>debug 3
2023-12-12T11:43:56.038Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format main-categories-base-query) => ["SELECT procurement_main_categories.* FROM procurement_main_categories ORDER BY procurement_main_categories.name ASC"]
>debug 4
>debug 5 {:id #uuid "519f7a95-9ca7-5256-bf63-142cfc23dc62", :name Audio- und Videotechnik}
>debug 5a id #uuid "519f7a95-9ca7-5256-bf63-142cfc23dc62"
2023-12-12T11:43:56.039Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "519f7a95-9ca7-5256-bf63-142cfc23dc62"]
>debug 5b {:main_category_id #uuid "519f7a95-9ca7-5256-bf63-142cfc23dc62", :content iVBORw0KGgoAAAANSUhEUgAAAHAAAACACAYAAADTcu1SAAAABHNCSVQICAgI
fAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAAA9tJREFUeJzt3U1rVFcAgOE3
Y6maVJeK/gIpbWmtJtaPneCqiOBfKLTgv3EtVPAPCEKroGsVEYpYu5LSYpd+
tDXtKtPFyQRTJ7lzzz0fOZn3gbNy7szNeefeTO7FOSBJkiRJkiRJkiRJkiRJ
kqTdYCHi8V8AF4AV4BhwBDgQ8Vy1jYG/gD+AX4AHwI/AT+v/tqvsB64QftDx
Lh8/A98B+5LM3A5wGfid+hNbevwGXEowfyl8TDg7/AusAreAz7o2WgJuUH8i
a4/rwGLXZGX0JfBqyn6tAstbbXQYeDxlo3kdj9bnpLQTTI83GfembXQYeLbN
RvM6ngGHOqc8na54Y+Cf/2+0hEfeduMRZU6ns8SbjE38ndc9vu+a/YFOAq97
7M+GyxE/zLyOi90dovSNtxFwP/P5p0Ls+BXY292jl2X6x9sIeKXSRLQ8vu1u
MrPYeGMIl8Dm4QpL6vGUNJcPl4E3A/aD4ztgMlodnVdDOqwwLN54RLgwrThD
5m4FuAMcHLIDo/UnUpxTA7YbHA/gA8ItIcWJmbtJvAMpdmBEuJ+nOEd7Pj5p
PAifotZo72bsTrEG7JnxsV8Bt0kYD0K4cconnEOzvPlPE+7nJY0H4RSqvLLF
g/AhRvmcJpw2P8r1Ah6B+WSPBwbM5QwF4oEBczhL+J2XPR4YMLWzwA8Uigd+
iElpcuQtlXxRj8A0zlEhHhgwhXOE02bxeOCVmBTeUikeGLB5nkIbZ8DGGbBx
BmycARtnwMYZsHEGbJwBG2fAxhmwcQZsnAEbZ8DGGbBxBmycARtnwMYZsHEG
bJwBG2fA4V7VfHEDDneeihENONxjKkY0YBrVIhownSoRDZhW8YgGTK9oRAPm
USyiAfMpEtGAeWWPaMD8skYc4X/wHGJtxsdlizgiLMGmOH/2eGyWiCPC+nmK
86Ln45NHHBG+sV5xYuYuacQRYeVKxbkfuV3SiJ9T/+v7Wx2fRMz3u44DLwfu
AwuEZUdrT0Zr4wlpvqp6UMTJnxFXE+zIvLnK+hEwUJLT6T7CmrG139WtjOfA
h1EzvbXYI3HDpYIT0Pr4uqtGpJiIm1xP8MPt9nGtI8JQfSNuskhYZrT2JO3U
8ZCw1mJufSK+x0WQp4/SiyDPEvG9RZAnDuGR+O54SNl4E10R72638SJhwd/a
k1d7XKPMaXMrW0V8S1hzt9NFwpqxtSey9HhOvk+bfR0DbgGrwN/ATXpeBdpL
WDP2KfUnNvd4AnxD+r/zsuh7KWgB+JSwcuUpwjvjKGEhw9bu7q8R7ue9INxV
uE/44vLJm1SSJEmSJEmSJEmSJEmSJEkq5j8E8YerHU6LEAAAAABJRU5ErkJg
gg==
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 1081, :content_type image/png, :filename video.png, :id #uuid "ee215167-b2c3-5fcc-90c3-098ad20d16ea", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.014, :System:Directory /tmp/tmp.qSpfBizLgM, :System:FileSize 1081 bytes, :PNG:ImageHeight 128, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 112x128, :PNG:ColorType RGB with Alpha, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 112, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/video.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName video.png, :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-12T11:43:56.040Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "519f7a95-9ca7-5256-bf63-142cfc23dc62"]
>debug 4
>debug 5 {:id #uuid "1a047acd-dc98-52c2-99d3-dc6332adc1e0", :name Bauliche Anpassungen und Mobiliar}
>debug 5a id #uuid "1a047acd-dc98-52c2-99d3-dc6332adc1e0"
2023-12-12T11:43:56.040Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "1a047acd-dc98-52c2-99d3-dc6332adc1e0"]
>debug 5b {:main_category_id #uuid "1a047acd-dc98-52c2-99d3-dc6332adc1e0", :content iVBORw0KGgoAAAANSUhEUgAAAGQAAACACAYAAAD9N8zAAAAABHNCSVQICAgI
fAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAABiNJREFUeJztnXmoVVUUh7+r
PvVpZebLHDJDsGywMiuLioSIIsMsMiqpoIIgqEwKLYUiqCAaoD+KlCQblKKR
BopSG0xJyyJKmp2liTSnJn32x763nqd97rD2uffu897vgwXCO2etvffv3Lv3
XnudKwghhBBCCCGEEEIIIYQQQgghhBBCCCFyTqHZDciAfsCw4r/XA781sS1d
lm7AFcAKYE/ClgNTCH/Y7gB+9/ivZKuAwwJj54r+wJtUHpjXcJ8eC0Or8F/O
5hrj5o6RwFdUPzBfACMMcY6uIYbPXrJ0Lm+MB36l9sH5GTitxlgSpALXAH9j
H6A/cXNOtUiQFLoD9xM2OB3tLtyCoBISxMO+wCtkJ0bJngP6VIgtQRIMBz4j
ezFK9hEwpEz8pglSzce30ZyC20uMrmOMscUYY+oYw0RsgkwBFgMDGxBrKLAE
mNSAWLmjG3An9q+Ir4tmubcdmM7eO/suPYf0AZ7F3vmFwAFFWxTgZy7Qs9im
LivIEPz5qGrtUaClg7+ewJwAf+8CbXRRQY4HNmDr8G5gKv4EYgG4CfdVZPH9
LXCR8d7cCnIBsANbZ7cCE6qIcR6wzRgjJCuQK0EKwAzsHV1DbcvhY4C1AfE6
tSC9gHnYO7kU/3K4BXi4aC2evx8ELAuI2ykFORB4H3sHnwJ6e/wOYO+VVWnF
laQ38HRA/E4lyFHA99g7dxv+yfsI3AScvP4bYJTn+gIwK6AdnUKQc3Bn3JZO
7cStdix+twBnp9w7GdvRbK4FKQA34Janlg5tBE5I8XtjlX53F6/1fbpOBDYZ
25Y7QVqAR7B35mNcnimJddM3m/924B05GPgkoJ25EKQ/8Bb2jjwP9PX4bcPt
oq1+38EtAJL0BV4M8Bu1ICOBL7F3Iu00L3RRULLvgCM9/rsB92TgPypBxmMr
QNiDO+++PMXvBNzOPKuB2gqcmxLrSuCvjOI0VZCrsacafgJO9fgsADdjz0eV
s93ANPyT/enALxnEaIog3YH7DI0t2efAoR6/vXCp8KyFSNpj+Cf7Ebjqw1wJ
ElqA8Dqwn8fvQMJ29LXae7gsQpJ+wBsBflcCrRVHMSOGE1aA8CDQw+N3NC55
2CgxSrYad/6RpAfwUIDf5cDg8kMZzsnAj8YG7gKuTfE7EXuqPAvbhkvX+7iu
2HaL3/XUsZDiMuAPY8M2A2d6fJbS8fWYvGu1duAW/JP9Wbh0jMXvDjIupMii
AOFwj9/ewBMBfutlj+MWFklG4U9mVmszyOB9nNAChEX40+GDaPwZRS32Af6z
lwGEZQzm4Re7KgbjJiZr8Nn4D4yOA9YF+G2UrcWdOCbpiVsyW/0uwVB3NgZ7
AUI7rsjA9/G8EPtZejNsO3C+px+hG9fV+Fd2XiYFDNo2/AUIBWBmHQasEdYO
3Ir/AZuIEy3Lsdpr0KZjV30N/gKEVmB+Ewc0K3sS/zHysdi/gttJSeP0wq0u
rI1diismSDKEsHkoNluGW5AkGQR8GOB3Dh3SOPUqQBiLfR6K2dbh3+y1AgsC
/C6meGYTIsZM/N+tk3Fn4s0evHrZDtwCJUkBuD3A70KwTeBpBQihDcqbzcL/
QF6CrZBiC9RevLYJfwFCH+CZCAap0TYff2Z3HPBDjb7mgDtXXlnlDStxxQFJ
huJeE2v24DTLluN/Re4Q4NMqfaygg7DDqKzmC/gLEE6iviU1ebENuIVMkn2A
lyvcuxGPoONIz+bejb8A4VLqX3SWJ9uJW9Ak6Q7cW+Ye3xQAuHf8Ol5c7oX7
qREMQKx2fcqYXcX/CykuTrn2X6bhyjRXUf4nKV6NoOOxWrkz9TNwafzNpAtn
QoLYBClLbK9Fd3kkSGRIkMiQIJEhQSJDgkSGBIkMX0lnrJSOli0UyMnDlydB
BlA8LzDQhvsxzOjJxVPTlZAgkSFBIkOCRIYEiQwJEhkSJDIkSGRIkMiQIJEh
QSJDgkSGBIkMCRIZEiQyJEhkSJDIkCCRIUEiI0SQnZm1ovOx3XpjiCBvB9zb
2WnK2LTQ2J/j2z+grW0NbOcimljN0xd4APeO4a46W6gg9W7fRtxra5X+00oh
hBBCCCGEEEIIIYQQQgghhBBCCCGEEA3kH1vl9UN9mBbVAAAAAElFTkSuQmCC
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 1665, :content_type image/png, :filename bauprojekte.png, :id #uuid "8e07c37e-d244-514d-bfa9-306158056160", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.013, :System:Directory /tmp/tmp.qSpfBizLgM, :System:FileSize 1665 bytes, :PNG:ImageHeight 128, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 100x128, :PNG:ColorType RGB with Alpha, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 100, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/bauprojekte.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName bauprojekte.png, :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-12T11:43:56.041Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "1a047acd-dc98-52c2-99d3-dc6332adc1e0"]
>debug 4
>debug 5 {:id #uuid "dda588f4-660c-573c-a2ff-944ae93ad42e", :name Beleuchtungstechnik}
>debug 5a id #uuid "dda588f4-660c-573c-a2ff-944ae93ad42e"
2023-12-12T11:43:56.041Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "dda588f4-660c-573c-a2ff-944ae93ad42e"]
>debug 5b {:main_category_id #uuid "dda588f4-660c-573c-a2ff-944ae93ad42e", :content iVBORw0KGgoAAAANSUhEUgAAAJsAAACACAYAAAAccBvUAAAACXBIWXMAAAQK
AAAECgFCV1GHAAA59GlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFj
a2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQi
Pz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0
az0iQWRvYmUgWE1QIENvcmUgNS42LWMxMTEgNzkuMTU4MzI1LCAyMDE1LzA5
LzEwLTAxOjEwOjIwICAgICAgICAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9
Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMi
PgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAg
ICAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8i
CiAgICAgICAgICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxl
bWVudHMvMS4xLyIKICAgICAgICAgICAgeG1sbnM6cGhvdG9zaG9wPSJodHRw
Oi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIgogICAgICAgICAgICB4
bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIK
ICAgICAgICAgICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20v
eGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgICAgICAgICAgeG1s
bnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAg
ICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8x
LjAvIj4KICAgICAgICAgPHhtcDpDcmVhdG9yVG9vbD5BZG9iZSBQaG90b3No
b3AgQ0MgMjAxNSAoTWFjaW50b3NoKTwveG1wOkNyZWF0b3JUb29sPgogICAg
ICAgICA8eG1wOkNyZWF0ZURhdGU+MjAxNi0wNy0xNFQxNTo0NTo0MSswMjow
MDwveG1wOkNyZWF0ZURhdGU+CiAgICAgICAgIDx4bXA6TW9kaWZ5RGF0ZT4y
MDE2LTA3LTE0VDE1OjQ5OjAyKzAyOjAwPC94bXA6TW9kaWZ5RGF0ZT4KICAg
ICAgICAgPHhtcDpNZXRhZGF0YURhdGU+MjAxNi0wNy0xNFQxNTo0OTowMisw
MjowMDwveG1wOk1ldGFkYXRhRGF0ZT4KICAgICAgICAgPGRjOmZvcm1hdD5p
bWFnZS9wbmc8L2RjOmZvcm1hdD4KICAgICAgICAgPHBob3Rvc2hvcDpDb2xv
ck1vZGU+MzwvcGhvdG9zaG9wOkNvbG9yTW9kZT4KICAgICAgICAgPHhtcE1N
Okluc3RhbmNlSUQ+eG1wLmlpZDozMTMzODRjNi0zYzM5LTQzNjgtODE5OS01
OWJhZDM3ODBkNGQ8L3htcE1NOkluc3RhbmNlSUQ+CiAgICAgICAgIDx4bXBN
TTpEb2N1bWVudElEPmFkb2JlOmRvY2lkOnBob3Rvc2hvcDoxYTU3ZjVjYy04
YTU4LTExNzktOGVmNS04OTFkYzJiZDEwY2Y8L3htcE1NOkRvY3VtZW50SUQ+
CiAgICAgICAgIDx4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ+eG1wLmRpZDpk
OWQ5MWY5NC0yNjQ0LTQ4NTItODAwYS0yZTA2OTBlN2VjMzM8L3htcE1NOk9y
aWdpbmFsRG9jdW1lbnRJRD4KICAgICAgICAgPHhtcE1NOkhpc3Rvcnk+CiAg
ICAgICAgICAgIDxyZGY6U2VxPgogICAgICAgICAgICAgICA8cmRmOmxpIHJk
ZjpwYXJzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgICAgICAgPHN0
RXZ0OmFjdGlvbj5jcmVhdGVkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAg
ICAgICAgIDxzdEV2dDppbnN0YW5jZUlEPnhtcC5paWQ6ZDlkOTFmOTQtMjY0
NC00ODUyLTgwMGEtMmUwNjkwZTdlYzMzPC9zdEV2dDppbnN0YW5jZUlEPgog
ICAgICAgICAgICAgICAgICA8c3RFdnQ6d2hlbj4yMDE2LTA3LTE0VDE1OjQ1
OjQxKzAyOjAwPC9zdEV2dDp3aGVuPgogICAgICAgICAgICAgICAgICA8c3RF
dnQ6c29mdHdhcmVBZ2VudD5BZG9iZSBQaG90b3Nob3AgQ0MgMjAxNSAoTWFj
aW50b3NoKTwvc3RFdnQ6c29mdHdhcmVBZ2VudD4KICAgICAgICAgICAgICAg
PC9yZGY6bGk+CiAgICAgICAgICAgICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlw
ZT0iUmVzb3VyY2UiPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6YWN0aW9u
PnNhdmVkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAgICAgICAgIDxzdEV2
dDppbnN0YW5jZUlEPnhtcC5paWQ6MzEzMzg0YzYtM2MzOS00MzY4LTgxOTkt
NTliYWQzNzgwZDRkPC9zdEV2dDppbnN0YW5jZUlEPgogICAgICAgICAgICAg
ICAgICA8c3RFdnQ6d2hlbj4yMDE2LTA3LTE0VDE1OjQ5OjAyKzAyOjAwPC9z
dEV2dDp3aGVuPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6c29mdHdhcmVB
Z2VudD5BZG9iZSBQaG90b3Nob3AgQ0MgMjAxNSAoTWFjaW50b3NoKTwvc3RF
dnQ6c29mdHdhcmVBZ2VudD4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OmNo
YW5nZWQ+Lzwvc3RFdnQ6Y2hhbmdlZD4KICAgICAgICAgICAgICAgPC9yZGY6
bGk+CiAgICAgICAgICAgIDwvcmRmOlNlcT4KICAgICAgICAgPC94bXBNTTpI
aXN0b3J5PgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9y
aWVudGF0aW9uPgogICAgICAgICA8dGlmZjpYUmVzb2x1dGlvbj4yNjI2MzYv
MTAwMDA8L3RpZmY6WFJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOllSZXNv
bHV0aW9uPjI2MjYzNi8xMDAwMDwvdGlmZjpZUmVzb2x1dGlvbj4KICAgICAg
ICAgPHRpZmY6UmVzb2x1dGlvblVuaXQ+MjwvdGlmZjpSZXNvbHV0aW9uVW5p
dD4KICAgICAgICAgPGV4aWY6Q29sb3JTcGFjZT42NTUzNTwvZXhpZjpDb2xv
clNwYWNlPgogICAgICAgICA8ZXhpZjpQaXhlbFhEaW1lbnNpb24+MTU1PC9l
eGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGlt
ZW5zaW9uPjEyODwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgIDwvcmRm
OkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAo8P3hwYWNrZXQgZW5kPSJ3
Ij8+W7LKAQAAACBjSFJNAAB6JQAAgIMAAPn/AACA6AAAUggAARVYAAA6lwAA
F2/XWh+QAAAJGElEQVR42uyda4hVVRTHf75GxJEhmxlFHEFHApEmicgnGppI
iJWSOlghGvghS8QQRpRQVOjlo4JUUkILH6SJiUJJfagsUjH9oCgOpuAjx5Ss
NEdzpg/toZA7M2fte869Z+2zPmyQ8c7Ze/33b+7Za+2916K5uRlr/zWgGpgO
zANWAB8Ce4AfgLPAn66ddT/b4z6zwv3OdKDatMyhrcFFJVALbAR+Bppjaj+7
Z9YClQZbBmEDOgDjgVXAcaApRsBaa02ur1Wu7w4GW9iQdQdeBk4XAK722mk3
lu4GW1iQVQFvAtdTANn97bobW5XBphuyx4HtwN0UQnZ/u+vG+rjBpguyB4CP
FADWWvsIeMBgSz9ozwCXFIPW0i4Bzxhs6YSswr2GmgNr24EKgy09oNUCVwME
raVdBWoNtuLHy9YVaMJvAPVux+Bz135wP7tRoDGs0x6f0wpaR2BTgsHXd4HJ
LmxSEmE8Je6zk93vJhUs3gR0NNgKB1on4OMYJ/B3YD3wLNAzxnH2dM9c7/qI
a7wfA50MtuRB6xyjI3ASmAv0KMC4e7i+TsboOHQ22JKbsC7Azhgm6jNgbBHt
GOvGkK8dO4EuBlsyk7Qjz8k5DoxKkT2j3JjysWmHwRb/xDyfpyc5P43rHLf+
nJ+nR/u8wRbfhPQCrvn+5QO9FdjYO49v7mtAL4MtnonY5TkJSxV62ks9bd1l
sOUv/jQP4f8G5igOVs9xNkjtnmaw+YteDjQIBb8FPB3AFtzTzhaJ7Q1AucHm
J7g0ntaYJm8zJm+1URp/M9jkQg/2eI0sDPBs3kIPHQYbbDKR3xYK/LXmPcN2
9oC/FmrxtsEmiz1dFp7j71ugsb0AHAJuAueAw8A+4D3guSRCEEBf4f2Jy2nd
O00jbBPT6IUBD0cczyngnTgvsXh45RMNtmjCfioQ9asCjustj0ssW4CamPr/
StD3pwZbtGM5jWmMLQGT8thSWh/lXFyM326NcR6XChW2uQJBrxTy1INbrO8C
7nkC910+W2fu1MsVQX9zDba2BZV4Xm8UaYwDXJR/ObDZjTnqja4LwGN59P2G
xEM32NoW85zg+HZ1isbdwQVhP4hw+eYy8GAeGZaiHjc/Z7C1/ZqKenv925Sf
Jn4K+DGJc2jAtwIHpaPBllvEPoJXxAYlt79mA3+1YsN0z+duEOjUx2DLLeIw
gYiLFO0CPNnKpvpFz+ctEug0zGDLLeJUgYgzlG07LW7Fjr4ez5oh0GmqwZZb
xAUCEUcozA33Rw47Jnk8a4RApwUGW24R12hdi0S0L5fD8HrCa9s1BltuETcL
RCxRCNv7OexY7fGcEoFOmw223CKuFojYWyFsuTbyH/a8HBNVp9UGW24R6wQi
1miD7b4jSoeAFzyfUSPQqc5gyy3ibIGI40JOB9qOTuMEOs022PI/VTErw7DN
Eug0yWDLLeJQSSafDMMmyeA01GBr/fhzVBF/yWLhCrcF9otAp74GW+tinhUI
OSSDsA0R6HPWTn20LaYkbenKDMK2UpIW1WBrW8zJAjF/A8oyBFqZszmqPpMN
tvYFleS5WJIh2JYI852UGWzti3pQIOqvQGkGQCt1tkbV5aDdroom7GvSm0sZ
gG29UJPXDLbof8XSIhpTAgZtikeRjlKDLZl90pYUDFUBglblUbqyLrX2pHiN
Iv12+x7oFhBo3ZxNQXyrpT0/W53HReD92tK1t3Eheb+H/XWptivlHtgVD8G3
qS658++Vxm0edl9Ju2eeduEneKY7WKcYNp/ib/eACam3TYH4yzxzayxXCNpy
T1uXqbBPyWvlgOckzFME2jxPGw9oWTZomYgKl5TFJ039Ewrse8IzHf0FTZWW
Nb1iRnpkz26pt16ZYrsqPevaNwIjVS0TlK1pZnq+ar5M46vGLRG+9LRppro1
aYYW0YsVpWUIzvnRClsHYKvn+m10iuwY7blO26r1SLzWWFRXlzZUOlEX07Cg
dg7PRc9UqV3VxhAVBz/LgXqNBWE9yz3Wp702VbCwuUl7yLMW6agijnmUZ03R
h9Tv+QawaT3GIyRypBjrHrfePOIR4hgTxEmWQI7jLNMQOvAM3SwLYY5Cgq0r
cNrDWehewDF293AKTmt2CIKEzU3m2DTHqzzjg2ODOnkc2DHqLR6VlysKFOqQ
VkbeEtwx98Bgq/DwTucXYFzzPbzPCoMt/cC9JJzYYwUY0zHhmF4K8qZYoJl+
vhFO7iMJjucR4Vi+CTVDU6h3LQcBd9KQVVuYBf0OMCjYO7ABX+79RDDJDUnc
ynK3pBoE4/gk6Jv9AcM2vNilrj1KkA832PQCd1Qw0SsS6H+FoP+jwecsCRw2
iWe6L4H+92XdA80SbN2Am1G3rxLoP+r21M2QUkdkEjY34ZJDlpUx9lspORQZ
+jxkBba1gkmfEGO/EwT9rjXYwoDtRUlhMaA2piYp/PaiwRYGbDWeN5gK2WoM
Nv2gDfTYlyxGOwYMNNj0glbtkbWxmO06UG2w6QOtBDiuCLSWdlxj4d6swzZV
IWgtbarBpgu2vYph22uw6YKtXjFs9QabLthuKYbtlsGmC7ZTimE7ZbDpgm27
Yti2G2y6YHtFMWyvGGy6YOsCnFAI2okQioZkcQdhBNCkCLQmYITtIBhsBpvB
Zq9Rg80cBHMQLPRhoQ+DzYK6FtS17SrbrjLY2oftjGLYzhhsumDbrRi23Qab
LtimKIZtisGmL852RCFoRyzOphO4/sBVRaBdBfrbDoJe4AYo2Uk4AQywq3z6
gXtVAWyv2iXlMGA7qQC2kwZbGOs2LWu2/gabbtjGK4JtvMGmG7YximAbY7Dp
hq1MyQHKJqDMYLMLy3Yx2WBLJPNksZplngwEtq7A4RSDdjikmqKZhs0B109Y
aaVQrQHol4U5yAxsDrhyYBVwOwWQ3XZjKc+K/pmC7X/QVQFLgR3AT4I6Cfm0
m66vHa7vqqzpnknYcsBXCpxPELTzQGnWdTbY/gNuYoKwTTSNDbb7gduWAGjb
TFuDrTUH4miMoB3NmgNgsMmA6wF8EQNoXwA9TFODrT3gOgMb8wBtI9DZtDTY
JNA96kIV9yIAds999lHTzmDLB7qBLja2FTjkKrFcd//e6v5voGnVfvtnAC9c
0Cv54m27AAAAAElFTkSuQmCC
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 17298, :content_type image/png, :filename bulb12323.png, :id #uuid "8debe2ef-4a7e-58a1-bf4c-1622dead4579", :metadata {:XMP-tiff:ResolutionUnit inches, :PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 1034, :XMP-exif:ExifImageHeight 128, :XMP-xmpMM:HistoryInstanceID [xmp.iid:d9d91f94-2644-4852-800a-2e0690e7ec33 xmp.iid:313384c6-3c39-4368-8199-59bad3780d4d], :XMP-xmpMM:DocumentID adobe:docid:photoshop:1a57f5cc-8a58-1179-8ef5-891dc2bd10cf, :XMP-xmpMM:InstanceID xmp.iid:313384c6-3c39-4368-8199-59bad3780d4d, :PNG:GreenX 0.21, :ExifTool:ExifToolVersion 10.4, :XMP-exif:ColorSpace Uncalibrated, :XMP-xmp:CreateDate 2016:07:14 15:45:41+02:00, :Composite:Megapixels 0.02, :XMP-tiff:Orientation Horizontal (normal), :PNG:WhitePointY 0.32899, :XMP-x:XMPToolkit Adobe XMP Core 5.6-c111 79.158325, 2015/09/10-01:10:20        , :System:Directory /tmp/tmp.qSpfBizLgM, :XMP-tiff:XResolution 26.2636, :XMP-photoshop:ColorMode RGB, :XMP-exif:ExifImageWidth 155, :XMP-xmpMM:HistoryAction [created saved], :System:FileSize 17 kB, :PNG:ImageHeight 128, :XMP-xmpMM:HistoryWhen [2016:07:14 15:45:41+02:00 2016:07:14 15:49:02+02:00], :File:FileTypeExtension png, :XMP-xmp:MetadataDate 2016:07:14 15:49:02+02:00, :XMP-xmp:CreatorTool Adobe Photoshop CC 2015 (Macintosh), :File:FileType PNG, :PNG:BitDepth 8, :XMP-xmpMM:HistorySoftwareAgent [Adobe Photoshop CC 2015 (Macintosh) Adobe Photoshop CC 2015 (Macintosh)], :Composite:ImageSize 155x128, :XMP-xmp:ModifyDate 2016:07:14 15:49:02+02:00, :PNG:ColorType RGB with Alpha, :PNG:WhitePointX 0.31269, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 155, :File:MIMEType image/png, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :PNG:BlueY 0.05999, :XMP-xmpMM:HistoryChanged /, :SourceFile /tmp/tmp.qSpfBizLgM/bulb12323.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG:RedX 0.63999, :PNG:GreenY 0.71, :PNG:BlueX 0.14999, :PNG:RedY 0.33, :PNG-pHYs:PixelsPerUnitX 1034, :System:FileName bulb12323.png, :XMP-tiff:YResolution 26.2636, :PNG-pHYs:PixelUnits meters, :XMP-xmpMM:OriginalDocumentID xmp.did:d9d91f94-2644-4852-800a-2e0690e7ec33, :PNG:Filter Adaptive, :XMP-dc:Format image/png}}
2023-12-12T11:43:56.042Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "dda588f4-660c-573c-a2ff-944ae93ad42e"]
>debug 4
>debug 5 {:id #uuid "2b07eb8a-4174-5257-83eb-920d536cc44a", :name Betriebseinrichtungen und Fahrzeuge}
>debug 5a id #uuid "2b07eb8a-4174-5257-83eb-920d536cc44a"
2023-12-12T11:43:56.042Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "2b07eb8a-4174-5257-83eb-920d536cc44a"]
>debug 5b {:main_category_id #uuid "2b07eb8a-4174-5257-83eb-920d536cc44a", :content iVBORw0KGgoAAAANSUhEUgAAAGwAAACACAYAAADu4Iw0AAAABHNCSVQICAgI
fAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAABE1JREFUeJzt3U+PFEUcxvHv
7AoriPEkckFI1JGErBtfAQgniJD4JtCIWRKPxkO/CfTgichJEz0QzoYEr7Ig
ARJOIokHCBDQXcLCjofaCaRpuqu6q7q6ap5P8ktIhqmpp5+dfzs7MyAiIiIi
IiIiIiIiIiIiIiIiIiIikrd9wHlgDZjM+KwB54BxpyMa0D7gPvEP1NDmHjCe
73BgQzkDLMbexABtA/aMYu+iwhrweuxNDNTqEAubxN7AkM3F3oC4UWGJUWGJ
UWGJUWGJUWGJUWGJUWGJUWGJUWGJUWGJCVXYCPgE+AG4Caxj/zKC9OwgcIn4
rx/lOl59M4BAuY83xQDCzMJ4UQwgyKxMZ8UAQszSdFIMIMCsTWvFADY/i9NK
4XABF4E9DmvHPiBDH2eFw+IXgTcd1499QIY+TgqHhduURaCQOY21wmHRtmUR
KGROY6VwWLBLWQQKmdM0KhwW61oWgULmNLUKh4V8lEWgkDnNK33rsIivsggY
NJepdNhhAZ9lETBoLvOSeeCq5Zl9l0XAoLnMS45ZnjFEWXgOl91U/YnAZxYH
9XfgCPDI4v+KR1WFfdRwHpUVUdUb+v4BdtWcZy/wV5DdGJW302KUCxsBT4DX
HM7jmwqrUb5J3EZ9WRJZuRybsnQNiKh8DXsWZRdirVzY0yi7EGsqLDFVj/h0
HzVgevdKYlRYYlRYYlRYYlRYYlRYYlRYYlRYYlRYYlRYYlRYYlRYYlRYYlRY
YlRYYlRYYlRYYlRYYlRYYqaFvfh9Xb5dAk4A7wNbgQXgA+Bz4HKAy+tb7/lC
fV/XE+Ak9dfiOWAZtw/AHMrEysf5QGGO1AQpO+o5VB9lxcoX5GsLTzqEmVoO
sI9QEzOf95/sP2j3YGYOuOJ5LyEmZr7Hc8BKiwuv8z2w0eJ8G8B3nvcSQsx8
KwCHgP/w9xP4XocNjT3uI9TEyvcvcODFhX4FbtP9JnJLh0ALHS+7j+kz3zqm
k18wTxsqjYDtmC8Orfrb+42GC9kaMFAfb4eKnW+EOfbbqTj+VXeeE2AVeLz5
77KHDZt6127vlfY2nP6gw9q2YuebYI79KhXHv82jnVsNpx9qsebU4YbT/+6w
tq3s8p2l/mq9QrsfBJtP4Pmx495tDDpfmwu+0HD6EvBVi3VPAfsb/s9vLdZ1
lV2+dzDv1Gx6dHPUYc1PLdd820uCelnm+7nhwqcbWKb+WjwPfE1zmAnwU4Ac
r5JdviWaH/5O5wrwBea53sLmfAh8if2nxj0DFkMGKsky32nLzfiY06HDVMgu
3w7geg9hrgFv9BGoJMt8Y+BuwDB3MK/expJlvo8JE+rO5tqxZZlvDNxo2KDr
zUTMa1ZZlvl28Py1orZBNjB3wDHus5pkm28J8zzG5rnHdNYxz0P6fOjeVtR8
IT+scidwHPOts4vAbuCtzdMeYH7R+Sfm1zHnMLfpKck9n4iIiIiIiIiIiIiI
iEjv/gec0agwRiP7+AAAAABJRU5ErkJggg==
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 1195, :content_type image/png, :filename fahrzeuge.png, :id #uuid "3d6cbe63-c327-5c6b-b7fa-48e6c52f2cdc", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:01+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.014, :System:Directory /tmp/tmp.qSpfBizLgM, :System:FileSize 1195 bytes, :PNG:ImageHeight 128, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 108x128, :PNG:ColorType RGB with Alpha, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 108, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:01+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/fahrzeuge.png, :System:FileAccessDate 2018:11:14 17:31:01+00:00, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName fahrzeuge.png, :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-12T11:43:56.099Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "2b07eb8a-4174-5257-83eb-920d536cc44a"]
>debug 4
>debug 5 {:id #uuid "f6827594-33a6-5760-ac41-f94ceefacfab", :name Bühnentechnik}
>debug 5a id #uuid "f6827594-33a6-5760-ac41-f94ceefacfab"
2023-12-12T11:43:56.101Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "f6827594-33a6-5760-ac41-f94ceefacfab"]
>debug 5b {:main_category_id #uuid "f6827594-33a6-5760-ac41-f94ceefacfab", :content iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAA3NCSVQICAjb
4U/gAAAACXBIWXMAAAG7AAABuwE67OPiAAAAGXRFWHRTb2Z0d2FyZQB3d3cu
aW5rc2NhcGUub3Jnm+48GgAAAM9QTFRF////AAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAA+q0M9gAAAER0Uk5TAAQGBwgJCwwQFBUbISIvMDIzNDU3ODtBREpP
UlNVVldpcXN7gIqTl6Chpqytv8PExsrS1uDj5Obo6evs7fLz9ff4/P3Djn9u
AAABnElEQVRYw+3XxXbDMBQE0AkzM3McZuY4/v9v6sKFKLEUPWXV085acxe2
9WQhNjR4mRcBACjOuUuGMfD7hnFwAYDrIFgyhCFKEgCSwiViIAUAqX/glwNx
AIi/AQQBIPgG4AEAjzpwMTfTRRlYmMBCGRiYwEAZqJlATRlImEBCFTjaTMB2
VAQ0fEZTBMJfQFgNmOA7EyWg/AOUVYAR7jKiA7fIPRC5kQENTDQqMHOzgHtG
Aw4hPCR0oAB6Fk/J6vLAtQCLFK6ywDEDy2SOcsAyCk6iSxmg6wU33u5LYJOH
MPmNEFjX3XgRd33NB5oOSMTR5AK7igxQ2QmeQd//qu7vix/iriTul3YvX2NL
1G/JfEhVfr8q9SXqOV4/p8vthVPEuh85ye7GVcCqH1jJz4OeFdCjDJTgcz+o
U0Za+xlok2bi2ffY951pU7n5CDSJY33vZPvOPfVgeZhrUfLJVGaBMhlosECD
DHRYoEMGxiwwJgNbFtjSfzDs9327wh8K8yE4/ybAnFIOPsC7fE/Z1zjlXr45
1/9JmgXSE871/wOnFjUuRak9PwAAAABJRU5ErkJggg==
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 841, :content_type image/png, :filename curtain-2.png, :id #uuid "9a8cba78-10ab-585b-a4c2-9d8e7f0818ee", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 443, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.004, :System:Directory /tmp/tmp.qSpfBizLgM, :PNG:Palette (Binary data 207 bytes, use -b option to extract), :System:FileSize 841 bytes, :PNG:ImageHeight 64, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 64x64, :PNG:ColorType Palette, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 64, :PNG:Software www.inkscape.org, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/curtain-2.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitX 443, :System:FileName curtain-2.png, :PNG:Transparency (Binary data 68 bytes, use -b option to extract), :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-12T11:43:56.101Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "f6827594-33a6-5760-ac41-f94ceefacfab"]
>debug 4
>debug 5 {:id #uuid "517b82ae-2b7e-4822-9aeb-0d4753dec821", :name Darlehen}
>debug 5a id #uuid "517b82ae-2b7e-4822-9aeb-0d4753dec821"
2023-12-12T11:43:56.102Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "517b82ae-2b7e-4822-9aeb-0d4753dec821"]
>debug 5b nil
2023-12-12T11:43:56.103Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "517b82ae-2b7e-4822-9aeb-0d4753dec821"]
>debug 4
>debug 5 {:id #uuid "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da", :name Fotografie}
>debug 5a id #uuid "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da"
2023-12-12T11:43:56.103Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da"]
>debug 5b {:main_category_id #uuid "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da", :content iVBORw0KGgoAAAANSUhEUgAAAGAAAACACAYAAAD03Gy6AAAABHNCSVQICAgI
fAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAABvdJREFUeJztnWuIVVUUx3/3
OpPaQ6d8ZKI9TM0sKyGnB72ozNKIisjqY0RQQVBQH0PqS4UZmSFB+EkqKMqi
l2JPCCwRGaWyzDzO5GPyEfmYcXzM9GHNhUHHe/a6d92zz51ZP9gg45q9197/
c+7es/ba+4LjOI7jOI7jOI7jOI7jOI7jOAOdQsr/jwbmA7OBK4DxwNBaO1Xn
HAV2Ai3AKuB9YI+2kpHAIqAT6PFSVTkMvN47pkFcA7TmwPGBVlqB5rTBnwN0
5MDZgVo6e8e4X67FP3KyEmFWadBLk3ATsBGYcCp1HFNagRnA/iG9P3gFWek4
2TASOA1YVQDGAG348jJrDgMTisBD+ODHYBgwvwjcEduTQczsAjIhTIztSY5o
B9YDXYrfGYGsIocr20oAjhB/aZaHchx4BmhQDmKJc4Dlyja7yEHH81KeVg/5
yRSBFZp2C73/GOy0ApOQt6BaLgE2hRoXDRocCKzBZvABfkcR/XQBhE7j+g6F
GroAkXEBIuMCRMYFiIwLEBkXIDIuQGRcgMi4AJFxAYQh6SYqgiOqLoAw1bCu
kcB5ocYugNBMQNJUIE+iHNfYcfi8lFZgmmbg+uF+lBtc9bQfkADfAeuAzcAu
4CDi/xnAWOBi4CrgZmB6BW10Ae8CPyNZCyEUkLyqOZTJeitH7CevXDkAvAnM
JD2T+0QmAy8ie7yx+1GuRHegv3IUWAiMUg56f5wOPAfsz0G/6kKADchZBGsm
IPn6sfuXawHeQ57YWlEEXspBP3MpwGKyWxY/nlGf6kaAt9BPstXyhJHvdS/A
F9iHAkJZGOjjgBVgBzYrnUppBH7qx69BI8B9VQ9h9VwGHGMQCvAD2X/un4ql
RBoHTSiiDfgmxaYZuDSwvrnAl4G2teZCYAthq7B24KsUmweQ8EgQoWqtCKjr
x8C6EvIXif2CMN//JX3RkATW1WM5CGciZ4xD+AjoNmzbgg8D7ZqQ2JQJlgJc
Tfhy8mvDdq1YrbANfdBSsRTgcoXtOsN2rWgDdgfamsWqLAWYHGh3EJnI8kYP
8GegbWhfU7EUYHygXSk+n0d2BdqF9jUVSwFCbwPpMGzTmtC8/iarBi0FCD1r
nLflZ19CFxHDrBq0HIzQIz7B9+ZEINQ3syW0pQChm9jjqPwoaK0JPS8dfAQp
DUsB9gXaNWCbCGVFI+F+7bVq1FKA7Qrb6wzbtWIm4fOYpq9lsRTgL4XtXYbt
WjFXYfuHVaOWAmxU2M4DzjZsu1oKwCMK+xarhi0FWI/k84QwDHjMsO1quROY
orBfY9m4ZTj6e0V9/yC3jMSmCKwl3O/tpG8kJaH1Wf9R9LnCdgySOhibR5FI
biifYhxKsXwDLlLU14P8QXObXVfUTAL+68evcuWmgHoTRX2mAoDE+jUd2o0I
lzVnIZOpxtfNhM2bSWidtYjLLFbajwZWojhVYsBw5IHSxvUXU4OdPOs3oIgs
STVPVunpyuJNaAK+rcC/XYTnrSaKes0FALi7gg72ICujWxXtaJkO/Fahb08p
2kkU9dZEgALwWYUd7QZeQzb5rWgAnqXyq5k3oAsgJoq6ayIASGRRu8LoW3Yg
B960NxH2pQH5/oNfq/DjOPoDfImi/poJAPCgov5Tlb1I9vTthInRiAT7Xsbm
Gv4FFfQ7Ca1fkxn3CXBvBc4sQq6DtOAo8AsyYe9EzpD1IB9X5yKH9GZQ3VvT
l9VImEJ7n1wCXBBqXMs3AORjQHWVY07KJuQu0EpIQtvJYn/2GPAw6XmleaIN
udI5dJOpYrLaIO8E7kEOyeWdrcAtyPxRc7LMUDiEiLA8wza1rAWuR7e5VDW1
ngNOpAA8j0xssT/n+5Z3sJu8E0W7mQtQ4gbkSYs98HuQ5bIliaL9aAKALB8X
IsvLrAe+G1iGBAOtSRR+RBWgxFTkG+e6Ff5UUz4GrqxhfxKFL7kQoMQU4A1k
+Wc96PuAJYQfoaqGROFXrgQoMRTJnHgbSRmvdNC39NYxD/nWoqxIQn3Ma4pg
F7K/XNpjHovcAzQN+RN/HBLXH4ospQ8jgb92pPObkCyNPJ5DOIk8vgH1TkLg
uOY5VXxQ4AJERiNAlpNYvaM6wBE6B7Qjmx1OeSahW6mpjBdk1o36pAHlXngB
uedS82QvQ7YIE/J32j0Wjchf1i8ANyp+70gB2AacXwuvnFS2FjHMdXfUtBSp
j12qgcrKAhKO/Rv/TuGs6QQmFpENiaWRnRmMLAH2lk56jEQSav17hbNhG5K/
dKDvD5upPHfSS3jpoMyJnDkuQs0HP/Ur5Gchr0hsZwdaSVCcRRuBbJb721B9
6QBeRY5EnUTacctRSHr3bGRHajweFU3jCHKUtQU5evUBhndLOI7jOI7jOI7j
OI7jOI7jOI5Tf/wPcYhVe1hRfeIAAAAASUVORK5CYII=
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 1877, :content_type image/png, :filename fotografie.png, :id #uuid "07a33b4c-d274-54e5-a2ce-11f26d57be05", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.012, :System:Directory /tmp/tmp.qSpfBizLgM, :System:FileSize 1877 bytes, :PNG:ImageHeight 128, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 96x128, :PNG:ColorType RGB with Alpha, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 96, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/fotografie.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName fotografie.png, :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-12T11:43:56.120Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da"]
>debug 4
>debug 5 {:id #uuid "2ea39047-e663-50d5-9080-838b75883704", :name IT & Elektronik}
>debug 5a id #uuid "2ea39047-e663-50d5-9080-838b75883704"
2023-12-12T11:43:56.121Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "2ea39047-e663-50d5-9080-838b75883704"]
>debug 5b {:main_category_id #uuid "2ea39047-e663-50d5-9080-838b75883704", :content iVBORw0KGgoAAAANSUhEUgAAAHgAAACACAYAAADApa2mAAAABHNCSVQICAgI
fAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAr5JREFUeJzt3b9qU2Ech/En
0UVbFAernQRHQZy8AtFNdJQWCgq6633oUCzeRi3qoHgBDiIugosglNY6Vq1L
/zicgC2kiel5k5N8fT7wLm15c/g9bU/+kQOSJEmSJEmSJEmSJEmSJEmSpG6m
gQfAK2AN2AH2XAfWTmc2L4H7wNSRJj1iLWAB+E7zA5y0tQHMDz7y0WkDz2h+
UJO+ljqzHCstjFtyPR1s/MO3QPNDSVtzAxU4RKvAHtPAF+Bsgb301wZwEdiq
s0mJ//VzGHcYzgF36m5SIvDtAnuou7GY7Rq9zyXL+BfezQywQu/ZrTZ2dPv0
exLDuIc7T+/Zbde9gRJ3svZGcBvJhjq/sXtArbIMHM7A4QwczsDhDBzOwOEM
HM7A4QwczsDhDBzOwOEMHM7A4QwczsDhDBzOwOEMHM7A4QwczsDhDBzOwOEM
HM7A4QwczsDhDBzOwOEMHM7A4QwczsDhDBzOwOEMHM7A4QwczsDhDBzOwOFK
BN7t8/2ZAreRarbP93dGchR99Ps44RWqT1XVQbPAC4b8ccLH624AfKD3b+JN
YL3A7fyP3tfdoMS/6OUCe6i72rMt8VnOU1QX5fBcW9Y3qoty/K6zSYm/4F/A
owL76KCH1Ixb2hLNX2soZS0OOPuRaFNdsavp4Uz6WmTMn5+Yozp/ND2oSVvr
FLhO0qicBO5RPQZepbp6SNMDHLe13ZnNc+AucOJIk5YkSWOpRXXCV6ixfryl
+gwczsDhkgNforqP8S/rckPHOHTJgY8N6WcnSgvYwqfJUm21gbdNH4WG5nWL
6lz1Dphu+GBU1g/gahv4BNzAN8YlWQOuA5/3f/EM8ITqLThNv5TmOtr6CTzu
tAS6v+nuNHALuAZcAS4Ap8i+xz2JdoFN4CvwEXhD9fr7ZpMHJUmSJEmSJEmS
JEmSJEmSJEml/QGym5SaY0sX5gAAAABJRU5ErkJggg==
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 796, :content_type image/png, :filename laptop.png, :id #uuid "1464e46c-e726-54a9-a42b-f937a0342d22", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:01+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.015, :System:Directory /tmp/tmp.qSpfBizLgM, :System:FileSize 796 bytes, :PNG:ImageHeight 128, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 120x128, :PNG:ColorType RGB with Alpha, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 120, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:01+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/laptop.png, :System:FileAccessDate 2018:11:14 17:31:01+00:00, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName laptop.png, :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-12T11:43:56.122Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "2ea39047-e663-50d5-9080-838b75883704"]
>debug 4
>debug 5 {:id #uuid "f6885671-3bf3-56f2-8e92-b5112d0f703f", :name Musikinstrumente}
>debug 5a id #uuid "f6885671-3bf3-56f2-8e92-b5112d0f703f"
2023-12-12T11:43:56.122Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "f6885671-3bf3-56f2-8e92-b5112d0f703f"]
>debug 5b {:main_category_id #uuid "f6885671-3bf3-56f2-8e92-b5112d0f703f", :content iVBORw0KGgoAAAANSUhEUgAAAI4AAACACAYAAADd91F4AAAACXBIWXMAAAsT
AAALEwEAmpwYAAA59GlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFj
a2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQi
Pz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0
az0iQWRvYmUgWE1QIENvcmUgNS42LWMxMTEgNzkuMTU4MzI1LCAyMDE1LzA5
LzEwLTAxOjEwOjIwICAgICAgICAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9
Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMi
PgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAg
ICAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8i
CiAgICAgICAgICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxl
bWVudHMvMS4xLyIKICAgICAgICAgICAgeG1sbnM6cGhvdG9zaG9wPSJodHRw
Oi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIgogICAgICAgICAgICB4
bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIK
ICAgICAgICAgICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20v
eGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgICAgICAgICAgeG1s
bnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAg
ICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8x
LjAvIj4KICAgICAgICAgPHhtcDpDcmVhdG9yVG9vbD5BZG9iZSBQaG90b3No
b3AgQ0MgMjAxNSAoTWFjaW50b3NoKTwveG1wOkNyZWF0b3JUb29sPgogICAg
ICAgICA8eG1wOkNyZWF0ZURhdGU+MjAxNi0wNy0xNFQxNTo0NjoxMSswMjow
MDwveG1wOkNyZWF0ZURhdGU+CiAgICAgICAgIDx4bXA6TW9kaWZ5RGF0ZT4y
MDE2LTA3LTE0VDE1OjQ5OjI4KzAyOjAwPC94bXA6TW9kaWZ5RGF0ZT4KICAg
ICAgICAgPHhtcDpNZXRhZGF0YURhdGU+MjAxNi0wNy0xNFQxNTo0OToyOCsw
MjowMDwveG1wOk1ldGFkYXRhRGF0ZT4KICAgICAgICAgPGRjOmZvcm1hdD5p
bWFnZS9wbmc8L2RjOmZvcm1hdD4KICAgICAgICAgPHBob3Rvc2hvcDpDb2xv
ck1vZGU+MzwvcGhvdG9zaG9wOkNvbG9yTW9kZT4KICAgICAgICAgPHhtcE1N
Okluc3RhbmNlSUQ+eG1wLmlpZDo2YzA4N2NiZS0xZjhlLTQ4YmUtYTU1YS00
ZmRmYzVkOTI2OWE8L3htcE1NOkluc3RhbmNlSUQ+CiAgICAgICAgIDx4bXBN
TTpEb2N1bWVudElEPmFkb2JlOmRvY2lkOnBob3Rvc2hvcDoyZTNiY2U2NC04
YTU4LTExNzktOGVmNS04OTFkYzJiZDEwY2Y8L3htcE1NOkRvY3VtZW50SUQ+
CiAgICAgICAgIDx4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ+eG1wLmRpZDo1
MzMwNmRlYi01NjAzLTQyZTEtOTBiMy04Nzc0MmQ2ODdhMDc8L3htcE1NOk9y
aWdpbmFsRG9jdW1lbnRJRD4KICAgICAgICAgPHhtcE1NOkhpc3Rvcnk+CiAg
ICAgICAgICAgIDxyZGY6U2VxPgogICAgICAgICAgICAgICA8cmRmOmxpIHJk
ZjpwYXJzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgICAgICAgPHN0
RXZ0OmFjdGlvbj5jcmVhdGVkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAg
ICAgICAgIDxzdEV2dDppbnN0YW5jZUlEPnhtcC5paWQ6NTMzMDZkZWItNTYw
My00MmUxLTkwYjMtODc3NDJkNjg3YTA3PC9zdEV2dDppbnN0YW5jZUlEPgog
ICAgICAgICAgICAgICAgICA8c3RFdnQ6d2hlbj4yMDE2LTA3LTE0VDE1OjQ2
OjExKzAyOjAwPC9zdEV2dDp3aGVuPgogICAgICAgICAgICAgICAgICA8c3RF
dnQ6c29mdHdhcmVBZ2VudD5BZG9iZSBQaG90b3Nob3AgQ0MgMjAxNSAoTWFj
aW50b3NoKTwvc3RFdnQ6c29mdHdhcmVBZ2VudD4KICAgICAgICAgICAgICAg
PC9yZGY6bGk+CiAgICAgICAgICAgICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlw
ZT0iUmVzb3VyY2UiPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6YWN0aW9u
PnNhdmVkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAgICAgICAgIDxzdEV2
dDppbnN0YW5jZUlEPnhtcC5paWQ6NmMwODdjYmUtMWY4ZS00OGJlLWE1NWEt
NGZkZmM1ZDkyNjlhPC9zdEV2dDppbnN0YW5jZUlEPgogICAgICAgICAgICAg
ICAgICA8c3RFdnQ6d2hlbj4yMDE2LTA3LTE0VDE1OjQ5OjI4KzAyOjAwPC9z
dEV2dDp3aGVuPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6c29mdHdhcmVB
Z2VudD5BZG9iZSBQaG90b3Nob3AgQ0MgMjAxNSAoTWFjaW50b3NoKTwvc3RF
dnQ6c29mdHdhcmVBZ2VudD4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OmNo
YW5nZWQ+Lzwvc3RFdnQ6Y2hhbmdlZD4KICAgICAgICAgICAgICAgPC9yZGY6
bGk+CiAgICAgICAgICAgIDwvcmRmOlNlcT4KICAgICAgICAgPC94bXBNTTpI
aXN0b3J5PgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9y
aWVudGF0aW9uPgogICAgICAgICA8dGlmZjpYUmVzb2x1dGlvbj43MjAwMDAv
MTAwMDA8L3RpZmY6WFJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOllSZXNv
bHV0aW9uPjcyMDAwMC8xMDAwMDwvdGlmZjpZUmVzb2x1dGlvbj4KICAgICAg
ICAgPHRpZmY6UmVzb2x1dGlvblVuaXQ+MjwvdGlmZjpSZXNvbHV0aW9uVW5p
dD4KICAgICAgICAgPGV4aWY6Q29sb3JTcGFjZT42NTUzNTwvZXhpZjpDb2xv
clNwYWNlPgogICAgICAgICA8ZXhpZjpQaXhlbFhEaW1lbnNpb24+MTQyPC9l
eGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGlt
ZW5zaW9uPjEyODwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgIDwvcmRm
OkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAo8P3hwYWNrZXQgZW5kPSJ3
Ij8+x0kGyQAAACBjSFJNAAB6JQAAgIMAAPn/AACA6AAAUggAARVYAAA6lwAA
F2/XWh+QAAAERklEQVR42uzdy4tOcRzH8ffIfUoYK7nGnlIuJZRSYutW4h+Q
+4KVUoSlUiSXWSgSFsrGJSJ2bpH7NSk7uYWZ8Vich9Bg5jyX8z3nvL/1qWma
xfk9vZrzPef5nt+hUqlgTG/jh2CEY4RjhGOEY4xwjHCMcIxwjHCMEY6JBMdq
SPUBpgHbgdtAJ9BR/Xkz0PrjD4VjDQQWAPuA10DlH7kHjBNOeasNWAGcAD78
B0t3eAYLpzw1AVgPXAK6eonlz2wSTjn6lbs1QvkzN4VT3n6llnwRTrn7ldQR
jv2KcOxXhCOc5vUrwrFfEU6Z4GTerwjHfkU4BYMTul8Rjv2KcHIKJ5f9inCy
Ow1tBO4UGYpw6lsjSYacKmWLcNLXAOB6GdEIp7ZaV1Y0wqmtbghHOGnqq3CE
k6YqwhGOcIQjHOEIRzjCEY5whCMc4QhHOMIRjnCEIxzhlAbOV+EIp6d5CxwB
FgNDhCOcf+UFsBuYC/TrzfqEUz4414EtwGSgJe36hFN8OB3AWWAVMKZe6xNO
MeG8A44Cy4ChjVifcIoD5xWwB5gH9G/0+oSTbzi3gK3AlP/0K8IpOZxO4AKw
Bhif5fqEEx/Oe+A4sBwYHmV9wokJ5zWwF5hP8qRouPUJJw6cO8A2YCrJViih
1yec7OB0kWxOsB6YSLwSTiA4H4GTwEpgBLFLOBnDeQPsBxYCg8hPCScjODuA
GUH6FeHkCE7eSzjCEY5whCMc4QhHOMIRjnCEIxzhCEc4whGOcIQjHOEIRzjC
EY5whCMc4QhHOMIpM5xWYA7Ju7PagavAS+DTL8f0mWQi8TZwGtgFLKX7Z8qF
U2A4Y4ENJEPvtb5b4gGwE5gknGLC6U+ymcBFGvdc1zXhFAdOC8nTnC/APQCF
07MaAZwBN48UTu/6mMcE21ZFOLHhtAGPCLh5k3BiwzlJ0F2/hBMXziwCbxcn
nLhw2oUjnDT1TDjCSVNdwhFOmuoMDKdDOJ6q0uSxcOLCORwYzgHhxIUzMzCc
6WWC09R5lTrhPBEQzTGAosPJbF6ljl85PAyE5gHVvZaLCCfEvEodT4ljguC5
D4z++e+2QHBCzavUuZ9qq546s1rLKWDYb+fpgsAJN6/SoEGupcDTJq7hCbCI
bl4wUgQ4IedVGng11w9YApxv0HF/I3kx2hKg718vKXMOJ+y8SpNuCYwG1gLn
gC81HOvnKpbVwKge3YvIOZyw8yoZ3FcaBMyuXkUeAq4Az0nePvOtmvfV310G
DpK8DmAWKTbuzjOc0PMqFLzyDKddOMJJA+eZcISTBk6XcISTBk7oeRXheKpK
Na8inLhwQs+rCCcunNDzKsKJfQMw7LyKcOJ/5RByXkU48b/kDDmvIpx8jFWE
m1cRTr4GucLMqwgnf6OjIeZVhJPvYfXM5lWEU5zHY5o6ryKcoHBMueKHYIRj
hGOEY4RjjHCMcIxwjHCMcIwRjqlDvg8A5/TdLBe62ugAAAAASUVORK5CYII=
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 16064, :content_type image/png, :filename music3213.png, :id #uuid "3a52eb87-b5fe-5df0-98b1-43e80f28d2dc", :metadata {:XMP-tiff:ResolutionUnit inches, :PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :XMP-exif:ExifImageHeight 128, :XMP-xmpMM:HistoryInstanceID [xmp.iid:53306deb-5603-42e1-90b3-87742d687a07 xmp.iid:6c087cbe-1f8e-48be-a55a-4fdfc5d9269a], :XMP-xmpMM:DocumentID adobe:docid:photoshop:2e3bce64-8a58-1179-8ef5-891dc2bd10cf, :XMP-xmpMM:InstanceID xmp.iid:6c087cbe-1f8e-48be-a55a-4fdfc5d9269a, :PNG:GreenX 0.21, :ExifTool:ExifToolVersion 10.4, :XMP-exif:ColorSpace Uncalibrated, :XMP-xmp:CreateDate 2016:07:14 15:46:11+02:00, :Composite:Megapixels 0.018, :XMP-tiff:Orientation Horizontal (normal), :PNG:WhitePointY 0.32899, :XMP-x:XMPToolkit Adobe XMP Core 5.6-c111 79.158325, 2015/09/10-01:10:20        , :System:Directory /tmp/tmp.qSpfBizLgM, :XMP-tiff:XResolution 72, :XMP-photoshop:ColorMode RGB, :XMP-exif:ExifImageWidth 142, :XMP-xmpMM:HistoryAction [created saved], :System:FileSize 16 kB, :PNG:ImageHeight 128, :XMP-xmpMM:HistoryWhen [2016:07:14 15:46:11+02:00 2016:07:14 15:49:28+02:00], :File:FileTypeExtension png, :XMP-xmp:MetadataDate 2016:07:14 15:49:28+02:00, :XMP-xmp:CreatorTool Adobe Photoshop CC 2015 (Macintosh), :File:FileType PNG, :PNG:BitDepth 8, :XMP-xmpMM:HistorySoftwareAgent [Adobe Photoshop CC 2015 (Macintosh) Adobe Photoshop CC 2015 (Macintosh)], :Composite:ImageSize 142x128, :XMP-xmp:ModifyDate 2016:07:14 15:49:28+02:00, :PNG:ColorType RGB with Alpha, :PNG:WhitePointX 0.31269, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 142, :File:MIMEType image/png, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :PNG:BlueY 0.05999, :XMP-xmpMM:HistoryChanged /, :SourceFile /tmp/tmp.qSpfBizLgM/music3213.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG:RedX 0.63999, :PNG:GreenY 0.71, :PNG:BlueX 0.14999, :PNG:RedY 0.33, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName music3213.png, :XMP-tiff:YResolution 72, :PNG-pHYs:PixelUnits meters, :XMP-xmpMM:OriginalDocumentID xmp.did:53306deb-5603-42e1-90b3-87742d687a07, :PNG:Filter Adaptive, :XMP-dc:Format image/png}}
2023-12-12T11:43:56.152Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "f6885671-3bf3-56f2-8e92-b5112d0f703f"]
>debug 4
>debug 5 {:id #uuid "6c8a0d77-6711-5156-a59a-12425ba01cff", :name Werkstatt-Technik}
>debug 5a id #uuid "6c8a0d77-6711-5156-a59a-12425ba01cff"
2023-12-12T11:43:56.153Z NX-41294 DEBUG [leihs.procurement.resources.main-categories:?] - (sql-format (image/image-query-for-main-category (:id mc))) => ["SELECT procurement_images.* FROM procurement_images WHERE procurement_images.main_category_id = CAST(? AS UUID)" #uuid "6c8a0d77-6711-5156-a59a-12425ba01cff"]
>debug 5b {:main_category_id #uuid "6c8a0d77-6711-5156-a59a-12425ba01cff", :content iVBORw0KGgoAAAANSUhEUgAAAGYAAACACAYAAAD5whz9AAAABHNCSVQICAgI
fAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAABrVJREFUeJztnVmMVEUUhr9p
GpdhlBmGYZ8BFByJGwGNoMYlPiku8UFNiMTlQU2MRk1QYkz0QY1riNEYE8WM
4oY8EaOGoAYVFRRE2TeHYRjAiAuiYByQ8eFQ0vTC9F2qqqvnfMn/AN1dt6r+
O/d2nzp1LiiKoiiKoiiKoiiKoiiKoiiKoig2qfHdgQqiP3AuMBU4GxgPjAIa
gROBDHAA+B3YAWwB1gLLga8O/7+SElngauAdYC/QE1OHgGXAQ8BYpyOoMuqA
B4DtxDfjWPoQuNjZaKqAfsAdwM/YMSRf7wOjnYwsYFqBr3FjSK5+A8Y5GF+Q
zAD24d4Uo1n2hxgWGeA5/BliNM32QEOiP/A2fg3ZA9xpe6AhkQXew58hh4CX
gSbbAw2JGmAO/kz5HJhofZQBMgs/hnQCN6DRlKJcjlxGXBryN/AoUGt/eGHS
gMSwXJryLtDiYnAh4/K+shINuZTFebgxZDdwOxLaUcpgEXYNOQDMRi6XSpnY
/mtZCExwNpoq4nXsGLIFWavRr78xOAnYjx1jrnI4jgIyPg+eAtOQZd+qI3Rj
rvTdAVuEbswlvjtgi5CNaaKKf3WHbMyZvjtgk5CNqeo0oZCNGeG7AzYJ2Zh6
3x2wScjGHOe7AzbJ+u6A8j+DkMSNJuDZkI3p9t2BlKgF7gMeREJMAJNCNib0
7PoaJEfgGaA577UpIRuzy3cHEjAReAG4qMTr+x32JXUuxe46zI/A9aQb9m8A
XqL3hJEVKR7TOU3YNcboS2BKwr5mgFspf5fBnITH804HbszpQTJi4kQbzgKW
RDzWLTGOU1HYWr0spX+Qm3U5P24HAE8BB2McJ/ioxo24NcboF+BuJHG9GNcA
22K2vSzZlFQGdfjd97IRuJYjXxBagAUJ27w/venxSxv+jDFajKTJJj1JuoEh
Kc6NU+ry/j0Z/8akpTeST48fJgCbOBK6MCzE/6Qm1SHgjMQz5IHTgZ+QQdyb
99pk3Gf5p603E8+QB1qREIwZxA4K05Zewd+kJtVfSBWOoGgFdlI4mJl576sH
uoq8LwTdk3SSXHMaxU3pQUqMDM97/2XAvyXeX6laRGALluPpfSPS/CKfm9nL
ZypJnQT29Xgc5V+Wpud9toYw7jd7kDhaMJxKtOI7e5H7UC5ZYF6ENlzrT+CC
hPPklKimGK2nMLCYBd6K0ZZt/Qqcn3CenHIKcs2NO+BPgePz2swATydoM21t
QL7QBMNY4kdjc7WA4mlN05HfCj5NmQcMTDJJrhlDOqYYfUDxPffjgS9SPE65
2o2cGEHtTBuDnVXIpcDQIsfLALdxdBTBlrqB55F8saAYDWzF3sR0AReWOLbJ
5UrzL9VoH/AictIFRwvQjv2z9iDwCKXTafsBVwBzkTy1uMc5AHyC1AA4OcnE
GHxc91qQhSWX2yjWAHchlZFKkQUmcXR532bkUlSLmNgN/IGEidqB1chS8BLk
t0mwNCP5Wrb/UkppAVqyqoBRyN55X6bk6iPgHLvDDYORVI4pPUg12VTuBSEz
EtiMfzOMlhLYDz0bjETW6H2bYbQMNYURSN6VbzOMvqHKtweWw3Aqy5RvUVMY
hkRRfZthtBytM8YwZG3EtxlGK1BTGAqsw78ZRt8RYAAxbYYiTx/ybYbRStQU
hlB5pjRaHXEANCEBQt9mGH2PmkITEl31bYbRD8BgqyMOgMHAKvybYbQKNYXB
yNnp2wyj1ejjQGhEruO+zTBaQ2AppjZoRL7x+DZDTclhEPKDzbcZRmtRUyrO
lHUUT03qUzQg8SbfZhitR+JxfZoGJDLr2wyjDRRuVOpz1CNrGL7NUFNyqEdW
+3ybYbQRNYWByLp4lIl7Fdk4lEHyxh4nvX2Qm6iCgjdJGYhkkESZuMdKtDUj
YjvFtBlJ5ujTDCD6k7s7OXYV2sUR28vVFgLc926DuUSfvN7qnjwco0015TAZ
ZJPmTTE+ayMhvR3Zq99loe3gaCPemb2d0oXUAD6L2F47VfzYkThsJf694IkS
bd4csR01pQhxajbmqg0p55RF9rw8SbSvy1uR3WVKHkmNSaIOAt0S54IO/Jiy
DTXlmLgukWtMqeonJqXBVNya0olUwVDK4DXcmLIdqRejlMkJwMfYNaULNSUW
tSSLb/VmyjhnI6lC6pCnP6Rpyg5kz7ySkDhrMqW0EzUlVRpInhmzk8Bqc4VC
I/Hzk3dRWA5RSZEhRN8ltgupKq5YZjjlJ5F3IfX3FUcMAGYj1YdKmTIfzZBM
jairkMOA65DyUY1IKai1SFWjjel2TVEURVEURVEURVGUxPwHYcurS2vCftQA
AAAASUVORK5CYII=
, :exiftool_options -j -s -a -u -G1, :exiftool_version 10.40, :size 1811, :content_type image/png, :filename werkzeug.png, :id #uuid "f4e1f230-df2e-5e95-bf89-827f7a6b4b3b", :metadata {:PNG:Compression Deflate/Inflate, :System:FilePermissions rw-r--r--, :System:FileModifyDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitY 2835, :ExifTool:ExifToolVersion 10.4, :Composite:Megapixels 0.013, :System:Directory /tmp/tmp.qSpfBizLgM, :System:FileSize 1811 bytes, :PNG:ImageHeight 128, :File:FileTypeExtension png, :File:FileType PNG, :PNG:BitDepth 8, :Composite:ImageSize 102x128, :PNG:ColorType RGB with Alpha, :PNG:Interlace Noninterlaced, :PNG:ImageWidth 102, :File:MIMEType image/png, :PNG:SignificantBits 8 8 8 8, :System:FileInodeChangeDate 2018:11:14 17:31:02+00:00, :SourceFile /tmp/tmp.qSpfBizLgM/werkzeug.png, :System:FileAccessDate 2018:11:14 17:31:02+00:00, :PNG-pHYs:PixelsPerUnitX 2835, :System:FileName werkzeug.png, :PNG-pHYs:PixelUnits meters, :PNG:Filter Adaptive}}
2023-12-12T11:43:56.158Z NX-41294 DEBUG [leihs.procurement.resources.categories:?] - (sql-format (sql/where categories-base-query [:= :procurement_categories.main_category_id main-cat-id])) => ["SELECT procurement_categories.* FROM procurement_categories WHERE procurement_categories.main_category_id = ? ORDER BY procurement_categories.name ASC" #uuid "6c8a0d77-6711-5156-a59a-12425ba01cff"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.159Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.159Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.159Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete3
2023-12-12T11:43:56.159Z NX-41294 DEBUG [leihs.procurement.resources.main-category:?] - (sql-format (sql/select (vector [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] :result))) => ["SELECT NOT EXISTS (SELECT TRUE FROM procurement_requests AS pr INNER JOIN procurement_categories AS pc ON pc.id = pr.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AND NOT EXISTS (SELECT TRUE FROM procurement_templates AS pt INNER JOIN procurement_categories AS pc ON pc.id = pt.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AS result" #uuid "519f7a95-9ca7-5256-bf63-142cfc23dc62" #uuid "519f7a95-9ca7-5256-bf63-142cfc23dc62"]
2023-12-12T11:43:56.160Z NX-41294 DEBUG [leihs.procurement.resources.main-category:154] - (-> (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format spy)) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.161Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.161Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.162Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.162Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.163Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.163Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.163Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.163Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.163Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "4e48b48c-e1bf-50d7-ab2d-9aa438c638de"]
2023-12-12T11:43:56.164Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"} {:id #uuid "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc", :firstname "Stefan", :lastname "Weinmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.165Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.165Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.165Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "4e48b48c-e1bf-50d7-ab2d-9aa438c638de"]
2023-12-12T11:43:56.165Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "4e48b48c-e1bf-50d7-ab2d-9aa438c638de"]
>o> inspector? {:result false}
2023-12-12T11:43:56.166Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "4e48b48c-e1bf-50d7-ab2d-9aa438c638de"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.166Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.166Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.167Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.168Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.168Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.168Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.168Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.169Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.169Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "a1727606-c7c8-54a2-aaa1-ceff7a7d4b40"]
2023-12-12T11:43:56.169Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"} {:id #uuid "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc", :firstname "Stefan", :lastname "Weinmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.170Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.170Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.170Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "a1727606-c7c8-54a2-aaa1-ceff7a7d4b40"]
2023-12-12T11:43:56.170Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "a1727606-c7c8-54a2-aaa1-ceff7a7d4b40"]
>o> inspector? {:result false}
2023-12-12T11:43:56.171Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "a1727606-c7c8-54a2-aaa1-ceff7a7d4b40"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.171Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.171Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.173Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.173Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.173Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.173Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.173Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.173Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.174Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "00382e27-a87a-5313-b31b-a369dad6c5f8"]
2023-12-12T11:43:56.174Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"} {:id #uuid "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc", :firstname "Stefan", :lastname "Weinmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.174Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.174Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.175Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "00382e27-a87a-5313-b31b-a369dad6c5f8"]
2023-12-12T11:43:56.178Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "00382e27-a87a-5313-b31b-a369dad6c5f8"]
>o> inspector? {:result false}
2023-12-12T11:43:56.179Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "00382e27-a87a-5313-b31b-a369dad6c5f8"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.180Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.180Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.180Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.180Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.181Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.181Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.181Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.181Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.181Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "ce5424cc-ce77-5e67-8201-333ec20963eb"]
2023-12-12T11:43:56.182Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"} {:id #uuid "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc", :firstname "Stefan", :lastname "Weinmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.182Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.182Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.183Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "ce5424cc-ce77-5e67-8201-333ec20963eb"]
2023-12-12T11:43:56.183Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "ce5424cc-ce77-5e67-8201-333ec20963eb"]
>o> inspector? {:result false}
2023-12-12T11:43:56.184Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "ce5424cc-ce77-5e67-8201-333ec20963eb"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.184Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.184Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.184Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.184Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.185Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.185Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.185Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.185Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.185Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "ce0812d7-080b-5f49-8530-dd4a821c57b6"]
2023-12-12T11:43:56.186Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"} {:id #uuid "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc", :firstname "Stefan", :lastname "Weinmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.186Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.186Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.186Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "ce0812d7-080b-5f49-8530-dd4a821c57b6"]
2023-12-12T11:43:56.186Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "ce0812d7-080b-5f49-8530-dd4a821c57b6"]
>o> inspector? {:result false}
2023-12-12T11:43:56.189Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "ce0812d7-080b-5f49-8530-dd4a821c57b6"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.190Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.190Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.190Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.190Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.190Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.190Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.190Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.191Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.191Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "67e5fc60-6fe3-53bb-9495-3669b917038a"]
2023-12-12T11:43:56.192Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"} {:id #uuid "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc", :firstname "Stefan", :lastname "Weinmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.193Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.193Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.194Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "67e5fc60-6fe3-53bb-9495-3669b917038a"]
2023-12-12T11:43:56.194Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "67e5fc60-6fe3-53bb-9495-3669b917038a"]
>o> inspector? {:result false}
2023-12-12T11:43:56.194Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "67e5fc60-6fe3-53bb-9495-3669b917038a"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.195Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.195Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.195Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.195Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.195Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.197Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.197Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.197Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.197Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "f94f72e8-ff65-5bad-b1f9-81ddd8fa7c0c"]
2023-12-12T11:43:56.197Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"} {:id #uuid "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc", :firstname "Stefan", :lastname "Weinmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.198Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.198Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.198Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "f94f72e8-ff65-5bad-b1f9-81ddd8fa7c0c"]
2023-12-12T11:43:56.198Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "f94f72e8-ff65-5bad-b1f9-81ddd8fa7c0c"]
>o> inspector? {:result false}
2023-12-12T11:43:56.198Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "f94f72e8-ff65-5bad-b1f9-81ddd8fa7c0c"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.203Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.203Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.203Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.204Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.204Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.204Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.204Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.205Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.205Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "89e4a22f-7d6c-5006-b26a-3ef6f8f19630"]
2023-12-12T11:43:56.205Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"} {:id #uuid "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc", :firstname "Stefan", :lastname "Weinmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.206Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.206Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.206Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "89e4a22f-7d6c-5006-b26a-3ef6f8f19630"]
2023-12-12T11:43:56.206Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "89e4a22f-7d6c-5006-b26a-3ef6f8f19630"]
>o> inspector? {:result false}
2023-12-12T11:43:56.207Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "89e4a22f-7d6c-5006-b26a-3ef6f8f19630"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.207Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.207Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.207Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.208Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.208Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.210Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.210Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.210Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.210Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "1fb59e17-a703-5abc-8a80-fc7a9c20ee1d"]
2023-12-12T11:43:56.211Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"} {:id #uuid "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc", :firstname "Stefan", :lastname "Weinmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.211Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.211Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.211Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "1fb59e17-a703-5abc-8a80-fc7a9c20ee1d"]
2023-12-12T11:43:56.211Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "1fb59e17-a703-5abc-8a80-fc7a9c20ee1d"]
>o> inspector? {:result false}
2023-12-12T11:43:56.212Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "1fb59e17-a703-5abc-8a80-fc7a9c20ee1d"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.213Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.214Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.214Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.214Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.214Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.214Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.214Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.215Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.215Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "c17698c1-5d5d-51ea-927f-b6ca96431a50"]
2023-12-12T11:43:56.217Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"} {:id #uuid "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc", :firstname "Stefan", :lastname "Weinmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.218Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.218Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.218Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "c17698c1-5d5d-51ea-927f-b6ca96431a50"]
2023-12-12T11:43:56.218Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "c17698c1-5d5d-51ea-927f-b6ca96431a50"]
>o> inspector? {:result false}
2023-12-12T11:43:56.219Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "c17698c1-5d5d-51ea-927f-b6ca96431a50"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.219Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.219Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.219Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.220Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.220Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.223Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.224Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.224Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.224Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "fabe3b8c-58b5-5009-8873-cc3e945a7c0d"]
2023-12-12T11:43:56.224Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"} {:id #uuid "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc", :firstname "Stefan", :lastname "Weinmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.225Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.225Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.225Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "fabe3b8c-58b5-5009-8873-cc3e945a7c0d"]
2023-12-12T11:43:56.225Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "fabe3b8c-58b5-5009-8873-cc3e945a7c0d"]
>o> inspector? {:result false}
2023-12-12T11:43:56.225Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "fabe3b8c-58b5-5009-8873-cc3e945a7c0d"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.227Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.227Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.228Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.228Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.228Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.228Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.229Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.229Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.229Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "ebb12585-ce23-5cbe-8f4f-41a42d60a656"]
2023-12-12T11:43:56.229Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "c0777d74-668b-5e01-abb5-f8277baa0ea8", :firstname "Matus", :lastname "Kmit"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "8a9d832a-cf4c-5253-bcaa-385ef03565c1", :firstname "Nadja", :lastname "Weisskopf-Admin"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"} {:id #uuid "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc", :firstname "Stefan", :lastname "Weinmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.231Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.231Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.231Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "ebb12585-ce23-5cbe-8f4f-41a42d60a656"]
2023-12-12T11:43:56.232Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "ebb12585-ce23-5cbe-8f4f-41a42d60a656"]
>o> inspector? {:result false}
2023-12-12T11:43:56.232Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "ebb12585-ce23-5cbe-8f4f-41a42d60a656"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.232Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.232Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.233Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete3
2023-12-12T11:43:56.233Z NX-41294 DEBUG [leihs.procurement.resources.main-category:?] - (sql-format (sql/select (vector [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] :result))) => ["SELECT NOT EXISTS (SELECT TRUE FROM procurement_requests AS pr INNER JOIN procurement_categories AS pc ON pc.id = pr.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AND NOT EXISTS (SELECT TRUE FROM procurement_templates AS pt INNER JOIN procurement_categories AS pc ON pc.id = pt.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AS result" #uuid "1a047acd-dc98-52c2-99d3-dc6332adc1e0" #uuid "1a047acd-dc98-52c2-99d3-dc6332adc1e0"]
2023-12-12T11:43:56.233Z NX-41294 DEBUG [leihs.procurement.resources.main-category:154] - (-> (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format spy)) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.252Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.252Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.252Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.253Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.253Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.253Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.253Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.253Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.254Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "0a082661-cc1c-5b49-baab-f4db926faa7e"]
2023-12-12T11:43:56.254Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "797264c9-a2c2-5642-9c1a-d45b01f4fdc5", :firstname "Heike", :lastname "Heldt"} {:id #uuid "2c1de10b-6145-56d6-a76e-3c207cfc35a1", :firstname "Marco", :lastname "Castellano"} {:id #uuid "57bb6aaa-95fb-435f-8dd9-d0b853bf2279", :firstname "Pascale", :lastname "Gisel"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.278Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.278Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.280Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "0a082661-cc1c-5b49-baab-f4db926faa7e"]
2023-12-12T11:43:56.280Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "0a082661-cc1c-5b49-baab-f4db926faa7e"]
>o> inspector? {:result false}
2023-12-12T11:43:56.281Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "0a082661-cc1c-5b49-baab-f4db926faa7e"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.281Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.281Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.281Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.282Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.282Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.282Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.282Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.283Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.283Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "42cc2d9a-cc45-5d77-85d3-0f21270d7a35"]
2023-12-12T11:43:56.284Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "797264c9-a2c2-5642-9c1a-d45b01f4fdc5", :firstname "Heike", :lastname "Heldt"} {:id #uuid "2c1de10b-6145-56d6-a76e-3c207cfc35a1", :firstname "Marco", :lastname "Castellano"} {:id #uuid "57bb6aaa-95fb-435f-8dd9-d0b853bf2279", :firstname "Pascale", :lastname "Gisel"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.285Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.285Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.286Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "42cc2d9a-cc45-5d77-85d3-0f21270d7a35"]
2023-12-12T11:43:56.286Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "42cc2d9a-cc45-5d77-85d3-0f21270d7a35"]
>o> inspector? {:result false}
2023-12-12T11:43:56.286Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "42cc2d9a-cc45-5d77-85d3-0f21270d7a35"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.287Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.287Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.287Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.287Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.287Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.288Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.288Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.288Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.288Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "56aaec64-8d65-50b3-bd81-f788d477b927"]
2023-12-12T11:43:56.288Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "797264c9-a2c2-5642-9c1a-d45b01f4fdc5", :firstname "Heike", :lastname "Heldt"} {:id #uuid "2c1de10b-6145-56d6-a76e-3c207cfc35a1", :firstname "Marco", :lastname "Castellano"} {:id #uuid "57bb6aaa-95fb-435f-8dd9-d0b853bf2279", :firstname "Pascale", :lastname "Gisel"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.289Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.289Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.290Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "56aaec64-8d65-50b3-bd81-f788d477b927"]
2023-12-12T11:43:56.290Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "56aaec64-8d65-50b3-bd81-f788d477b927"]
>o> inspector? {:result false}
2023-12-12T11:43:56.291Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "56aaec64-8d65-50b3-bd81-f788d477b927"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.291Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.291Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.291Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.292Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.292Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.292Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.292Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.292Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.292Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "483ac871-b632-5dcd-9d37-789d65f4c424"]
2023-12-12T11:43:56.296Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "797264c9-a2c2-5642-9c1a-d45b01f4fdc5", :firstname "Heike", :lastname "Heldt"} {:id #uuid "2c1de10b-6145-56d6-a76e-3c207cfc35a1", :firstname "Marco", :lastname "Castellano"} {:id #uuid "57bb6aaa-95fb-435f-8dd9-d0b853bf2279", :firstname "Pascale", :lastname "Gisel"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.297Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.297Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.297Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "483ac871-b632-5dcd-9d37-789d65f4c424"]
2023-12-12T11:43:56.297Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "483ac871-b632-5dcd-9d37-789d65f4c424"]
>o> inspector? {:result false}
2023-12-12T11:43:56.297Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "483ac871-b632-5dcd-9d37-789d65f4c424"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.298Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.298Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.298Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.299Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.299Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.300Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.300Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.301Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.302Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "2b3749a2-6a59-5a25-9b9f-32f5e485e635"]
2023-12-12T11:43:56.302Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "797264c9-a2c2-5642-9c1a-d45b01f4fdc5", :firstname "Heike", :lastname "Heldt"} {:id #uuid "2c1de10b-6145-56d6-a76e-3c207cfc35a1", :firstname "Marco", :lastname "Castellano"} {:id #uuid "57bb6aaa-95fb-435f-8dd9-d0b853bf2279", :firstname "Pascale", :lastname "Gisel"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.302Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.303Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.303Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "2b3749a2-6a59-5a25-9b9f-32f5e485e635"]
2023-12-12T11:43:56.303Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "2b3749a2-6a59-5a25-9b9f-32f5e485e635"]
>o> inspector? {:result false}
2023-12-12T11:43:56.304Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "2b3749a2-6a59-5a25-9b9f-32f5e485e635"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.304Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.304Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.305Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.305Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.305Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.306Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.306Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.306Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.306Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "fad911e4-8c69-535c-a138-f3e2544519ba"]
2023-12-12T11:43:56.307Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "797264c9-a2c2-5642-9c1a-d45b01f4fdc5", :firstname "Heike", :lastname "Heldt"} {:id #uuid "2c1de10b-6145-56d6-a76e-3c207cfc35a1", :firstname "Marco", :lastname "Castellano"} {:id #uuid "57bb6aaa-95fb-435f-8dd9-d0b853bf2279", :firstname "Pascale", :lastname "Gisel"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.308Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.308Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.308Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "fad911e4-8c69-535c-a138-f3e2544519ba"]
2023-12-12T11:43:56.308Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "fad911e4-8c69-535c-a138-f3e2544519ba"]
>o> inspector? {:result false}
2023-12-12T11:43:56.313Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "fad911e4-8c69-535c-a138-f3e2544519ba"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.314Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.315Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.315Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.316Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.316Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.322Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.322Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.323Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.323Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "c3f14f79-931c-52c8-a847-ed77449ce9a6"]
2023-12-12T11:43:56.323Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "797264c9-a2c2-5642-9c1a-d45b01f4fdc5", :firstname "Heike", :lastname "Heldt"} {:id #uuid "2c1de10b-6145-56d6-a76e-3c207cfc35a1", :firstname "Marco", :lastname "Castellano"} {:id #uuid "57bb6aaa-95fb-435f-8dd9-d0b853bf2279", :firstname "Pascale", :lastname "Gisel"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.323Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.323Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.324Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "c3f14f79-931c-52c8-a847-ed77449ce9a6"]
2023-12-12T11:43:56.324Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "c3f14f79-931c-52c8-a847-ed77449ce9a6"]
>o> inspector? {:result false}
2023-12-12T11:43:56.325Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "c3f14f79-931c-52c8-a847-ed77449ce9a6"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.326Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.326Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.326Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete3
2023-12-12T11:43:56.326Z NX-41294 DEBUG [leihs.procurement.resources.main-category:?] - (sql-format (sql/select (vector [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] :result))) => ["SELECT NOT EXISTS (SELECT TRUE FROM procurement_requests AS pr INNER JOIN procurement_categories AS pc ON pc.id = pr.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AND NOT EXISTS (SELECT TRUE FROM procurement_templates AS pt INNER JOIN procurement_categories AS pc ON pc.id = pt.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AS result" #uuid "dda588f4-660c-573c-a2ff-944ae93ad42e" #uuid "dda588f4-660c-573c-a2ff-944ae93ad42e"]
2023-12-12T11:43:56.326Z NX-41294 DEBUG [leihs.procurement.resources.main-category:154] - (-> (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format spy)) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.327Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.327Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.327Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.327Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.327Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.329Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.330Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.330Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.330Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "b9e4f492-55e3-57e4-9467-91c81bfe2325"]
2023-12-12T11:43:56.330Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.331Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.331Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.331Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "b9e4f492-55e3-57e4-9467-91c81bfe2325"]
2023-12-12T11:43:56.331Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "b9e4f492-55e3-57e4-9467-91c81bfe2325"]
>o> inspector? {:result false}
2023-12-12T11:43:56.332Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "b9e4f492-55e3-57e4-9467-91c81bfe2325"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.334Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.334Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.334Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.335Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.335Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.335Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.335Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.336Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.336Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "a7cca5a4-e265-5f36-b794-1024c8aacc3e"]
2023-12-12T11:43:56.336Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.339Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.339Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.339Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "a7cca5a4-e265-5f36-b794-1024c8aacc3e"]
2023-12-12T11:43:56.340Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "a7cca5a4-e265-5f36-b794-1024c8aacc3e"]
>o> inspector? {:result false}
2023-12-12T11:43:56.340Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "a7cca5a4-e265-5f36-b794-1024c8aacc3e"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.341Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.341Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.341Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.342Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.342Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.345Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.345Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.345Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.345Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "79822b89-0edb-588c-b9e5-65b7722ac50b"]
2023-12-12T11:43:56.346Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.347Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.347Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.347Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "79822b89-0edb-588c-b9e5-65b7722ac50b"]
2023-12-12T11:43:56.347Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "79822b89-0edb-588c-b9e5-65b7722ac50b"]
>o> inspector? {:result false}
2023-12-12T11:43:56.348Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "79822b89-0edb-588c-b9e5-65b7722ac50b"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.349Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.349Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.349Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.350Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.350Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.350Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.350Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.350Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.351Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "ab911807-6431-5ca7-890a-3573737bb4d3"]
2023-12-12T11:43:56.351Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "2c1de10b-6145-56d6-a76e-3c207cfc35a1", :firstname "Marco", :lastname "Castellano"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.352Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.353Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.353Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "ab911807-6431-5ca7-890a-3573737bb4d3"]
2023-12-12T11:43:56.354Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "ab911807-6431-5ca7-890a-3573737bb4d3"]
>o> inspector? {:result false}
2023-12-12T11:43:56.354Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "ab911807-6431-5ca7-890a-3573737bb4d3"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.354Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.354Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.355Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.355Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.355Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.355Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.355Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.357Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.357Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "64c6f8ad-a1b7-530b-946a-ebb1644ac897"]
2023-12-12T11:43:56.357Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.358Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.358Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.358Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "64c6f8ad-a1b7-530b-946a-ebb1644ac897"]
2023-12-12T11:43:56.358Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "64c6f8ad-a1b7-530b-946a-ebb1644ac897"]
>o> inspector? {:result false}
2023-12-12T11:43:56.359Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "64c6f8ad-a1b7-530b-946a-ebb1644ac897"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.359Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.359Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.361Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.361Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.361Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.361Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.361Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.362Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.362Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "f2bb3f23-bb5b-5855-b03f-0166bd19fc0c"]
2023-12-12T11:43:56.363Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.363Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.363Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.363Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "f2bb3f23-bb5b-5855-b03f-0166bd19fc0c"]
2023-12-12T11:43:56.365Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "f2bb3f23-bb5b-5855-b03f-0166bd19fc0c"]
>o> inspector? {:result false}
2023-12-12T11:43:56.366Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "f2bb3f23-bb5b-5855-b03f-0166bd19fc0c"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.367Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.367Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.367Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete3
2023-12-12T11:43:56.367Z NX-41294 DEBUG [leihs.procurement.resources.main-category:?] - (sql-format (sql/select (vector [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] :result))) => ["SELECT NOT EXISTS (SELECT TRUE FROM procurement_requests AS pr INNER JOIN procurement_categories AS pc ON pc.id = pr.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AND NOT EXISTS (SELECT TRUE FROM procurement_templates AS pt INNER JOIN procurement_categories AS pc ON pc.id = pt.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AS result" #uuid "2b07eb8a-4174-5257-83eb-920d536cc44a" #uuid "2b07eb8a-4174-5257-83eb-920d536cc44a"]
2023-12-12T11:43:56.367Z NX-41294 DEBUG [leihs.procurement.resources.main-category:154] - (-> (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format spy)) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.368Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.368Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.369Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.370Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.370Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.370Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.370Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.371Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.371Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "5d8639a3-4569-5009-af28-f63f2af5209d"]
2023-12-12T11:43:56.371Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "2c1de10b-6145-56d6-a76e-3c207cfc35a1", :firstname "Marco", :lastname "Castellano"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.372Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.372Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.372Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "5d8639a3-4569-5009-af28-f63f2af5209d"]
2023-12-12T11:43:56.372Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "5d8639a3-4569-5009-af28-f63f2af5209d"]
>o> inspector? {:result false}
2023-12-12T11:43:56.374Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "5d8639a3-4569-5009-af28-f63f2af5209d"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.374Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.374Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.374Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.375Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.375Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.375Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.375Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.375Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.375Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "b34f1cbb-4ac7-59a0-81f2-3ca7ecc94e71"]
2023-12-12T11:43:56.375Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "2c1de10b-6145-56d6-a76e-3c207cfc35a1", :firstname "Marco", :lastname "Castellano"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.377Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.378Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.378Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "b34f1cbb-4ac7-59a0-81f2-3ca7ecc94e71"]
2023-12-12T11:43:56.378Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "b34f1cbb-4ac7-59a0-81f2-3ca7ecc94e71"]
>o> inspector? {:result false}
2023-12-12T11:43:56.378Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "b34f1cbb-4ac7-59a0-81f2-3ca7ecc94e71"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.379Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.379Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.379Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.379Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.379Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.381Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.381Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.381Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.381Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "73e97867-43ea-5bee-b46b-d7c74fbf873b"]
2023-12-12T11:43:56.382Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "2c1de10b-6145-56d6-a76e-3c207cfc35a1", :firstname "Marco", :lastname "Castellano"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.382Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.382Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.382Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "73e97867-43ea-5bee-b46b-d7c74fbf873b"]
2023-12-12T11:43:56.382Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "73e97867-43ea-5bee-b46b-d7c74fbf873b"]
>o> inspector? {:result false}
2023-12-12T11:43:56.383Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "73e97867-43ea-5bee-b46b-d7c74fbf873b"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.388Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.388Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.388Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.389Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.389Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.390Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.390Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.390Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.390Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "b6601a86-b5d3-5682-88b6-cff956b00d7b"]
2023-12-12T11:43:56.390Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "2c1de10b-6145-56d6-a76e-3c207cfc35a1", :firstname "Marco", :lastname "Castellano"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.392Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.392Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.392Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "b6601a86-b5d3-5682-88b6-cff956b00d7b"]
2023-12-12T11:43:56.392Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "b6601a86-b5d3-5682-88b6-cff956b00d7b"]
>o> inspector? {:result false}
2023-12-12T11:43:56.393Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "b6601a86-b5d3-5682-88b6-cff956b00d7b"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.393Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.393Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.393Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete3
2023-12-12T11:43:56.393Z NX-41294 DEBUG [leihs.procurement.resources.main-category:?] - (sql-format (sql/select (vector [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] :result))) => ["SELECT NOT EXISTS (SELECT TRUE FROM procurement_requests AS pr INNER JOIN procurement_categories AS pc ON pc.id = pr.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AND NOT EXISTS (SELECT TRUE FROM procurement_templates AS pt INNER JOIN procurement_categories AS pc ON pc.id = pt.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AS result" #uuid "f6827594-33a6-5760-ac41-f94ceefacfab" #uuid "f6827594-33a6-5760-ac41-f94ceefacfab"]
2023-12-12T11:43:56.394Z NX-41294 DEBUG [leihs.procurement.resources.main-category:154] - (-> (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format spy)) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.396Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.396Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.396Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.397Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.397Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.397Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.397Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.397Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.397Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "455bc6dc-afbd-579d-a621-6d75e0fca9ea"]
2023-12-12T11:43:56.397Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "428a72a9-36df-52fa-880f-64db35843013", :firstname "Dominik", :lastname "Fedier"} {:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "8448b7b2-f5d9-4590-8355-2295b50bba40", :firstname "Sergej", :lastname "Tratar Baamonde"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.400Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.400Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.400Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "455bc6dc-afbd-579d-a621-6d75e0fca9ea"]
2023-12-12T11:43:56.400Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "455bc6dc-afbd-579d-a621-6d75e0fca9ea"]
>o> inspector? {:result false}
2023-12-12T11:43:56.400Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "455bc6dc-afbd-579d-a621-6d75e0fca9ea"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.401Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.401Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.401Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.402Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.402Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.404Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.404Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.404Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.405Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "747b6b21-9fad-4a01-acd9-cd8983aed286"]
2023-12-12T11:43:56.405Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "428a72a9-36df-52fa-880f-64db35843013", :firstname "Dominik", :lastname "Fedier"} {:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.406Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.406Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.406Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "747b6b21-9fad-4a01-acd9-cd8983aed286"]
2023-12-12T11:43:56.406Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "747b6b21-9fad-4a01-acd9-cd8983aed286"]
>o> inspector? {:result false}
2023-12-12T11:43:56.407Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "747b6b21-9fad-4a01-acd9-cd8983aed286"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.408Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.408Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.408Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.409Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.409Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.409Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.409Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.409Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.409Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "07a6af37-e127-5f4b-94ec-698a5698d98c"]
2023-12-12T11:43:56.410Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "428a72a9-36df-52fa-880f-64db35843013", :firstname "Dominik", :lastname "Fedier"} {:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "8448b7b2-f5d9-4590-8355-2295b50bba40", :firstname "Sergej", :lastname "Tratar Baamonde"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.410Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.412Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.412Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "07a6af37-e127-5f4b-94ec-698a5698d98c"]
2023-12-12T11:43:56.412Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "07a6af37-e127-5f4b-94ec-698a5698d98c"]
>o> inspector? {:result false}
2023-12-12T11:43:56.413Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "07a6af37-e127-5f4b-94ec-698a5698d98c"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.413Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.413Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.413Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete3
2023-12-12T11:43:56.413Z NX-41294 DEBUG [leihs.procurement.resources.main-category:?] - (sql-format (sql/select (vector [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] :result))) => ["SELECT NOT EXISTS (SELECT TRUE FROM procurement_requests AS pr INNER JOIN procurement_categories AS pc ON pc.id = pr.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AND NOT EXISTS (SELECT TRUE FROM procurement_templates AS pt INNER JOIN procurement_categories AS pc ON pc.id = pt.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AS result" #uuid "517b82ae-2b7e-4822-9aeb-0d4753dec821" #uuid "517b82ae-2b7e-4822-9aeb-0d4753dec821"]
2023-12-12T11:43:56.414Z NX-41294 DEBUG [leihs.procurement.resources.main-category:154] - (-> (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format spy)) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.414Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.415Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.416Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.416Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.416Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.417Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.417Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.417Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.417Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "671ab85c-b8c1-4659-9c6e-9ebe2f122a59"]
2023-12-12T11:43:56.417Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "b610f5bd-6da8-5122-94f0-c0bbf1b7ed73", :firstname "Daniel", :lastname "Fischer"} {:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.418Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.418Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.426Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "671ab85c-b8c1-4659-9c6e-9ebe2f122a59"]
2023-12-12T11:43:56.427Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "671ab85c-b8c1-4659-9c6e-9ebe2f122a59"]
>o> inspector? {:result false}
2023-12-12T11:43:56.427Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "671ab85c-b8c1-4659-9c6e-9ebe2f122a59"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.428Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.428Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.430Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete3
2023-12-12T11:43:56.430Z NX-41294 DEBUG [leihs.procurement.resources.main-category:?] - (sql-format (sql/select (vector [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] :result))) => ["SELECT NOT EXISTS (SELECT TRUE FROM procurement_requests AS pr INNER JOIN procurement_categories AS pc ON pc.id = pr.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AND NOT EXISTS (SELECT TRUE FROM procurement_templates AS pt INNER JOIN procurement_categories AS pc ON pc.id = pt.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AS result" #uuid "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da" #uuid "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da"]
2023-12-12T11:43:56.431Z NX-41294 DEBUG [leihs.procurement.resources.main-category:154] - (-> (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format spy)) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.431Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.431Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.431Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.432Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.432Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.432Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.432Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.432Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.432Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "e1b4cad8-0416-5cf7-9e4a-dde208d0abad"]
2023-12-12T11:43:56.433Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.433Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.433Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.433Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "e1b4cad8-0416-5cf7-9e4a-dde208d0abad"]
2023-12-12T11:43:56.435Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "e1b4cad8-0416-5cf7-9e4a-dde208d0abad"]
>o> inspector? {:result false}
2023-12-12T11:43:56.436Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "e1b4cad8-0416-5cf7-9e4a-dde208d0abad"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.436Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.436Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.437Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.437Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.437Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.438Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.438Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.438Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.438Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "011ff3f3-09fa-59e1-9713-52466786adf8"]
2023-12-12T11:43:56.461Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.462Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.462Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.462Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "011ff3f3-09fa-59e1-9713-52466786adf8"]
2023-12-12T11:43:56.462Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "011ff3f3-09fa-59e1-9713-52466786adf8"]
>o> inspector? {:result false}
2023-12-12T11:43:56.463Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "011ff3f3-09fa-59e1-9713-52466786adf8"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.463Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.464Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.464Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.464Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.464Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.465Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.465Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.465Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.465Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "54b87eb0-061c-5a97-96ad-e9b6da605184"]
2023-12-12T11:43:56.466Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.466Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.466Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.466Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "54b87eb0-061c-5a97-96ad-e9b6da605184"]
2023-12-12T11:43:56.466Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "54b87eb0-061c-5a97-96ad-e9b6da605184"]
>o> inspector? {:result false}
2023-12-12T11:43:56.467Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "54b87eb0-061c-5a97-96ad-e9b6da605184"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.537Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.537Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.537Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.538Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.538Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.539Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.539Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.539Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.539Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "5858ec5d-5f01-50fb-bc96-4b4766bd7799"]
2023-12-12T11:43:56.539Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.541Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.541Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.541Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "5858ec5d-5f01-50fb-bc96-4b4766bd7799"]
2023-12-12T11:43:56.541Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "5858ec5d-5f01-50fb-bc96-4b4766bd7799"]
>o> inspector? {:result false}
2023-12-12T11:43:56.542Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "5858ec5d-5f01-50fb-bc96-4b4766bd7799"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.542Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.542Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.542Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.542Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.543Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.544Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.544Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.545Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.545Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "ba5b41a7-4317-5160-9b82-b0931a48aec0"]
2023-12-12T11:43:56.545Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.545Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.545Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.546Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "ba5b41a7-4317-5160-9b82-b0931a48aec0"]
2023-12-12T11:43:56.546Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "ba5b41a7-4317-5160-9b82-b0931a48aec0"]
>o> inspector? {:result false}
2023-12-12T11:43:56.547Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "ba5b41a7-4317-5160-9b82-b0931a48aec0"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.548Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.548Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.548Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.549Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.549Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.549Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.549Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.549Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.550Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "9df68a66-4523-5072-aa31-1df9abeaa1c7"]
2023-12-12T11:43:56.550Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "340e3295-90ba-5c73-8f01-61fefd9960ff", :firstname "Mike", :lastname "Honegger"} {:id #uuid "95727ff5-358f-540c-a09c-53a1ac219dd0", :firstname "Ralph", :lastname "Wetli"} {:id #uuid "e27434b5-115e-5792-a757-8ec39e0d3b7f", :firstname "Roger", :lastname "Bachmann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.552Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.552Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.553Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "9df68a66-4523-5072-aa31-1df9abeaa1c7"]
2023-12-12T11:43:56.553Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "9df68a66-4523-5072-aa31-1df9abeaa1c7"]
>o> inspector? {:result false}
2023-12-12T11:43:56.553Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "9df68a66-4523-5072-aa31-1df9abeaa1c7"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.554Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.554Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.554Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete3
2023-12-12T11:43:56.555Z NX-41294 DEBUG [leihs.procurement.resources.main-category:?] - (sql-format (sql/select (vector [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] :result))) => ["SELECT NOT EXISTS (SELECT TRUE FROM procurement_requests AS pr INNER JOIN procurement_categories AS pc ON pc.id = pr.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AND NOT EXISTS (SELECT TRUE FROM procurement_templates AS pt INNER JOIN procurement_categories AS pc ON pc.id = pt.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AS result" #uuid "2ea39047-e663-50d5-9080-838b75883704" #uuid "2ea39047-e663-50d5-9080-838b75883704"]
2023-12-12T11:43:56.555Z NX-41294 DEBUG [leihs.procurement.resources.main-category:154] - (-> (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format spy)) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.556Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.556Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.557Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.557Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.557Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.557Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.558Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.558Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.558Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "f2531d7e-d9ff-5c3e-9e88-6d3a16a89aa1"]
2023-12-12T11:43:56.558Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "e9656e43-9f35-502d-b495-eec36093208e", :firstname "Christian", :lastname "Wildhaber"} {:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "28552e7e-f8be-5019-bdad-846babd8c642", :firstname "Hugo", :lastname "Vögtle"} {:id #uuid "301988e6-5e0e-43a9-bcb6-3d0022b7ca99", :firstname "Lars", :lastname "Gnädinger"} {:id #uuid "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d", :firstname "Lenny Ron", :lastname "Frei"} {:id #uuid "b5d09795-0b94-423d-a645-bae0aed895ce", :firstname "Lukas", :lastname "Brupbacher"} {:id #uuid "b41e6486-ec39-4855-8d8a-c03aa83af233", :firstname "Matthias", :lastname "Daniels"} {:id #uuid "8a9d832a-cf4c-5253-bcaa-385ef03565c1", :firstname "Nadja", :lastname "Weisskopf-Admin"} {:id #uuid "4884241c-8104-5c10-a393-0e21dcd1a46e", :firstname "Patrice", :lastname "Huber"} {:id #uuid "52c2d39d-7f53-592f-8142-824afbaf59d3", :firstname "Tilo", :lastname "Seiring"} {:id #uuid "96c5a731-ae34-5ede-917c-90a42dc66a1e", :firstname "Ugo", :lastname "De Vito"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.561Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.561Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.561Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "f2531d7e-d9ff-5c3e-9e88-6d3a16a89aa1"]
2023-12-12T11:43:56.561Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "f2531d7e-d9ff-5c3e-9e88-6d3a16a89aa1"]
>o> inspector? {:result false}
2023-12-12T11:43:56.562Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "f2531d7e-d9ff-5c3e-9e88-6d3a16a89aa1"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.562Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.562Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.562Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.563Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.563Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.564Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.564Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.565Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.565Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "1af3a7f2-b16a-4203-b6ac-f2c7be612d74"]
2023-12-12T11:43:56.565Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "e9656e43-9f35-502d-b495-eec36093208e", :firstname "Christian", :lastname "Wildhaber"} {:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "28552e7e-f8be-5019-bdad-846babd8c642", :firstname "Hugo", :lastname "Vögtle"} {:id #uuid "301988e6-5e0e-43a9-bcb6-3d0022b7ca99", :firstname "Lars", :lastname "Gnädinger"} {:id #uuid "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d", :firstname "Lenny Ron", :lastname "Frei"} {:id #uuid "b5d09795-0b94-423d-a645-bae0aed895ce", :firstname "Lukas", :lastname "Brupbacher"} {:id #uuid "b41e6486-ec39-4855-8d8a-c03aa83af233", :firstname "Matthias", :lastname "Daniels"} {:id #uuid "4884241c-8104-5c10-a393-0e21dcd1a46e", :firstname "Patrice", :lastname "Huber"} {:id #uuid "52c2d39d-7f53-592f-8142-824afbaf59d3", :firstname "Tilo", :lastname "Seiring"} {:id #uuid "96c5a731-ae34-5ede-917c-90a42dc66a1e", :firstname "Ugo", :lastname "De Vito"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.566Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.566Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.566Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "1af3a7f2-b16a-4203-b6ac-f2c7be612d74"]
2023-12-12T11:43:56.566Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "1af3a7f2-b16a-4203-b6ac-f2c7be612d74"]
>o> inspector? {:result false}
2023-12-12T11:43:56.566Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "1af3a7f2-b16a-4203-b6ac-f2c7be612d74"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.568Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.568Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.569Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.569Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.569Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.569Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.569Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.570Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.570Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "ccab158d-79c7-5c28-a8a2-47cb4925f101"]
2023-12-12T11:43:56.570Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "e9656e43-9f35-502d-b495-eec36093208e", :firstname "Christian", :lastname "Wildhaber"} {:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "28552e7e-f8be-5019-bdad-846babd8c642", :firstname "Hugo", :lastname "Vögtle"} {:id #uuid "301988e6-5e0e-43a9-bcb6-3d0022b7ca99", :firstname "Lars", :lastname "Gnädinger"} {:id #uuid "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d", :firstname "Lenny Ron", :lastname "Frei"} {:id #uuid "b41e6486-ec39-4855-8d8a-c03aa83af233", :firstname "Matthias", :lastname "Daniels"} {:id #uuid "4884241c-8104-5c10-a393-0e21dcd1a46e", :firstname "Patrice", :lastname "Huber"} {:id #uuid "52c2d39d-7f53-592f-8142-824afbaf59d3", :firstname "Tilo", :lastname "Seiring"} {:id #uuid "96c5a731-ae34-5ede-917c-90a42dc66a1e", :firstname "Ugo", :lastname "De Vito"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.572Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.572Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.572Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "ccab158d-79c7-5c28-a8a2-47cb4925f101"]
2023-12-12T11:43:56.573Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "ccab158d-79c7-5c28-a8a2-47cb4925f101"]
>o> inspector? {:result false}
2023-12-12T11:43:56.573Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "ccab158d-79c7-5c28-a8a2-47cb4925f101"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.574Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.574Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.574Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.575Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.575Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.576Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.576Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.576Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.576Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "eb1e7bef-80c6-4958-b16e-35555735ce61"]
2023-12-12T11:43:56.577Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "3651eeeb-0fb1-4840-80dd-6c739bda6c57", :firstname "Christian", :lastname "Schneider"} {:id #uuid "301988e6-5e0e-43a9-bcb6-3d0022b7ca99", :firstname "Lars", :lastname "Gnädinger"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.578Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.578Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.578Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "eb1e7bef-80c6-4958-b16e-35555735ce61"]
2023-12-12T11:43:56.579Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "eb1e7bef-80c6-4958-b16e-35555735ce61"]
>o> inspector? {:result false}
2023-12-12T11:43:56.579Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "eb1e7bef-80c6-4958-b16e-35555735ce61"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.580Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.581Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.581Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.581Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.581Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.581Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.581Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.582Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.582Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "4ecc9e97-2d12-5173-bd8c-781482c842e8"]
2023-12-12T11:43:56.583Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "e9656e43-9f35-502d-b495-eec36093208e", :firstname "Christian", :lastname "Wildhaber"} {:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "28552e7e-f8be-5019-bdad-846babd8c642", :firstname "Hugo", :lastname "Vögtle"} {:id #uuid "301988e6-5e0e-43a9-bcb6-3d0022b7ca99", :firstname "Lars", :lastname "Gnädinger"} {:id #uuid "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d", :firstname "Lenny Ron", :lastname "Frei"} {:id #uuid "b41e6486-ec39-4855-8d8a-c03aa83af233", :firstname "Matthias", :lastname "Daniels"} {:id #uuid "4884241c-8104-5c10-a393-0e21dcd1a46e", :firstname "Patrice", :lastname "Huber"} {:id #uuid "52c2d39d-7f53-592f-8142-824afbaf59d3", :firstname "Tilo", :lastname "Seiring"} {:id #uuid "96c5a731-ae34-5ede-917c-90a42dc66a1e", :firstname "Ugo", :lastname "De Vito"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.584Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.584Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.585Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "4ecc9e97-2d12-5173-bd8c-781482c842e8"]
2023-12-12T11:43:56.585Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "4ecc9e97-2d12-5173-bd8c-781482c842e8"]
>o> inspector? {:result false}
2023-12-12T11:43:56.588Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "4ecc9e97-2d12-5173-bd8c-781482c842e8"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.589Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.589Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.590Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.590Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.590Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.590Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.590Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.591Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.591Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "80226a51-c17a-5fd8-93db-40aef5b03491"]
2023-12-12T11:43:56.591Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "e9656e43-9f35-502d-b495-eec36093208e", :firstname "Christian", :lastname "Wildhaber"} {:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "28552e7e-f8be-5019-bdad-846babd8c642", :firstname "Hugo", :lastname "Vögtle"} {:id #uuid "301988e6-5e0e-43a9-bcb6-3d0022b7ca99", :firstname "Lars", :lastname "Gnädinger"} {:id #uuid "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d", :firstname "Lenny Ron", :lastname "Frei"} {:id #uuid "b41e6486-ec39-4855-8d8a-c03aa83af233", :firstname "Matthias", :lastname "Daniels"} {:id #uuid "4884241c-8104-5c10-a393-0e21dcd1a46e", :firstname "Patrice", :lastname "Huber"} {:id #uuid "52c2d39d-7f53-592f-8142-824afbaf59d3", :firstname "Tilo", :lastname "Seiring"} {:id #uuid "96c5a731-ae34-5ede-917c-90a42dc66a1e", :firstname "Ugo", :lastname "De Vito"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.592Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.592Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.592Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "80226a51-c17a-5fd8-93db-40aef5b03491"]
2023-12-12T11:43:56.592Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "80226a51-c17a-5fd8-93db-40aef5b03491"]
>o> inspector? {:result false}
2023-12-12T11:43:56.592Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "80226a51-c17a-5fd8-93db-40aef5b03491"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.593Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.593Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.593Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.593Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.593Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.593Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.593Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.593Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.594Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "fe602c35-1097-52d0-acd0-40579d295f00"]
2023-12-12T11:43:56.594Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "e9656e43-9f35-502d-b495-eec36093208e", :firstname "Christian", :lastname "Wildhaber"} {:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "28552e7e-f8be-5019-bdad-846babd8c642", :firstname "Hugo", :lastname "Vögtle"} {:id #uuid "301988e6-5e0e-43a9-bcb6-3d0022b7ca99", :firstname "Lars", :lastname "Gnädinger"} {:id #uuid "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d", :firstname "Lenny Ron", :lastname "Frei"} {:id #uuid "b41e6486-ec39-4855-8d8a-c03aa83af233", :firstname "Matthias", :lastname "Daniels"} {:id #uuid "4884241c-8104-5c10-a393-0e21dcd1a46e", :firstname "Patrice", :lastname "Huber"} {:id #uuid "52c2d39d-7f53-592f-8142-824afbaf59d3", :firstname "Tilo", :lastname "Seiring"} {:id #uuid "96c5a731-ae34-5ede-917c-90a42dc66a1e", :firstname "Ugo", :lastname "De Vito"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.596Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.596Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.597Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "fe602c35-1097-52d0-acd0-40579d295f00"]
2023-12-12T11:43:56.597Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "fe602c35-1097-52d0-acd0-40579d295f00"]
>o> inspector? {:result false}
2023-12-12T11:43:56.597Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "fe602c35-1097-52d0-acd0-40579d295f00"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.598Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.598Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.600Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.601Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.601Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.602Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.602Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.602Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.602Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "56065d53-cd2f-5a39-9b66-532fd83ad2e6"]
2023-12-12T11:43:56.603Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "e9656e43-9f35-502d-b495-eec36093208e", :firstname "Christian", :lastname "Wildhaber"} {:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "28552e7e-f8be-5019-bdad-846babd8c642", :firstname "Hugo", :lastname "Vögtle"} {:id #uuid "301988e6-5e0e-43a9-bcb6-3d0022b7ca99", :firstname "Lars", :lastname "Gnädinger"} {:id #uuid "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d", :firstname "Lenny Ron", :lastname "Frei"} {:id #uuid "b41e6486-ec39-4855-8d8a-c03aa83af233", :firstname "Matthias", :lastname "Daniels"} {:id #uuid "4884241c-8104-5c10-a393-0e21dcd1a46e", :firstname "Patrice", :lastname "Huber"} {:id #uuid "52c2d39d-7f53-592f-8142-824afbaf59d3", :firstname "Tilo", :lastname "Seiring"} {:id #uuid "96c5a731-ae34-5ede-917c-90a42dc66a1e", :firstname "Ugo", :lastname "De Vito"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.603Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.603Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.603Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "56065d53-cd2f-5a39-9b66-532fd83ad2e6"]
2023-12-12T11:43:56.603Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "56065d53-cd2f-5a39-9b66-532fd83ad2e6"]
>o> inspector? {:result false}
2023-12-12T11:43:56.604Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "56065d53-cd2f-5a39-9b66-532fd83ad2e6"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.604Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.604Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.605Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.605Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.605Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.605Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.605Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.605Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.606Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "fc7bc38c-62f3-5576-802f-c874e06ee776"]
2023-12-12T11:43:56.606Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "e9656e43-9f35-502d-b495-eec36093208e", :firstname "Christian", :lastname "Wildhaber"} {:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "28552e7e-f8be-5019-bdad-846babd8c642", :firstname "Hugo", :lastname "Vögtle"} {:id #uuid "301988e6-5e0e-43a9-bcb6-3d0022b7ca99", :firstname "Lars", :lastname "Gnädinger"} {:id #uuid "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d", :firstname "Lenny Ron", :lastname "Frei"} {:id #uuid "b41e6486-ec39-4855-8d8a-c03aa83af233", :firstname "Matthias", :lastname "Daniels"} {:id #uuid "8a9d832a-cf4c-5253-bcaa-385ef03565c1", :firstname "Nadja", :lastname "Weisskopf-Admin"} {:id #uuid "4884241c-8104-5c10-a393-0e21dcd1a46e", :firstname "Patrice", :lastname "Huber"} {:id #uuid "52c2d39d-7f53-592f-8142-824afbaf59d3", :firstname "Tilo", :lastname "Seiring"} {:id #uuid "96c5a731-ae34-5ede-917c-90a42dc66a1e", :firstname "Ugo", :lastname "De Vito"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.608Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.608Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.608Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "fc7bc38c-62f3-5576-802f-c874e06ee776"]
2023-12-12T11:43:56.608Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "fc7bc38c-62f3-5576-802f-c874e06ee776"]
>o> inspector? {:result false}
2023-12-12T11:43:56.609Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "fc7bc38c-62f3-5576-802f-c874e06ee776"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.610Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.610Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.610Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.610Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.611Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.612Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.612Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.613Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.614Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "76fdca98-4a2a-5640-bc98-f33059d6ffa0"]
2023-12-12T11:43:56.615Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "e9656e43-9f35-502d-b495-eec36093208e", :firstname "Christian", :lastname "Wildhaber"} {:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "28552e7e-f8be-5019-bdad-846babd8c642", :firstname "Hugo", :lastname "Vögtle"} {:id #uuid "301988e6-5e0e-43a9-bcb6-3d0022b7ca99", :firstname "Lars", :lastname "Gnädinger"} {:id #uuid "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d", :firstname "Lenny Ron", :lastname "Frei"} {:id #uuid "b41e6486-ec39-4855-8d8a-c03aa83af233", :firstname "Matthias", :lastname "Daniels"} {:id #uuid "4884241c-8104-5c10-a393-0e21dcd1a46e", :firstname "Patrice", :lastname "Huber"} {:id #uuid "52c2d39d-7f53-592f-8142-824afbaf59d3", :firstname "Tilo", :lastname "Seiring"} {:id #uuid "96c5a731-ae34-5ede-917c-90a42dc66a1e", :firstname "Ugo", :lastname "De Vito"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.615Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.615Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.616Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "76fdca98-4a2a-5640-bc98-f33059d6ffa0"]
2023-12-12T11:43:56.616Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "76fdca98-4a2a-5640-bc98-f33059d6ffa0"]
>o> inspector? {:result false}
2023-12-12T11:43:56.617Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "76fdca98-4a2a-5640-bc98-f33059d6ffa0"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.617Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.617Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.617Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.618Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.618Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.618Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.618Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.619Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.619Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "77857566-03d9-58f4-8b0d-290227434aff"]
2023-12-12T11:43:56.622Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "e9656e43-9f35-502d-b495-eec36093208e", :firstname "Christian", :lastname "Wildhaber"} {:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "28552e7e-f8be-5019-bdad-846babd8c642", :firstname "Hugo", :lastname "Vögtle"} {:id #uuid "301988e6-5e0e-43a9-bcb6-3d0022b7ca99", :firstname "Lars", :lastname "Gnädinger"} {:id #uuid "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d", :firstname "Lenny Ron", :lastname "Frei"} {:id #uuid "b41e6486-ec39-4855-8d8a-c03aa83af233", :firstname "Matthias", :lastname "Daniels"} {:id #uuid "4884241c-8104-5c10-a393-0e21dcd1a46e", :firstname "Patrice", :lastname "Huber"} {:id #uuid "52c2d39d-7f53-592f-8142-824afbaf59d3", :firstname "Tilo", :lastname "Seiring"} {:id #uuid "96c5a731-ae34-5ede-917c-90a42dc66a1e", :firstname "Ugo", :lastname "De Vito"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.622Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.622Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.622Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "77857566-03d9-58f4-8b0d-290227434aff"]
2023-12-12T11:43:56.623Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "77857566-03d9-58f4-8b0d-290227434aff"]
>o> inspector? {:result false}
2023-12-12T11:43:56.623Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "77857566-03d9-58f4-8b0d-290227434aff"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.623Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.623Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.624Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.624Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.624Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.624Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.624Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.624Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.625Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "5059c4fc-d34c-5c9a-9efe-257c7ec6fb6b"]
2023-12-12T11:43:56.625Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "e9656e43-9f35-502d-b495-eec36093208e", :firstname "Christian", :lastname "Wildhaber"} {:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "28552e7e-f8be-5019-bdad-846babd8c642", :firstname "Hugo", :lastname "Vögtle"} {:id #uuid "301988e6-5e0e-43a9-bcb6-3d0022b7ca99", :firstname "Lars", :lastname "Gnädinger"} {:id #uuid "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d", :firstname "Lenny Ron", :lastname "Frei"} {:id #uuid "b41e6486-ec39-4855-8d8a-c03aa83af233", :firstname "Matthias", :lastname "Daniels"} {:id #uuid "4884241c-8104-5c10-a393-0e21dcd1a46e", :firstname "Patrice", :lastname "Huber"} {:id #uuid "52c2d39d-7f53-592f-8142-824afbaf59d3", :firstname "Tilo", :lastname "Seiring"} {:id #uuid "96c5a731-ae34-5ede-917c-90a42dc66a1e", :firstname "Ugo", :lastname "De Vito"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.625Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.625Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.626Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "5059c4fc-d34c-5c9a-9efe-257c7ec6fb6b"]
2023-12-12T11:43:56.626Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "5059c4fc-d34c-5c9a-9efe-257c7ec6fb6b"]
>o> inspector? {:result false}
2023-12-12T11:43:56.626Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "5059c4fc-d34c-5c9a-9efe-257c7ec6fb6b"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.628Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.628Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.628Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete3
2023-12-12T11:43:56.628Z NX-41294 DEBUG [leihs.procurement.resources.main-category:?] - (sql-format (sql/select (vector [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] :result))) => ["SELECT NOT EXISTS (SELECT TRUE FROM procurement_requests AS pr INNER JOIN procurement_categories AS pc ON pc.id = pr.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AND NOT EXISTS (SELECT TRUE FROM procurement_templates AS pt INNER JOIN procurement_categories AS pc ON pc.id = pt.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AS result" #uuid "f6885671-3bf3-56f2-8e92-b5112d0f703f" #uuid "f6885671-3bf3-56f2-8e92-b5112d0f703f"]
2023-12-12T11:43:56.629Z NX-41294 DEBUG [leihs.procurement.resources.main-category:154] - (-> (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format spy)) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.629Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.629Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.629Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.629Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.629Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.631Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.631Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.632Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.632Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "af3372a1-63a8-52dc-850e-c2ae91c1c078"]
2023-12-12T11:43:56.633Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "6eeeeb75-e3d8-56c9-b7b6-0c45b7795cb9", :firstname "Martin", :lastname "Weyermann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.633Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.633Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.633Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "af3372a1-63a8-52dc-850e-c2ae91c1c078"]
2023-12-12T11:43:56.634Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "af3372a1-63a8-52dc-850e-c2ae91c1c078"]
>o> inspector? {:result false}
2023-12-12T11:43:56.634Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "af3372a1-63a8-52dc-850e-c2ae91c1c078"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.635Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.635Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.635Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.636Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.636Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.636Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.636Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.636Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.636Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "17a52112-1986-5074-b1d9-0faff29a785b"]
2023-12-12T11:43:56.637Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "6eeeeb75-e3d8-56c9-b7b6-0c45b7795cb9", :firstname "Martin", :lastname "Weyermann"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.639Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.639Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.639Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "17a52112-1986-5074-b1d9-0faff29a785b"]
2023-12-12T11:43:56.639Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "17a52112-1986-5074-b1d9-0faff29a785b"]
>o> inspector? {:result false}
2023-12-12T11:43:56.639Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "17a52112-1986-5074-b1d9-0faff29a785b"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.640Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.640Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.640Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete3
2023-12-12T11:43:56.640Z NX-41294 DEBUG [leihs.procurement.resources.main-category:?] - (sql-format (sql/select (vector [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] :result))) => ["SELECT NOT EXISTS (SELECT TRUE FROM procurement_requests AS pr INNER JOIN procurement_categories AS pc ON pc.id = pr.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AND NOT EXISTS (SELECT TRUE FROM procurement_templates AS pt INNER JOIN procurement_categories AS pc ON pc.id = pt.category_id WHERE pc.main_category_id = CAST(? AS UUID)) AS result" #uuid "6c8a0d77-6711-5156-a59a-12425ba01cff" #uuid "6c8a0d77-6711-5156-a59a-12425ba01cff"]
2023-12-12T11:43:56.640Z NX-41294 DEBUG [leihs.procurement.resources.main-category:154] - (-> (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/join [:procurement_categories :pc] [:= :pc.id :pr.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/join [:procurement_categories :pc] [:= :pc.id :pt.category_id]) (sql/where [:= :pc.main_category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format spy)) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.655Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.655Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.656Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.656Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.656Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.657Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.657Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.657Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.657Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "6870a16c-9a71-5e60-b94a-f0b784398fec"]
2023-12-12T11:43:56.657Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "ad765b67-18f7-55a8-88b6-11a82cd0d0b4", :firstname "Adrian", :lastname "Brazerol"} {:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.679Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.680Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.680Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "6870a16c-9a71-5e60-b94a-f0b784398fec"]
2023-12-12T11:43:56.680Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "6870a16c-9a71-5e60-b94a-f0b784398fec"]
>o> inspector? {:result false}
2023-12-12T11:43:56.680Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "6870a16c-9a71-5e60-b94a-f0b784398fec"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.681Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.681Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.681Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.681Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.681Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.682Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.683Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.686Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.686Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "771fddcf-b19a-5e6b-8b6f-7266b6922c4f"]
2023-12-12T11:43:56.687Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "ad765b67-18f7-55a8-88b6-11a82cd0d0b4", :firstname "Adrian", :lastname "Brazerol"} {:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.687Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.687Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.688Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "771fddcf-b19a-5e6b-8b6f-7266b6922c4f"]
2023-12-12T11:43:56.688Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "771fddcf-b19a-5e6b-8b6f-7266b6922c4f"]
>o> inspector? {:result false}
2023-12-12T11:43:56.689Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "771fddcf-b19a-5e6b-8b6f-7266b6922c4f"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.689Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.689Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.689Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.690Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.690Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.690Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.690Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.690Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.691Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "c7ece4a6-2b5c-409f-96ea-e4fd6e8f9792"]
2023-12-12T11:43:56.691Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "ad765b67-18f7-55a8-88b6-11a82cd0d0b4", :firstname "Adrian", :lastname "Brazerol"} {:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.691Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.691Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.691Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "c7ece4a6-2b5c-409f-96ea-e4fd6e8f9792"]
2023-12-12T11:43:56.692Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "c7ece4a6-2b5c-409f-96ea-e4fd6e8f9792"]
>o> inspector? {:result false}
2023-12-12T11:43:56.692Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "c7ece4a6-2b5c-409f-96ea-e4fd6e8f9792"]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.693Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.693Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.693Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>> can-delete1
2023-12-12T11:43:56.693Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format)) => {:result false}
2023-12-12T11:43:56.693Z NX-41294 DEBUG [leihs.procurement.resources.category:112] - (-> (spy (jdbc/execute-one! (-> context :request :tx-next) (-> [:and [:not [:exists (-> (sql/select true) (sql/from [:procurement_requests :pr]) (sql/where [:= :pr.category_id [:cast (:id value) :uuid]]))]] [:not [:exists (-> (sql/select true) (sql/from [:procurement_templates :pt]) (sql/where [:= :pt.category_id [:cast (:id value) :uuid]]))]]] (vector :result) sql/select sql-format))) :result) => false
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.693Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.693Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.694Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> tocheck1 true/false
2023-12-12T11:43:56.694Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pci.user_id FROM procurement_category_inspectors AS pci WHERE pci.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "3eaad5d5-516a-5610-8caf-342cfdcaac62"]
2023-12-12T11:43:56.696Z NX-41294 DEBUG [leihs.procurement.resources.inspectors:77] - (jdbc/execute! (-> context :request :tx-next) (-> users-base-query (sql/where [:in :users.id (-> (sql/select :pci.user_id) (sql/from [:procurement_category_inspectors :pci]) (sql/where [:= :pci.category_id [:cast (:id value) :uuid]]))]) sql-format spy)) => [{:id #uuid "ad765b67-18f7-55a8-88b6-11a82cd0d0b4", :firstname "Adrian", :lastname "Brazerol"} {:id #uuid "cbcbc88f-e7b4-58fd-8dc2-e83be0d06475", :firstname "Claudia", :lastname "Bachmann"} {:id #uuid "da18869a-e4bd-4493-a4c9-2e6fe78c94e7", :firstname "Etienne", :lastname "Schudel"} {:id #uuid "f721d6b7-8275-5ee0-b225-aa7c13781f45", :firstname "Hans Ulrich", :lastname "Gasser"} {:id #uuid "6ecace30-0931-59f4-9032-cd412530256c", :firstname "Judith", :lastname "Richi"} {:id #uuid "de3d3911-8b37-4bfe-aa59-25ee8dac5b07", :firstname "Julio", :lastname "Barrantes Zunzunegui"} {:id #uuid "b1e54635-ec2a-444f-8edd-7186075b0760", :firstname "Nomce", :lastname "Tanaskoski"} {:id #uuid "8448b7b2-f5d9-4590-8355-2295b50bba40", :firstname "Sergej", :lastname "Tratar Baamonde"} {:id #uuid "48e259df-9b53-5e56-a03e-65ce562f231a", :firstname "Silvan", :lastname "Becchio"} {:id #uuid "d0853239-fe13-4540-9c16-4ec1656461d3", :firstname "Silvia", :lastname "Eichenberger"} {:id #uuid "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc", :firstname "Stefan", :lastname "Weinmann"} {:id #uuid "baa628c5-c7fc-4cce-bea7-d8093f78adca", :firstname "Zelda", :lastname "Keller"}]
>>1x #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
>>2x {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
2023-12-12T11:43:56.697Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.697Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.698Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "3eaad5d5-516a-5610-8caf-342cfdcaac62"]
2023-12-12T11:43:56.698Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE (procurement_category_inspectors.user_id = CAST(? AS UUID)) AND (procurement_category_inspectors.category_id = CAST(? AS UUID))) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500" #uuid "3eaad5d5-516a-5610-8caf-342cfdcaac62"]
>o> inspector? {:result false}
2023-12-12T11:43:56.698Z NX-41294 DEBUG [leihs.procurement.resources.viewers:?] - (sql-format (sql/where users-base-query [:in :users.id (-> (sql/select :pcv.user_id) (sql/from [:procurement_category_viewers :pcv]) (sql/where [:= :pcv.category_id [:cast (:id value) :uuid]]))])) => ["SELECT users.id, users.firstname, users.lastname FROM users WHERE users.id IN (SELECT pcv.user_id FROM procurement_category_viewers AS pcv WHERE pcv.category_id = CAST(? AS UUID)) ORDER BY CONCAT(users.firstname, users.lastname, users.login, users.id) ASC" #uuid "3eaad5d5-516a-5610-8caf-342cfdcaac62"]

>request-grapql _> request {:leihs-user-language {:name Deutsch, :locale de-CH, :default true, :active true}, :authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 219b97e6-bb13-401e-92a7-2304bf206106}, leihs-user-session {:value d429c048-7118-407f-a7a9-b33da6f15b06}}, :remote-addr 127.0.0.1, :start-time 48742518587708, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type application/json, cookie leihs-anti-csrf-token=219b97e6-bb13-401e-92a7-2304bf206106; leihs-user-session=d429c048-7118-407f-a7a9-b33da6f15b06, content-length 595, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/admin/categories/dda588f4660c573ca2ff944ae93ad42e, connection keep-alive, pragma no-cache, x-csrf-token 219b97e6-bb13-401e-92a7-2304bf206106, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x5b509e0f /127.0.0.1:3230<->/127.0.0.1:56143], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x65dc1b71 HikariDataSource (db-pool)]}, :content-length 595, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:operationName MainCategories, :variables {}, :query query MainCategories {
  main_categories {
    ...MainCatProps
    __typename
  }
}

fragment MainCatProps on MainCategory {
  id
  name
  can_delete
  image_url
  categories {
    id
    name
    can_delete
    cost_center
    general_ledger_account
    procurement_account
    inspectors {
      ...UserProps
      __typename
    }
    viewers {
      ...UserProps
      __typename
    }
    __typename
  }
  __typename
}

fragment UserProps on User {
  id
  firstname
  lastname
  __typename
}
}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0xbde374d leihs.procurement.graphql$handler@bde374d], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>request-c-grapql _> request (json) {"leihs-user-language":{"name":"Deutsch","locale":"de-CH","default":true,"active":true},"authenticated-entity":{"email":"manuel.radl@zhdk.ch","contracts_count":1,"lastname":"Radl","org_id":"271682","scope_read":true,"is_admin":true,"authentication-method":"session","login":"mradl","scope_system_admin_write":true,"scope_write":true,"firstname":"Manuel","scope_admin_write":true,"user_session_created_at":"2023-12-12T11:17:19.570671Z","id":"a786135f-c159-4618-9dd3-0012ebb3d500","user_session_id":"463ca0ef-36e9-430c-b982-23371c7fc689","scope_system_admin_read":true,"access-rights":[{"role":"customer","inventory_pool_id":"3977012c-ce0e-501f-889b-8715fdb5d83b"},{"role":"customer","inventory_pool_id":"5863967f-9804-4909-a9b7-92254616d6b2"},{"role":"customer","inventory_pool_id":"5dd25b58-fa56-5095-bd97-2696d92c2fb1"},{"role":"customer","inventory_pool_id":"77e88ec8-9ff6-5435-818e-dc902fc631a6"},{"role":"inventory_manager","inventory_pool_id":"8bd16d45-056d-5590-bc7f-12849f034351"},{"role":"inventory_manager","inventory_pool_id":"a02b8163-9a16-5066-b48e-9eb74cf8b791"},{"role":"inventory_manager","inventory_pool_id":"b534b07c-d9bf-4572-840c-0a630b8cd8ed"},{"role":"customer","inventory_pool_id":"fc5a841e-36c6-5dc3-8207-1306c1fb89bf"},{"role":"customer","inventory_pool_id":"ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}],"user_id":"a786135f-c159-4618-9dd3-0012ebb3d500","is_system_admin":true,"external_sign_out_url":null,"language_locale":"de-CH","inventory_pool_roles_count":9,"scope_admin_read":true},"cookies":{"leihs-anti-csrf-token":{"value":"219b97e6-bb13-401e-92a7-2304bf206106"},"leihs-user-session":{"value":"d429c048-7118-407f-a7a9-b33da6f15b06"}},"remote-addr":"127.0.0.1","start-time":48742518587708,"params":{},"settings":{"email_sending_enabled":false,"sessions_max_lifetime_secs":432000,"smtp_default_from_address":"noreply@zhdk.ch","public_image_caching_enabled":true,"sessions_force_secure":false,"deliver_received_order_notifications":false,"external_base_url":"http:\/\/localhost:3200","sessions_force_uniqueness":false,"email_signature":"Das ZHdK-Ausleihe-Team"},"query-params-raw":{},"route-params":null,"headers":{"origin":"http:\/\/localhost:3230","sec-fetch-site":"same-origin","sec-ch-ua-mobile":"?0","host":"localhost:3230","user-agent":"Mozilla\/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit\/537.36 (KHTML, like Gecko) Chrome\/119.0.0.0 Safari\/537.36","content-type":"application\/json","cookie":"leihs-anti-csrf-token=219b97e6-bb13-401e-92a7-2304bf206106; leihs-user-session=d429c048-7118-407f-a7a9-b33da6f15b06","content-length":"595","sec-ch-ua":"\"Google Chrome\";v=\"119\", \"Chromium\";v=\"119\", \"Not?A_Brand\";v=\"24\"","sec-ch-ua-platform":"\"macOS\"","referer":"http:\/\/localhost:3230\/procure\/admin\/categories\/dda588f4660c573ca2ff944ae93ad42e","connection":"keep-alive","pragma":"no-cache","x-csrf-token":"219b97e6-bb13-401e-92a7-2304bf206106","accept":"application\/json","accept-language":"de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7","sec-fetch-dest":"empty","accept-encoding":"gzip, deflate, br","sec-fetch-mode":"cors","cache-control":"no-cache"},"server-port":3230,"params-raw":{},"content-length":595,"form-params":{},"websocket?":false,"query-params":{},"content-type":"application\/json","form-params-raw":{},"character-encoding":"utf8","uri":"\/procure\/graphql","server-name":"localhost","handler-key":"graphql","query-string":null,"body":{"operationName":"MainCategories","variables":{},"query":"query MainCategories {\n  main_categories {\n    ...MainCatProps\n    __typename\n  }\n}\n\nfragment MainCatProps on MainCategory {\n  id\n  name\n  can_delete\n  image_url\n  categories {\n    id\n    name\n    can_delete\n    cost_center\n    general_ledger_account\n    procurement_account\n    inspectors {\n      ...UserProps\n      __typename\n    }\n    viewers {\n      ...UserProps\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment UserProps on User {\n  id\n  firstname\n  lastname\n  __typename\n}\n"},"multipart-params":{},"scheme":"http","request-method":"post","accept":{"mime":"json","charset":null,"encoding":null,"language":null}}

>request-grapql _> result => {:data #ordered/map ([:main_categories [#ordered/map ([:id 519f7a95-9ca7-5256-bf63-142cfc23dc62] [:name Audio- und Videotechnik] [:can_delete false] [:image_url /procure/images/ee215167-b2c3-5fcc-90c3-098ad20d16ea] [:categories [#ordered/map ([:id 4e48b48c-e1bf-50d7-ab2d-9aa438c638de] [:name Beamer] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id a1727606-c7c8-54a2-aaa1-ceff7a7d4b40] [:name Funk-Strecken] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 00382e27-a87a-5313-b31b-a369dad6c5f8] [:name Lautsprecher] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id ce5424cc-ce77-5e67-8201-333ec20963eb] [:name Lautsprecherstative] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id ce0812d7-080b-5f49-8530-dd4a821c57b6] [:name Mikrofone] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 67e5fc60-6fe3-53bb-9495-3669b917038a] [:name Mikrofonstative] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id f94f72e8-ff65-5bad-b1f9-81ddd8fa7c0c] [:name Monitore / Screens] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 89e4a22f-7d6c-5006-b26a-3ef6f8f19630] [:name Schnittplatz / Mischpult / Regie] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 1fb59e17-a703-5abc-8a80-fc7a9c20ee1d] [:name Video/Film-Kameras] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id c17698c1-5d5d-51ea-927f-b6ca96431a50] [:name Video/Film-Stative] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id fabe3b8c-58b5-5009-8873-cc3e945a7c0d] [:name Video/Filmobjektive] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id ebb12585-ce23-5cbe-8f4f-41a42d60a656] [:name Zuteilung unbekannt - Audio- und Videotechnik] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id c0777d74-668b-5e01-abb5-f8277baa0ea8] [:firstname Matus] [:lastname Kmit] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 8a9d832a-cf4c-5253-bcaa-385ef03565c1] [:firstname Nadja] [:lastname Weisskopf-Admin] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id 1a047acd-dc98-52c2-99d3-dc6332adc1e0] [:name Bauliche Anpassungen und Mobiliar] [:can_delete false] [:image_url /procure/images/8e07c37e-d244-514d-bfa9-306158056160] [:categories [#ordered/map ([:id 0a082661-cc1c-5b49-baab-f4db926faa7e] [:name Bauprojekte] [:can_delete false] [:cost_center 11410210] [:general_ledger_account 5069097000] [:procurement_account 3119097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 797264c9-a2c2-5642-9c1a-d45b01f4fdc5] [:firstname Heike] [:lastname Heldt] [:__typename :User]) #ordered/map ([:id 2c1de10b-6145-56d6-a76e-3c207cfc35a1] [:firstname Marco] [:lastname Castellano] [:__typename :User]) #ordered/map ([:id 57bb6aaa-95fb-435f-8dd9-d0b853bf2279] [:firstname Pascale] [:lastname Gisel] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 42cc2d9a-cc45-5d77-85d3-0f21270d7a35] [:name Einrichtungsprojekte] [:can_delete false] [:cost_center 11410220] [:general_ledger_account 5069097000] [:procurement_account 3110097001] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 797264c9-a2c2-5642-9c1a-d45b01f4fdc5] [:firstname Heike] [:lastname Heldt] [:__typename :User]) #ordered/map ([:id 2c1de10b-6145-56d6-a76e-3c207cfc35a1] [:firstname Marco] [:lastname Castellano] [:__typename :User]) #ordered/map ([:id 57bb6aaa-95fb-435f-8dd9-d0b853bf2279] [:firstname Pascale] [:lastname Gisel] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 56aaec64-8d65-50b3-bd81-f788d477b927] [:name Mobiliarergänzungen] [:can_delete false] [:cost_center 11410220] [:general_ledger_account 5069097000] [:procurement_account 3110097001] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 797264c9-a2c2-5642-9c1a-d45b01f4fdc5] [:firstname Heike] [:lastname Heldt] [:__typename :User]) #ordered/map ([:id 2c1de10b-6145-56d6-a76e-3c207cfc35a1] [:firstname Marco] [:lastname Castellano] [:__typename :User]) #ordered/map ([:id 57bb6aaa-95fb-435f-8dd9-d0b853bf2279] [:firstname Pascale] [:lastname Gisel] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 483ac871-b632-5dcd-9d37-789d65f4c424] [:name Schliessanlagen und Türen] [:can_delete false] [:cost_center 11410210] [:general_ledger_account 5069097000] [:procurement_account 3119097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 797264c9-a2c2-5642-9c1a-d45b01f4fdc5] [:firstname Heike] [:lastname Heldt] [:__typename :User]) #ordered/map ([:id 2c1de10b-6145-56d6-a76e-3c207cfc35a1] [:firstname Marco] [:lastname Castellano] [:__typename :User]) #ordered/map ([:id 57bb6aaa-95fb-435f-8dd9-d0b853bf2279] [:firstname Pascale] [:lastname Gisel] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 2b3749a2-6a59-5a25-9b9f-32f5e485e635] [:name Signaletik] [:can_delete false] [:cost_center 11410210] [:general_ledger_account 5069097000] [:procurement_account 3119097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 797264c9-a2c2-5642-9c1a-d45b01f4fdc5] [:firstname Heike] [:lastname Heldt] [:__typename :User]) #ordered/map ([:id 2c1de10b-6145-56d6-a76e-3c207cfc35a1] [:firstname Marco] [:lastname Castellano] [:__typename :User]) #ordered/map ([:id 57bb6aaa-95fb-435f-8dd9-d0b853bf2279] [:firstname Pascale] [:lastname Gisel] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id fad911e4-8c69-535c-a138-f3e2544519ba] [:name Vorhänge] [:can_delete false] [:cost_center 11410210] [:general_ledger_account 5069097000] [:procurement_account 3119097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 797264c9-a2c2-5642-9c1a-d45b01f4fdc5] [:firstname Heike] [:lastname Heldt] [:__typename :User]) #ordered/map ([:id 2c1de10b-6145-56d6-a76e-3c207cfc35a1] [:firstname Marco] [:lastname Castellano] [:__typename :User]) #ordered/map ([:id 57bb6aaa-95fb-435f-8dd9-d0b853bf2279] [:firstname Pascale] [:lastname Gisel] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id c3f14f79-931c-52c8-a847-ed77449ce9a6] [:name Zuteilung unbekannt - Bauliche Anpassungen und Mobiliar] [:can_delete false] [:cost_center 11410220] [:general_ledger_account 5069097000] [:procurement_account 3119097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 797264c9-a2c2-5642-9c1a-d45b01f4fdc5] [:firstname Heike] [:lastname Heldt] [:__typename :User]) #ordered/map ([:id 2c1de10b-6145-56d6-a76e-3c207cfc35a1] [:firstname Marco] [:lastname Castellano] [:__typename :User]) #ordered/map ([:id 57bb6aaa-95fb-435f-8dd9-d0b853bf2279] [:firstname Pascale] [:lastname Gisel] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id dda588f4-660c-573c-a2ff-944ae93ad42e] [:name Beleuchtungstechnik] [:can_delete false] [:image_url /procure/images/8debe2ef-4a7e-58a1-bf4c-1622dead4579] [:categories [#ordered/map ([:id b9e4f492-55e3-57e4-9467-91c81bfe2325] [:name Bühnenlicht] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User])]] [:viewers [#ordered/map ([:id 8448b7b2-f5d9-4590-8355-2295b50bba40] [:firstname Sergej] [:lastname Tratar Baamonde] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id a7cca5a4-e265-5f36-b794-1024c8aacc3e] [:name Film-Beleuchtung] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User])]] [:viewers [#ordered/map ([:id 8448b7b2-f5d9-4590-8355-2295b50bba40] [:firstname Sergej] [:lastname Tratar Baamonde] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id 79822b89-0edb-588c-b9e5-65b7722ac50b] [:name Kameralicht] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User])]] [:viewers [#ordered/map ([:id 8448b7b2-f5d9-4590-8355-2295b50bba40] [:firstname Sergej] [:lastname Tratar Baamonde] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id ab911807-6431-5ca7-890a-3573737bb4d3] [:name Mobiles Raumlicht für Ausstellungen] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 2c1de10b-6145-56d6-a76e-3c207cfc35a1] [:firstname Marco] [:lastname Castellano] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 64c6f8ad-a1b7-530b-946a-ebb1644ac897] [:name Studio-Licht] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User])]] [:viewers [#ordered/map ([:id 8448b7b2-f5d9-4590-8355-2295b50bba40] [:firstname Sergej] [:lastname Tratar Baamonde] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id f2bb3f23-bb5b-5855-b03f-0166bd19fc0c] [:name Zuteilung unbekannt - Beleuchtungstechnik] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User])]] [:viewers [#ordered/map ([:id 8448b7b2-f5d9-4590-8355-2295b50bba40] [:firstname Sergej] [:lastname Tratar Baamonde] [:__typename :User])]] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id 2b07eb8a-4174-5257-83eb-920d536cc44a] [:name Betriebseinrichtungen und Fahrzeuge] [:can_delete false] [:image_url /procure/images/3d6cbe63-c327-5c6b-b7fa-48e6c52f2cdc] [:categories [#ordered/map ([:id 5d8639a3-4569-5009-af28-f63f2af5209d] [:name Betriebseinrichtungen] [:can_delete false] [:cost_center 11410200] [:general_ledger_account 5061097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 2c1de10b-6145-56d6-a76e-3c207cfc35a1] [:firstname Marco] [:lastname Castellano] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id b34f1cbb-4ac7-59a0-81f2-3ca7ecc94e71] [:name Fahrzeuge] [:can_delete false] [:cost_center 11410200] [:general_ledger_account 5061097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 2c1de10b-6145-56d6-a76e-3c207cfc35a1] [:firstname Marco] [:lastname Castellano] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 73e97867-43ea-5bee-b46b-d7c74fbf873b] [:name Hub- und Hebegeräte] [:can_delete false] [:cost_center 11410200] [:general_ledger_account 5061097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 2c1de10b-6145-56d6-a76e-3c207cfc35a1] [:firstname Marco] [:lastname Castellano] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id b6601a86-b5d3-5682-88b6-cff956b00d7b] [:name Zuteilung unbekannt - Betriebseinrichtungen und Fahrzeuge] [:can_delete false] [:cost_center 11410200] [:general_ledger_account 5061097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 2c1de10b-6145-56d6-a76e-3c207cfc35a1] [:firstname Marco] [:lastname Castellano] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id f6827594-33a6-5760-ac41-f94ceefacfab] [:name Bühnentechnik] [:can_delete false] [:image_url /procure/images/9a8cba78-10ab-585b-a4c2-9d8e7f0818ee] [:categories [#ordered/map ([:id 455bc6dc-afbd-579d-a621-6d75e0fca9ea] [:name Bühnentechnik] [:can_delete false] [:cost_center 11410500] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id 428a72a9-36df-52fa-880f-64db35843013] [:firstname Dominik] [:lastname Fedier] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 8448b7b2-f5d9-4590-8355-2295b50bba40] [:firstname Sergej] [:lastname Tratar Baamonde] [:__typename :User])]] [:viewers [#ordered/map ([:id 8448b7b2-f5d9-4590-8355-2295b50bba40] [:firstname Sergej] [:lastname Tratar Baamonde] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id 747b6b21-9fad-4a01-acd9-cd8983aed286] [:name Fundus] [:can_delete false] [:cost_center 11410500] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id 428a72a9-36df-52fa-880f-64db35843013] [:firstname Dominik] [:lastname Fedier] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User])]] [:viewers [#ordered/map ([:id 8448b7b2-f5d9-4590-8355-2295b50bba40] [:firstname Sergej] [:lastname Tratar Baamonde] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id 07a6af37-e127-5f4b-94ec-698a5698d98c] [:name Zuteilung unbekannt - Bühnentechnik] [:can_delete false] [:cost_center 11410500] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id 428a72a9-36df-52fa-880f-64db35843013] [:firstname Dominik] [:lastname Fedier] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 8448b7b2-f5d9-4590-8355-2295b50bba40] [:firstname Sergej] [:lastname Tratar Baamonde] [:__typename :User])]] [:viewers [#ordered/map ([:id 8448b7b2-f5d9-4590-8355-2295b50bba40] [:firstname Sergej] [:lastname Tratar Baamonde] [:__typename :User])]] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id 517b82ae-2b7e-4822-9aeb-0d4753dec821] [:name Darlehen] [:can_delete false] [:image_url nil] [:categories [#ordered/map ([:id 671ab85c-b8c1-4659-9c6e-9ebe2f122a59] [:name Darlehen] [:can_delete false] [:cost_center 11410101] [:general_ledger_account 5064097000] [:procurement_account ] [:inspectors [#ordered/map ([:id b610f5bd-6da8-5122-94f0-c0bbf1b7ed73] [:firstname Daniel] [:lastname Fischer] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id ca1d97ac-0ac4-597a-8edb-f9c466b1c7da] [:name Fotografie] [:can_delete false] [:image_url /procure/images/07a33b4c-d274-54e5-a2ce-11f26d57be05] [:categories [#ordered/map ([:id e1b4cad8-0416-5cf7-9e4a-dde208d0abad] [:name Blitzanlagen] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 011ff3f3-09fa-59e1-9713-52466786adf8] [:name Fotokameras] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 54b87eb0-061c-5a97-96ad-e9b6da605184] [:name Fotostative] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 5858ec5d-5f01-50fb-bc96-4b4766bd7799] [:name Kompakt-Blitze] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id ba5b41a7-4317-5160-9b82-b0931a48aec0] [:name Objektive] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 9df68a66-4523-5072-aa31-1df9abeaa1c7] [:name Zuteilung unbekannt - Fotografie] [:can_delete false] [:cost_center 11410300] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 340e3295-90ba-5c73-8f01-61fefd9960ff] [:firstname Mike] [:lastname Honegger] [:__typename :User]) #ordered/map ([:id 95727ff5-358f-540c-a09c-53a1ac219dd0] [:firstname Ralph] [:lastname Wetli] [:__typename :User]) #ordered/map ([:id e27434b5-115e-5792-a757-8ec39e0d3b7f] [:firstname Roger] [:lastname Bachmann] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id 2ea39047-e663-50d5-9080-838b75883704] [:name IT & Elektronik] [:can_delete false] [:image_url /procure/images/1464e46c-e726-54a9-a42b-f937a0342d22] [:categories [#ordered/map ([:id f2531d7e-d9ff-5c3e-9e88-6d3a16a89aa1] [:name Desktop] [:can_delete false] [:cost_center 11410660] [:general_ledger_account 5064097000] [:procurement_account 3113097000] [:inspectors [#ordered/map ([:id e9656e43-9f35-502d-b495-eec36093208e] [:firstname Christian] [:lastname Wildhaber] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 28552e7e-f8be-5019-bdad-846babd8c642] [:firstname Hugo] [:lastname Vögtle] [:__typename :User]) #ordered/map ([:id 301988e6-5e0e-43a9-bcb6-3d0022b7ca99] [:firstname Lars] [:lastname Gnädinger] [:__typename :User]) #ordered/map ([:id 0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d] [:firstname Lenny Ron] [:lastname Frei] [:__typename :User]) #ordered/map ([:id b5d09795-0b94-423d-a645-bae0aed895ce] [:firstname Lukas] [:lastname Brupbacher] [:__typename :User]) #ordered/map ([:id b41e6486-ec39-4855-8d8a-c03aa83af233] [:firstname Matthias] [:lastname Daniels] [:__typename :User]) #ordered/map ([:id 8a9d832a-cf4c-5253-bcaa-385ef03565c1] [:firstname Nadja] [:lastname Weisskopf-Admin] [:__typename :User]) #ordered/map ([:id 4884241c-8104-5c10-a393-0e21dcd1a46e] [:firstname Patrice] [:lastname Huber] [:__typename :User]) #ordered/map ([:id 52c2d39d-7f53-592f-8142-824afbaf59d3] [:firstname Tilo] [:lastname Seiring] [:__typename :User]) #ordered/map ([:id 96c5a731-ae34-5ede-917c-90a42dc66a1e] [:firstname Ugo] [:lastname De Vito] [:__typename :User])]] [:viewers [#ordered/map ([:id b363936a-fd9c-567a-82a4-f0b523dbb26b] [:firstname Beat] [:lastname Rohrer] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id 1af3a7f2-b16a-4203-b6ac-f2c7be612d74] [:name IT_Projekte] [:can_delete false] [:cost_center 11410650] [:general_ledger_account 5064097000] [:procurement_account 3118097000] [:inspectors [#ordered/map ([:id e9656e43-9f35-502d-b495-eec36093208e] [:firstname Christian] [:lastname Wildhaber] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 28552e7e-f8be-5019-bdad-846babd8c642] [:firstname Hugo] [:lastname Vögtle] [:__typename :User]) #ordered/map ([:id 301988e6-5e0e-43a9-bcb6-3d0022b7ca99] [:firstname Lars] [:lastname Gnädinger] [:__typename :User]) #ordered/map ([:id 0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d] [:firstname Lenny Ron] [:lastname Frei] [:__typename :User]) #ordered/map ([:id b5d09795-0b94-423d-a645-bae0aed895ce] [:firstname Lukas] [:lastname Brupbacher] [:__typename :User]) #ordered/map ([:id b41e6486-ec39-4855-8d8a-c03aa83af233] [:firstname Matthias] [:lastname Daniels] [:__typename :User]) #ordered/map ([:id 4884241c-8104-5c10-a393-0e21dcd1a46e] [:firstname Patrice] [:lastname Huber] [:__typename :User]) #ordered/map ([:id 52c2d39d-7f53-592f-8142-824afbaf59d3] [:firstname Tilo] [:lastname Seiring] [:__typename :User]) #ordered/map ([:id 96c5a731-ae34-5ede-917c-90a42dc66a1e] [:firstname Ugo] [:lastname De Vito] [:__typename :User])]] [:viewers [#ordered/map ([:id b363936a-fd9c-567a-82a4-f0b523dbb26b] [:firstname Beat] [:lastname Rohrer] [:__typename :User]) #ordered/map ([:id b5d09795-0b94-423d-a645-bae0aed895ce] [:firstname Lukas] [:lastname Brupbacher] [:__typename :User]) #ordered/map ([:id 233a038c-66fb-4036-9149-762c10a5b72e] [:firstname Maria] [:lastname Krause] [:__typename :User]) #ordered/map ([:id d65e52a5-0404-4069-b6a0-7e8ef60dc1e1] [:firstname Maurizio] [:lastname Mattiola] [:__typename :User]) #ordered/map ([:id 119a33c1-151f-4579-8c79-0d3225d4b9b6] [:firstname Michael] [:lastname Bozenicar] [:__typename :User]) #ordered/map ([:id 45b1cf11-1f50-5d8b-aedf-5d8b83b19a52] [:firstname Monika] [:lastname Petschen] [:__typename :User]) #ordered/map ([:id 8160a951-8900-448d-8c3e-e31ec60fd3f3] [:firstname Stefan] [:lastname Uhle] [:__typename :User]) #ordered/map ([:id a4d8f8c9-8f5e-444f-b2cf-67e53f7d3d0c] [:firstname Thomas] [:lastname Bickel] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id ccab158d-79c7-5c28-a8a2-47cb4925f101] [:name IT-Basisinfrastruktur] [:can_delete false] [:cost_center 11410640] [:general_ledger_account 5064097000] [:procurement_account 3113097000] [:inspectors [#ordered/map ([:id e9656e43-9f35-502d-b495-eec36093208e] [:firstname Christian] [:lastname Wildhaber] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 28552e7e-f8be-5019-bdad-846babd8c642] [:firstname Hugo] [:lastname Vögtle] [:__typename :User]) #ordered/map ([:id 301988e6-5e0e-43a9-bcb6-3d0022b7ca99] [:firstname Lars] [:lastname Gnädinger] [:__typename :User]) #ordered/map ([:id 0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d] [:firstname Lenny Ron] [:lastname Frei] [:__typename :User]) #ordered/map ([:id b41e6486-ec39-4855-8d8a-c03aa83af233] [:firstname Matthias] [:lastname Daniels] [:__typename :User]) #ordered/map ([:id 4884241c-8104-5c10-a393-0e21dcd1a46e] [:firstname Patrice] [:lastname Huber] [:__typename :User]) #ordered/map ([:id 52c2d39d-7f53-592f-8142-824afbaf59d3] [:firstname Tilo] [:lastname Seiring] [:__typename :User]) #ordered/map ([:id 96c5a731-ae34-5ede-917c-90a42dc66a1e] [:firstname Ugo] [:lastname De Vito] [:__typename :User])]] [:viewers [#ordered/map ([:id b363936a-fd9c-567a-82a4-f0b523dbb26b] [:firstname Beat] [:lastname Rohrer] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id eb1e7bef-80c6-4958-b16e-35555735ce61] [:name IT-Security] [:can_delete false] [:cost_center 11410600] [:general_ledger_account 5064097000] [:procurement_account 3113097000] [:inspectors [#ordered/map ([:id 3651eeeb-0fb1-4840-80dd-6c739bda6c57] [:firstname Christian] [:lastname Schneider] [:__typename :User]) #ordered/map ([:id 301988e6-5e0e-43a9-bcb6-3d0022b7ca99] [:firstname Lars] [:lastname Gnädinger] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 4ecc9e97-2d12-5173-bd8c-781482c842e8] [:name Laptops] [:can_delete false] [:cost_center 11410660] [:general_ledger_account 5064097000] [:procurement_account 3113097000] [:inspectors [#ordered/map ([:id e9656e43-9f35-502d-b495-eec36093208e] [:firstname Christian] [:lastname Wildhaber] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 28552e7e-f8be-5019-bdad-846babd8c642] [:firstname Hugo] [:lastname Vögtle] [:__typename :User]) #ordered/map ([:id 301988e6-5e0e-43a9-bcb6-3d0022b7ca99] [:firstname Lars] [:lastname Gnädinger] [:__typename :User]) #ordered/map ([:id 0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d] [:firstname Lenny Ron] [:lastname Frei] [:__typename :User]) #ordered/map ([:id b41e6486-ec39-4855-8d8a-c03aa83af233] [:firstname Matthias] [:lastname Daniels] [:__typename :User]) #ordered/map ([:id 4884241c-8104-5c10-a393-0e21dcd1a46e] [:firstname Patrice] [:lastname Huber] [:__typename :User]) #ordered/map ([:id 52c2d39d-7f53-592f-8142-824afbaf59d3] [:firstname Tilo] [:lastname Seiring] [:__typename :User]) #ordered/map ([:id 96c5a731-ae34-5ede-917c-90a42dc66a1e] [:firstname Ugo] [:lastname De Vito] [:__typename :User])]] [:viewers [#ordered/map ([:id b363936a-fd9c-567a-82a4-f0b523dbb26b] [:firstname Beat] [:lastname Rohrer] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id 80226a51-c17a-5fd8-93db-40aef5b03491] [:name Monitore] [:can_delete false] [:cost_center 11410660] [:general_ledger_account 5064097000] [:procurement_account 3113097000] [:inspectors [#ordered/map ([:id e9656e43-9f35-502d-b495-eec36093208e] [:firstname Christian] [:lastname Wildhaber] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 28552e7e-f8be-5019-bdad-846babd8c642] [:firstname Hugo] [:lastname Vögtle] [:__typename :User]) #ordered/map ([:id 301988e6-5e0e-43a9-bcb6-3d0022b7ca99] [:firstname Lars] [:lastname Gnädinger] [:__typename :User]) #ordered/map ([:id 0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d] [:firstname Lenny Ron] [:lastname Frei] [:__typename :User]) #ordered/map ([:id b41e6486-ec39-4855-8d8a-c03aa83af233] [:firstname Matthias] [:lastname Daniels] [:__typename :User]) #ordered/map ([:id 4884241c-8104-5c10-a393-0e21dcd1a46e] [:firstname Patrice] [:lastname Huber] [:__typename :User]) #ordered/map ([:id 52c2d39d-7f53-592f-8142-824afbaf59d3] [:firstname Tilo] [:lastname Seiring] [:__typename :User]) #ordered/map ([:id 96c5a731-ae34-5ede-917c-90a42dc66a1e] [:firstname Ugo] [:lastname De Vito] [:__typename :User])]] [:viewers [#ordered/map ([:id b363936a-fd9c-567a-82a4-f0b523dbb26b] [:firstname Beat] [:lastname Rohrer] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id fe602c35-1097-52d0-acd0-40579d295f00] [:name Scanner] [:can_delete false] [:cost_center 11410660] [:general_ledger_account 5064097000] [:procurement_account 3113097000] [:inspectors [#ordered/map ([:id e9656e43-9f35-502d-b495-eec36093208e] [:firstname Christian] [:lastname Wildhaber] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 28552e7e-f8be-5019-bdad-846babd8c642] [:firstname Hugo] [:lastname Vögtle] [:__typename :User]) #ordered/map ([:id 301988e6-5e0e-43a9-bcb6-3d0022b7ca99] [:firstname Lars] [:lastname Gnädinger] [:__typename :User]) #ordered/map ([:id 0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d] [:firstname Lenny Ron] [:lastname Frei] [:__typename :User]) #ordered/map ([:id b41e6486-ec39-4855-8d8a-c03aa83af233] [:firstname Matthias] [:lastname Daniels] [:__typename :User]) #ordered/map ([:id 4884241c-8104-5c10-a393-0e21dcd1a46e] [:firstname Patrice] [:lastname Huber] [:__typename :User]) #ordered/map ([:id 52c2d39d-7f53-592f-8142-824afbaf59d3] [:firstname Tilo] [:lastname Seiring] [:__typename :User]) #ordered/map ([:id 96c5a731-ae34-5ede-917c-90a42dc66a1e] [:firstname Ugo] [:lastname De Vito] [:__typename :User])]] [:viewers [#ordered/map ([:id b363936a-fd9c-567a-82a4-f0b523dbb26b] [:firstname Beat] [:lastname Rohrer] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id 56065d53-cd2f-5a39-9b66-532fd83ad2e6] [:name Schnittstellengeräte] [:can_delete false] [:cost_center 11410660] [:general_ledger_account 5064097000] [:procurement_account 3113097000] [:inspectors [#ordered/map ([:id e9656e43-9f35-502d-b495-eec36093208e] [:firstname Christian] [:lastname Wildhaber] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 28552e7e-f8be-5019-bdad-846babd8c642] [:firstname Hugo] [:lastname Vögtle] [:__typename :User]) #ordered/map ([:id 301988e6-5e0e-43a9-bcb6-3d0022b7ca99] [:firstname Lars] [:lastname Gnädinger] [:__typename :User]) #ordered/map ([:id 0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d] [:firstname Lenny Ron] [:lastname Frei] [:__typename :User]) #ordered/map ([:id b41e6486-ec39-4855-8d8a-c03aa83af233] [:firstname Matthias] [:lastname Daniels] [:__typename :User]) #ordered/map ([:id 4884241c-8104-5c10-a393-0e21dcd1a46e] [:firstname Patrice] [:lastname Huber] [:__typename :User]) #ordered/map ([:id 52c2d39d-7f53-592f-8142-824afbaf59d3] [:firstname Tilo] [:lastname Seiring] [:__typename :User]) #ordered/map ([:id 96c5a731-ae34-5ede-917c-90a42dc66a1e] [:firstname Ugo] [:lastname De Vito] [:__typename :User])]] [:viewers [#ordered/map ([:id b363936a-fd9c-567a-82a4-f0b523dbb26b] [:firstname Beat] [:lastname Rohrer] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id fc7bc38c-62f3-5576-802f-c874e06ee776] [:name Software] [:can_delete false] [:cost_center 11410660] [:general_ledger_account 5064097000] [:procurement_account 3118097000] [:inspectors [#ordered/map ([:id e9656e43-9f35-502d-b495-eec36093208e] [:firstname Christian] [:lastname Wildhaber] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 28552e7e-f8be-5019-bdad-846babd8c642] [:firstname Hugo] [:lastname Vögtle] [:__typename :User]) #ordered/map ([:id 301988e6-5e0e-43a9-bcb6-3d0022b7ca99] [:firstname Lars] [:lastname Gnädinger] [:__typename :User]) #ordered/map ([:id 0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d] [:firstname Lenny Ron] [:lastname Frei] [:__typename :User]) #ordered/map ([:id b41e6486-ec39-4855-8d8a-c03aa83af233] [:firstname Matthias] [:lastname Daniels] [:__typename :User]) #ordered/map ([:id 8a9d832a-cf4c-5253-bcaa-385ef03565c1] [:firstname Nadja] [:lastname Weisskopf-Admin] [:__typename :User]) #ordered/map ([:id 4884241c-8104-5c10-a393-0e21dcd1a46e] [:firstname Patrice] [:lastname Huber] [:__typename :User]) #ordered/map ([:id 52c2d39d-7f53-592f-8142-824afbaf59d3] [:firstname Tilo] [:lastname Seiring] [:__typename :User]) #ordered/map ([:id 96c5a731-ae34-5ede-917c-90a42dc66a1e] [:firstname Ugo] [:lastname De Vito] [:__typename :User])]] [:viewers [#ordered/map ([:id b363936a-fd9c-567a-82a4-f0b523dbb26b] [:firstname Beat] [:lastname Rohrer] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id 76fdca98-4a2a-5640-bc98-f33059d6ffa0] [:name Tablets] [:can_delete false] [:cost_center 11410660] [:general_ledger_account 5064097000] [:procurement_account 3113097000] [:inspectors [#ordered/map ([:id e9656e43-9f35-502d-b495-eec36093208e] [:firstname Christian] [:lastname Wildhaber] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 28552e7e-f8be-5019-bdad-846babd8c642] [:firstname Hugo] [:lastname Vögtle] [:__typename :User]) #ordered/map ([:id 301988e6-5e0e-43a9-bcb6-3d0022b7ca99] [:firstname Lars] [:lastname Gnädinger] [:__typename :User]) #ordered/map ([:id 0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d] [:firstname Lenny Ron] [:lastname Frei] [:__typename :User]) #ordered/map ([:id b41e6486-ec39-4855-8d8a-c03aa83af233] [:firstname Matthias] [:lastname Daniels] [:__typename :User]) #ordered/map ([:id 4884241c-8104-5c10-a393-0e21dcd1a46e] [:firstname Patrice] [:lastname Huber] [:__typename :User]) #ordered/map ([:id 52c2d39d-7f53-592f-8142-824afbaf59d3] [:firstname Tilo] [:lastname Seiring] [:__typename :User]) #ordered/map ([:id 96c5a731-ae34-5ede-917c-90a42dc66a1e] [:firstname Ugo] [:lastname De Vito] [:__typename :User])]] [:viewers [#ordered/map ([:id b363936a-fd9c-567a-82a4-f0b523dbb26b] [:firstname Beat] [:lastname Rohrer] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id 77857566-03d9-58f4-8b0d-290227434aff] [:name Telefon] [:can_delete false] [:cost_center 11410660] [:general_ledger_account 5064097000] [:procurement_account 3113097000] [:inspectors [#ordered/map ([:id e9656e43-9f35-502d-b495-eec36093208e] [:firstname Christian] [:lastname Wildhaber] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 28552e7e-f8be-5019-bdad-846babd8c642] [:firstname Hugo] [:lastname Vögtle] [:__typename :User]) #ordered/map ([:id 301988e6-5e0e-43a9-bcb6-3d0022b7ca99] [:firstname Lars] [:lastname Gnädinger] [:__typename :User]) #ordered/map ([:id 0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d] [:firstname Lenny Ron] [:lastname Frei] [:__typename :User]) #ordered/map ([:id b41e6486-ec39-4855-8d8a-c03aa83af233] [:firstname Matthias] [:lastname Daniels] [:__typename :User]) #ordered/map ([:id 4884241c-8104-5c10-a393-0e21dcd1a46e] [:firstname Patrice] [:lastname Huber] [:__typename :User]) #ordered/map ([:id 52c2d39d-7f53-592f-8142-824afbaf59d3] [:firstname Tilo] [:lastname Seiring] [:__typename :User]) #ordered/map ([:id 96c5a731-ae34-5ede-917c-90a42dc66a1e] [:firstname Ugo] [:lastname De Vito] [:__typename :User])]] [:viewers [#ordered/map ([:id b363936a-fd9c-567a-82a4-f0b523dbb26b] [:firstname Beat] [:lastname Rohrer] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id 5059c4fc-d34c-5c9a-9efe-257c7ec6fb6b] [:name Zuteilung unbekannt - IT & Elektronik] [:can_delete false] [:cost_center 11410600] [:general_ledger_account 5064097000] [:procurement_account 3113097000] [:inspectors [#ordered/map ([:id e9656e43-9f35-502d-b495-eec36093208e] [:firstname Christian] [:lastname Wildhaber] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 28552e7e-f8be-5019-bdad-846babd8c642] [:firstname Hugo] [:lastname Vögtle] [:__typename :User]) #ordered/map ([:id 301988e6-5e0e-43a9-bcb6-3d0022b7ca99] [:firstname Lars] [:lastname Gnädinger] [:__typename :User]) #ordered/map ([:id 0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d] [:firstname Lenny Ron] [:lastname Frei] [:__typename :User]) #ordered/map ([:id b41e6486-ec39-4855-8d8a-c03aa83af233] [:firstname Matthias] [:lastname Daniels] [:__typename :User]) #ordered/map ([:id 4884241c-8104-5c10-a393-0e21dcd1a46e] [:firstname Patrice] [:lastname Huber] [:__typename :User]) #ordered/map ([:id 52c2d39d-7f53-592f-8142-824afbaf59d3] [:firstname Tilo] [:lastname Seiring] [:__typename :User]) #ordered/map ([:id 96c5a731-ae34-5ede-917c-90a42dc66a1e] [:firstname Ugo] [:lastname De Vito] [:__typename :User])]] [:viewers [#ordered/map ([:id b363936a-fd9c-567a-82a4-f0b523dbb26b] [:firstname Beat] [:lastname Rohrer] [:__typename :User])]] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id f6885671-3bf3-56f2-8e92-b5112d0f703f] [:name Musikinstrumente] [:can_delete false] [:image_url /procure/images/3a52eb87-b5fe-5df0-98b1-43e80f28d2dc] [:categories [#ordered/map ([:id af3372a1-63a8-52dc-850e-c2ae91c1c078] [:name Musikinstrumente] [:can_delete false] [:cost_center 11410800] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 6eeeeb75-e3d8-56c9-b7b6-0c45b7795cb9] [:firstname Martin] [:lastname Weyermann] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 17a52112-1986-5074-b1d9-0faff29a785b] [:name Zuteilung unbekannt - Musikinstrumente] [:can_delete false] [:cost_center 11410800] [:general_ledger_account 5063097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 6eeeeb75-e3d8-56c9-b7b6-0c45b7795cb9] [:firstname Martin] [:lastname Weyermann] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id 6c8a0d77-6711-5156-a59a-12425ba01cff] [:name Werkstatt-Technik] [:can_delete false] [:image_url /procure/images/f4e1f230-df2e-5e95-bf89-827f7a6b4b3b] [:categories [#ordered/map ([:id 6870a16c-9a71-5e60-b94a-f0b784398fec] [:name Handwerkzeug] [:can_delete false] [:cost_center 11410400] [:general_ledger_account 5061097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id ad765b67-18f7-55a8-88b6-11a82cd0d0b4] [:firstname Adrian] [:lastname Brazerol] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 771fddcf-b19a-5e6b-8b6f-7266b6922c4f] [:name Maschinen] [:can_delete false] [:cost_center 11410400] [:general_ledger_account 5061097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id ad765b67-18f7-55a8-88b6-11a82cd0d0b4] [:firstname Adrian] [:lastname Brazerol] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id c7ece4a6-2b5c-409f-96ea-e4fd6e8f9792] [:name Sicherheit] [:can_delete false] [:cost_center 11410400] [:general_ledger_account 5061097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id ad765b67-18f7-55a8-88b6-11a82cd0d0b4] [:firstname Adrian] [:lastname Brazerol] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id 3eaad5d5-516a-5610-8caf-342cfdcaac62] [:name Zuteilung unbekannt - Werkstatt-Technik] [:can_delete false] [:cost_center 11410400] [:general_ledger_account 5061097000] [:procurement_account 3111097000] [:inspectors [#ordered/map ([:id ad765b67-18f7-55a8-88b6-11a82cd0d0b4] [:firstname Adrian] [:lastname Brazerol] [:__typename :User]) #ordered/map ([:id cbcbc88f-e7b4-58fd-8dc2-e83be0d06475] [:firstname Claudia] [:lastname Bachmann] [:__typename :User]) #ordered/map ([:id da18869a-e4bd-4493-a4c9-2e6fe78c94e7] [:firstname Etienne] [:lastname Schudel] [:__typename :User]) #ordered/map ([:id f721d6b7-8275-5ee0-b225-aa7c13781f45] [:firstname Hans Ulrich] [:lastname Gasser] [:__typename :User]) #ordered/map ([:id 6ecace30-0931-59f4-9032-cd412530256c] [:firstname Judith] [:lastname Richi] [:__typename :User]) #ordered/map ([:id de3d3911-8b37-4bfe-aa59-25ee8dac5b07] [:firstname Julio] [:lastname Barrantes Zunzunegui] [:__typename :User]) #ordered/map ([:id b1e54635-ec2a-444f-8edd-7186075b0760] [:firstname Nomce] [:lastname Tanaskoski] [:__typename :User]) #ordered/map ([:id 8448b7b2-f5d9-4590-8355-2295b50bba40] [:firstname Sergej] [:lastname Tratar Baamonde] [:__typename :User]) #ordered/map ([:id 48e259df-9b53-5e56-a03e-65ce562f231a] [:firstname Silvan] [:lastname Becchio] [:__typename :User]) #ordered/map ([:id d0853239-fe13-4540-9c16-4ec1656461d3] [:firstname Silvia] [:lastname Eichenberger] [:__typename :User]) #ordered/map ([:id 26eb4afc-8200-41bf-bf23-b3e0d2deb1fc] [:firstname Stefan] [:lastname Weinmann] [:__typename :User]) #ordered/map ([:id baa628c5-c7fc-4cce-bea7-d8093f78adca] [:firstname Zelda] [:lastname Keller] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory])]])}
2023-12-12T11:43:56.727Z NX-41294 DEBUG [leihs.procurement.graphql:86] - result => {:data #ordered/map ([:main_categories [#ordered/map ([:id "519f7a95-9ca7-5256-bf63-142cfc23dc62"] [:name "Audio- und Videotechnik"] [:can_delete false] [:image_url "/procure/images/ee215167-b2c3-5fcc-90c3-098ad20d16ea"] [:categories [#ordered/map ([:id "4e48b48c-e1bf-50d7-ab2d-9aa438c638de"] [:name "Beamer"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "a1727606-c7c8-54a2-aaa1-ceff7a7d4b40"] [:name "Funk-Strecken"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "00382e27-a87a-5313-b31b-a369dad6c5f8"] [:name "Lautsprecher"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "ce5424cc-ce77-5e67-8201-333ec20963eb"] [:name "Lautsprecherstative"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "ce0812d7-080b-5f49-8530-dd4a821c57b6"] [:name "Mikrofone"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "67e5fc60-6fe3-53bb-9495-3669b917038a"] [:name "Mikrofonstative"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "f94f72e8-ff65-5bad-b1f9-81ddd8fa7c0c"] [:name "Monitore / Screens"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "89e4a22f-7d6c-5006-b26a-3ef6f8f19630"] [:name "Schnittplatz / Mischpult / Regie"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "1fb59e17-a703-5abc-8a80-fc7a9c20ee1d"] [:name "Video/Film-Kameras"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "c17698c1-5d5d-51ea-927f-b6ca96431a50"] [:name "Video/Film-Stative"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "fabe3b8c-58b5-5009-8873-cc3e945a7c0d"] [:name "Video/Filmobjektive"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "ebb12585-ce23-5cbe-8f4f-41a42d60a656"] [:name "Zuteilung unbekannt - Audio- und Videotechnik"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "c0777d74-668b-5e01-abb5-f8277baa0ea8"] [:firstname "Matus"] [:lastname "Kmit"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "8a9d832a-cf4c-5253-bcaa-385ef03565c1"] [:firstname "Nadja"] [:lastname "Weisskopf-Admin"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "1a047acd-dc98-52c2-99d3-dc6332adc1e0"] [:name "Bauliche Anpassungen und Mobiliar"] [:can_delete false] [:image_url "/procure/images/8e07c37e-d244-514d-bfa9-306158056160"] [:categories [#ordered/map ([:id "0a082661-cc1c-5b49-baab-f4db926faa7e"] [:name "Bauprojekte"] [:can_delete false] [:cost_center "11410210"] [:general_ledger_account "5069097000"] [:procurement_account "3119097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "797264c9-a2c2-5642-9c1a-d45b01f4fdc5"] [:firstname "Heike"] [:lastname "Heldt"] [:__typename :User]) #ordered/map ([:id "2c1de10b-6145-56d6-a76e-3c207cfc35a1"] [:firstname "Marco"] [:lastname "Castellano"] [:__typename :User]) #ordered/map ([:id "57bb6aaa-95fb-435f-8dd9-d0b853bf2279"] [:firstname "Pascale"] [:lastname "Gisel"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "42cc2d9a-cc45-5d77-85d3-0f21270d7a35"] [:name "Einrichtungsprojekte"] [:can_delete false] [:cost_center "11410220"] [:general_ledger_account "5069097000"] [:procurement_account "3110097001"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "797264c9-a2c2-5642-9c1a-d45b01f4fdc5"] [:firstname "Heike"] [:lastname "Heldt"] [:__typename :User]) #ordered/map ([:id "2c1de10b-6145-56d6-a76e-3c207cfc35a1"] [:firstname "Marco"] [:lastname "Castellano"] [:__typename :User]) #ordered/map ([:id "57bb6aaa-95fb-435f-8dd9-d0b853bf2279"] [:firstname "Pascale"] [:lastname "Gisel"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "56aaec64-8d65-50b3-bd81-f788d477b927"] [:name "Mobiliarergänzungen"] [:can_delete false] [:cost_center "11410220"] [:general_ledger_account "5069097000"] [:procurement_account "3110097001"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "797264c9-a2c2-5642-9c1a-d45b01f4fdc5"] [:firstname "Heike"] [:lastname "Heldt"] [:__typename :User]) #ordered/map ([:id "2c1de10b-6145-56d6-a76e-3c207cfc35a1"] [:firstname "Marco"] [:lastname "Castellano"] [:__typename :User]) #ordered/map ([:id "57bb6aaa-95fb-435f-8dd9-d0b853bf2279"] [:firstname "Pascale"] [:lastname "Gisel"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "483ac871-b632-5dcd-9d37-789d65f4c424"] [:name "Schliessanlagen und Türen"] [:can_delete false] [:cost_center "11410210"] [:general_ledger_account "5069097000"] [:procurement_account "3119097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "797264c9-a2c2-5642-9c1a-d45b01f4fdc5"] [:firstname "Heike"] [:lastname "Heldt"] [:__typename :User]) #ordered/map ([:id "2c1de10b-6145-56d6-a76e-3c207cfc35a1"] [:firstname "Marco"] [:lastname "Castellano"] [:__typename :User]) #ordered/map ([:id "57bb6aaa-95fb-435f-8dd9-d0b853bf2279"] [:firstname "Pascale"] [:lastname "Gisel"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "2b3749a2-6a59-5a25-9b9f-32f5e485e635"] [:name "Signaletik"] [:can_delete false] [:cost_center "11410210"] [:general_ledger_account "5069097000"] [:procurement_account "3119097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "797264c9-a2c2-5642-9c1a-d45b01f4fdc5"] [:firstname "Heike"] [:lastname "Heldt"] [:__typename :User]) #ordered/map ([:id "2c1de10b-6145-56d6-a76e-3c207cfc35a1"] [:firstname "Marco"] [:lastname "Castellano"] [:__typename :User]) #ordered/map ([:id "57bb6aaa-95fb-435f-8dd9-d0b853bf2279"] [:firstname "Pascale"] [:lastname "Gisel"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "fad911e4-8c69-535c-a138-f3e2544519ba"] [:name "Vorhänge"] [:can_delete false] [:cost_center "11410210"] [:general_ledger_account "5069097000"] [:procurement_account "3119097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "797264c9-a2c2-5642-9c1a-d45b01f4fdc5"] [:firstname "Heike"] [:lastname "Heldt"] [:__typename :User]) #ordered/map ([:id "2c1de10b-6145-56d6-a76e-3c207cfc35a1"] [:firstname "Marco"] [:lastname "Castellano"] [:__typename :User]) #ordered/map ([:id "57bb6aaa-95fb-435f-8dd9-d0b853bf2279"] [:firstname "Pascale"] [:lastname "Gisel"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "c3f14f79-931c-52c8-a847-ed77449ce9a6"] [:name "Zuteilung unbekannt - Bauliche Anpassungen und Mobiliar"] [:can_delete false] [:cost_center "11410220"] [:general_ledger_account "5069097000"] [:procurement_account "3119097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "797264c9-a2c2-5642-9c1a-d45b01f4fdc5"] [:firstname "Heike"] [:lastname "Heldt"] [:__typename :User]) #ordered/map ([:id "2c1de10b-6145-56d6-a76e-3c207cfc35a1"] [:firstname "Marco"] [:lastname "Castellano"] [:__typename :User]) #ordered/map ([:id "57bb6aaa-95fb-435f-8dd9-d0b853bf2279"] [:firstname "Pascale"] [:lastname "Gisel"] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "dda588f4-660c-573c-a2ff-944ae93ad42e"] [:name "Beleuchtungstechnik"] [:can_delete false] [:image_url "/procure/images/8debe2ef-4a7e-58a1-bf4c-1622dead4579"] [:categories [#ordered/map ([:id "b9e4f492-55e3-57e4-9467-91c81bfe2325"] [:name "Bühnenlicht"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User])]] [:viewers [#ordered/map ([:id "8448b7b2-f5d9-4590-8355-2295b50bba40"] [:firstname "Sergej"] [:lastname "Tratar Baamonde"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "a7cca5a4-e265-5f36-b794-1024c8aacc3e"] [:name "Film-Beleuchtung"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User])]] [:viewers [#ordered/map ([:id "8448b7b2-f5d9-4590-8355-2295b50bba40"] [:firstname "Sergej"] [:lastname "Tratar Baamonde"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "79822b89-0edb-588c-b9e5-65b7722ac50b"] [:name "Kameralicht"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User])]] [:viewers [#ordered/map ([:id "8448b7b2-f5d9-4590-8355-2295b50bba40"] [:firstname "Sergej"] [:lastname "Tratar Baamonde"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "ab911807-6431-5ca7-890a-3573737bb4d3"] [:name "Mobiles Raumlicht für Ausstellungen"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "2c1de10b-6145-56d6-a76e-3c207cfc35a1"] [:firstname "Marco"] [:lastname "Castellano"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "64c6f8ad-a1b7-530b-946a-ebb1644ac897"] [:name "Studio-Licht"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User])]] [:viewers [#ordered/map ([:id "8448b7b2-f5d9-4590-8355-2295b50bba40"] [:firstname "Sergej"] [:lastname "Tratar Baamonde"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "f2bb3f23-bb5b-5855-b03f-0166bd19fc0c"] [:name "Zuteilung unbekannt - Beleuchtungstechnik"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User])]] [:viewers [#ordered/map ([:id "8448b7b2-f5d9-4590-8355-2295b50bba40"] [:firstname "Sergej"] [:lastname "Tratar Baamonde"] [:__typename :User])]] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "2b07eb8a-4174-5257-83eb-920d536cc44a"] [:name "Betriebseinrichtungen und Fahrzeuge"] [:can_delete false] [:image_url "/procure/images/3d6cbe63-c327-5c6b-b7fa-48e6c52f2cdc"] [:categories [#ordered/map ([:id "5d8639a3-4569-5009-af28-f63f2af5209d"] [:name "Betriebseinrichtungen"] [:can_delete false] [:cost_center "11410200"] [:general_ledger_account "5061097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "2c1de10b-6145-56d6-a76e-3c207cfc35a1"] [:firstname "Marco"] [:lastname "Castellano"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "b34f1cbb-4ac7-59a0-81f2-3ca7ecc94e71"] [:name "Fahrzeuge"] [:can_delete false] [:cost_center "11410200"] [:general_ledger_account "5061097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "2c1de10b-6145-56d6-a76e-3c207cfc35a1"] [:firstname "Marco"] [:lastname "Castellano"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "73e97867-43ea-5bee-b46b-d7c74fbf873b"] [:name "Hub- und Hebegeräte"] [:can_delete false] [:cost_center "11410200"] [:general_ledger_account "5061097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "2c1de10b-6145-56d6-a76e-3c207cfc35a1"] [:firstname "Marco"] [:lastname "Castellano"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "b6601a86-b5d3-5682-88b6-cff956b00d7b"] [:name "Zuteilung unbekannt - Betriebseinrichtungen und Fahrzeuge"] [:can_delete false] [:cost_center "11410200"] [:general_ledger_account "5061097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "2c1de10b-6145-56d6-a76e-3c207cfc35a1"] [:firstname "Marco"] [:lastname "Castellano"] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "f6827594-33a6-5760-ac41-f94ceefacfab"] [:name "Bühnentechnik"] [:can_delete false] [:image_url "/procure/images/9a8cba78-10ab-585b-a4c2-9d8e7f0818ee"] [:categories [#ordered/map ([:id "455bc6dc-afbd-579d-a621-6d75e0fca9ea"] [:name "Bühnentechnik"] [:can_delete false] [:cost_center "11410500"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "428a72a9-36df-52fa-880f-64db35843013"] [:firstname "Dominik"] [:lastname "Fedier"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "8448b7b2-f5d9-4590-8355-2295b50bba40"] [:firstname "Sergej"] [:lastname "Tratar Baamonde"] [:__typename :User])]] [:viewers [#ordered/map ([:id "8448b7b2-f5d9-4590-8355-2295b50bba40"] [:firstname "Sergej"] [:lastname "Tratar Baamonde"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "747b6b21-9fad-4a01-acd9-cd8983aed286"] [:name "Fundus"] [:can_delete false] [:cost_center "11410500"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "428a72a9-36df-52fa-880f-64db35843013"] [:firstname "Dominik"] [:lastname "Fedier"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User])]] [:viewers [#ordered/map ([:id "8448b7b2-f5d9-4590-8355-2295b50bba40"] [:firstname "Sergej"] [:lastname "Tratar Baamonde"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "07a6af37-e127-5f4b-94ec-698a5698d98c"] [:name "Zuteilung unbekannt - Bühnentechnik"] [:can_delete false] [:cost_center "11410500"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "428a72a9-36df-52fa-880f-64db35843013"] [:firstname "Dominik"] [:lastname "Fedier"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "8448b7b2-f5d9-4590-8355-2295b50bba40"] [:firstname "Sergej"] [:lastname "Tratar Baamonde"] [:__typename :User])]] [:viewers [#ordered/map ([:id "8448b7b2-f5d9-4590-8355-2295b50bba40"] [:firstname "Sergej"] [:lastname "Tratar Baamonde"] [:__typename :User])]] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "517b82ae-2b7e-4822-9aeb-0d4753dec821"] [:name "Darlehen"] [:can_delete false] [:image_url nil] [:categories [#ordered/map ([:id "671ab85c-b8c1-4659-9c6e-9ebe2f122a59"] [:name "Darlehen"] [:can_delete false] [:cost_center "11410101"] [:general_ledger_account "5064097000"] [:procurement_account ""] [:inspectors [#ordered/map ([:id "b610f5bd-6da8-5122-94f0-c0bbf1b7ed73"] [:firstname "Daniel"] [:lastname "Fischer"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "ca1d97ac-0ac4-597a-8edb-f9c466b1c7da"] [:name "Fotografie"] [:can_delete false] [:image_url "/procure/images/07a33b4c-d274-54e5-a2ce-11f26d57be05"] [:categories [#ordered/map ([:id "e1b4cad8-0416-5cf7-9e4a-dde208d0abad"] [:name "Blitzanlagen"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "011ff3f3-09fa-59e1-9713-52466786adf8"] [:name "Fotokameras"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "54b87eb0-061c-5a97-96ad-e9b6da605184"] [:name "Fotostative"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "5858ec5d-5f01-50fb-bc96-4b4766bd7799"] [:name "Kompakt-Blitze"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "ba5b41a7-4317-5160-9b82-b0931a48aec0"] [:name "Objektive"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "9df68a66-4523-5072-aa31-1df9abeaa1c7"] [:name "Zuteilung unbekannt - Fotografie"] [:can_delete false] [:cost_center "11410300"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "340e3295-90ba-5c73-8f01-61fefd9960ff"] [:firstname "Mike"] [:lastname "Honegger"] [:__typename :User]) #ordered/map ([:id "95727ff5-358f-540c-a09c-53a1ac219dd0"] [:firstname "Ralph"] [:lastname "Wetli"] [:__typename :User]) #ordered/map ([:id "e27434b5-115e-5792-a757-8ec39e0d3b7f"] [:firstname "Roger"] [:lastname "Bachmann"] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "2ea39047-e663-50d5-9080-838b75883704"] [:name "IT & Elektronik"] [:can_delete false] [:image_url "/procure/images/1464e46c-e726-54a9-a42b-f937a0342d22"] [:categories [#ordered/map ([:id "f2531d7e-d9ff-5c3e-9e88-6d3a16a89aa1"] [:name "Desktop"] [:can_delete false] [:cost_center "11410660"] [:general_ledger_account "5064097000"] [:procurement_account "3113097000"] [:inspectors [#ordered/map ([:id "e9656e43-9f35-502d-b495-eec36093208e"] [:firstname "Christian"] [:lastname "Wildhaber"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "28552e7e-f8be-5019-bdad-846babd8c642"] [:firstname "Hugo"] [:lastname "Vögtle"] [:__typename :User]) #ordered/map ([:id "301988e6-5e0e-43a9-bcb6-3d0022b7ca99"] [:firstname "Lars"] [:lastname "Gnädinger"] [:__typename :User]) #ordered/map ([:id "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d"] [:firstname "Lenny Ron"] [:lastname "Frei"] [:__typename :User]) #ordered/map ([:id "b5d09795-0b94-423d-a645-bae0aed895ce"] [:firstname "Lukas"] [:lastname "Brupbacher"] [:__typename :User]) #ordered/map ([:id "b41e6486-ec39-4855-8d8a-c03aa83af233"] [:firstname "Matthias"] [:lastname "Daniels"] [:__typename :User]) #ordered/map ([:id "8a9d832a-cf4c-5253-bcaa-385ef03565c1"] [:firstname "Nadja"] [:lastname "Weisskopf-Admin"] [:__typename :User]) #ordered/map ([:id "4884241c-8104-5c10-a393-0e21dcd1a46e"] [:firstname "Patrice"] [:lastname "Huber"] [:__typename :User]) #ordered/map ([:id "52c2d39d-7f53-592f-8142-824afbaf59d3"] [:firstname "Tilo"] [:lastname "Seiring"] [:__typename :User]) #ordered/map ([:id "96c5a731-ae34-5ede-917c-90a42dc66a1e"] [:firstname "Ugo"] [:lastname "De Vito"] [:__typename :User])]] [:viewers [#ordered/map ([:id "b363936a-fd9c-567a-82a4-f0b523dbb26b"] [:firstname "Beat"] [:lastname "Rohrer"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "1af3a7f2-b16a-4203-b6ac-f2c7be612d74"] [:name "IT_Projekte"] [:can_delete false] [:cost_center "11410650"] [:general_ledger_account "5064097000"] [:procurement_account "3118097000"] [:inspectors [#ordered/map ([:id "e9656e43-9f35-502d-b495-eec36093208e"] [:firstname "Christian"] [:lastname "Wildhaber"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "28552e7e-f8be-5019-bdad-846babd8c642"] [:firstname "Hugo"] [:lastname "Vögtle"] [:__typename :User]) #ordered/map ([:id "301988e6-5e0e-43a9-bcb6-3d0022b7ca99"] [:firstname "Lars"] [:lastname "Gnädinger"] [:__typename :User]) #ordered/map ([:id "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d"] [:firstname "Lenny Ron"] [:lastname "Frei"] [:__typename :User]) #ordered/map ([:id "b5d09795-0b94-423d-a645-bae0aed895ce"] [:firstname "Lukas"] [:lastname "Brupbacher"] [:__typename :User]) #ordered/map ([:id "b41e6486-ec39-4855-8d8a-c03aa83af233"] [:firstname "Matthias"] [:lastname "Daniels"] [:__typename :User]) #ordered/map ([:id "4884241c-8104-5c10-a393-0e21dcd1a46e"] [:firstname "Patrice"] [:lastname "Huber"] [:__typename :User]) #ordered/map ([:id "52c2d39d-7f53-592f-8142-824afbaf59d3"] [:firstname "Tilo"] [:lastname "Seiring"] [:__typename :User]) #ordered/map ([:id "96c5a731-ae34-5ede-917c-90a42dc66a1e"] [:firstname "Ugo"] [:lastname "De Vito"] [:__typename :User])]] [:viewers [#ordered/map ([:id "b363936a-fd9c-567a-82a4-f0b523dbb26b"] [:firstname "Beat"] [:lastname "Rohrer"] [:__typename :User]) #ordered/map ([:id "b5d09795-0b94-423d-a645-bae0aed895ce"] [:firstname "Lukas"] [:lastname "Brupbacher"] [:__typename :User]) #ordered/map ([:id "233a038c-66fb-4036-9149-762c10a5b72e"] [:firstname "Maria"] [:lastname "Krause"] [:__typename :User]) #ordered/map ([:id "d65e52a5-0404-4069-b6a0-7e8ef60dc1e1"] [:firstname "Maurizio"] [:lastname "Mattiola"] [:__typename :User]) #ordered/map ([:id "119a33c1-151f-4579-8c79-0d3225d4b9b6"] [:firstname "Michael"] [:lastname "Bozenicar"] [:__typename :User]) #ordered/map ([:id "45b1cf11-1f50-5d8b-aedf-5d8b83b19a52"] [:firstname "Monika"] [:lastname "Petschen"] [:__typename :User]) #ordered/map ([:id "8160a951-8900-448d-8c3e-e31ec60fd3f3"] [:firstname "Stefan"] [:lastname "Uhle"] [:__typename :User]) #ordered/map ([:id "a4d8f8c9-8f5e-444f-b2cf-67e53f7d3d0c"] [:firstname "Thomas"] [:lastname "Bickel"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "ccab158d-79c7-5c28-a8a2-47cb4925f101"] [:name "IT-Basisinfrastruktur"] [:can_delete false] [:cost_center "11410640"] [:general_ledger_account "5064097000"] [:procurement_account "3113097000"] [:inspectors [#ordered/map ([:id "e9656e43-9f35-502d-b495-eec36093208e"] [:firstname "Christian"] [:lastname "Wildhaber"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "28552e7e-f8be-5019-bdad-846babd8c642"] [:firstname "Hugo"] [:lastname "Vögtle"] [:__typename :User]) #ordered/map ([:id "301988e6-5e0e-43a9-bcb6-3d0022b7ca99"] [:firstname "Lars"] [:lastname "Gnädinger"] [:__typename :User]) #ordered/map ([:id "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d"] [:firstname "Lenny Ron"] [:lastname "Frei"] [:__typename :User]) #ordered/map ([:id "b41e6486-ec39-4855-8d8a-c03aa83af233"] [:firstname "Matthias"] [:lastname "Daniels"] [:__typename :User]) #ordered/map ([:id "4884241c-8104-5c10-a393-0e21dcd1a46e"] [:firstname "Patrice"] [:lastname "Huber"] [:__typename :User]) #ordered/map ([:id "52c2d39d-7f53-592f-8142-824afbaf59d3"] [:firstname "Tilo"] [:lastname "Seiring"] [:__typename :User]) #ordered/map ([:id "96c5a731-ae34-5ede-917c-90a42dc66a1e"] [:firstname "Ugo"] [:lastname "De Vito"] [:__typename :User])]] [:viewers [#ordered/map ([:id "b363936a-fd9c-567a-82a4-f0b523dbb26b"] [:firstname "Beat"] [:lastname "Rohrer"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "eb1e7bef-80c6-4958-b16e-35555735ce61"] [:name "IT-Security"] [:can_delete false] [:cost_center "11410600"] [:general_ledger_account "5064097000"] [:procurement_account "3113097000"] [:inspectors [#ordered/map ([:id "3651eeeb-0fb1-4840-80dd-6c739bda6c57"] [:firstname "Christian"] [:lastname "Schneider"] [:__typename :User]) #ordered/map ([:id "301988e6-5e0e-43a9-bcb6-3d0022b7ca99"] [:firstname "Lars"] [:lastname "Gnädinger"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "4ecc9e97-2d12-5173-bd8c-781482c842e8"] [:name "Laptops"] [:can_delete false] [:cost_center "11410660"] [:general_ledger_account "5064097000"] [:procurement_account "3113097000"] [:inspectors [#ordered/map ([:id "e9656e43-9f35-502d-b495-eec36093208e"] [:firstname "Christian"] [:lastname "Wildhaber"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "28552e7e-f8be-5019-bdad-846babd8c642"] [:firstname "Hugo"] [:lastname "Vögtle"] [:__typename :User]) #ordered/map ([:id "301988e6-5e0e-43a9-bcb6-3d0022b7ca99"] [:firstname "Lars"] [:lastname "Gnädinger"] [:__typename :User]) #ordered/map ([:id "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d"] [:firstname "Lenny Ron"] [:lastname "Frei"] [:__typename :User]) #ordered/map ([:id "b41e6486-ec39-4855-8d8a-c03aa83af233"] [:firstname "Matthias"] [:lastname "Daniels"] [:__typename :User]) #ordered/map ([:id "4884241c-8104-5c10-a393-0e21dcd1a46e"] [:firstname "Patrice"] [:lastname "Huber"] [:__typename :User]) #ordered/map ([:id "52c2d39d-7f53-592f-8142-824afbaf59d3"] [:firstname "Tilo"] [:lastname "Seiring"] [:__typename :User]) #ordered/map ([:id "96c5a731-ae34-5ede-917c-90a42dc66a1e"] [:firstname "Ugo"] [:lastname "De Vito"] [:__typename :User])]] [:viewers [#ordered/map ([:id "b363936a-fd9c-567a-82a4-f0b523dbb26b"] [:firstname "Beat"] [:lastname "Rohrer"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "80226a51-c17a-5fd8-93db-40aef5b03491"] [:name "Monitore"] [:can_delete false] [:cost_center "11410660"] [:general_ledger_account "5064097000"] [:procurement_account "3113097000"] [:inspectors [#ordered/map ([:id "e9656e43-9f35-502d-b495-eec36093208e"] [:firstname "Christian"] [:lastname "Wildhaber"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "28552e7e-f8be-5019-bdad-846babd8c642"] [:firstname "Hugo"] [:lastname "Vögtle"] [:__typename :User]) #ordered/map ([:id "301988e6-5e0e-43a9-bcb6-3d0022b7ca99"] [:firstname "Lars"] [:lastname "Gnädinger"] [:__typename :User]) #ordered/map ([:id "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d"] [:firstname "Lenny Ron"] [:lastname "Frei"] [:__typename :User]) #ordered/map ([:id "b41e6486-ec39-4855-8d8a-c03aa83af233"] [:firstname "Matthias"] [:lastname "Daniels"] [:__typename :User]) #ordered/map ([:id "4884241c-8104-5c10-a393-0e21dcd1a46e"] [:firstname "Patrice"] [:lastname "Huber"] [:__typename :User]) #ordered/map ([:id "52c2d39d-7f53-592f-8142-824afbaf59d3"] [:firstname "Tilo"] [:lastname "Seiring"] [:__typename :User]) #ordered/map ([:id "96c5a731-ae34-5ede-917c-90a42dc66a1e"] [:firstname "Ugo"] [:lastname "De Vito"] [:__typename :User])]] [:viewers [#ordered/map ([:id "b363936a-fd9c-567a-82a4-f0b523dbb26b"] [:firstname "Beat"] [:lastname "Rohrer"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "fe602c35-1097-52d0-acd0-40579d295f00"] [:name "Scanner"] [:can_delete false] [:cost_center "11410660"] [:general_ledger_account "5064097000"] [:procurement_account "3113097000"] [:inspectors [#ordered/map ([:id "e9656e43-9f35-502d-b495-eec36093208e"] [:firstname "Christian"] [:lastname "Wildhaber"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "28552e7e-f8be-5019-bdad-846babd8c642"] [:firstname "Hugo"] [:lastname "Vögtle"] [:__typename :User]) #ordered/map ([:id "301988e6-5e0e-43a9-bcb6-3d0022b7ca99"] [:firstname "Lars"] [:lastname "Gnädinger"] [:__typename :User]) #ordered/map ([:id "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d"] [:firstname "Lenny Ron"] [:lastname "Frei"] [:__typename :User]) #ordered/map ([:id "b41e6486-ec39-4855-8d8a-c03aa83af233"] [:firstname "Matthias"] [:lastname "Daniels"] [:__typename :User]) #ordered/map ([:id "4884241c-8104-5c10-a393-0e21dcd1a46e"] [:firstname "Patrice"] [:lastname "Huber"] [:__typename :User]) #ordered/map ([:id "52c2d39d-7f53-592f-8142-824afbaf59d3"] [:firstname "Tilo"] [:lastname "Seiring"] [:__typename :User]) #ordered/map ([:id "96c5a731-ae34-5ede-917c-90a42dc66a1e"] [:firstname "Ugo"] [:lastname "De Vito"] [:__typename :User])]] [:viewers [#ordered/map ([:id "b363936a-fd9c-567a-82a4-f0b523dbb26b"] [:firstname "Beat"] [:lastname "Rohrer"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "56065d53-cd2f-5a39-9b66-532fd83ad2e6"] [:name "Schnittstellengeräte"] [:can_delete false] [:cost_center "11410660"] [:general_ledger_account "5064097000"] [:procurement_account "3113097000"] [:inspectors [#ordered/map ([:id "e9656e43-9f35-502d-b495-eec36093208e"] [:firstname "Christian"] [:lastname "Wildhaber"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "28552e7e-f8be-5019-bdad-846babd8c642"] [:firstname "Hugo"] [:lastname "Vögtle"] [:__typename :User]) #ordered/map ([:id "301988e6-5e0e-43a9-bcb6-3d0022b7ca99"] [:firstname "Lars"] [:lastname "Gnädinger"] [:__typename :User]) #ordered/map ([:id "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d"] [:firstname "Lenny Ron"] [:lastname "Frei"] [:__typename :User]) #ordered/map ([:id "b41e6486-ec39-4855-8d8a-c03aa83af233"] [:firstname "Matthias"] [:lastname "Daniels"] [:__typename :User]) #ordered/map ([:id "4884241c-8104-5c10-a393-0e21dcd1a46e"] [:firstname "Patrice"] [:lastname "Huber"] [:__typename :User]) #ordered/map ([:id "52c2d39d-7f53-592f-8142-824afbaf59d3"] [:firstname "Tilo"] [:lastname "Seiring"] [:__typename :User]) #ordered/map ([:id "96c5a731-ae34-5ede-917c-90a42dc66a1e"] [:firstname "Ugo"] [:lastname "De Vito"] [:__typename :User])]] [:viewers [#ordered/map ([:id "b363936a-fd9c-567a-82a4-f0b523dbb26b"] [:firstname "Beat"] [:lastname "Rohrer"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "fc7bc38c-62f3-5576-802f-c874e06ee776"] [:name "Software"] [:can_delete false] [:cost_center "11410660"] [:general_ledger_account "5064097000"] [:procurement_account "3118097000"] [:inspectors [#ordered/map ([:id "e9656e43-9f35-502d-b495-eec36093208e"] [:firstname "Christian"] [:lastname "Wildhaber"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "28552e7e-f8be-5019-bdad-846babd8c642"] [:firstname "Hugo"] [:lastname "Vögtle"] [:__typename :User]) #ordered/map ([:id "301988e6-5e0e-43a9-bcb6-3d0022b7ca99"] [:firstname "Lars"] [:lastname "Gnädinger"] [:__typename :User]) #ordered/map ([:id "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d"] [:firstname "Lenny Ron"] [:lastname "Frei"] [:__typename :User]) #ordered/map ([:id "b41e6486-ec39-4855-8d8a-c03aa83af233"] [:firstname "Matthias"] [:lastname "Daniels"] [:__typename :User]) #ordered/map ([:id "8a9d832a-cf4c-5253-bcaa-385ef03565c1"] [:firstname "Nadja"] [:lastname "Weisskopf-Admin"] [:__typename :User]) #ordered/map ([:id "4884241c-8104-5c10-a393-0e21dcd1a46e"] [:firstname "Patrice"] [:lastname "Huber"] [:__typename :User]) #ordered/map ([:id "52c2d39d-7f53-592f-8142-824afbaf59d3"] [:firstname "Tilo"] [:lastname "Seiring"] [:__typename :User]) #ordered/map ([:id "96c5a731-ae34-5ede-917c-90a42dc66a1e"] [:firstname "Ugo"] [:lastname "De Vito"] [:__typename :User])]] [:viewers [#ordered/map ([:id "b363936a-fd9c-567a-82a4-f0b523dbb26b"] [:firstname "Beat"] [:lastname "Rohrer"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "76fdca98-4a2a-5640-bc98-f33059d6ffa0"] [:name "Tablets"] [:can_delete false] [:cost_center "11410660"] [:general_ledger_account "5064097000"] [:procurement_account "3113097000"] [:inspectors [#ordered/map ([:id "e9656e43-9f35-502d-b495-eec36093208e"] [:firstname "Christian"] [:lastname "Wildhaber"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "28552e7e-f8be-5019-bdad-846babd8c642"] [:firstname "Hugo"] [:lastname "Vögtle"] [:__typename :User]) #ordered/map ([:id "301988e6-5e0e-43a9-bcb6-3d0022b7ca99"] [:firstname "Lars"] [:lastname "Gnädinger"] [:__typename :User]) #ordered/map ([:id "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d"] [:firstname "Lenny Ron"] [:lastname "Frei"] [:__typename :User]) #ordered/map ([:id "b41e6486-ec39-4855-8d8a-c03aa83af233"] [:firstname "Matthias"] [:lastname "Daniels"] [:__typename :User]) #ordered/map ([:id "4884241c-8104-5c10-a393-0e21dcd1a46e"] [:firstname "Patrice"] [:lastname "Huber"] [:__typename :User]) #ordered/map ([:id "52c2d39d-7f53-592f-8142-824afbaf59d3"] [:firstname "Tilo"] [:lastname "Seiring"] [:__typename :User]) #ordered/map ([:id "96c5a731-ae34-5ede-917c-90a42dc66a1e"] [:firstname "Ugo"] [:lastname "De Vito"] [:__typename :User])]] [:viewers [#ordered/map ([:id "b363936a-fd9c-567a-82a4-f0b523dbb26b"] [:firstname "Beat"] [:lastname "Rohrer"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "77857566-03d9-58f4-8b0d-290227434aff"] [:name "Telefon"] [:can_delete false] [:cost_center "11410660"] [:general_ledger_account "5064097000"] [:procurement_account "3113097000"] [:inspectors [#ordered/map ([:id "e9656e43-9f35-502d-b495-eec36093208e"] [:firstname "Christian"] [:lastname "Wildhaber"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "28552e7e-f8be-5019-bdad-846babd8c642"] [:firstname "Hugo"] [:lastname "Vögtle"] [:__typename :User]) #ordered/map ([:id "301988e6-5e0e-43a9-bcb6-3d0022b7ca99"] [:firstname "Lars"] [:lastname "Gnädinger"] [:__typename :User]) #ordered/map ([:id "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d"] [:firstname "Lenny Ron"] [:lastname "Frei"] [:__typename :User]) #ordered/map ([:id "b41e6486-ec39-4855-8d8a-c03aa83af233"] [:firstname "Matthias"] [:lastname "Daniels"] [:__typename :User]) #ordered/map ([:id "4884241c-8104-5c10-a393-0e21dcd1a46e"] [:firstname "Patrice"] [:lastname "Huber"] [:__typename :User]) #ordered/map ([:id "52c2d39d-7f53-592f-8142-824afbaf59d3"] [:firstname "Tilo"] [:lastname "Seiring"] [:__typename :User]) #ordered/map ([:id "96c5a731-ae34-5ede-917c-90a42dc66a1e"] [:firstname "Ugo"] [:lastname "De Vito"] [:__typename :User])]] [:viewers [#ordered/map ([:id "b363936a-fd9c-567a-82a4-f0b523dbb26b"] [:firstname "Beat"] [:lastname "Rohrer"] [:__typename :User])]] [:__typename :Category]) #ordered/map ([:id "5059c4fc-d34c-5c9a-9efe-257c7ec6fb6b"] [:name "Zuteilung unbekannt - IT & Elektronik"] [:can_delete false] [:cost_center "11410600"] [:general_ledger_account "5064097000"] [:procurement_account "3113097000"] [:inspectors [#ordered/map ([:id "e9656e43-9f35-502d-b495-eec36093208e"] [:firstname "Christian"] [:lastname "Wildhaber"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "28552e7e-f8be-5019-bdad-846babd8c642"] [:firstname "Hugo"] [:lastname "Vögtle"] [:__typename :User]) #ordered/map ([:id "301988e6-5e0e-43a9-bcb6-3d0022b7ca99"] [:firstname "Lars"] [:lastname "Gnädinger"] [:__typename :User]) #ordered/map ([:id "0dc06eee-6309-4cd0-b0f6-6aeb55b5c34d"] [:firstname "Lenny Ron"] [:lastname "Frei"] [:__typename :User]) #ordered/map ([:id "b41e6486-ec39-4855-8d8a-c03aa83af233"] [:firstname "Matthias"] [:lastname "Daniels"] [:__typename :User]) #ordered/map ([:id "4884241c-8104-5c10-a393-0e21dcd1a46e"] [:firstname "Patrice"] [:lastname "Huber"] [:__typename :User]) #ordered/map ([:id "52c2d39d-7f53-592f-8142-824afbaf59d3"] [:firstname "Tilo"] [:lastname "Seiring"] [:__typename :User]) #ordered/map ([:id "96c5a731-ae34-5ede-917c-90a42dc66a1e"] [:firstname "Ugo"] [:lastname "De Vito"] [:__typename :User])]] [:viewers [#ordered/map ([:id "b363936a-fd9c-567a-82a4-f0b523dbb26b"] [:firstname "Beat"] [:lastname "Rohrer"] [:__typename :User])]] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "f6885671-3bf3-56f2-8e92-b5112d0f703f"] [:name "Musikinstrumente"] [:can_delete false] [:image_url "/procure/images/3a52eb87-b5fe-5df0-98b1-43e80f28d2dc"] [:categories [#ordered/map ([:id "af3372a1-63a8-52dc-850e-c2ae91c1c078"] [:name "Musikinstrumente"] [:can_delete false] [:cost_center "11410800"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "6eeeeb75-e3d8-56c9-b7b6-0c45b7795cb9"] [:firstname "Martin"] [:lastname "Weyermann"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "17a52112-1986-5074-b1d9-0faff29a785b"] [:name "Zuteilung unbekannt - Musikinstrumente"] [:can_delete false] [:cost_center "11410800"] [:general_ledger_account "5063097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "6eeeeb75-e3d8-56c9-b7b6-0c45b7795cb9"] [:firstname "Martin"] [:lastname "Weyermann"] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory]) #ordered/map ([:id "6c8a0d77-6711-5156-a59a-12425ba01cff"] [:name "Werkstatt-Technik"] [:can_delete false] [:image_url "/procure/images/f4e1f230-df2e-5e95-bf89-827f7a6b4b3b"] [:categories [#ordered/map ([:id "6870a16c-9a71-5e60-b94a-f0b784398fec"] [:name "Handwerkzeug"] [:can_delete false] [:cost_center "11410400"] [:general_ledger_account "5061097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "ad765b67-18f7-55a8-88b6-11a82cd0d0b4"] [:firstname "Adrian"] [:lastname "Brazerol"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "771fddcf-b19a-5e6b-8b6f-7266b6922c4f"] [:name "Maschinen"] [:can_delete false] [:cost_center "11410400"] [:general_ledger_account "5061097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "ad765b67-18f7-55a8-88b6-11a82cd0d0b4"] [:firstname "Adrian"] [:lastname "Brazerol"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "c7ece4a6-2b5c-409f-96ea-e4fd6e8f9792"] [:name "Sicherheit"] [:can_delete false] [:cost_center "11410400"] [:general_ledger_account "5061097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "ad765b67-18f7-55a8-88b6-11a82cd0d0b4"] [:firstname "Adrian"] [:lastname "Brazerol"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User])]] [:viewers []] [:__typename :Category]) #ordered/map ([:id "3eaad5d5-516a-5610-8caf-342cfdcaac62"] [:name "Zuteilung unbekannt - Werkstatt-Technik"] [:can_delete false] [:cost_center "11410400"] [:general_ledger_account "5061097000"] [:procurement_account "3111097000"] [:inspectors [#ordered/map ([:id "ad765b67-18f7-55a8-88b6-11a82cd0d0b4"] [:firstname "Adrian"] [:lastname "Brazerol"] [:__typename :User]) #ordered/map ([:id "cbcbc88f-e7b4-58fd-8dc2-e83be0d06475"] [:firstname "Claudia"] [:lastname "Bachmann"] [:__typename :User]) #ordered/map ([:id "da18869a-e4bd-4493-a4c9-2e6fe78c94e7"] [:firstname "Etienne"] [:lastname "Schudel"] [:__typename :User]) #ordered/map ([:id "f721d6b7-8275-5ee0-b225-aa7c13781f45"] [:firstname "Hans Ulrich"] [:lastname "Gasser"] [:__typename :User]) #ordered/map ([:id "6ecace30-0931-59f4-9032-cd412530256c"] [:firstname "Judith"] [:lastname "Richi"] [:__typename :User]) #ordered/map ([:id "de3d3911-8b37-4bfe-aa59-25ee8dac5b07"] [:firstname "Julio"] [:lastname "Barrantes Zunzunegui"] [:__typename :User]) #ordered/map ([:id "b1e54635-ec2a-444f-8edd-7186075b0760"] [:firstname "Nomce"] [:lastname "Tanaskoski"] [:__typename :User]) #ordered/map ([:id "8448b7b2-f5d9-4590-8355-2295b50bba40"] [:firstname "Sergej"] [:lastname "Tratar Baamonde"] [:__typename :User]) #ordered/map ([:id "48e259df-9b53-5e56-a03e-65ce562f231a"] [:firstname "Silvan"] [:lastname "Becchio"] [:__typename :User]) #ordered/map ([:id "d0853239-fe13-4540-9c16-4ec1656461d3"] [:firstname "Silvia"] [:lastname "Eichenberger"] [:__typename :User]) #ordered/map ([:id "26eb4afc-8200-41bf-bf23-b3e0d2deb1fc"] [:firstname "Stefan"] [:lastname "Weinmann"] [:__typename :User]) #ordered/map ([:id "baa628c5-c7fc-4cce-bea7-d8093f78adca"] [:firstname "Zelda"] [:lastname "Keller"] [:__typename :User])]] [:viewers []] [:__typename :Category])]] [:__typename :MainCategory])]])}
>>> authenticate::skip= true  handler-key= :image
>>> authenticate::authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}

>> authorize >

>> authorize::handler > #object[leihs.core.locale$wrap$fn__45159 0x55069a5c leihs.core.locale$wrap$fn__45159@55069a5c]

>> authorize::request > {:authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 219b97e6-bb13-401e-92a7-2304bf206106}, leihs-user-session {:value d429c048-7118-407f-a7a9-b33da6f15b06}}, :remote-addr 127.0.0.1, :start-time 48743387539833, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}, :query-params-raw {}, :route-params {:image-id 8debe2ef-4a7e-58a1-bf4c-1622dead4579}, :headers {sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, cookie leihs-anti-csrf-token=219b97e6-bb13-401e-92a7-2304bf206106; leihs-user-session=d429c048-7118-407f-a7a9-b33da6f15b06, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/admin/categories/dda588f4660c573ca2ff944ae93ad42e, connection keep-alive, pragma no-cache, accept image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest image, accept-encoding gzip, deflate, br, sec-fetch-mode no-cors, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x26fc6de7 /127.0.0.1:3230<->/127.0.0.1:56143], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x65dc1b71 HikariDataSource (db-pool)]}, :content-length 0, :form-params {}, :websocket? false, :query-params {}, :content-type nil, :form-params-raw {}, :character-encoding utf8, :uri /procure/images/8debe2ef-4a7e-58a1-bf4c-1622dead4579, :server-name localhost, :handler-key :image, :query-string nil, :body nil, :graphql-schema #CompiledSchema<>, :handler #object[compojure.core$routes$fn__27950 0x42c6e004 compojure.core$routes$fn__27950@42c6e004], :multipart-params {}, :scheme :http, :request-method :get, :accept {:mime :apng, :charset nil, :encoding nil, :language nil}}

>> authorize::handler-key >> :image
>myprint>  authEnt? {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>myprint>  txn #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x6164f0d HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
2023-12-12T11:43:56.903Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.904Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:43:56.932Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>myprint>  admin true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.932Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> inspector? {:result false}
>myprint>  inspector false
>o> viewer? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.933Z NX-41294 DEBUG [leihs.procurement.permissions.user:85] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> viewer? {:result false}
>myprint>  viewer false
>o> requester?? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:43:56.933Z NX-41294 DEBUG [leihs.procurement.permissions.user:169] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> requester?? {:exists false}
2023-12-12T11:43:56.933Z NX-41294 DEBUG [leihs.procurement.permissions.user:173] - (:exists result) => false
>myprint>  requester false

> 1 anti-csrf-token >  219b97e6-bb13-401e-92a7-2304bf206106

> 1 anti-csrf-token class >  java.lang.String

> 2 anti-csrf-token-new >  nil
>>> authenticate::skip= true  handler-key= :upload
>>> authenticate::authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}

>> authorize >

>> authorize::handler > #object[leihs.core.locale$wrap$fn__45159 0x55069a5c leihs.core.locale$wrap$fn__45159@55069a5c]

>> authorize::request > {:authenticated-entity {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 219b97e6-bb13-401e-92a7-2304bf206106}, leihs-user-session {:value d429c048-7118-407f-a7a9-b33da6f15b06}}, :remote-addr 127.0.0.1, :start-time 48750696781333, :params {:files {:filename thx.png, :content-type image/png, :tempfile #object[java.io.File 0x348c3c0b /var/folders/jl/49spzkdd2v3cdz37fgmp0ddr6cj76v/T/ring-multipart-1889197302240827634.tmp], :size 1669}}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.pool.HikariProxyConnection 0x189e515a HikariProxyConnection@413028698 wrapping org.postgresql.jdbc.PgConnection@6f737354], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type multipart/form-data; boundary=----WebKitFormBoundaryCpWSZciBVMXEeyv2, cookie leihs-anti-csrf-token=219b97e6-bb13-401e-92a7-2304bf206106; leihs-user-session=d429c048-7118-407f-a7a9-b33da6f15b06, content-length 1850, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/admin/categories/dda588f4660c573ca2ff944ae93ad42e, connection keep-alive, pragma no-cache, x-csrf-token 219b97e6-bb13-401e-92a7-2304bf206106, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x18d3907a /127.0.0.1:3230<->/127.0.0.1:56143], :server-port 3230, :params-raw {:files {:filename thx.png, :content-type image/png, :tempfile #object[java.io.File 0x348c3c0b /var/folders/jl/49spzkdd2v3cdz37fgmp0ddr6cj76v/T/ring-multipart-1889197302240827634.tmp], :size 1669}}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x65dc1b71 HikariDataSource (db-pool)], :connection #object[com.zaxxer.hikari.pool.HikariProxyConnection 0x545bde35 HikariProxyConnection@1415306805 wrapping org.postgresql.jdbc.PgConnection@2bfe7fef], :level 1, :rollback #object[clojure.lang.Atom 0x1e2dcd1 {:status :ready, :val false}]}, :content-length 1850, :form-params {}, :websocket? false, :query-params {}, :content-type multipart/form-data; boundary=----WebKitFormBoundaryCpWSZciBVMXEeyv2, :form-params-raw {}, :character-encoding utf8, :uri /procure/upload, :server-name localhost, :handler-key :upload, :query-string nil, :body #object[org.httpkit.BytesInputStream 0x6b9c5936 BytesInputStream[len=1850]], :graphql-schema #CompiledSchema<>, :handler #object[compojure.core$routes$fn__27950 0x36e85cd6 compojure.core$routes$fn__27950@36e85cd6], :multipart-params {files {:filename thx.png, :content-type image/png, :tempfile #object[java.io.File 0x348c3c0b /var/folders/jl/49spzkdd2v3cdz37fgmp0ddr6cj76v/T/ring-multipart-1889197302240827634.tmp], :size 1669}}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>> authorize::handler-key >> :upload
>myprint>  authEnt? {:email manuel.radl@zhdk.ch, :contracts_count 1, :lastname Radl, :org_id 271682, :scope_read true, :is_admin true, :authentication-method :session, :login mradl, :scope_system_admin_write true, :scope_write true, :firstname Manuel, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-12T11:17:19.570671Z", :id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :user_session_id #uuid "463ca0ef-36e9-430c-b982-23371c7fc689", :scope_system_admin_read true, :access-rights ({:role customer, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role customer, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role inventory_manager, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role inventory_manager, :inventory_pool_id #uuid "b534b07c-d9bf-4572-840c-0a630b8cd8ed"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "a786135f-c159-4618-9dd3-0012ebb3d500", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 9, :scope_admin_read true}
>myprint>  txn #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.pool.HikariProxyConnection 0x189e515a HikariProxyConnection@413028698 wrapping org.postgresql.jdbc.PgConnection@6f737354], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6a6239a1 next.jdbc.result_set$as_unqualified_lower_maps@6a6239a1]}}
2023-12-12T11:44:04.218Z NX-41294 DEBUG [leihs.procurement.permissions.user:?] - (sql-format (sql/select [[:exists (-> (sql/select [true :exists]) (sql/from :procurement_admins) (sql/where [:= :procurement_admins.user_id [:cast (:user_id auth-entity) :uuid]]))]])) => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:44:04.218Z NX-41294 DEBUG [leihs.procurement.permissions.user:38] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_admins WHERE procurement_admins.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> admin? {:exists true}
2023-12-12T11:44:04.219Z NX-41294 DEBUG [leihs.procurement.permissions.user:42] - (:exists result) => true
>myprint>  admin true
>o> inspector? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:44:04.220Z NX-41294 DEBUG [leihs.procurement.permissions.user:62] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_inspectors WHERE procurement_category_inspectors.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> inspector? {:result false}
>myprint>  inspector false
>o> viewer? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:44:04.225Z NX-41294 DEBUG [leihs.procurement.permissions.user:85] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_category_viewers WHERE procurement_category_viewers.user_id = CAST(? AS UUID)) AS result" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> viewer? {:result false}
>myprint>  viewer false
>o> requester?? [SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID)) #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
2023-12-12T11:44:04.226Z NX-41294 DEBUG [leihs.procurement.permissions.user:169] - query => ["SELECT EXISTS (SELECT TRUE AS exists FROM procurement_requesters_organizations WHERE procurement_requesters_organizations.user_id = CAST(? AS UUID))" #uuid "a786135f-c159-4618-9dd3-0012ebb3d500"]
>o> requester?? {:exists false}
2023-12-12T11:44:04.227Z NX-41294 DEBUG [leihs.procurement.permissions.user:173] - (:exists result) => false
>myprint>  requester false

> 1 anti-csrf-token >  219b97e6-bb13-401e-92a7-2304bf206106

> 1 anti-csrf-token class >  java.lang.String

> 2 anti-csrf-token-new >  nil
>o> m {:filename thx.png, :content-type image/png, :size 1669, :content iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAGTElEQVR4nO2d63HjNhDHkcw1wBZY
Qngl2CUoJUgF5INcgvUhBVglRCWcSghTgkoIS0iGM4AOhkEC+wAJUf/fjOZsHQHjsdhdLB40AAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGrll3u5/vlzrSI2xpjWGNMT
0rwEv49pB8Xy7Oy/46czxlzt/12J5VwaV17jlfkrv/1x/+obs4G6yHdt5nPhdz43Y8zFGHO2P4e8
G2P2Np+Qk/1wBaHx8g/xBW5s2LeKBKG1Zd5F+iDVnrMaoLEZd7YBYo1ekjfboY6xc46JvzdW9ndG
mcY6/iDUcRSy1wqE4GjbJYeTbdNPGuDXSMLGZvyvzXy3QueboMNfMjrf2LLmPOfTEDvfMNKMA+lv
Y8x/wecjMmpz+SB0vrHt8hF+GQpAaytGybgk754myoXyrGsYjoDnluvDfmKmzwnGnFmcypNaT/f3
PqXzBcBJNbUwpensyM6lJXYoJe+QlLY5ZnQUtd13zM7309/xBWAvUEcl4ZQptzFbYZ1TTm1uR435
/JUpuKra2ReAcGpVCyX9Dw2BnysfJf82Q2Binr6ImBNYE7XPu01CA1CnpCl/RKL6HZ/as2YBGOy0
pTafhMJ0MCbOnGP5oqSlL/4vvgBQC1uSMXDx/QFGfwpOm05pAer0NsYlbFM/EngWTIm4XO1Id6Hc
W2WCKOUSm3sncBHJg/dYqzD6h3sgyONb8MArIyhCoffCqLn2scaZic9cPQY7sKi2e28jdy58qzH6
T7FwcOgD9Fb1lhqFjTfqcyk5DdRYQIrG2D3OzHxdp+fMDlJcg7D6ndhi0M1qArcG0AUaoffU9g9i
QWobzUv4GL39UJ1ZpwWko38IzMkn5lYD+w04YbVwZvgCxvoCUtt/mNNStccBzINPAx0XprmRLsRd
wmlfiEQAluqY0rOSlA3XYEh1RKG/Oan6HRIB4HbMGkvLcywhAGbKCSvIIUfrrGECKJqjNmGRsGSM
45SrcWr3AR7B/lM0yBJm4EbRNhIBqD1Ak4t0VFIE4Ky4eXWKLNXvWMMHeHZK+gInqkBv1QTUbDpK
mYE+FutPUbsTyKVm7XQrJATJKV8MmIB1op3aAsA+p1B7IGirfsZFMf7QS/wKTAPXg7tK6DMwD8Lc
eYS1gNJIRqIkrYYARNf4KWzVCaSwlgAMQiEYNKaUEgHgLlNS7PpWgk1TSJxB6ompKLWbgK0LgNQR
FO/hfGYfYGw4t9V6qRXBEOluH/F2Mc79AI+Av4u28/5tFI6DafGidNDjKFlj4AqAxJHLbXzJVqiW
sV9xaTR2+hrPF2A5hFwTILE7W7frOeyVz2KyfQHEAWRwfIdGcfT7ebLMSc0C8AiagiMApY7hs7QA
VwCW6JwtrgO0BUa/o+HcHbCGD6CR/lEpffaSrF3WMgFbXuSZQmval4KkYWr2AWq9sYRLKdUfQtIC
a5mAZ0N72pciW9i4AvCMKpxLiWlfin1uH9UcCpZqmX5mtW2ITOE4kcOc8Otat6+921Pes6wlAF3G
9mWplnlb4CROKg6wxuh3uIWu2TZAJLAs7wJNpnGAJCl8XAHYmoduCmiLTjjtIx/yiJC8WaxWDbAF
J1Nyo6fbLqZximhWC9QqAI8+zdwJtaS7UELjosxZLYBI4E80D21K7/M9T/zMZfJ6mrUEoMYRrnVC
SDrtC0f95Ns+CLRTt6KvJQBr7cHTJlYP6bQvFrvQ0AIQgAKE9eiEo3/qrIDGvQKqAvAIHUhtMA0f
QOrbTI10lUMgMeHkCoB0fpqyt9L8B4ZN1xBqqW8zp+o1tMCX8nEFQCKNQ2YHS5wyjgBR08TKJz0r
OJdeqgWig0JiAriFyU0ncXy4aSnpYs4a9R5kR27nZt/+NZH2CxIn8I3R0JTo1plZWckiUO6LJ/uJ
umddzhhJ80rQHgeGdpwqr3gWcCDcS3NiNA61siehmrxl3LKVeuZC6NAb4wWUTmBy63m1z0fLq/Xu
4HYm/HlVuBHjmNhQeVVaPHG0E5sqrkRnzLVJ6+XV27aYHJXEcu4iN7q7ssZDyd6bQ2t4eTQFV9HO
29Sh+eLo58ATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA9WOM+R9FIkVy
7JSO3AAAAABJRU5ErkJggg==, :metadata :json, :exiftool_version 12.70, :exiftool_options -j -s -a -u -G1}
>o> :metadata :json
2023-12-12T11:44:04.362Z NX-41294 DEBUG [leihs.procurement.resources.upload:92] - m => {:filename "thx.png", :content-type "image/png", :size 1669, :content "iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAGTElEQVR4nO2d63HjNhDHkcw1wBZY\r\nQngl2CUoJUgF5INcgvUhBVglRCWcSghTgkoIS0iGM4AOhkEC+wAJUf/fjOZsHQHjsdhdLB40AAAA\r\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGrll3u5/vlzrSI2xpjWGNMT\r\n0rwEv49pB8Xy7Oy/46czxlzt/12J5VwaV17jlfkrv/1x/+obs4G6yHdt5nPhdz43Y8zFGHO2P4e8\r\nG2P2Np+Qk/1wBaHx8g/xBW5s2LeKBKG1Zd5F+iDVnrMaoLEZd7YBYo1ekjfboY6xc46JvzdW9ndG\r\nmcY6/iDUcRSy1wqE4GjbJYeTbdNPGuDXSMLGZvyvzXy3QueboMNfMjrf2LLmPOfTEDvfMNKMA+lv\r\nY8x/wecjMmpz+SB0vrHt8hF+GQpAaytGybgk754myoXyrGsYjoDnluvDfmKmzwnGnFmcypNaT/f3\r\nPqXzBcBJNbUwpensyM6lJXYoJe+QlLY5ZnQUtd13zM7309/xBWAvUEcl4ZQptzFbYZ1TTm1uR435\r\n/JUpuKra2ReAcGpVCyX9Dw2BnysfJf82Q2Binr6ImBNYE7XPu01CA1CnpCl/RKL6HZ/as2YBGOy0\r\npTafhMJ0MCbOnGP5oqSlL/4vvgBQC1uSMXDx/QFGfwpOm05pAer0NsYlbFM/EngWTIm4XO1Id6Hc\r\nW2WCKOUSm3sncBHJg/dYqzD6h3sgyONb8MArIyhCoffCqLn2scaZic9cPQY7sKi2e28jdy58qzH6\r\nT7FwcOgD9Fb1lhqFjTfqcyk5DdRYQIrG2D3OzHxdp+fMDlJcg7D6ndhi0M1qArcG0AUaoffU9g9i\r\nQWobzUv4GL39UJ1ZpwWko38IzMkn5lYD+w04YbVwZvgCxvoCUtt/mNNStccBzINPAx0XprmRLsRd\r\nwmlfiEQAluqY0rOSlA3XYEh1RKG/Oan6HRIB4HbMGkvLcywhAGbKCSvIIUfrrGECKJqjNmGRsGSM\r\n45SrcWr3AR7B/lM0yBJm4EbRNhIBqD1Ak4t0VFIE4Ky4eXWKLNXvWMMHeHZK+gInqkBv1QTUbDpK\r\nmYE+FutPUbsTyKVm7XQrJATJKV8MmIB1op3aAsA+p1B7IGirfsZFMf7QS/wKTAPXg7tK6DMwD8Lc\r\neYS1gNJIRqIkrYYARNf4KWzVCaSwlgAMQiEYNKaUEgHgLlNS7PpWgk1TSJxB6ompKLWbgK0LgNQR\r\nFO/hfGYfYGw4t9V6qRXBEOluH/F2Mc79AI+Av4u28/5tFI6DafGidNDjKFlj4AqAxJHLbXzJVqiW\r\nsV9xaTR2+hrPF2A5hFwTILE7W7frOeyVz2KyfQHEAWRwfIdGcfT7ebLMSc0C8AiagiMApY7hs7QA\r\nVwCW6JwtrgO0BUa/o+HcHbCGD6CR/lEpffaSrF3WMgFbXuSZQmval4KkYWr2AWq9sYRLKdUfQtIC\r\na5mAZ0N72pciW9i4AvCMKpxLiWlfin1uH9UcCpZqmX5mtW2ITOE4kcOc8Otat6+921Pes6wlAF3G\r\n9mWplnlb4CROKg6wxuh3uIWu2TZAJLAs7wJNpnGAJCl8XAHYmoduCmiLTjjtIx/yiJC8WaxWDbAF\r\nJ1Nyo6fbLqZximhWC9QqAI8+zdwJtaS7UELjosxZLYBI4E80D21K7/M9T/zMZfJ6mrUEoMYRrnVC\r\nSDrtC0f95Ns+CLRTt6KvJQBr7cHTJlYP6bQvFrvQ0AIQgAKE9eiEo3/qrIDGvQKqAvAIHUhtMA0f\r\nQOrbTI10lUMgMeHkCoB0fpqyt9L8B4ZN1xBqqW8zp+o1tMCX8nEFQCKNQ2YHS5wyjgBR08TKJz0r\r\nOJdeqgWig0JiAriFyU0ncXy4aSnpYs4a9R5kR27nZt/+NZH2CxIn8I3R0JTo1plZWckiUO6LJ/uJ\r\numddzhhJ80rQHgeGdpwqr3gWcCDcS3NiNA61siehmrxl3LKVeuZC6NAb4wWUTmBy63m1z0fLq/Xu\r\n4HYm/HlVuBHjmNhQeVVaPHG0E5sqrkRnzLVJ6+XV27aYHJXEcu4iN7q7ssZDyd6bQ2t4eTQFV9HO\r\n29Sh+eLo58ATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA9WOM+R9FIkVy\r\n7JSO3AAAAABJRU5ErkJggg==", :metadata :json, :exiftool_version "12.70", :exiftool_options "-j -s -a -u -G1"}
2023-12-12T11:44:04.362Z NX-41294 DEBUG [leihs.procurement.resources.upload:?] - (sql-format (sql/values (sql/insert-into :procurement_uploads) [(spy m)])) => ["INSERT INTO procurement_uploads (filename, content_type, size, content, metadata, exiftool_version, exiftool_options) VALUES (?, ?, ?, ?, json, ?, ?)" "thx.png" "image/png" 1669 "iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAGTElEQVR4nO2d63HjNhDHkcw1wBZY\r\nQngl2CUoJUgF5INcgvUhBVglRCWcSghTgkoIS0iGM4AOhkEC+wAJUf/fjOZsHQHjsdhdLB40AAAA\r\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGrll3u5/vlzrSI2xpjWGNMT\r\n0rwEv49pB8Xy7Oy/46czxlzt/12J5VwaV17jlfkrv/1x/+obs4G6yHdt5nPhdz43Y8zFGHO2P4e8\r\nG2P2Np+Qk/1wBaHx8g/xBW5s2LeKBKG1Zd5F+iDVnrMaoLEZd7YBYo1ekjfboY6xc46JvzdW9ndG\r\nmcY6/iDUcRSy1wqE4GjbJYeTbdNPGuDXSMLGZvyvzXy3QueboMNfMjrf2LLmPOfTEDvfMNKMA+lv\r\nY8x/wecjMmpz+SB0vrHt8hF+GQpAaytGybgk754myoXyrGsYjoDnluvDfmKmzwnGnFmcypNaT/f3\r\nPqXzBcBJNbUwpensyM6lJXYoJe+QlLY5ZnQUtd13zM7309/xBWAvUEcl4ZQptzFbYZ1TTm1uR435\r\n/JUpuKra2ReAcGpVCyX9Dw2BnysfJf82Q2Binr6ImBNYE7XPu01CA1CnpCl/RKL6HZ/as2YBGOy0\r\npTafhMJ0MCbOnGP5oqSlL/4vvgBQC1uSMXDx/QFGfwpOm05pAer0NsYlbFM/EngWTIm4XO1Id6Hc\r\nW2WCKOUSm3sncBHJg/dYqzD6h3sgyONb8MArIyhCoffCqLn2scaZic9cPQY7sKi2e28jdy58qzH6\r\nT7FwcOgD9Fb1lhqFjTfqcyk5DdRYQIrG2D3OzHxdp+fMDlJcg7D6ndhi0M1qArcG0AUaoffU9g9i\r\nQWobzUv4GL39UJ1ZpwWko38IzMkn5lYD+w04YbVwZvgCxvoCUtt/mNNStccBzINPAx0XprmRLsRd\r\nwmlfiEQAluqY0rOSlA3XYEh1RKG/Oan6HRIB4HbMGkvLcywhAGbKCSvIIUfrrGECKJqjNmGRsGSM\r\n45SrcWr3AR7B/lM0yBJm4EbRNhIBqD1Ak4t0VFIE4Ky4eXWKLNXvWMMHeHZK+gInqkBv1QTUbDpK\r\nmYE+FutPUbsTyKVm7XQrJATJKV8MmIB1op3aAsA+p1B7IGirfsZFMf7QS/wKTAPXg7tK6DMwD8Lc\r\neYS1gNJIRqIkrYYARNf4KWzVCaSwlgAMQiEYNKaUEgHgLlNS7PpWgk1TSJxB6ompKLWbgK0LgNQR\r\nFO/hfGYfYGw4t9V6qRXBEOluH/F2Mc79AI+Av4u28/5tFI6DafGidNDjKFlj4AqAxJHLbXzJVqiW\r\nsV9xaTR2+hrPF2A5hFwTILE7W7frOeyVz2KyfQHEAWRwfIdGcfT7ebLMSc0C8AiagiMApY7hs7QA\r\nVwCW6JwtrgO0BUa/o+HcHbCGD6CR/lEpffaSrF3WMgFbXuSZQmval4KkYWr2AWq9sYRLKdUfQtIC\r\na5mAZ0N72pciW9i4AvCMKpxLiWlfin1uH9UcCpZqmX5mtW2ITOE4kcOc8Otat6+921Pes6wlAF3G\r\n9mWplnlb4CROKg6wxuh3uIWu2TZAJLAs7wJNpnGAJCl8XAHYmoduCmiLTjjtIx/yiJC8WaxWDbAF\r\nJ1Nyo6fbLqZximhWC9QqAI8+zdwJtaS7UELjosxZLYBI4E80D21K7/M9T/zMZfJ6mrUEoMYRrnVC\r\nSDrtC0f95Ns+CLRTt6KvJQBr7cHTJlYP6bQvFrvQ0AIQgAKE9eiEo3/qrIDGvQKqAvAIHUhtMA0f\r\nQOrbTI10lUMgMeHkCoB0fpqyt9L8B4ZN1xBqqW8zp+o1tMCX8nEFQCKNQ2YHS5wyjgBR08TKJz0r\r\nOJdeqgWig0JiAriFyU0ncXy4aSnpYs4a9R5kR27nZt/+NZH2CxIn8I3R0JTo1plZWckiUO6LJ/uJ\r\numddzhhJ80rQHgeGdpwqr3gWcCDcS3NiNA61siehmrxl3LKVeuZC6NAb4wWUTmBy63m1z0fLq/Xu\r\n4HYm/HlVuBHjmNhQeVVaPHG0E5sqrkRnzLVJ6+XV27aYHJXEcu4iN7q7ssZDyd6bQ2t4eTQFV9HO\r\n29Sh+eLo58ATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA9WOM+R9FIkVy\r\n7JSO3AAAAABJRU5ErkJggg==" "12.70" "-j -s -a -u -G1"]
2023-12-12T11:44:04.363Z NX-41294 WARN [leihs.core.db:205] - Rolling back transaction because of  ERROR: column "json" does not exist
  Position: 143
2023-12-12T11:44:04.365Z NX-41294 WARN [leihs.procurement.utils.ring-exception:326] -   THROWABLE: org.postgresql.util.PSQLException: ERROR: column "json" does not exist
  Position: 143
2023-12-12T11:44:04.365Z NX-41294 DEBUG [leihs.procurement.utils.ring-exception:326] - #error {
 :cause ERROR: column "json" does not exist
  Position: 143
 :via
 [{:type org.postgresql.util.PSQLException
   :message ERROR: column "json" does not exist
  Position: 143
   :at [org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse QueryExecutorImpl.java 2533]}]
 :trace
 [[org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse QueryExecutorImpl.java 2533]
  [org.postgresql.core.v3.QueryExecutorImpl processResults QueryExecutorImpl.java 2268]
  [org.postgresql.core.v3.QueryExecutorImpl execute QueryExecutorImpl.java 313]
  [org.postgresql.jdbc.PgStatement executeInternal PgStatement.java 448]
  [org.postgresql.jdbc.PgStatement execute PgStatement.java 369]
  [org.postgresql.jdbc.PgPreparedStatement executeWithFlags PgPreparedStatement.java 159]
  [org.postgresql.jdbc.PgPreparedStatement execute PgPreparedStatement.java 148]
  [com.zaxxer.hikari.pool.ProxyPreparedStatement execute ProxyPreparedStatement.java 44]
  [com.zaxxer.hikari.pool.HikariProxyPreparedStatement execute HikariProxyPreparedStatement.java -1]
  [next.jdbc.result_set$stmt__GT_result_set invokeStatic result_set.clj 669]
  [next.jdbc.result_set$stmt__GT_result_set invoke result_set.clj 664]
  [next.jdbc.result_set$eval11828$fn__11836 invoke result_set.clj 897]
  [next.jdbc.protocols$eval10723$fn__10754$G__10714__10763 invoke protocols.clj 34]
  [next.jdbc.default_options$eval11019$fn__11024 invoke default_options.clj 31]
  [next.jdbc.protocols$eval10723$fn__10754$G__10714__10763 invoke protocols.clj 34]
  [next.jdbc$execute_BANG_ invokeStatic jdbc.clj 251]
  [next.jdbc$execute_BANG_ invoke jdbc.clj 238]
  [leihs.procurement.resources.upload$insert_file_upload_BANG_ invokeStatic upload.clj 90]
  [leihs.procurement.resources.upload$insert_file_upload_BANG_ invoke upload.clj 81]
  [leihs.procurement.resources.upload$upload invokeStatic upload.clj 138]
  [leihs.procurement.resources.upload$upload invoke upload.clj 131]
  [compojure.response$eval26095$fn__26096 invoke response.clj 47]
  [compojure.response$eval26017$fn__26018$G__26008__26025 invoke response.clj 7]
  [compojure.response$eval26103$fn__26104 invoke response.clj 51]
  [compojure.response$eval26017$fn__26018$G__26008__26025 invoke response.clj 7]
  [compojure.core$wrap_response$fn__27938 invoke core.clj 158]
  [compojure.core$wrap_route_middleware$fn__27922 invoke core.clj 128]
  [compojure.core$wrap_route_info$fn__27927 invoke core.clj 137]
  [compojure.core$wrap_route_matches$fn__27931 invoke core.clj 146]
  [compojure.core$routing$fn__27946 invoke core.clj 185]
  [clojure.core$some invokeStatic core.clj 2705]
  [clojure.core$some invoke core.clj 2696]
  [compojure.core$routing invokeStatic core.clj 185]
  [compojure.core$routing doInvoke core.clj 182]
  [clojure.lang.RestFn applyTo RestFn.java 139]
  [clojure.core$apply invokeStatic core.clj 669]
  [clojure.core$apply invoke core.clj 662]
  [compojure.core$routes$fn__27950 invoke core.clj 192]
  [leihs.procurement.routes$dispatch_to_handler invokeStatic routes.clj 65]
  [leihs.procurement.routes$dispatch_to_handler invoke routes.clj 62]
  [leihs.core.anti_csrf.back$wrap$fn__45107 invoke back.clj 95]
  [leihs.core.locale$wrap$fn__45159 invoke locale.clj 140]
  [leihs.procurement.authorization$authorize invokeStatic authorization.clj 147]
  [leihs.procurement.authorization$authorize invoke authorization.clj 115]
  [leihs.procurement.authorization$wrap_authorize$fn__39368 invoke authorization.clj 156]
  [leihs.procurement.authorization$authenticate invokeStatic authorization.clj 92]
  [leihs.procurement.authorization$authenticate invoke authorization.clj 85]
  [leihs.procurement.authorization$wrap_authenticate$fn__39360 invoke authorization.clj 111]
  [leihs.core.auth.session$wrap_authenticate$fn__38138 invoke session.clj 93]
  [ring.middleware.cookies$wrap_cookies$fn__48441 invoke cookies.clj 214]
  [leihs.core.settings$wrap invokeStatic settings.clj 47]
  [leihs.core.settings$wrap invoke settings.clj 42]
  [leihs.core.settings$wrap$fn__46230 invoke settings.clj 45]
  [leihs.core.status$wrap$fn__28078 invoke status.clj 78]
  [leihs.core.db$wrap_tx$fn__25321$fn__25322$fn__25323 invoke db.clj 191]
  [next.jdbc.transaction$transact_STAR_ invokeStatic transaction.clj 72]
  [next.jdbc.transaction$transact_STAR_ invoke transaction.clj 51]
  [next.jdbc.transaction$eval12027$fn__12028 invoke transaction.clj 141]
  [next.jdbc.protocols$eval10813$fn__10814$G__10804__10823 invoke protocols.clj 58]
  [next.jdbc.default_options$eval11031$fn__11032 invoke default_options.clj 43]
  [next.jdbc.protocols$eval10813$fn__10814$G__10804__10823 invoke protocols.clj 58]
  [next.jdbc$transact invokeStatic jdbc.clj 420]
  [next.jdbc$transact invoke jdbc.clj 412]
  [leihs.core.db$wrap_tx$fn__25321$fn__25322 invoke db.clj 187]
  [clojure.java.jdbc$db_transaction_STAR_ invokeStatic jdbc.clj 807]
  [clojure.java.jdbc$db_transaction_STAR_ invoke jdbc.clj 776]
  [clojure.java.jdbc$db_transaction_STAR_ invokeStatic jdbc.clj 852]
  [clojure.java.jdbc$db_transaction_STAR_ invoke jdbc.clj 776]
  [clojure.java.jdbc$db_transaction_STAR_ invokeStatic jdbc.clj 789]
  [clojure.java.jdbc$db_transaction_STAR_ invoke jdbc.clj 776]
  [leihs.core.db$wrap_tx$fn__25321 invoke db.clj 186]
  [ring.middleware.json$wrap_json_response$fn__48607 invoke json.clj 143]
  [ring.middleware.json$wrap_json_body$fn__48556 invoke json.clj 60]
  [leihs.procurement.routes$wrap_empty$fn__49352 invoke routes.clj 97]
  [leihs.core.graphql$wrap_with_schema$fn__17899 invoke graphql.clj 80]
  [leihs.core.routing.back$wrap_canonicalize_params_maps$fn__47806 invoke back.clj 74]
  [ring.middleware.params$wrap_params$fn__48772 invoke params.clj 75]
  [ring.middleware.multipart_params$handle_request_and_errors$fn__48729$fn__48730 invoke multipart_params.clj 135]
  [ring.middleware.multipart_params$handle_request_and_errors invokeStatic multipart_params.clj 133]
  [ring.middleware.multipart_params$handle_request_and_errors invoke multipart_params.clj 132]
  [ring.middleware.multipart_params$wrap_multipart_params$fn__48735 invoke multipart_params.clj 187]
  [leihs.core.http_cache_buster2$wrap_resource$fn__45528 invoke http_cache_buster2.clj 117]
  [leihs.procurement.routes$wrap_rewrite_uri_for_static_paths$fn__49359 invoke routes.clj 116]
  [leihs.procurement.routes$wrap_resolve_handler invokeStatic routes.clj 90]
  [leihs.procurement.routes$wrap_resolve_handler invoke routes.clj 82]
  [leihs.procurement.routes$wrap_resolve_handler$fn__49347 invoke routes.clj 83]
  [ring.middleware.accept$wrap_accept$fn__48242 invoke accept.clj 125]
  [ring.middleware.content_type$wrap_content_type$fn__47496 invoke content_type.clj 34]
  [leihs.procurement.utils.ring_exception$wrap$fn__45335 invoke ring_exception.clj 22]
  [org.httpkit.server.HttpHandler run RingHandler.java 123]
  [java.util.concurrent.Executors$RunnableAdapter call Executors.java 515]
  [java.util.concurrent.FutureTask run FutureTask.java 264]
  [java.util.concurrent.ThreadPoolExecutor runWorker ThreadPoolExecutor.java 1128]
  [java.util.concurrent.ThreadPoolExecutor$Worker run ThreadPoolExecutor.java 628]
  [java.lang.Thread run Thread.java 829]]}
error #error {
 :cause ERROR: column "json" does not exist
  Position: 143
 :via
 [{:type org.postgresql.util.PSQLException
   :message ERROR: column "json" does not exist
  Position: 143
   :at [org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse QueryExecutorImpl.java 2533]}]
 :trace
 [[org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse QueryExecutorImpl.java 2533]
  [org.postgresql.core.v3.QueryExecutorImpl processResults QueryExecutorImpl.java 2268]
  [org.postgresql.core.v3.QueryExecutorImpl execute QueryExecutorImpl.java 313]
  [org.postgresql.jdbc.PgStatement executeInternal PgStatement.java 448]
  [org.postgresql.jdbc.PgStatement execute PgStatement.java 369]
  [org.postgresql.jdbc.PgPreparedStatement executeWithFlags PgPreparedStatement.java 159]
  [org.postgresql.jdbc.PgPreparedStatement execute PgPreparedStatement.java 148]
  [com.zaxxer.hikari.pool.ProxyPreparedStatement execute ProxyPreparedStatement.java 44]
  [com.zaxxer.hikari.pool.HikariProxyPreparedStatement execute HikariProxyPreparedStatement.java -1]
  [next.jdbc.result_set$stmt__GT_result_set invokeStatic result_set.clj 669]
  [next.jdbc.result_set$stmt__GT_result_set invoke result_set.clj 664]
  [next.jdbc.result_set$eval11828$fn__11836 invoke result_set.clj 897]
  [next.jdbc.protocols$eval10723$fn__10754$G__10714__10763 invoke protocols.clj 34]
  [next.jdbc.default_options$eval11019$fn__11024 invoke default_options.clj 31]
  [next.jdbc.protocols$eval10723$fn__10754$G__10714__10763 invoke protocols.clj 34]
  [next.jdbc$execute_BANG_ invokeStatic jdbc.clj 251]
  [next.jdbc$execute_BANG_ invoke jdbc.clj 238]
  [leihs.procurement.resources.upload$insert_file_upload_BANG_ invokeStatic upload.clj 90]
  [leihs.procurement.resources.upload$insert_file_upload_BANG_ invoke upload.clj 81]
  [leihs.procurement.resources.upload$upload invokeStatic upload.clj 138]
  [leihs.procurement.resources.upload$upload invoke upload.clj 131]
  [compojure.response$eval26095$fn__26096 invoke response.clj 47]
  [compojure.response$eval26017$fn__26018$G__26008__26025 invoke response.clj 7]
  [compojure.response$eval26103$fn__26104 invoke response.clj 51]
  [compojure.response$eval26017$fn__26018$G__26008__26025 invoke response.clj 7]
  [compojure.core$wrap_response$fn__27938 invoke core.clj 158]
  [compojure.core$wrap_route_middleware$fn__27922 invoke core.clj 128]
  [compojure.core$wrap_route_info$fn__27927 invoke core.clj 137]
  [compojure.core$wrap_route_matches$fn__27931 invoke core.clj 146]
  [compojure.core$routing$fn__27946 invoke core.clj 185]
  [clojure.core$some invokeStatic core.clj 2705]
  [clojure.core$some invoke core.clj 2696]
  [compojure.core$routing invokeStatic core.clj 185]
  [compojure.core$routing doInvoke core.clj 182]
  [clojure.lang.RestFn applyTo RestFn.java 139]
  [clojure.core$apply invokeStatic core.clj 669]
  [clojure.core$apply invoke core.clj 662]
  [compojure.core$routes$fn__27950 invoke core.clj 192]
  [leihs.procurement.routes$dispatch_to_handler invokeStatic routes.clj 65]
  [leihs.procurement.routes$dispatch_to_handler invoke routes.clj 62]
  [leihs.core.anti_csrf.back$wrap$fn__45107 invoke back.clj 95]
  [leihs.core.locale$wrap$fn__45159 invoke locale.clj 140]
  [leihs.procurement.authorization$authorize invokeStatic authorization.clj 147]
  [leihs.procurement.authorization$authorize invoke authorization.clj 115]
  [leihs.procurement.authorization$wrap_authorize$fn__39368 invoke authorization.clj 156]
  [leihs.procurement.authorization$authenticate invokeStatic authorization.clj 92]
  [leihs.procurement.authorization$authenticate invoke authorization.clj 85]
  [leihs.procurement.authorization$wrap_authenticate$fn__39360 invoke authorization.clj 111]
  [leihs.core.auth.session$wrap_authenticate$fn__38138 invoke session.clj 93]
  [ring.middleware.cookies$wrap_cookies$fn__48441 invoke cookies.clj 214]
  [leihs.core.settings$wrap invokeStatic settings.clj 47]
  [leihs.core.settings$wrap invoke settings.clj 42]
  [leihs.core.settings$wrap$fn__46230 invoke settings.clj 45]
  [leihs.core.status$wrap$fn__28078 invoke status.clj 78]
  [leihs.core.db$wrap_tx$fn__25321$fn__25322$fn__25323 invoke db.clj 191]
  [next.jdbc.transaction$transact_STAR_ invokeStatic transaction.clj 72]
  [next.jdbc.transaction$transact_STAR_ invoke transaction.clj 51]
  [next.jdbc.transaction$eval12027$fn__12028 invoke transaction.clj 141]
  [next.jdbc.protocols$eval10813$fn__10814$G__10804__10823 invoke protocols.clj 58]
  [next.jdbc.default_options$eval11031$fn__11032 invoke default_options.clj 43]
  [next.jdbc.protocols$eval10813$fn__10814$G__10804__10823 invoke protocols.clj 58]
  [next.jdbc$transact invokeStatic jdbc.clj 420]
  [next.jdbc$transact invoke jdbc.clj 412]
  [leihs.core.db$wrap_tx$fn__25321$fn__25322 invoke db.clj 187]
  [clojure.java.jdbc$db_transaction_STAR_ invokeStatic jdbc.clj 807]
  [clojure.java.jdbc$db_transaction_STAR_ invoke jdbc.clj 776]
  [clojure.java.jdbc$db_transaction_STAR_ invokeStatic jdbc.clj 852]
  [clojure.java.jdbc$db_transaction_STAR_ invoke jdbc.clj 776]
  [clojure.java.jdbc$db_transaction_STAR_ invokeStatic jdbc.clj 789]
  [clojure.java.jdbc$db_transaction_STAR_ invoke jdbc.clj 776]
  [leihs.core.db$wrap_tx$fn__25321 invoke db.clj 186]
  [ring.middleware.json$wrap_json_response$fn__48607 invoke json.clj 143]
  [ring.middleware.json$wrap_json_body$fn__48556 invoke json.clj 60]
  [leihs.procurement.routes$wrap_empty$fn__49352 invoke routes.clj 97]
  [leihs.core.graphql$wrap_with_schema$fn__17899 invoke graphql.clj 80]
  [leihs.core.routing.back$wrap_canonicalize_params_maps$fn__47806 invoke back.clj 74]
  [ring.middleware.params$wrap_params$fn__48772 invoke params.clj 75]
  [ring.middleware.multipart_params$handle_request_and_errors$fn__48729$fn__48730 invoke multipart_params.clj 135]
  [ring.middleware.multipart_params$handle_request_and_errors invokeStatic multipart_params.clj 133]
  [ring.middleware.multipart_params$handle_request_and_errors invoke multipart_params.clj 132]
  [ring.middleware.multipart_params$wrap_multipart_params$fn__48735 invoke multipart_params.clj 187]
  [leihs.core.http_cache_buster2$wrap_resource$fn__45528 invoke http_cache_buster2.clj 117]
  [leihs.procurement.routes$wrap_rewrite_uri_for_static_paths$fn__49359 invoke routes.clj 116]
  [leihs.procurement.routes$wrap_resolve_handler invokeStatic routes.clj 90]
  [leihs.procurement.routes$wrap_resolve_handler invoke routes.clj 82]
  [leihs.procurement.routes$wrap_resolve_handler$fn__49347 invoke routes.clj 83]
  [ring.middleware.accept$wrap_accept$fn__48242 invoke accept.clj 125]
  [ring.middleware.content_type$wrap_content_type$fn__47496 invoke content_type.clj 34]
  [leihs.procurement.utils.ring_exception$wrap$fn__45335 invoke ring_exception.clj 22]
  [org.httpkit.server.HttpHandler run RingHandler.java 123]
  [java.util.concurrent.Executors$RunnableAdapter call Executors.java 515]
  [java.util.concurrent.FutureTask run FutureTask.java 264]
  [java.util.concurrent.ThreadPoolExecutor runWorker ThreadPoolExecutor.java 1128]
  [java.util.concurrent.ThreadPoolExecutor$Worker run ThreadPoolExecutor.java 628]
  [java.lang.Thread run Thread.java 829]]}
error2 #error {
 :cause ERROR: column "json" does not exist
  Position: 143
 :via
 [{:type org.postgresql.util.PSQLException
   :message ERROR: column "json" does not exist
  Position: 143
   :at [org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse QueryExecutorImpl.java 2533]}]
 :trace
 [[org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse QueryExecutorImpl.java 2533]
  [org.postgresql.core.v3.QueryExecutorImpl processResults QueryExecutorImpl.java 2268]
  [org.postgresql.core.v3.QueryExecutorImpl execute QueryExecutorImpl.java 313]
  [org.postgresql.jdbc.PgStatement executeInternal PgStatement.java 448]
  [org.postgresql.jdbc.PgStatement execute PgStatement.java 369]
  [org.postgresql.jdbc.PgPreparedStatement executeWithFlags PgPreparedStatement.java 159]
  [org.postgresql.jdbc.PgPreparedStatement execute PgPreparedStatement.java 148]
  [com.zaxxer.hikari.pool.ProxyPreparedStatement execute ProxyPreparedStatement.java 44]
  [com.zaxxer.hikari.pool.HikariProxyPreparedStatement execute HikariProxyPreparedStatement.java -1]
  [next.jdbc.result_set$stmt__GT_result_set invokeStatic result_set.clj 669]
  [next.jdbc.result_set$stmt__GT_result_set invoke result_set.clj 664]
  [next.jdbc.result_set$eval11828$fn__11836 invoke result_set.clj 897]
  [next.jdbc.protocols$eval10723$fn__10754$G__10714__10763 invoke protocols.clj 34]
  [next.jdbc.default_options$eval11019$fn__11024 invoke default_options.clj 31]
  [next.jdbc.protocols$eval10723$fn__10754$G__10714__10763 invoke protocols.clj 34]
  [next.jdbc$execute_BANG_ invokeStatic jdbc.clj 251]
  [next.jdbc$execute_BANG_ invoke jdbc.clj 238]
  [leihs.procurement.resources.upload$insert_file_upload_BANG_ invokeStatic upload.clj 90]
  [leihs.procurement.resources.upload$insert_file_upload_BANG_ invoke upload.clj 81]
  [leihs.procurement.resources.upload$upload invokeStatic upload.clj 138]
  [leihs.procurement.resources.upload$upload invoke upload.clj 131]
  [compojure.response$eval26095$fn__26096 invoke response.clj 47]
  [compojure.response$eval26017$fn__26018$G__26008__26025 invoke response.clj 7]
  [compojure.response$eval26103$fn__26104 invoke response.clj 51]
  [compojure.response$eval26017$fn__26018$G__26008__26025 invoke response.clj 7]
  [compojure.core$wrap_response$fn__27938 invoke core.clj 158]
  [compojure.core$wrap_route_middleware$fn__27922 invoke core.clj 128]
  [compojure.core$wrap_route_info$fn__27927 invoke core.clj 137]
  [compojure.core$wrap_route_matches$fn__27931 invoke core.clj 146]
  [compojure.core$routing$fn__27946 invoke core.clj 185]
  [clojure.core$some invokeStatic core.clj 2705]
  [clojure.core$some invoke core.clj 2696]
  [compojure.core$routing invokeStatic core.clj 185]
  [compojure.core$routing doInvoke core.clj 182]
  [clojure.lang.RestFn applyTo RestFn.java 139]
  [clojure.core$apply invokeStatic core.clj 669]
  [clojure.core$apply invoke core.clj 662]
  [compojure.core$routes$fn__27950 invoke core.clj 192]
  [leihs.procurement.routes$dispatch_to_handler invokeStatic routes.clj 65]
  [leihs.procurement.routes$dispatch_to_handler invoke routes.clj 62]
  [leihs.core.anti_csrf.back$wrap$fn__45107 invoke back.clj 95]
  [leihs.core.locale$wrap$fn__45159 invoke locale.clj 140]
  [leihs.procurement.authorization$authorize invokeStatic authorization.clj 147]
  [leihs.procurement.authorization$authorize invoke authorization.clj 115]
  [leihs.procurement.authorization$wrap_authorize$fn__39368 invoke authorization.clj 156]
  [leihs.procurement.authorization$authenticate invokeStatic authorization.clj 92]
  [leihs.procurement.authorization$authenticate invoke authorization.clj 85]
  [leihs.procurement.authorization$wrap_authenticate$fn__39360 invoke authorization.clj 111]
  [leihs.core.auth.session$wrap_authenticate$fn__38138 invoke session.clj 93]
  [ring.middleware.cookies$wrap_cookies$fn__48441 invoke cookies.clj 214]
  [leihs.core.settings$wrap invokeStatic settings.clj 47]
  [leihs.core.settings$wrap invoke settings.clj 42]
  [leihs.core.settings$wrap$fn__46230 invoke settings.clj 45]
  [leihs.core.status$wrap$fn__28078 invoke status.clj 78]
  [leihs.core.db$wrap_tx$fn__25321$fn__25322$fn__25323 invoke db.clj 191]
  [next.jdbc.transaction$transact_STAR_ invokeStatic transaction.clj 72]
  [next.jdbc.transaction$transact_STAR_ invoke transaction.clj 51]
  [next.jdbc.transaction$eval12027$fn__12028 invoke transaction.clj 141]
  [next.jdbc.protocols$eval10813$fn__10814$G__10804__10823 invoke protocols.clj 58]
  [next.jdbc.default_options$eval11031$fn__11032 invoke default_options.clj 43]
  [next.jdbc.protocols$eval10813$fn__10814$G__10804__10823 invoke protocols.clj 58]
  [next.jdbc$transact invokeStatic jdbc.clj 420]
  [next.jdbc$transact invoke jdbc.clj 412]
  [leihs.core.db$wrap_tx$fn__25321$fn__25322 invoke db.clj 187]
  [clojure.java.jdbc$db_transaction_STAR_ invokeStatic jdbc.clj 807]
  [clojure.java.jdbc$db_transaction_STAR_ invoke jdbc.clj 776]
  [clojure.java.jdbc$db_transaction_STAR_ invokeStatic jdbc.clj 852]
  [clojure.java.jdbc$db_transaction_STAR_ invoke jdbc.clj 776]
  [clojure.java.jdbc$db_transaction_STAR_ invokeStatic jdbc.clj 789]
  [clojure.java.jdbc$db_transaction_STAR_ invoke jdbc.clj 776]
  [leihs.core.db$wrap_tx$fn__25321 invoke db.clj 186]
  [ring.middleware.json$wrap_json_response$fn__48607 invoke json.clj 143]
  [ring.middleware.json$wrap_json_body$fn__48556 invoke json.clj 60]
  [leihs.procurement.routes$wrap_empty$fn__49352 invoke routes.clj 97]
  [leihs.core.graphql$wrap_with_schema$fn__17899 invoke graphql.clj 80]
  [leihs.core.routing.back$wrap_canonicalize_params_maps$fn__47806 invoke back.clj 74]
  [ring.middleware.params$wrap_params$fn__48772 invoke params.clj 75]
  [ring.middleware.multipart_params$handle_request_and_errors$fn__48729$fn__48730 invoke multipart_params.clj 135]
  [ring.middleware.multipart_params$handle_request_and_errors invokeStatic multipart_params.clj 133]
  [ring.middleware.multipart_params$handle_request_and_errors invoke multipart_params.clj 132]
  [ring.middleware.multipart_params$wrap_multipart_params$fn__48735 invoke multipart_params.clj 187]
  [leihs.core.http_cache_buster2$wrap_resource$fn__45528 invoke http_cache_buster2.clj 117]
  [leihs.procurement.routes$wrap_rewrite_uri_for_static_paths$fn__49359 invoke routes.clj 116]
  [leihs.procurement.routes$wrap_resolve_handler invokeStatic routes.clj 90]
  [leihs.procurement.routes$wrap_resolve_handler invoke routes.clj 82]
  [leihs.procurement.routes$wrap_resolve_handler$fn__49347 invoke routes.clj 83]
  [ring.middleware.accept$wrap_accept$fn__48242 invoke accept.clj 125]
  [ring.middleware.content_type$wrap_content_type$fn__47496 invoke content_type.clj 34]
  [leihs.procurement.utils.ring_exception$wrap$fn__45335 invoke ring_exception.clj 22]
  [org.httpkit.server.HttpHandler run RingHandler.java 123]
  [java.util.concurrent.Executors$RunnableAdapter call Executors.java 515]
  [java.util.concurrent.FutureTask run FutureTask.java 264]
  [java.util.concurrent.ThreadPoolExecutor runWorker ThreadPoolExecutor.java 1128]
  [java.util.concurrent.ThreadPoolExecutor$Worker run ThreadPoolExecutor.java 628]
  [java.lang.Thread run Thread.java 829]]}
