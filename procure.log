# java_leihs-procure-server env check via asdf v0.13.1
# java_leihs-procure-server env skipped update; touch .tool-versions or remove /var/folders/jl/49spzkdd2v3cdz37fgmp0ddr6cj76v/T/asdf_cache_java_leihs-procure-server to force update
# clojure_leihs-procure-server env check via asdf v0.13.1
# clojure_leihs-procure-server env skipped update; touch .tool-versions or remove /var/folders/jl/49spzkdd2v3cdz37fgmp0ddr6cj76v/T/asdf_cache_clojure_leihs-procure-server to force update
Warning: environ value /Users/mradl/.asdf/installs/java/zulu-11.60.19 for key :java-home has been overwritten with /Users/mradl/.asdf/installs/java/zulu-11.60.19/zulu-11.jdk/Contents/Home
>o> conc concat(lower(coalesce(procurement_requests.article_name, '')), lower(coalesce(models.product, '')), lower(coalesce(models.version, '')))
2023-12-01T18:32:34.991Z NX-41294 WARN [leihs.core.release:13] - Failed to read releases.yml, returning bogus value 
2023-12-01T18:32:35.569Z NX-41294 INFO [leihs.core.logging:37] - initializing logging  {:min-level [[#{"leihs.procurement" "leihs.procurement.resources.*" "leihs.procurement.permissions.*" "leihs.procurement.authorization" "leihs.procurement.*"} :debug] [#{"com.zaxxer.hikari.*" "leihs.*"} :info] [#{"*"} :warn]], :log-level nil}
2023-12-01T18:32:35.577Z NX-41294 INFO [leihs.core.logging:39] - initialized logging  {:min-level [[#{"leihs.procurement" "leihs.procurement.resources.*" "leihs.procurement.permissions.*" "leihs.procurement.authorization" "leihs.procurement.*"} :debug] [#{"com.zaxxer.hikari.*" "leihs.*"} :info] [#{"*"} :warn]], :ns-filter #{"*"}, :middleware [], :timestamp-opts {:pattern :iso8601, :locale :jvm-default, :timezone :utc}, :output-fn #object[taoensso.timbre$default_output_fn 0x5e868e3c "taoensso.timbre$default_output_fn@5e868e3c"], :appenders {:println {:enabled? true, :fn #object[taoensso.timbre.appenders.core$println_appender$fn__3459 0x5f416733 "taoensso.timbre.appenders.core$println_appender$fn__3459@5f416733"]}}, :_init-config {:loaded-from-source :default, :compile-time-config {:min-level nil, :ns-pattern "*"}}, :log-level nil}
2023-12-01T18:32:35.579Z NX-41294 INFO [leihs.procurement.main:50] - main ("--dev-mode" "true" "--repl" "true" "run" "--db-port" "5415" "--db-name" "leihs_test")
2023-12-01T18:32:35.592Z NX-41294 INFO [leihs.core.repl:62] - init {:dev-mode true, :repl true, :repl-bind "localhost", :repl-port 33481, :repl-port-file ".nrepl-port"}
2023-12-01T18:32:35.594Z NX-41294 INFO [leihs.core.repl:70] - starting nREPL server  33481 localhost
2023-12-01T18:32:35.615Z NX-41294 INFO [leihs.core.repl:75] - started nREPL server 
2023-12-01T18:32:35.619Z NX-41294 INFO [leihs.procurement.run:326] - Invoking run with options:  {:db-host localhost, :db-max-pool-size 16, :db-min-pool-size 2, :db-name leihs_test, :db-password leihs, :db-port 5415, :db-user leihs, :dev-mode true, :http-host localhost, :http-max-threads 8, :http-min-threads 1, :http-port 3230, :http-queue-capacity 640, :http-thread-keep-alive-seconds 10, :http-worker-prefix leihs-service-http-worker-, :pid-file nil, :repl true, :repl-bind localhost, :repl-port 33481, :repl-port-file .nrepl-port}
2023-12-01T18:32:35.620Z NX-41294 INFO [leihs.core.shutdown:20] - PID 88514
2023-12-01T18:32:35.642Z NX-41294 INFO [leihs.core.shutdown:29] - Registering SIGTERM handler for shutdown.
2023-12-01T18:32:35.702Z NX-41294 INFO [leihs.core.graphql:17] - Initialized graphQL schema.
2023-12-01T18:32:35.703Z NX-41294 INFO [leihs.core.db:220] - Initializing db  {:db-name "leihs_test", :db-port 5415, :db-host "localhost", :db-user "leihs", :db-password "leihs", :db-min-pool-size 2, :db-max-pool-size 16}
2023-12-01T18:32:35.709Z NX-41294 INFO [com.zaxxer.hikari.HikariDataSource:80] - db-pool - Starting...
2023-12-01T18:32:35.785Z NX-41294 INFO [com.zaxxer.hikari.pool.HikariPool:565] - db-pool - Added connection org.postgresql.jdbc.PgConnection@253bdf0e
2023-12-01T18:32:35.792Z NX-41294 INFO [com.zaxxer.hikari.HikariDataSource:82] - db-pool - Start completed.
2023-12-01T18:32:35.792Z NX-41294 INFO [leihs.core.db:222] - Initialized db  {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x5a68bf1d "HikariDataSource (db-pool)"]}
2023-12-01T18:32:35.793Z NX-41294 INFO [leihs.core.db:223] - Initializing ds-next  {:db-name "leihs_test", :db-port 5415, :db-host "localhost", :db-user "leihs", :db-password "leihs", :db-min-pool-size 2, :db-max-pool-size 16}
2023-12-01T18:32:35.807Z NX-41294 INFO [com.zaxxer.hikari.HikariDataSource:110] - HikariPool-1 - Starting...
2023-12-01T18:32:35.818Z NX-41294 INFO [com.zaxxer.hikari.pool.HikariPool:565] - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@6a0f0be3
2023-12-01T18:32:35.819Z NX-41294 INFO [com.zaxxer.hikari.HikariDataSource:123] - HikariPool-1 - Start completed.
2023-12-01T18:32:35.824Z NX-41294 INFO [leihs.core.db:225] - Initialized ds-next  #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x2309707f "HikariDataSource (HikariPool-1)"], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6e4670ef "next.jdbc.result_set$as_unqualified_lower_maps@6e4670ef"]}}
2023-12-01T18:32:35.830Z NX-41294 INFO [leihs.core.http-server:101] - starting http-server  {:port 3230, :ip "localhost", :pool {:queue #object[java.util.concurrent.ArrayBlockingQueue 0x3167f01e "[]"], :pool #object[java.util.concurrent.ThreadPoolExecutor 0x6ed0c6ca "java.util.concurrent.ThreadPoolExecutor@6ed0c6ca[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]"]}}
2023-12-01T18:32:35.841Z NX-41294 INFO [leihs.core.http-server:104] - started http-server 
>>> authenticate::skip= nil  handler-key= :graphql
>>> authenticate::authenticated-entity {:email urs.vanbinsbergen@zhdk.ch, :contracts_count 4, :lastname van Binsbergen, :org_id 244750, :scope_read true, :is_admin true, :authentication-method :session, :login uvanbins, :scope_system_admin_write true, :scope_write true, :firstname Urs, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role inventory_manager, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role inventory_manager, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role customer, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 8, :scope_admin_read true}

>> authorize >

>> authorize::handler > #object[leihs.core.locale$wrap$fn__44352 0x1edc471e leihs.core.locale$wrap$fn__44352@1edc471e]

>> authorize::request > {:authenticated-entity {:email urs.vanbinsbergen@zhdk.ch, :contracts_count 4, :lastname van Binsbergen, :org_id 244750, :scope_read true, :is_admin true, :authentication-method :session, :login uvanbins, :scope_system_admin_write true, :scope_write true, :firstname Urs, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role inventory_manager, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role inventory_manager, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role customer, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 8, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 6e1aae74-85d2-42a1-a803-d998943e2e69}, leihs-user-session {:value 883fc2af-3a55-41ff-b156-b0ce6d5ae1cc}}, :remote-addr 127.0.0.1, :start-time 218102923669916, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x2309707f HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6e4670ef next.jdbc.result_set$as_unqualified_lower_maps@6e4670ef]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type application/json, cookie leihs-anti-csrf-token=6e1aae74-85d2-42a1-a803-d998943e2e69; leihs-user-session=883fc2af-3a55-41ff-b156-b0ce6d5ae1cc, content-length 343, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/requests, connection keep-alive, pragma no-cache, x-csrf-token 6e1aae74-85d2-42a1-a803-d998943e2e69, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, postman-token 11a1670c-6f63-46b8-b215-2744b8947a7c, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x666f776b /127.0.0.1:3230<->/127.0.0.1:63745], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x5a68bf1d HikariDataSource (db-pool)]}, :content-length 343, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:query query RequestFilters ($id: [ID!]) {
    budget_periods (id: $id) {
      id
      cacheKey
      name
      inspection_start_date
      end_date
      total_price_cents


    }
    __typename
  }


, :operationName RequestsIndexFiltered, :variables {:id [8b8fe440-cae5-4bf9-8048-d0ec2399faa1]}}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0x2f0ad127 leihs.procurement.graphql$handler@2f0ad127], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>> authorize::handler-key >> :graphql
>myprint>  authEnt? {:email urs.vanbinsbergen@zhdk.ch, :contracts_count 4, :lastname van Binsbergen, :org_id 244750, :scope_read true, :is_admin true, :authentication-method :session, :login uvanbins, :scope_system_admin_write true, :scope_write true, :firstname Urs, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role inventory_manager, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role inventory_manager, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role customer, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 8, :scope_admin_read true}
>myprint>  txn {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x5a68bf1d HikariDataSource (db-pool)]}
2023-12-01T18:33:11.643Z NX-41294 DEBUG [leihs.procurement.permissions.user:24] - auth-entity => {:email "urs.vanbinsbergen@zhdk.ch", :contracts_count 4, :lastname "van Binsbergen", :org_id "244750", :scope_read true, :is_admin true, :authentication-method :session, :login "uvanbins", :scope_system_admin_write true, :scope_write true, :firstname "Urs", :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role "inventory_manager", :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role "customer", :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role "inventory_manager", :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role "customer", :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role "inventory_manager", :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role "customer", :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role "customer", :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role "customer", :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale "de-CH", :inventory_pool_roles_count 8, :scope_admin_read true}
2023-12-01T18:33:11.647Z NX-41294 DEBUG [leihs.procurement.permissions.user:25] - (-> (sql/select [true :has_entry]) (sql/from :procurement_admins) (sql/where [:= :user_id [:cast (:user_id auth-entity) :uuid]]) sql-format (->> (jdbc/execute-one! tx))) => {:has_entry true}
>myprint>  admin true
2023-12-01T18:33:11.651Z NX-41294 DEBUG [leihs.procurement.permissions.user:59] - query => ["SELECT TRUE AS has_entry FROM procurement_category_inspectors WHERE user_id IS NULL"]
>myprint>  inspector false
2023-12-01T18:33:11.654Z NX-41294 DEBUG [leihs.procurement.permissions.user:78] - query => ["SELECT TRUE AS has_entry FROM procurement_category_viewers WHERE user_id IS NULL"]
>myprint>  viewer false
2023-12-01T18:33:11.656Z NX-41294 DEBUG [leihs.procurement.permissions.user:86] - (-> (sql/select [true :has_entry]) (sql/from :procurement_requesters_organizations) (sql/where [:= :user_id [:cast (:user_id auth-entity) :uuid]]) sql-format) => ["SELECT TRUE AS has_entry FROM procurement_requesters_organizations WHERE user_id = CAST(? AS UUID)" #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7"]
>myprint>  requester false
2023-12-01T18:33:11.658Z NX-41294 DEBUG [leihs.procurement.permissions.user:24] - auth-entity => {:email "urs.vanbinsbergen@zhdk.ch", :contracts_count 4, :lastname "van Binsbergen", :org_id "244750", :scope_read true, :is_admin true, :authentication-method :session, :login "uvanbins", :scope_system_admin_write true, :scope_write true, :firstname "Urs", :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role "inventory_manager", :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role "customer", :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role "inventory_manager", :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role "customer", :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role "inventory_manager", :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role "customer", :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role "customer", :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role "customer", :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale "de-CH", :inventory_pool_roles_count 8, :scope_admin_read true}
2023-12-01T18:33:11.660Z NX-41294 DEBUG [leihs.procurement.permissions.user:25] - (-> (sql/select [true :has_entry]) (sql/from :procurement_admins) (sql/where [:= :user_id [:cast (:user_id auth-entity) :uuid]]) sql-format (->> (jdbc/execute-one! tx))) => {:has_entry true}
2023-12-01T18:33:11.661Z NX-41294 DEBUG [leihs.procurement.permissions.user:59] - query => ["SELECT TRUE AS has_entry FROM procurement_category_inspectors WHERE user_id IS NULL"]
2023-12-01T18:33:11.663Z NX-41294 DEBUG [leihs.procurement.permissions.user:78] - query => ["SELECT TRUE AS has_entry FROM procurement_category_viewers WHERE user_id IS NULL"]
2023-12-01T18:33:11.664Z NX-41294 DEBUG [leihs.procurement.permissions.user:86] - (-> (sql/select [true :has_entry]) (sql/from :procurement_requesters_organizations) (sql/where [:= :user_id [:cast (:user_id auth-entity) :uuid]]) sql-format) => ["SELECT TRUE AS has_entry FROM procurement_requesters_organizations WHERE user_id = CAST(? AS UUID)" #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7"]

> 1 anti-csrf-token >  6e1aae74-85d2-42a1-a803-d998943e2e69

> 1 anti-csrf-token class >  java.lang.String

> 2 anti-csrf-token-new >  nil
pure-handler >> 2
2023-12-01T18:33:11.672Z NX-41294 DEBUG [leihs.procurement.graphql:71] - graphql query query RequestFilters ($id: [ID!]) {
    budget_periods (id: $id) {
      id
      cacheKey
      name
      inspection_start_date
      end_date
      total_price_cents


    }
    __typename
  }


 with variables {:id ["8b8fe440-cae5-4bf9-8048-d0ec2399faa1"]}
>oo> vars from graphQL-Requst nil nil nil {:id [8b8fe440-cae5-4bf9-8048-d0ec2399faa1]}
>e> #error {
 :cause ERROR: syntax error at or near "uuid"
  Position: 81
 :via
 [{:type org.postgresql.util.PSQLException
   :message ERROR: syntax error at or near "uuid"
  Position: 81
   :at [org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse QueryExecutorImpl.java 2533]}]
 :trace
 [[org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse QueryExecutorImpl.java 2533]
  [org.postgresql.core.v3.QueryExecutorImpl processResults QueryExecutorImpl.java 2268]
  [org.postgresql.core.v3.QueryExecutorImpl execute QueryExecutorImpl.java 313]
  [org.postgresql.jdbc.PgStatement executeInternal PgStatement.java 448]
  [org.postgresql.jdbc.PgStatement execute PgStatement.java 369]
  [org.postgresql.jdbc.PgPreparedStatement executeWithFlags PgPreparedStatement.java 159]
  [org.postgresql.jdbc.PgPreparedStatement execute PgPreparedStatement.java 148]
  [com.zaxxer.hikari.pool.ProxyPreparedStatement execute ProxyPreparedStatement.java 44]
  [com.zaxxer.hikari.pool.HikariProxyPreparedStatement execute HikariProxyPreparedStatement.java -1]
  [next.jdbc.result_set$stmt__GT_result_set invokeStatic result_set.clj 669]
  [next.jdbc.result_set$stmt__GT_result_set invoke result_set.clj 664]
  [next.jdbc.result_set$eval11841$fn__11849 invoke result_set.clj 944]
  [next.jdbc.protocols$eval10723$fn__10754$G__10714__10763 invoke protocols.clj 34]
  [next.jdbc.default_options$eval11019$fn__11024 invoke default_options.clj 31]
  [next.jdbc.protocols$eval10723$fn__10754$G__10714__10763 invoke protocols.clj 34]
  [next.jdbc$execute_BANG_ invokeStatic jdbc.clj 251]
  [next.jdbc$execute_BANG_ invoke jdbc.clj 238]
  [leihs.procurement.resources.budget_periods$get_budget_periods invokeStatic budget_periods.clj 47]
  [leihs.procurement.resources.budget_periods$get_budget_periods invoke budget_periods.clj 34]
  [leihs.procurement.graphql.resolver$wrap_resolver_with_error$fn__44472 invoke resolver.clj 16]
  [com.walmartlabs.lacinia.schema$wrap_resolver_to_ensure_resolver_result$fn__14023 invoke schema.clj 986]
  [com.walmartlabs.lacinia.executor$invoke_resolver_for_field invokeStatic executor.clj 86]
  [com.walmartlabs.lacinia.executor$invoke_resolver_for_field invoke executor.clj 68]
  [com.walmartlabs.lacinia.executor$resolve_and_select invokeStatic executor.clj 353]
  [com.walmartlabs.lacinia.executor$resolve_and_select invoke executor.clj 234]
  [com.walmartlabs.lacinia.executor$apply_field_selection invokeStatic executor.clj 140]
  [com.walmartlabs.lacinia.executor$apply_field_selection invoke executor.clj 135]
  [com.walmartlabs.lacinia.executor$apply_selection invokeStatic executor.clj 173]
  [com.walmartlabs.lacinia.executor$apply_selection invoke executor.clj 165]
  [com.walmartlabs.lacinia.executor$execute_nested_selections$fn__17481 invoke executor.clj 197]
  [com.walmartlabs.lacinia.internal_utils$keepv$fn__12187 invoke internal_utils.clj 46]
  [clojure.lang.ArrayChunk reduce ArrayChunk.java 58]
  [clojure.core.protocols$fn__8176 invokeStatic protocols.clj 136]
  [clojure.core.protocols$fn__8176 invoke protocols.clj 124]
  [clojure.core.protocols$fn__8136$G__8131__8145 invoke protocols.clj 19]
  [clojure.core.protocols$seq_reduce invokeStatic protocols.clj 31]
  [clojure.core.protocols$fn__8168 invokeStatic protocols.clj 75]
  [clojure.core.protocols$fn__8168 invoke protocols.clj 75]
  [clojure.core.protocols$fn__8110$G__8105__8123 invoke protocols.clj 13]
  [clojure.core$reduce invokeStatic core.clj 6830]
  [clojure.core$reduce invoke core.clj 6812]
  [com.walmartlabs.lacinia.internal_utils$keepv invokeStatic internal_utils.clj 45]
  [com.walmartlabs.lacinia.internal_utils$keepv invoke internal_utils.clj 41]
  [com.walmartlabs.lacinia.executor$execute_nested_selections invokeStatic executor.clj 197]
  [com.walmartlabs.lacinia.executor$execute_nested_selections invoke executor.clj 190]
  [com.walmartlabs.lacinia.executor$execute_query$fn__17519 invoke executor.clj 400]
  [clojure.lang.AFn applyToHelper AFn.java 152]
  [clojure.lang.AFn applyTo AFn.java 144]
  [clojure.core$apply invokeStatic core.clj 667]
  [clojure.core$with_bindings_STAR_ invokeStatic core.clj 1977]
  [clojure.core$with_bindings_STAR_ doInvoke core.clj 1977]
  [clojure.lang.RestFn invoke RestFn.java 425]
  [clojure.lang.AFn applyToHelper AFn.java 156]
  [clojure.lang.RestFn applyTo RestFn.java 132]
  [clojure.core$apply invokeStatic core.clj 671]
  [clojure.core$bound_fn_STAR_$fn__5767 doInvoke core.clj 2007]
  [clojure.lang.RestFn invoke RestFn.java 397]
  [com.walmartlabs.lacinia.executor$execute_query$fn__17524 invoke executor.clj 421]
  [clojure.core$binding_conveyor_fn$fn__5772 invoke core.clj 2034]
  [clojure.lang.AFn call AFn.java 18]
  [java.util.concurrent.FutureTask run FutureTask.java 264]
  [java.util.concurrent.ThreadPoolExecutor runWorker ThreadPoolExecutor.java 1128]
  [java.util.concurrent.ThreadPoolExecutor$Worker run ThreadPoolExecutor.java 628]
  [java.lang.Thread run Thread.java 829]]}
2023-12-01T18:33:11.694Z NX-41294 WARN [leihs.procurement.graphql.resolver:326] - ERROR: syntax error at or near "uuid"
  Position: 81
2023-12-01T18:33:11.695Z NX-41294 DEBUG [leihs.procurement.graphql.resolver:326] - #error {
 :cause ERROR: syntax error at or near "uuid"
  Position: 81
 :via
 [{:type org.postgresql.util.PSQLException
   :message ERROR: syntax error at or near "uuid"
  Position: 81
   :at [org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse QueryExecutorImpl.java 2533]}]
 :trace
 [[org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse QueryExecutorImpl.java 2533]
  [org.postgresql.core.v3.QueryExecutorImpl processResults QueryExecutorImpl.java 2268]
  [org.postgresql.core.v3.QueryExecutorImpl execute QueryExecutorImpl.java 313]
  [org.postgresql.jdbc.PgStatement executeInternal PgStatement.java 448]
  [org.postgresql.jdbc.PgStatement execute PgStatement.java 369]
  [org.postgresql.jdbc.PgPreparedStatement executeWithFlags PgPreparedStatement.java 159]
  [org.postgresql.jdbc.PgPreparedStatement execute PgPreparedStatement.java 148]
  [com.zaxxer.hikari.pool.ProxyPreparedStatement execute ProxyPreparedStatement.java 44]
  [com.zaxxer.hikari.pool.HikariProxyPreparedStatement execute HikariProxyPreparedStatement.java -1]
  [next.jdbc.result_set$stmt__GT_result_set invokeStatic result_set.clj 669]
  [next.jdbc.result_set$stmt__GT_result_set invoke result_set.clj 664]
  [next.jdbc.result_set$eval11841$fn__11849 invoke result_set.clj 944]
  [next.jdbc.protocols$eval10723$fn__10754$G__10714__10763 invoke protocols.clj 34]
  [next.jdbc.default_options$eval11019$fn__11024 invoke default_options.clj 31]
  [next.jdbc.protocols$eval10723$fn__10754$G__10714__10763 invoke protocols.clj 34]
  [next.jdbc$execute_BANG_ invokeStatic jdbc.clj 251]
  [next.jdbc$execute_BANG_ invoke jdbc.clj 238]
  [leihs.procurement.resources.budget_periods$get_budget_periods invokeStatic budget_periods.clj 47]
  [leihs.procurement.resources.budget_periods$get_budget_periods invoke budget_periods.clj 34]
  [leihs.procurement.graphql.resolver$wrap_resolver_with_error$fn__44472 invoke resolver.clj 16]
  [com.walmartlabs.lacinia.schema$wrap_resolver_to_ensure_resolver_result$fn__14023 invoke schema.clj 986]
  [com.walmartlabs.lacinia.executor$invoke_resolver_for_field invokeStatic executor.clj 86]
  [com.walmartlabs.lacinia.executor$invoke_resolver_for_field invoke executor.clj 68]
  [com.walmartlabs.lacinia.executor$resolve_and_select invokeStatic executor.clj 353]
  [com.walmartlabs.lacinia.executor$resolve_and_select invoke executor.clj 234]
  [com.walmartlabs.lacinia.executor$apply_field_selection invokeStatic executor.clj 140]
  [com.walmartlabs.lacinia.executor$apply_field_selection invoke executor.clj 135]
  [com.walmartlabs.lacinia.executor$apply_selection invokeStatic executor.clj 173]
  [com.walmartlabs.lacinia.executor$apply_selection invoke executor.clj 165]
  [com.walmartlabs.lacinia.executor$execute_nested_selections$fn__17481 invoke executor.clj 197]
  [com.walmartlabs.lacinia.internal_utils$keepv$fn__12187 invoke internal_utils.clj 46]
  [clojure.lang.ArrayChunk reduce ArrayChunk.java 58]
  [clojure.core.protocols$fn__8176 invokeStatic protocols.clj 136]
  [clojure.core.protocols$fn__8176 invoke protocols.clj 124]
  [clojure.core.protocols$fn__8136$G__8131__8145 invoke protocols.clj 19]
  [clojure.core.protocols$seq_reduce invokeStatic protocols.clj 31]
  [clojure.core.protocols$fn__8168 invokeStatic protocols.clj 75]
  [clojure.core.protocols$fn__8168 invoke protocols.clj 75]
  [clojure.core.protocols$fn__8110$G__8105__8123 invoke protocols.clj 13]
  [clojure.core$reduce invokeStatic core.clj 6830]
  [clojure.core$reduce invoke core.clj 6812]
  [com.walmartlabs.lacinia.internal_utils$keepv invokeStatic internal_utils.clj 45]
  [com.walmartlabs.lacinia.internal_utils$keepv invoke internal_utils.clj 41]
  [com.walmartlabs.lacinia.executor$execute_nested_selections invokeStatic executor.clj 197]
  [com.walmartlabs.lacinia.executor$execute_nested_selections invoke executor.clj 190]
  [com.walmartlabs.lacinia.executor$execute_query$fn__17519 invoke executor.clj 400]
  [clojure.lang.AFn applyToHelper AFn.java 152]
  [clojure.lang.AFn applyTo AFn.java 144]
  [clojure.core$apply invokeStatic core.clj 667]
  [clojure.core$with_bindings_STAR_ invokeStatic core.clj 1977]
  [clojure.core$with_bindings_STAR_ doInvoke core.clj 1977]
  [clojure.lang.RestFn invoke RestFn.java 425]
  [clojure.lang.AFn applyToHelper AFn.java 156]
  [clojure.lang.RestFn applyTo RestFn.java 132]
  [clojure.core$apply invokeStatic core.clj 671]
  [clojure.core$bound_fn_STAR_$fn__5767 doInvoke core.clj 2007]
  [clojure.lang.RestFn invoke RestFn.java 397]
  [com.walmartlabs.lacinia.executor$execute_query$fn__17524 invoke executor.clj 421]
  [clojure.core$binding_conveyor_fn$fn__5772 invoke core.clj 2034]
  [clojure.lang.AFn call AFn.java 18]
  [java.util.concurrent.FutureTask run FutureTask.java 264]
  [java.util.concurrent.ThreadPoolExecutor runWorker ThreadPoolExecutor.java 1128]
  [java.util.concurrent.ThreadPoolExecutor$Worker run ThreadPoolExecutor.java 628]
  [java.lang.Thread run Thread.java 829]]}

>oo>1pure-handler _> request {:leihs-user-language {:name Deutsch, :locale de-CH, :default true, :active true}, :authenticated-entity {:email urs.vanbinsbergen@zhdk.ch, :contracts_count 4, :lastname van Binsbergen, :org_id 244750, :scope_read true, :is_admin true, :authentication-method :session, :login uvanbins, :scope_system_admin_write true, :scope_write true, :firstname Urs, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role inventory_manager, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role inventory_manager, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role customer, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 8, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 6e1aae74-85d2-42a1-a803-d998943e2e69}, leihs-user-session {:value 883fc2af-3a55-41ff-b156-b0ce6d5ae1cc}}, :remote-addr 127.0.0.1, :start-time 218102923669916, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x2309707f HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6e4670ef next.jdbc.result_set$as_unqualified_lower_maps@6e4670ef]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type application/json, cookie leihs-anti-csrf-token=6e1aae74-85d2-42a1-a803-d998943e2e69; leihs-user-session=883fc2af-3a55-41ff-b156-b0ce6d5ae1cc, content-length 343, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/requests, connection keep-alive, pragma no-cache, x-csrf-token 6e1aae74-85d2-42a1-a803-d998943e2e69, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, postman-token 11a1670c-6f63-46b8-b215-2744b8947a7c, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x666f776b /127.0.0.1:3230<->/127.0.0.1:63745], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x5a68bf1d HikariDataSource (db-pool)]}, :content-length 343, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:query query RequestFilters ($id: [ID!]) {
    budget_periods (id: $id) {
      id
      cacheKey
      name
      inspection_start_date
      end_date
      total_price_cents


    }
    __typename
  }


, :operationName RequestsIndexFiltered, :variables {:id [8b8fe440-cae5-4bf9-8048-d0ec2399faa1]}}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0x2f0ad127 leihs.procurement.graphql$handler@2f0ad127], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>o>2pure-handler _> query query RequestFilters ($id: [ID!]) {
    budget_periods (id: $id) {
      id
      cacheKey
      name
      inspection_start_date
      end_date
      total_price_cents


    }
    __typename
  }




>o>3pure-handler, result=> {:data #ordered/map ([:budget_periods nil] [:__typename :Query]), :errors ({:message ERROR: syntax error at or near "uuid"
  Position: 81, :locations [{:line 2, :column 5}], :path [:budget_periods], :extensions {:exception PSQLException, :arguments {:id $id}}})}
2023-12-01T18:33:11.703Z NX-41294 DEBUG [leihs.procurement.graphql:112] - result => {:data #ordered/map ([:budget_periods nil] [:__typename :Query]), :errors ({:message "ERROR: syntax error at or near \"uuid\"\n  Position: 81", :locations [{:line 2, :column 5}], :path [:budget_periods], :extensions {:exception "PSQLException", :arguments {:id $id}}})}
2023-12-01T18:33:11.703Z NX-41294 DEBUG [leihs.procurement.graphql:113] - {:data #ordered/map ([:budget_periods nil] [:__typename :Query]), :errors ({:message "ERROR: syntax error at or near \"uuid\"\n  Position: 81", :locations [{:line 2, :column 5}], :path [:budget_periods], :extensions {:exception "PSQLException", :arguments {:id $id}}})}

>o> ERROR 4pure-handler, result=> {:data #ordered/map ([:budget_periods nil] [:__typename :Query]), :errors ({:message ERROR: syntax error at or near "uuid"
  Position: 81, :locations [{:line 2, :column 5}], :path [:budget_periods], :extensions {:exception PSQLException, :arguments {:id $id}}})}
>>> authenticate::skip= nil  handler-key= :graphql
>>> authenticate::authenticated-entity {:email urs.vanbinsbergen@zhdk.ch, :contracts_count 4, :lastname van Binsbergen, :org_id 244750, :scope_read true, :is_admin true, :authentication-method :session, :login uvanbins, :scope_system_admin_write true, :scope_write true, :firstname Urs, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role inventory_manager, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role inventory_manager, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role customer, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 8, :scope_admin_read true}

>> authorize >

>> authorize::handler > #object[leihs.core.locale$wrap$fn__44352 0x1edc471e leihs.core.locale$wrap$fn__44352@1edc471e]

>> authorize::request > {:authenticated-entity {:email urs.vanbinsbergen@zhdk.ch, :contracts_count 4, :lastname van Binsbergen, :org_id 244750, :scope_read true, :is_admin true, :authentication-method :session, :login uvanbins, :scope_system_admin_write true, :scope_write true, :firstname Urs, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role inventory_manager, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role inventory_manager, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role customer, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 8, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 6e1aae74-85d2-42a1-a803-d998943e2e69}, leihs-user-session {:value 883fc2af-3a55-41ff-b156-b0ce6d5ae1cc}}, :remote-addr 127.0.0.1, :start-time 218327011070000, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x2309707f HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6e4670ef next.jdbc.result_set$as_unqualified_lower_maps@6e4670ef]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type application/json, cookie leihs-anti-csrf-token=6e1aae74-85d2-42a1-a803-d998943e2e69; leihs-user-session=883fc2af-3a55-41ff-b156-b0ce6d5ae1cc, content-length 340, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/requests, connection keep-alive, pragma no-cache, x-csrf-token 6e1aae74-85d2-42a1-a803-d998943e2e69, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, postman-token f3b9a0ee-41b0-4d5d-b4cf-a4bd9df0c3f5, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x311a0dd9 /127.0.0.1:3230<->/127.0.0.1:63745], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x5a68bf1d HikariDataSource (db-pool)]}, :content-length 340, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:query query RequestFilters ($id: [ID!]) {
    budget_periods (id: $id) {
      id
      cacheKey
      name
      inspection_start_date
      end_date
      total_price_cents


    }
    __typename
  }


, :operationName RequestsIndexFiltered, :variables {:id 8b8fe440-cae5-4bf9-8048-d0ec2399faa1}}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0x2f0ad127 leihs.procurement.graphql$handler@2f0ad127], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>> authorize::handler-key >> :graphql
>myprint>  authEnt? {:email urs.vanbinsbergen@zhdk.ch, :contracts_count 4, :lastname van Binsbergen, :org_id 244750, :scope_read true, :is_admin true, :authentication-method :session, :login uvanbins, :scope_system_admin_write true, :scope_write true, :firstname Urs, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role inventory_manager, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role inventory_manager, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role customer, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 8, :scope_admin_read true}
>myprint>  txn {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x5a68bf1d HikariDataSource (db-pool)]}
2023-12-01T18:36:55.621Z NX-41294 DEBUG [leihs.procurement.permissions.user:24] - auth-entity => {:email "urs.vanbinsbergen@zhdk.ch", :contracts_count 4, :lastname "van Binsbergen", :org_id "244750", :scope_read true, :is_admin true, :authentication-method :session, :login "uvanbins", :scope_system_admin_write true, :scope_write true, :firstname "Urs", :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role "inventory_manager", :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role "customer", :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role "inventory_manager", :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role "customer", :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role "inventory_manager", :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role "customer", :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role "customer", :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role "customer", :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale "de-CH", :inventory_pool_roles_count 8, :scope_admin_read true}
2023-12-01T18:36:55.627Z NX-41294 DEBUG [leihs.procurement.permissions.user:25] - (-> (sql/select [true :has_entry]) (sql/from :procurement_admins) (sql/where [:= :user_id [:cast (:user_id auth-entity) :uuid]]) sql-format (->> (jdbc/execute-one! tx))) => {:has_entry true}
>myprint>  admin true
2023-12-01T18:36:55.628Z NX-41294 DEBUG [leihs.procurement.permissions.user:59] - query => ["SELECT TRUE AS has_entry FROM procurement_category_inspectors WHERE user_id IS NULL"]
>myprint>  inspector false
2023-12-01T18:36:55.629Z NX-41294 DEBUG [leihs.procurement.permissions.user:78] - query => ["SELECT TRUE AS has_entry FROM procurement_category_viewers WHERE user_id IS NULL"]
>myprint>  viewer false
2023-12-01T18:36:55.630Z NX-41294 DEBUG [leihs.procurement.permissions.user:86] - (-> (sql/select [true :has_entry]) (sql/from :procurement_requesters_organizations) (sql/where [:= :user_id [:cast (:user_id auth-entity) :uuid]]) sql-format) => ["SELECT TRUE AS has_entry FROM procurement_requesters_organizations WHERE user_id = CAST(? AS UUID)" #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7"]
>myprint>  requester false
2023-12-01T18:36:55.631Z NX-41294 DEBUG [leihs.procurement.permissions.user:24] - auth-entity => {:email "urs.vanbinsbergen@zhdk.ch", :contracts_count 4, :lastname "van Binsbergen", :org_id "244750", :scope_read true, :is_admin true, :authentication-method :session, :login "uvanbins", :scope_system_admin_write true, :scope_write true, :firstname "Urs", :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role "inventory_manager", :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role "customer", :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role "inventory_manager", :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role "customer", :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role "inventory_manager", :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role "customer", :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role "customer", :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role "customer", :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale "de-CH", :inventory_pool_roles_count 8, :scope_admin_read true}
2023-12-01T18:36:55.633Z NX-41294 DEBUG [leihs.procurement.permissions.user:25] - (-> (sql/select [true :has_entry]) (sql/from :procurement_admins) (sql/where [:= :user_id [:cast (:user_id auth-entity) :uuid]]) sql-format (->> (jdbc/execute-one! tx))) => {:has_entry true}
2023-12-01T18:36:55.634Z NX-41294 DEBUG [leihs.procurement.permissions.user:59] - query => ["SELECT TRUE AS has_entry FROM procurement_category_inspectors WHERE user_id IS NULL"]
2023-12-01T18:36:55.634Z NX-41294 DEBUG [leihs.procurement.permissions.user:78] - query => ["SELECT TRUE AS has_entry FROM procurement_category_viewers WHERE user_id IS NULL"]
2023-12-01T18:36:55.635Z NX-41294 DEBUG [leihs.procurement.permissions.user:86] - (-> (sql/select [true :has_entry]) (sql/from :procurement_requesters_organizations) (sql/where [:= :user_id [:cast (:user_id auth-entity) :uuid]]) sql-format) => ["SELECT TRUE AS has_entry FROM procurement_requesters_organizations WHERE user_id = CAST(? AS UUID)" #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7"]

> 1 anti-csrf-token >  6e1aae74-85d2-42a1-a803-d998943e2e69

> 1 anti-csrf-token class >  java.lang.String

> 2 anti-csrf-token-new >  nil
pure-handler >> 2
2023-12-01T18:36:55.640Z NX-41294 DEBUG [leihs.procurement.graphql:71] - graphql query query RequestFilters ($id: [ID!]) {
    budget_periods (id: $id) {
      id
      cacheKey
      name
      inspection_start_date
      end_date
      total_price_cents


    }
    __typename
  }


 with variables {:id "8b8fe440-cae5-4bf9-8048-d0ec2399faa1"}
>oo> vars from graphQL-Requst nil nil nil {:id 8b8fe440-cae5-4bf9-8048-d0ec2399faa1}
>e> #error {
 :cause ERROR: syntax error at or near "uuid"
  Position: 81
 :via
 [{:type org.postgresql.util.PSQLException
   :message ERROR: syntax error at or near "uuid"
  Position: 81
   :at [org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse QueryExecutorImpl.java 2533]}]
 :trace
 [[org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse QueryExecutorImpl.java 2533]
  [org.postgresql.core.v3.QueryExecutorImpl processResults QueryExecutorImpl.java 2268]
  [org.postgresql.core.v3.QueryExecutorImpl execute QueryExecutorImpl.java 313]
  [org.postgresql.jdbc.PgStatement executeInternal PgStatement.java 448]
  [org.postgresql.jdbc.PgStatement execute PgStatement.java 369]
  [org.postgresql.jdbc.PgPreparedStatement executeWithFlags PgPreparedStatement.java 159]
  [org.postgresql.jdbc.PgPreparedStatement execute PgPreparedStatement.java 148]
  [com.zaxxer.hikari.pool.ProxyPreparedStatement execute ProxyPreparedStatement.java 44]
  [com.zaxxer.hikari.pool.HikariProxyPreparedStatement execute HikariProxyPreparedStatement.java -1]
  [next.jdbc.result_set$stmt__GT_result_set invokeStatic result_set.clj 669]
  [next.jdbc.result_set$stmt__GT_result_set invoke result_set.clj 664]
  [next.jdbc.result_set$eval11841$fn__11849 invoke result_set.clj 944]
  [next.jdbc.protocols$eval10723$fn__10754$G__10714__10763 invoke protocols.clj 34]
  [next.jdbc.default_options$eval11019$fn__11024 invoke default_options.clj 31]
  [next.jdbc.protocols$eval10723$fn__10754$G__10714__10763 invoke protocols.clj 34]
  [next.jdbc$execute_BANG_ invokeStatic jdbc.clj 251]
  [next.jdbc$execute_BANG_ invoke jdbc.clj 238]
  [leihs.procurement.resources.budget_periods$get_budget_periods invokeStatic budget_periods.clj 47]
  [leihs.procurement.resources.budget_periods$get_budget_periods invoke budget_periods.clj 34]
  [leihs.procurement.graphql.resolver$wrap_resolver_with_error$fn__44472 invoke resolver.clj 16]
  [com.walmartlabs.lacinia.schema$wrap_resolver_to_ensure_resolver_result$fn__14023 invoke schema.clj 986]
  [com.walmartlabs.lacinia.executor$invoke_resolver_for_field invokeStatic executor.clj 86]
  [com.walmartlabs.lacinia.executor$invoke_resolver_for_field invoke executor.clj 68]
  [com.walmartlabs.lacinia.executor$resolve_and_select invokeStatic executor.clj 353]
  [com.walmartlabs.lacinia.executor$resolve_and_select invoke executor.clj 234]
  [com.walmartlabs.lacinia.executor$apply_field_selection invokeStatic executor.clj 140]
  [com.walmartlabs.lacinia.executor$apply_field_selection invoke executor.clj 135]
  [com.walmartlabs.lacinia.executor$apply_selection invokeStatic executor.clj 173]
  [com.walmartlabs.lacinia.executor$apply_selection invoke executor.clj 165]
  [com.walmartlabs.lacinia.executor$execute_nested_selections$fn__17481 invoke executor.clj 197]
  [com.walmartlabs.lacinia.internal_utils$keepv$fn__12187 invoke internal_utils.clj 46]
  [clojure.lang.ArrayChunk reduce ArrayChunk.java 58]
  [clojure.core.protocols$fn__8176 invokeStatic protocols.clj 136]
  [clojure.core.protocols$fn__8176 invoke protocols.clj 124]
  [clojure.core.protocols$fn__8136$G__8131__8145 invoke protocols.clj 19]
  [clojure.core.protocols$seq_reduce invokeStatic protocols.clj 31]
  [clojure.core.protocols$fn__8168 invokeStatic protocols.clj 75]
  [clojure.core.protocols$fn__8168 invoke protocols.clj 75]
  [clojure.core.protocols$fn__8110$G__8105__8123 invoke protocols.clj 13]
  [clojure.core$reduce invokeStatic core.clj 6830]
  [clojure.core$reduce invoke core.clj 6812]
  [com.walmartlabs.lacinia.internal_utils$keepv invokeStatic internal_utils.clj 45]
  [com.walmartlabs.lacinia.internal_utils$keepv invoke internal_utils.clj 41]
  [com.walmartlabs.lacinia.executor$execute_nested_selections invokeStatic executor.clj 197]
  [com.walmartlabs.lacinia.executor$execute_nested_selections invoke executor.clj 190]
  [com.walmartlabs.lacinia.executor$execute_query$fn__17519 invoke executor.clj 400]
  [clojure.lang.AFn applyToHelper AFn.java 152]
  [clojure.lang.AFn applyTo AFn.java 144]
  [clojure.core$apply invokeStatic core.clj 667]
  [clojure.core$with_bindings_STAR_ invokeStatic core.clj 1977]
  [clojure.core$with_bindings_STAR_ doInvoke core.clj 1977]
  [clojure.lang.RestFn invoke RestFn.java 425]
  [clojure.lang.AFn applyToHelper AFn.java 156]
  [clojure.lang.RestFn applyTo RestFn.java 132]
  [clojure.core$apply invokeStatic core.clj 671]
  [clojure.core$bound_fn_STAR_$fn__5767 doInvoke core.clj 2007]
  [clojure.lang.RestFn invoke RestFn.java 397]
  [com.walmartlabs.lacinia.executor$execute_query$fn__17524 invoke executor.clj 421]
  [clojure.core$binding_conveyor_fn$fn__5772 invoke core.clj 2034]
  [clojure.lang.AFn call AFn.java 18]
  [java.util.concurrent.FutureTask run FutureTask.java 264]
  [java.util.concurrent.ThreadPoolExecutor runWorker ThreadPoolExecutor.java 1128]
  [java.util.concurrent.ThreadPoolExecutor$Worker run ThreadPoolExecutor.java 628]
  [java.lang.Thread run Thread.java 829]]}
2023-12-01T18:36:55.645Z NX-41294 WARN [leihs.procurement.graphql.resolver:326] - ERROR: syntax error at or near "uuid"
  Position: 81
2023-12-01T18:36:55.646Z NX-41294 DEBUG [leihs.procurement.graphql.resolver:326] - #error {
 :cause ERROR: syntax error at or near "uuid"
  Position: 81
 :via
 [{:type org.postgresql.util.PSQLException
   :message ERROR: syntax error at or near "uuid"
  Position: 81
   :at [org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse QueryExecutorImpl.java 2533]}]
 :trace
 [[org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse QueryExecutorImpl.java 2533]
  [org.postgresql.core.v3.QueryExecutorImpl processResults QueryExecutorImpl.java 2268]
  [org.postgresql.core.v3.QueryExecutorImpl execute QueryExecutorImpl.java 313]
  [org.postgresql.jdbc.PgStatement executeInternal PgStatement.java 448]
  [org.postgresql.jdbc.PgStatement execute PgStatement.java 369]
  [org.postgresql.jdbc.PgPreparedStatement executeWithFlags PgPreparedStatement.java 159]
  [org.postgresql.jdbc.PgPreparedStatement execute PgPreparedStatement.java 148]
  [com.zaxxer.hikari.pool.ProxyPreparedStatement execute ProxyPreparedStatement.java 44]
  [com.zaxxer.hikari.pool.HikariProxyPreparedStatement execute HikariProxyPreparedStatement.java -1]
  [next.jdbc.result_set$stmt__GT_result_set invokeStatic result_set.clj 669]
  [next.jdbc.result_set$stmt__GT_result_set invoke result_set.clj 664]
  [next.jdbc.result_set$eval11841$fn__11849 invoke result_set.clj 944]
  [next.jdbc.protocols$eval10723$fn__10754$G__10714__10763 invoke protocols.clj 34]
  [next.jdbc.default_options$eval11019$fn__11024 invoke default_options.clj 31]
  [next.jdbc.protocols$eval10723$fn__10754$G__10714__10763 invoke protocols.clj 34]
  [next.jdbc$execute_BANG_ invokeStatic jdbc.clj 251]
  [next.jdbc$execute_BANG_ invoke jdbc.clj 238]
  [leihs.procurement.resources.budget_periods$get_budget_periods invokeStatic budget_periods.clj 47]
  [leihs.procurement.resources.budget_periods$get_budget_periods invoke budget_periods.clj 34]
  [leihs.procurement.graphql.resolver$wrap_resolver_with_error$fn__44472 invoke resolver.clj 16]
  [com.walmartlabs.lacinia.schema$wrap_resolver_to_ensure_resolver_result$fn__14023 invoke schema.clj 986]
  [com.walmartlabs.lacinia.executor$invoke_resolver_for_field invokeStatic executor.clj 86]
  [com.walmartlabs.lacinia.executor$invoke_resolver_for_field invoke executor.clj 68]
  [com.walmartlabs.lacinia.executor$resolve_and_select invokeStatic executor.clj 353]
  [com.walmartlabs.lacinia.executor$resolve_and_select invoke executor.clj 234]
  [com.walmartlabs.lacinia.executor$apply_field_selection invokeStatic executor.clj 140]
  [com.walmartlabs.lacinia.executor$apply_field_selection invoke executor.clj 135]
  [com.walmartlabs.lacinia.executor$apply_selection invokeStatic executor.clj 173]
  [com.walmartlabs.lacinia.executor$apply_selection invoke executor.clj 165]
  [com.walmartlabs.lacinia.executor$execute_nested_selections$fn__17481 invoke executor.clj 197]
  [com.walmartlabs.lacinia.internal_utils$keepv$fn__12187 invoke internal_utils.clj 46]
  [clojure.lang.ArrayChunk reduce ArrayChunk.java 58]
  [clojure.core.protocols$fn__8176 invokeStatic protocols.clj 136]
  [clojure.core.protocols$fn__8176 invoke protocols.clj 124]
  [clojure.core.protocols$fn__8136$G__8131__8145 invoke protocols.clj 19]
  [clojure.core.protocols$seq_reduce invokeStatic protocols.clj 31]
  [clojure.core.protocols$fn__8168 invokeStatic protocols.clj 75]
  [clojure.core.protocols$fn__8168 invoke protocols.clj 75]
  [clojure.core.protocols$fn__8110$G__8105__8123 invoke protocols.clj 13]
  [clojure.core$reduce invokeStatic core.clj 6830]
  [clojure.core$reduce invoke core.clj 6812]
  [com.walmartlabs.lacinia.internal_utils$keepv invokeStatic internal_utils.clj 45]
  [com.walmartlabs.lacinia.internal_utils$keepv invoke internal_utils.clj 41]
  [com.walmartlabs.lacinia.executor$execute_nested_selections invokeStatic executor.clj 197]
  [com.walmartlabs.lacinia.executor$execute_nested_selections invoke executor.clj 190]
  [com.walmartlabs.lacinia.executor$execute_query$fn__17519 invoke executor.clj 400]
  [clojure.lang.AFn applyToHelper AFn.java 152]
  [clojure.lang.AFn applyTo AFn.java 144]
  [clojure.core$apply invokeStatic core.clj 667]
  [clojure.core$with_bindings_STAR_ invokeStatic core.clj 1977]
  [clojure.core$with_bindings_STAR_ doInvoke core.clj 1977]
  [clojure.lang.RestFn invoke RestFn.java 425]
  [clojure.lang.AFn applyToHelper AFn.java 156]
  [clojure.lang.RestFn applyTo RestFn.java 132]
  [clojure.core$apply invokeStatic core.clj 671]
  [clojure.core$bound_fn_STAR_$fn__5767 doInvoke core.clj 2007]
  [clojure.lang.RestFn invoke RestFn.java 397]
  [com.walmartlabs.lacinia.executor$execute_query$fn__17524 invoke executor.clj 421]
  [clojure.core$binding_conveyor_fn$fn__5772 invoke core.clj 2034]
  [clojure.lang.AFn call AFn.java 18]
  [java.util.concurrent.FutureTask run FutureTask.java 264]
  [java.util.concurrent.ThreadPoolExecutor runWorker ThreadPoolExecutor.java 1128]
  [java.util.concurrent.ThreadPoolExecutor$Worker run ThreadPoolExecutor.java 628]
  [java.lang.Thread run Thread.java 829]]}

>oo>1pure-handler _> request {:leihs-user-language {:name Deutsch, :locale de-CH, :default true, :active true}, :authenticated-entity {:email urs.vanbinsbergen@zhdk.ch, :contracts_count 4, :lastname van Binsbergen, :org_id 244750, :scope_read true, :is_admin true, :authentication-method :session, :login uvanbins, :scope_system_admin_write true, :scope_write true, :firstname Urs, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role inventory_manager, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role inventory_manager, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role customer, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 8, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 6e1aae74-85d2-42a1-a803-d998943e2e69}, leihs-user-session {:value 883fc2af-3a55-41ff-b156-b0ce6d5ae1cc}}, :remote-addr 127.0.0.1, :start-time 218327011070000, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x2309707f HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6e4670ef next.jdbc.result_set$as_unqualified_lower_maps@6e4670ef]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type application/json, cookie leihs-anti-csrf-token=6e1aae74-85d2-42a1-a803-d998943e2e69; leihs-user-session=883fc2af-3a55-41ff-b156-b0ce6d5ae1cc, content-length 340, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/requests, connection keep-alive, pragma no-cache, x-csrf-token 6e1aae74-85d2-42a1-a803-d998943e2e69, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, postman-token f3b9a0ee-41b0-4d5d-b4cf-a4bd9df0c3f5, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x311a0dd9 /127.0.0.1:3230<->/127.0.0.1:63745], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x5a68bf1d HikariDataSource (db-pool)]}, :content-length 340, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:query query RequestFilters ($id: [ID!]) {
    budget_periods (id: $id) {
      id
      cacheKey
      name
      inspection_start_date
      end_date
      total_price_cents


    }
    __typename
  }


, :operationName RequestsIndexFiltered, :variables {:id 8b8fe440-cae5-4bf9-8048-d0ec2399faa1}}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0x2f0ad127 leihs.procurement.graphql$handler@2f0ad127], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>o>2pure-handler _> query query RequestFilters ($id: [ID!]) {
    budget_periods (id: $id) {
      id
      cacheKey
      name
      inspection_start_date
      end_date
      total_price_cents


    }
    __typename
  }




>o>3pure-handler, result=> {:data #ordered/map ([:budget_periods nil] [:__typename :Query]), :errors ({:message ERROR: syntax error at or near "uuid"
  Position: 81, :locations [{:line 2, :column 5}], :path [:budget_periods], :extensions {:exception PSQLException, :arguments {:id $id}}})}
2023-12-01T18:36:55.647Z NX-41294 DEBUG [leihs.procurement.graphql:112] - result => {:data #ordered/map ([:budget_periods nil] [:__typename :Query]), :errors ({:message "ERROR: syntax error at or near \"uuid\"\n  Position: 81", :locations [{:line 2, :column 5}], :path [:budget_periods], :extensions {:exception "PSQLException", :arguments {:id $id}}})}
2023-12-01T18:36:55.647Z NX-41294 DEBUG [leihs.procurement.graphql:113] - {:data #ordered/map ([:budget_periods nil] [:__typename :Query]), :errors ({:message "ERROR: syntax error at or near \"uuid\"\n  Position: 81", :locations [{:line 2, :column 5}], :path [:budget_periods], :extensions {:exception "PSQLException", :arguments {:id $id}}})}

>o> ERROR 4pure-handler, result=> {:data #ordered/map ([:budget_periods nil] [:__typename :Query]), :errors ({:message ERROR: syntax error at or near "uuid"
  Position: 81, :locations [{:line 2, :column 5}], :path [:budget_periods], :extensions {:exception PSQLException, :arguments {:id $id}}})}
>>> authenticate::skip= nil  handler-key= :graphql
>>> authenticate::authenticated-entity {:email urs.vanbinsbergen@zhdk.ch, :contracts_count 4, :lastname van Binsbergen, :org_id 244750, :scope_read true, :is_admin true, :authentication-method :session, :login uvanbins, :scope_system_admin_write true, :scope_write true, :firstname Urs, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role inventory_manager, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role inventory_manager, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role customer, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 8, :scope_admin_read true}

>> authorize >

>> authorize::handler > #object[leihs.core.locale$wrap$fn__44352 0x1edc471e leihs.core.locale$wrap$fn__44352@1edc471e]

>> authorize::request > {:authenticated-entity {:email urs.vanbinsbergen@zhdk.ch, :contracts_count 4, :lastname van Binsbergen, :org_id 244750, :scope_read true, :is_admin true, :authentication-method :session, :login uvanbins, :scope_system_admin_write true, :scope_write true, :firstname Urs, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role inventory_manager, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role inventory_manager, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role customer, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 8, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 6e1aae74-85d2-42a1-a803-d998943e2e69}, leihs-user-session {:value 883fc2af-3a55-41ff-b156-b0ce6d5ae1cc}}, :remote-addr 127.0.0.1, :start-time 218337892881375, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x2309707f HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6e4670ef next.jdbc.result_set$as_unqualified_lower_maps@6e4670ef]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type application/json, cookie leihs-anti-csrf-token=6e1aae74-85d2-42a1-a803-d998943e2e69; leihs-user-session=883fc2af-3a55-41ff-b156-b0ce6d5ae1cc, content-length 338, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/requests, connection keep-alive, pragma no-cache, x-csrf-token 6e1aae74-85d2-42a1-a803-d998943e2e69, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, postman-token 456871b7-ccb7-4475-977e-99972a7d7894, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x7a58bddd /127.0.0.1:3230<->/127.0.0.1:63745], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x5a68bf1d HikariDataSource (db-pool)]}, :content-length 338, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:query query RequestFilters ($id: ID!) {
    budget_periods (id: $id) {
      id
      cacheKey
      name
      inspection_start_date
      end_date
      total_price_cents


    }
    __typename
  }


, :operationName RequestsIndexFiltered, :variables {:id 8b8fe440-cae5-4bf9-8048-d0ec2399faa1}}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0x2f0ad127 leihs.procurement.graphql$handler@2f0ad127], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>> authorize::handler-key >> :graphql
>myprint>  authEnt? {:email urs.vanbinsbergen@zhdk.ch, :contracts_count 4, :lastname van Binsbergen, :org_id 244750, :scope_read true, :is_admin true, :authentication-method :session, :login uvanbins, :scope_system_admin_write true, :scope_write true, :firstname Urs, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role inventory_manager, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role inventory_manager, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role customer, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 8, :scope_admin_read true}
>myprint>  txn {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x5a68bf1d HikariDataSource (db-pool)]}
2023-12-01T18:37:06.500Z NX-41294 DEBUG [leihs.procurement.permissions.user:24] - auth-entity => {:email "urs.vanbinsbergen@zhdk.ch", :contracts_count 4, :lastname "van Binsbergen", :org_id "244750", :scope_read true, :is_admin true, :authentication-method :session, :login "uvanbins", :scope_system_admin_write true, :scope_write true, :firstname "Urs", :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role "inventory_manager", :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role "customer", :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role "inventory_manager", :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role "customer", :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role "inventory_manager", :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role "customer", :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role "customer", :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role "customer", :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale "de-CH", :inventory_pool_roles_count 8, :scope_admin_read true}
2023-12-01T18:37:06.501Z NX-41294 DEBUG [leihs.procurement.permissions.user:25] - (-> (sql/select [true :has_entry]) (sql/from :procurement_admins) (sql/where [:= :user_id [:cast (:user_id auth-entity) :uuid]]) sql-format (->> (jdbc/execute-one! tx))) => {:has_entry true}
>myprint>  admin true
2023-12-01T18:37:06.503Z NX-41294 DEBUG [leihs.procurement.permissions.user:59] - query => ["SELECT TRUE AS has_entry FROM procurement_category_inspectors WHERE user_id IS NULL"]
>myprint>  inspector false
2023-12-01T18:37:06.505Z NX-41294 DEBUG [leihs.procurement.permissions.user:78] - query => ["SELECT TRUE AS has_entry FROM procurement_category_viewers WHERE user_id IS NULL"]
>myprint>  viewer false
2023-12-01T18:37:06.506Z NX-41294 DEBUG [leihs.procurement.permissions.user:86] - (-> (sql/select [true :has_entry]) (sql/from :procurement_requesters_organizations) (sql/where [:= :user_id [:cast (:user_id auth-entity) :uuid]]) sql-format) => ["SELECT TRUE AS has_entry FROM procurement_requesters_organizations WHERE user_id = CAST(? AS UUID)" #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7"]
>myprint>  requester false
2023-12-01T18:37:06.508Z NX-41294 DEBUG [leihs.procurement.permissions.user:24] - auth-entity => {:email "urs.vanbinsbergen@zhdk.ch", :contracts_count 4, :lastname "van Binsbergen", :org_id "244750", :scope_read true, :is_admin true, :authentication-method :session, :login "uvanbins", :scope_system_admin_write true, :scope_write true, :firstname "Urs", :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role "inventory_manager", :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role "customer", :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role "inventory_manager", :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role "customer", :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role "inventory_manager", :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role "customer", :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role "customer", :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role "customer", :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale "de-CH", :inventory_pool_roles_count 8, :scope_admin_read true}
2023-12-01T18:37:06.510Z NX-41294 DEBUG [leihs.procurement.permissions.user:25] - (-> (sql/select [true :has_entry]) (sql/from :procurement_admins) (sql/where [:= :user_id [:cast (:user_id auth-entity) :uuid]]) sql-format (->> (jdbc/execute-one! tx))) => {:has_entry true}
2023-12-01T18:37:06.511Z NX-41294 DEBUG [leihs.procurement.permissions.user:59] - query => ["SELECT TRUE AS has_entry FROM procurement_category_inspectors WHERE user_id IS NULL"]
2023-12-01T18:37:06.511Z NX-41294 DEBUG [leihs.procurement.permissions.user:78] - query => ["SELECT TRUE AS has_entry FROM procurement_category_viewers WHERE user_id IS NULL"]
2023-12-01T18:37:06.512Z NX-41294 DEBUG [leihs.procurement.permissions.user:86] - (-> (sql/select [true :has_entry]) (sql/from :procurement_requesters_organizations) (sql/where [:= :user_id [:cast (:user_id auth-entity) :uuid]]) sql-format) => ["SELECT TRUE AS has_entry FROM procurement_requesters_organizations WHERE user_id = CAST(? AS UUID)" #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7"]

> 1 anti-csrf-token >  6e1aae74-85d2-42a1-a803-d998943e2e69

> 1 anti-csrf-token class >  java.lang.String

> 2 anti-csrf-token-new >  nil
pure-handler >> 2
2023-12-01T18:37:06.519Z NX-41294 DEBUG [leihs.procurement.graphql:71] - graphql query query RequestFilters ($id: ID!) {
    budget_periods (id: $id) {
      id
      cacheKey
      name
      inspection_start_date
      end_date
      total_price_cents


    }
    __typename
  }


 with variables {:id "8b8fe440-cae5-4bf9-8048-d0ec2399faa1"}
>oo> vars from graphQL-Requst nil nil nil {:id 8b8fe440-cae5-4bf9-8048-d0ec2399faa1}
>e> #error {
 :cause ERROR: syntax error at or near "uuid"
  Position: 81
 :via
 [{:type org.postgresql.util.PSQLException
   :message ERROR: syntax error at or near "uuid"
  Position: 81
   :at [org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse QueryExecutorImpl.java 2533]}]
 :trace
 [[org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse QueryExecutorImpl.java 2533]
  [org.postgresql.core.v3.QueryExecutorImpl processResults QueryExecutorImpl.java 2268]
  [org.postgresql.core.v3.QueryExecutorImpl execute QueryExecutorImpl.java 313]
  [org.postgresql.jdbc.PgStatement executeInternal PgStatement.java 448]
  [org.postgresql.jdbc.PgStatement execute PgStatement.java 369]
  [org.postgresql.jdbc.PgPreparedStatement executeWithFlags PgPreparedStatement.java 159]
  [org.postgresql.jdbc.PgPreparedStatement execute PgPreparedStatement.java 148]
  [com.zaxxer.hikari.pool.ProxyPreparedStatement execute ProxyPreparedStatement.java 44]
  [com.zaxxer.hikari.pool.HikariProxyPreparedStatement execute HikariProxyPreparedStatement.java -1]
  [next.jdbc.result_set$stmt__GT_result_set invokeStatic result_set.clj 669]
  [next.jdbc.result_set$stmt__GT_result_set invoke result_set.clj 664]
  [next.jdbc.result_set$eval11841$fn__11849 invoke result_set.clj 944]
  [next.jdbc.protocols$eval10723$fn__10754$G__10714__10763 invoke protocols.clj 34]
  [next.jdbc.default_options$eval11019$fn__11024 invoke default_options.clj 31]
  [next.jdbc.protocols$eval10723$fn__10754$G__10714__10763 invoke protocols.clj 34]
  [next.jdbc$execute_BANG_ invokeStatic jdbc.clj 251]
  [next.jdbc$execute_BANG_ invoke jdbc.clj 238]
  [leihs.procurement.resources.budget_periods$get_budget_periods invokeStatic budget_periods.clj 47]
  [leihs.procurement.resources.budget_periods$get_budget_periods invoke budget_periods.clj 34]
  [leihs.procurement.graphql.resolver$wrap_resolver_with_error$fn__44472 invoke resolver.clj 16]
  [com.walmartlabs.lacinia.schema$wrap_resolver_to_ensure_resolver_result$fn__14023 invoke schema.clj 986]
  [com.walmartlabs.lacinia.executor$invoke_resolver_for_field invokeStatic executor.clj 86]
  [com.walmartlabs.lacinia.executor$invoke_resolver_for_field invoke executor.clj 68]
  [com.walmartlabs.lacinia.executor$resolve_and_select invokeStatic executor.clj 353]
  [com.walmartlabs.lacinia.executor$resolve_and_select invoke executor.clj 234]
  [com.walmartlabs.lacinia.executor$apply_field_selection invokeStatic executor.clj 140]
  [com.walmartlabs.lacinia.executor$apply_field_selection invoke executor.clj 135]
  [com.walmartlabs.lacinia.executor$apply_selection invokeStatic executor.clj 173]
  [com.walmartlabs.lacinia.executor$apply_selection invoke executor.clj 165]
  [com.walmartlabs.lacinia.executor$execute_nested_selections$fn__17481 invoke executor.clj 197]
  [com.walmartlabs.lacinia.internal_utils$keepv$fn__12187 invoke internal_utils.clj 46]
  [clojure.lang.ArrayChunk reduce ArrayChunk.java 58]
  [clojure.core.protocols$fn__8176 invokeStatic protocols.clj 136]
  [clojure.core.protocols$fn__8176 invoke protocols.clj 124]
  [clojure.core.protocols$fn__8136$G__8131__8145 invoke protocols.clj 19]
  [clojure.core.protocols$seq_reduce invokeStatic protocols.clj 31]
  [clojure.core.protocols$fn__8168 invokeStatic protocols.clj 75]
  [clojure.core.protocols$fn__8168 invoke protocols.clj 75]
  [clojure.core.protocols$fn__8110$G__8105__8123 invoke protocols.clj 13]
  [clojure.core$reduce invokeStatic core.clj 6830]
  [clojure.core$reduce invoke core.clj 6812]
  [com.walmartlabs.lacinia.internal_utils$keepv invokeStatic internal_utils.clj 45]
  [com.walmartlabs.lacinia.internal_utils$keepv invoke internal_utils.clj 41]
  [com.walmartlabs.lacinia.executor$execute_nested_selections invokeStatic executor.clj 197]
  [com.walmartlabs.lacinia.executor$execute_nested_selections invoke executor.clj 190]
  [com.walmartlabs.lacinia.executor$execute_query$fn__17519 invoke executor.clj 400]
  [clojure.lang.AFn applyToHelper AFn.java 152]
  [clojure.lang.AFn applyTo AFn.java 144]
  [clojure.core$apply invokeStatic core.clj 667]
  [clojure.core$with_bindings_STAR_ invokeStatic core.clj 1977]
  [clojure.core$with_bindings_STAR_ doInvoke core.clj 1977]
  [clojure.lang.RestFn invoke RestFn.java 425]
  [clojure.lang.AFn applyToHelper AFn.java 156]
  [clojure.lang.RestFn applyTo RestFn.java 132]
  [clojure.core$apply invokeStatic core.clj 671]
  [clojure.core$bound_fn_STAR_$fn__5767 doInvoke core.clj 2007]
  [clojure.lang.RestFn invoke RestFn.java 397]
  [com.walmartlabs.lacinia.executor$execute_query$fn__17524 invoke executor.clj 421]
  [clojure.core$binding_conveyor_fn$fn__5772 invoke core.clj 2034]
  [clojure.lang.AFn call AFn.java 18]
  [java.util.concurrent.FutureTask run FutureTask.java 264]
  [java.util.concurrent.ThreadPoolExecutor runWorker ThreadPoolExecutor.java 1128]
  [java.util.concurrent.ThreadPoolExecutor$Worker run ThreadPoolExecutor.java 628]
  [java.lang.Thread run Thread.java 829]]}
2023-12-01T18:37:06.523Z NX-41294 WARN [leihs.procurement.graphql.resolver:326] - ERROR: syntax error at or near "uuid"
  Position: 81
2023-12-01T18:37:06.524Z NX-41294 DEBUG [leihs.procurement.graphql.resolver:326] - #error {
 :cause ERROR: syntax error at or near "uuid"
  Position: 81
 :via
 [{:type org.postgresql.util.PSQLException
   :message ERROR: syntax error at or near "uuid"
  Position: 81
   :at [org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse QueryExecutorImpl.java 2533]}]
 :trace
 [[org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse QueryExecutorImpl.java 2533]
  [org.postgresql.core.v3.QueryExecutorImpl processResults QueryExecutorImpl.java 2268]
  [org.postgresql.core.v3.QueryExecutorImpl execute QueryExecutorImpl.java 313]
  [org.postgresql.jdbc.PgStatement executeInternal PgStatement.java 448]
  [org.postgresql.jdbc.PgStatement execute PgStatement.java 369]
  [org.postgresql.jdbc.PgPreparedStatement executeWithFlags PgPreparedStatement.java 159]
  [org.postgresql.jdbc.PgPreparedStatement execute PgPreparedStatement.java 148]
  [com.zaxxer.hikari.pool.ProxyPreparedStatement execute ProxyPreparedStatement.java 44]
  [com.zaxxer.hikari.pool.HikariProxyPreparedStatement execute HikariProxyPreparedStatement.java -1]
  [next.jdbc.result_set$stmt__GT_result_set invokeStatic result_set.clj 669]
  [next.jdbc.result_set$stmt__GT_result_set invoke result_set.clj 664]
  [next.jdbc.result_set$eval11841$fn__11849 invoke result_set.clj 944]
  [next.jdbc.protocols$eval10723$fn__10754$G__10714__10763 invoke protocols.clj 34]
  [next.jdbc.default_options$eval11019$fn__11024 invoke default_options.clj 31]
  [next.jdbc.protocols$eval10723$fn__10754$G__10714__10763 invoke protocols.clj 34]
  [next.jdbc$execute_BANG_ invokeStatic jdbc.clj 251]
  [next.jdbc$execute_BANG_ invoke jdbc.clj 238]
  [leihs.procurement.resources.budget_periods$get_budget_periods invokeStatic budget_periods.clj 47]
  [leihs.procurement.resources.budget_periods$get_budget_periods invoke budget_periods.clj 34]
  [leihs.procurement.graphql.resolver$wrap_resolver_with_error$fn__44472 invoke resolver.clj 16]
  [com.walmartlabs.lacinia.schema$wrap_resolver_to_ensure_resolver_result$fn__14023 invoke schema.clj 986]
  [com.walmartlabs.lacinia.executor$invoke_resolver_for_field invokeStatic executor.clj 86]
  [com.walmartlabs.lacinia.executor$invoke_resolver_for_field invoke executor.clj 68]
  [com.walmartlabs.lacinia.executor$resolve_and_select invokeStatic executor.clj 353]
  [com.walmartlabs.lacinia.executor$resolve_and_select invoke executor.clj 234]
  [com.walmartlabs.lacinia.executor$apply_field_selection invokeStatic executor.clj 140]
  [com.walmartlabs.lacinia.executor$apply_field_selection invoke executor.clj 135]
  [com.walmartlabs.lacinia.executor$apply_selection invokeStatic executor.clj 173]
  [com.walmartlabs.lacinia.executor$apply_selection invoke executor.clj 165]
  [com.walmartlabs.lacinia.executor$execute_nested_selections$fn__17481 invoke executor.clj 197]
  [com.walmartlabs.lacinia.internal_utils$keepv$fn__12187 invoke internal_utils.clj 46]
  [clojure.lang.ArrayChunk reduce ArrayChunk.java 58]
  [clojure.core.protocols$fn__8176 invokeStatic protocols.clj 136]
  [clojure.core.protocols$fn__8176 invoke protocols.clj 124]
  [clojure.core.protocols$fn__8136$G__8131__8145 invoke protocols.clj 19]
  [clojure.core.protocols$seq_reduce invokeStatic protocols.clj 31]
  [clojure.core.protocols$fn__8168 invokeStatic protocols.clj 75]
  [clojure.core.protocols$fn__8168 invoke protocols.clj 75]
  [clojure.core.protocols$fn__8110$G__8105__8123 invoke protocols.clj 13]
  [clojure.core$reduce invokeStatic core.clj 6830]
  [clojure.core$reduce invoke core.clj 6812]
  [com.walmartlabs.lacinia.internal_utils$keepv invokeStatic internal_utils.clj 45]
  [com.walmartlabs.lacinia.internal_utils$keepv invoke internal_utils.clj 41]
  [com.walmartlabs.lacinia.executor$execute_nested_selections invokeStatic executor.clj 197]
  [com.walmartlabs.lacinia.executor$execute_nested_selections invoke executor.clj 190]
  [com.walmartlabs.lacinia.executor$execute_query$fn__17519 invoke executor.clj 400]
  [clojure.lang.AFn applyToHelper AFn.java 152]
  [clojure.lang.AFn applyTo AFn.java 144]
  [clojure.core$apply invokeStatic core.clj 667]
  [clojure.core$with_bindings_STAR_ invokeStatic core.clj 1977]
  [clojure.core$with_bindings_STAR_ doInvoke core.clj 1977]
  [clojure.lang.RestFn invoke RestFn.java 425]
  [clojure.lang.AFn applyToHelper AFn.java 156]
  [clojure.lang.RestFn applyTo RestFn.java 132]
  [clojure.core$apply invokeStatic core.clj 671]
  [clojure.core$bound_fn_STAR_$fn__5767 doInvoke core.clj 2007]
  [clojure.lang.RestFn invoke RestFn.java 397]
  [com.walmartlabs.lacinia.executor$execute_query$fn__17524 invoke executor.clj 421]
  [clojure.core$binding_conveyor_fn$fn__5772 invoke core.clj 2034]
  [clojure.lang.AFn call AFn.java 18]
  [java.util.concurrent.FutureTask run FutureTask.java 264]
  [java.util.concurrent.ThreadPoolExecutor runWorker ThreadPoolExecutor.java 1128]
  [java.util.concurrent.ThreadPoolExecutor$Worker run ThreadPoolExecutor.java 628]
  [java.lang.Thread run Thread.java 829]]}

>oo>1pure-handler _> request {:leihs-user-language {:name Deutsch, :locale de-CH, :default true, :active true}, :authenticated-entity {:email urs.vanbinsbergen@zhdk.ch, :contracts_count 4, :lastname van Binsbergen, :org_id 244750, :scope_read true, :is_admin true, :authentication-method :session, :login uvanbins, :scope_system_admin_write true, :scope_write true, :firstname Urs, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role inventory_manager, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role inventory_manager, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role customer, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 8, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 6e1aae74-85d2-42a1-a803-d998943e2e69}, leihs-user-session {:value 883fc2af-3a55-41ff-b156-b0ce6d5ae1cc}}, :remote-addr 127.0.0.1, :start-time 218337892881375, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x2309707f HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6e4670ef next.jdbc.result_set$as_unqualified_lower_maps@6e4670ef]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type application/json, cookie leihs-anti-csrf-token=6e1aae74-85d2-42a1-a803-d998943e2e69; leihs-user-session=883fc2af-3a55-41ff-b156-b0ce6d5ae1cc, content-length 338, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/requests, connection keep-alive, pragma no-cache, x-csrf-token 6e1aae74-85d2-42a1-a803-d998943e2e69, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, postman-token 456871b7-ccb7-4475-977e-99972a7d7894, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x7a58bddd /127.0.0.1:3230<->/127.0.0.1:63745], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x5a68bf1d HikariDataSource (db-pool)]}, :content-length 338, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:query query RequestFilters ($id: ID!) {
    budget_periods (id: $id) {
      id
      cacheKey
      name
      inspection_start_date
      end_date
      total_price_cents


    }
    __typename
  }


, :operationName RequestsIndexFiltered, :variables {:id 8b8fe440-cae5-4bf9-8048-d0ec2399faa1}}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0x2f0ad127 leihs.procurement.graphql$handler@2f0ad127], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>o>2pure-handler _> query query RequestFilters ($id: ID!) {
    budget_periods (id: $id) {
      id
      cacheKey
      name
      inspection_start_date
      end_date
      total_price_cents


    }
    __typename
  }




>o>3pure-handler, result=> {:data #ordered/map ([:budget_periods nil] [:__typename :Query]), :errors ({:message ERROR: syntax error at or near "uuid"
  Position: 81, :locations [{:line 2, :column 5}], :path [:budget_periods], :extensions {:exception PSQLException, :arguments {:id $id}}})}
2023-12-01T18:37:06.525Z NX-41294 DEBUG [leihs.procurement.graphql:112] - result => {:data #ordered/map ([:budget_periods nil] [:__typename :Query]), :errors ({:message "ERROR: syntax error at or near \"uuid\"\n  Position: 81", :locations [{:line 2, :column 5}], :path [:budget_periods], :extensions {:exception "PSQLException", :arguments {:id $id}}})}
2023-12-01T18:37:06.525Z NX-41294 DEBUG [leihs.procurement.graphql:113] - {:data #ordered/map ([:budget_periods nil] [:__typename :Query]), :errors ({:message "ERROR: syntax error at or near \"uuid\"\n  Position: 81", :locations [{:line 2, :column 5}], :path [:budget_periods], :extensions {:exception "PSQLException", :arguments {:id $id}}})}

>o> ERROR 4pure-handler, result=> {:data #ordered/map ([:budget_periods nil] [:__typename :Query]), :errors ({:message ERROR: syntax error at or near "uuid"
  Position: 81, :locations [{:line 2, :column 5}], :path [:budget_periods], :extensions {:exception PSQLException, :arguments {:id $id}}})}
>>> authenticate::skip= nil  handler-key= :graphql
>>> authenticate::authenticated-entity {:email urs.vanbinsbergen@zhdk.ch, :contracts_count 4, :lastname van Binsbergen, :org_id 244750, :scope_read true, :is_admin true, :authentication-method :session, :login uvanbins, :scope_system_admin_write true, :scope_write true, :firstname Urs, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role inventory_manager, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role inventory_manager, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role customer, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 8, :scope_admin_read true}

>> authorize >

>> authorize::handler > #object[leihs.core.locale$wrap$fn__44352 0x1edc471e leihs.core.locale$wrap$fn__44352@1edc471e]

>> authorize::request > {:authenticated-entity {:email urs.vanbinsbergen@zhdk.ch, :contracts_count 4, :lastname van Binsbergen, :org_id 244750, :scope_read true, :is_admin true, :authentication-method :session, :login uvanbins, :scope_system_admin_write true, :scope_write true, :firstname Urs, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role inventory_manager, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role inventory_manager, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role customer, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 8, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 6e1aae74-85d2-42a1-a803-d998943e2e69}, leihs-user-session {:value 883fc2af-3a55-41ff-b156-b0ce6d5ae1cc}}, :remote-addr 127.0.0.1, :start-time 218356355026208, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x2309707f HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6e4670ef next.jdbc.result_set$as_unqualified_lower_maps@6e4670ef]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type application/json, cookie leihs-anti-csrf-token=6e1aae74-85d2-42a1-a803-d998943e2e69; leihs-user-session=883fc2af-3a55-41ff-b156-b0ce6d5ae1cc, content-length 340, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/requests, connection keep-alive, pragma no-cache, x-csrf-token 6e1aae74-85d2-42a1-a803-d998943e2e69, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, postman-token 54d7ef93-86d9-4585-9955-a3309ccffb98, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x17019281 /127.0.0.1:3230<->/127.0.0.1:63745], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x5a68bf1d HikariDataSource (db-pool)]}, :content-length 340, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:query query RequestFilters ($id: [ID!]) {
    budget_periods (id: $id) {
      id
      cacheKey
      name
      inspection_start_date
      end_date
      total_price_cents


    }
    __typename
  }


, :operationName RequestsIndexFiltered, :variables {:id 8b8fe440-cae5-4bf9-8048-d0ec2399faa1}}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0x2f0ad127 leihs.procurement.graphql$handler@2f0ad127], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>> authorize::handler-key >> :graphql
>myprint>  authEnt? {:email urs.vanbinsbergen@zhdk.ch, :contracts_count 4, :lastname van Binsbergen, :org_id 244750, :scope_read true, :is_admin true, :authentication-method :session, :login uvanbins, :scope_system_admin_write true, :scope_write true, :firstname Urs, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role inventory_manager, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role inventory_manager, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role customer, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 8, :scope_admin_read true}
>myprint>  txn {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x5a68bf1d HikariDataSource (db-pool)]}
2023-12-01T18:37:24.968Z NX-41294 DEBUG [leihs.procurement.permissions.user:24] - auth-entity => {:email "urs.vanbinsbergen@zhdk.ch", :contracts_count 4, :lastname "van Binsbergen", :org_id "244750", :scope_read true, :is_admin true, :authentication-method :session, :login "uvanbins", :scope_system_admin_write true, :scope_write true, :firstname "Urs", :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role "inventory_manager", :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role "customer", :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role "inventory_manager", :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role "customer", :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role "inventory_manager", :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role "customer", :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role "customer", :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role "customer", :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale "de-CH", :inventory_pool_roles_count 8, :scope_admin_read true}
2023-12-01T18:37:24.969Z NX-41294 DEBUG [leihs.procurement.permissions.user:25] - (-> (sql/select [true :has_entry]) (sql/from :procurement_admins) (sql/where [:= :user_id [:cast (:user_id auth-entity) :uuid]]) sql-format (->> (jdbc/execute-one! tx))) => {:has_entry true}
>myprint>  admin true
2023-12-01T18:37:24.970Z NX-41294 DEBUG [leihs.procurement.permissions.user:59] - query => ["SELECT TRUE AS has_entry FROM procurement_category_inspectors WHERE user_id IS NULL"]
>myprint>  inspector false
2023-12-01T18:37:24.971Z NX-41294 DEBUG [leihs.procurement.permissions.user:78] - query => ["SELECT TRUE AS has_entry FROM procurement_category_viewers WHERE user_id IS NULL"]
>myprint>  viewer false
2023-12-01T18:37:24.971Z NX-41294 DEBUG [leihs.procurement.permissions.user:86] - (-> (sql/select [true :has_entry]) (sql/from :procurement_requesters_organizations) (sql/where [:= :user_id [:cast (:user_id auth-entity) :uuid]]) sql-format) => ["SELECT TRUE AS has_entry FROM procurement_requesters_organizations WHERE user_id = CAST(? AS UUID)" #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7"]
>myprint>  requester false
2023-12-01T18:37:24.972Z NX-41294 DEBUG [leihs.procurement.permissions.user:24] - auth-entity => {:email "urs.vanbinsbergen@zhdk.ch", :contracts_count 4, :lastname "van Binsbergen", :org_id "244750", :scope_read true, :is_admin true, :authentication-method :session, :login "uvanbins", :scope_system_admin_write true, :scope_write true, :firstname "Urs", :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role "inventory_manager", :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role "customer", :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role "inventory_manager", :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role "customer", :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role "inventory_manager", :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role "customer", :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role "customer", :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role "customer", :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale "de-CH", :inventory_pool_roles_count 8, :scope_admin_read true}
2023-12-01T18:37:24.973Z NX-41294 DEBUG [leihs.procurement.permissions.user:25] - (-> (sql/select [true :has_entry]) (sql/from :procurement_admins) (sql/where [:= :user_id [:cast (:user_id auth-entity) :uuid]]) sql-format (->> (jdbc/execute-one! tx))) => {:has_entry true}
2023-12-01T18:37:24.974Z NX-41294 DEBUG [leihs.procurement.permissions.user:59] - query => ["SELECT TRUE AS has_entry FROM procurement_category_inspectors WHERE user_id IS NULL"]
2023-12-01T18:37:24.974Z NX-41294 DEBUG [leihs.procurement.permissions.user:78] - query => ["SELECT TRUE AS has_entry FROM procurement_category_viewers WHERE user_id IS NULL"]
2023-12-01T18:37:24.975Z NX-41294 DEBUG [leihs.procurement.permissions.user:86] - (-> (sql/select [true :has_entry]) (sql/from :procurement_requesters_organizations) (sql/where [:= :user_id [:cast (:user_id auth-entity) :uuid]]) sql-format) => ["SELECT TRUE AS has_entry FROM procurement_requesters_organizations WHERE user_id = CAST(? AS UUID)" #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7"]

> 1 anti-csrf-token >  6e1aae74-85d2-42a1-a803-d998943e2e69

> 1 anti-csrf-token class >  java.lang.String

> 2 anti-csrf-token-new >  nil
pure-handler >> 2
2023-12-01T18:37:24.978Z NX-41294 DEBUG [leihs.procurement.graphql:71] - graphql query query RequestFilters ($id: [ID!]) {
    budget_periods (id: $id) {
      id
      cacheKey
      name
      inspection_start_date
      end_date
      total_price_cents


    }
    __typename
  }


 with variables {:id "8b8fe440-cae5-4bf9-8048-d0ec2399faa1"}
>oo> vars from graphQL-Requst nil nil nil {:id 8b8fe440-cae5-4bf9-8048-d0ec2399faa1}
>e> #error {
 :cause ERROR: syntax error at or near "uuid"
  Position: 81
 :via
 [{:type org.postgresql.util.PSQLException
   :message ERROR: syntax error at or near "uuid"
  Position: 81
   :at [org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse QueryExecutorImpl.java 2533]}]
 :trace
 [[org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse QueryExecutorImpl.java 2533]
  [org.postgresql.core.v3.QueryExecutorImpl processResults QueryExecutorImpl.java 2268]
  [org.postgresql.core.v3.QueryExecutorImpl execute QueryExecutorImpl.java 313]
  [org.postgresql.jdbc.PgStatement executeInternal PgStatement.java 448]
  [org.postgresql.jdbc.PgStatement execute PgStatement.java 369]
  [org.postgresql.jdbc.PgPreparedStatement executeWithFlags PgPreparedStatement.java 159]
  [org.postgresql.jdbc.PgPreparedStatement execute PgPreparedStatement.java 148]
  [com.zaxxer.hikari.pool.ProxyPreparedStatement execute ProxyPreparedStatement.java 44]
  [com.zaxxer.hikari.pool.HikariProxyPreparedStatement execute HikariProxyPreparedStatement.java -1]
  [next.jdbc.result_set$stmt__GT_result_set invokeStatic result_set.clj 669]
  [next.jdbc.result_set$stmt__GT_result_set invoke result_set.clj 664]
  [next.jdbc.result_set$eval11841$fn__11849 invoke result_set.clj 944]
  [next.jdbc.protocols$eval10723$fn__10754$G__10714__10763 invoke protocols.clj 34]
  [next.jdbc.default_options$eval11019$fn__11024 invoke default_options.clj 31]
  [next.jdbc.protocols$eval10723$fn__10754$G__10714__10763 invoke protocols.clj 34]
  [next.jdbc$execute_BANG_ invokeStatic jdbc.clj 251]
  [next.jdbc$execute_BANG_ invoke jdbc.clj 238]
  [leihs.procurement.resources.budget_periods$get_budget_periods invokeStatic budget_periods.clj 47]
  [leihs.procurement.resources.budget_periods$get_budget_periods invoke budget_periods.clj 34]
  [leihs.procurement.graphql.resolver$wrap_resolver_with_error$fn__44472 invoke resolver.clj 16]
  [com.walmartlabs.lacinia.schema$wrap_resolver_to_ensure_resolver_result$fn__14023 invoke schema.clj 986]
  [com.walmartlabs.lacinia.executor$invoke_resolver_for_field invokeStatic executor.clj 86]
  [com.walmartlabs.lacinia.executor$invoke_resolver_for_field invoke executor.clj 68]
  [com.walmartlabs.lacinia.executor$resolve_and_select invokeStatic executor.clj 353]
  [com.walmartlabs.lacinia.executor$resolve_and_select invoke executor.clj 234]
  [com.walmartlabs.lacinia.executor$apply_field_selection invokeStatic executor.clj 140]
  [com.walmartlabs.lacinia.executor$apply_field_selection invoke executor.clj 135]
  [com.walmartlabs.lacinia.executor$apply_selection invokeStatic executor.clj 173]
  [com.walmartlabs.lacinia.executor$apply_selection invoke executor.clj 165]
  [com.walmartlabs.lacinia.executor$execute_nested_selections$fn__17481 invoke executor.clj 197]
  [com.walmartlabs.lacinia.internal_utils$keepv$fn__12187 invoke internal_utils.clj 46]
  [clojure.lang.ArrayChunk reduce ArrayChunk.java 58]
  [clojure.core.protocols$fn__8176 invokeStatic protocols.clj 136]
  [clojure.core.protocols$fn__8176 invoke protocols.clj 124]
  [clojure.core.protocols$fn__8136$G__8131__8145 invoke protocols.clj 19]
  [clojure.core.protocols$seq_reduce invokeStatic protocols.clj 31]
  [clojure.core.protocols$fn__8168 invokeStatic protocols.clj 75]
  [clojure.core.protocols$fn__8168 invoke protocols.clj 75]
  [clojure.core.protocols$fn__8110$G__8105__8123 invoke protocols.clj 13]
  [clojure.core$reduce invokeStatic core.clj 6830]
  [clojure.core$reduce invoke core.clj 6812]
  [com.walmartlabs.lacinia.internal_utils$keepv invokeStatic internal_utils.clj 45]
  [com.walmartlabs.lacinia.internal_utils$keepv invoke internal_utils.clj 41]
  [com.walmartlabs.lacinia.executor$execute_nested_selections invokeStatic executor.clj 197]
  [com.walmartlabs.lacinia.executor$execute_nested_selections invoke executor.clj 190]
  [com.walmartlabs.lacinia.executor$execute_query$fn__17519 invoke executor.clj 400]
  [clojure.lang.AFn applyToHelper AFn.java 152]
  [clojure.lang.AFn applyTo AFn.java 144]
  [clojure.core$apply invokeStatic core.clj 667]
  [clojure.core$with_bindings_STAR_ invokeStatic core.clj 1977]
  [clojure.core$with_bindings_STAR_ doInvoke core.clj 1977]
  [clojure.lang.RestFn invoke RestFn.java 425]
  [clojure.lang.AFn applyToHelper AFn.java 156]
  [clojure.lang.RestFn applyTo RestFn.java 132]
  [clojure.core$apply invokeStatic core.clj 671]
  [clojure.core$bound_fn_STAR_$fn__5767 doInvoke core.clj 2007]
  [clojure.lang.RestFn invoke RestFn.java 397]
  [com.walmartlabs.lacinia.executor$execute_query$fn__17524 invoke executor.clj 421]
  [clojure.core$binding_conveyor_fn$fn__5772 invoke core.clj 2034]
  [clojure.lang.AFn call AFn.java 18]
  [java.util.concurrent.FutureTask run FutureTask.java 264]
  [java.util.concurrent.ThreadPoolExecutor runWorker ThreadPoolExecutor.java 1128]
  [java.util.concurrent.ThreadPoolExecutor$Worker run ThreadPoolExecutor.java 628]
  [java.lang.Thread run Thread.java 829]]}
2023-12-01T18:37:24.982Z NX-41294 WARN [leihs.procurement.graphql.resolver:326] - ERROR: syntax error at or near "uuid"
  Position: 81
2023-12-01T18:37:24.983Z NX-41294 DEBUG [leihs.procurement.graphql.resolver:326] - #error {
 :cause ERROR: syntax error at or near "uuid"
  Position: 81
 :via
 [{:type org.postgresql.util.PSQLException
   :message ERROR: syntax error at or near "uuid"
  Position: 81
   :at [org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse QueryExecutorImpl.java 2533]}]
 :trace
 [[org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse QueryExecutorImpl.java 2533]
  [org.postgresql.core.v3.QueryExecutorImpl processResults QueryExecutorImpl.java 2268]
  [org.postgresql.core.v3.QueryExecutorImpl execute QueryExecutorImpl.java 313]
  [org.postgresql.jdbc.PgStatement executeInternal PgStatement.java 448]
  [org.postgresql.jdbc.PgStatement execute PgStatement.java 369]
  [org.postgresql.jdbc.PgPreparedStatement executeWithFlags PgPreparedStatement.java 159]
  [org.postgresql.jdbc.PgPreparedStatement execute PgPreparedStatement.java 148]
  [com.zaxxer.hikari.pool.ProxyPreparedStatement execute ProxyPreparedStatement.java 44]
  [com.zaxxer.hikari.pool.HikariProxyPreparedStatement execute HikariProxyPreparedStatement.java -1]
  [next.jdbc.result_set$stmt__GT_result_set invokeStatic result_set.clj 669]
  [next.jdbc.result_set$stmt__GT_result_set invoke result_set.clj 664]
  [next.jdbc.result_set$eval11841$fn__11849 invoke result_set.clj 944]
  [next.jdbc.protocols$eval10723$fn__10754$G__10714__10763 invoke protocols.clj 34]
  [next.jdbc.default_options$eval11019$fn__11024 invoke default_options.clj 31]
  [next.jdbc.protocols$eval10723$fn__10754$G__10714__10763 invoke protocols.clj 34]
  [next.jdbc$execute_BANG_ invokeStatic jdbc.clj 251]
  [next.jdbc$execute_BANG_ invoke jdbc.clj 238]
  [leihs.procurement.resources.budget_periods$get_budget_periods invokeStatic budget_periods.clj 47]
  [leihs.procurement.resources.budget_periods$get_budget_periods invoke budget_periods.clj 34]
  [leihs.procurement.graphql.resolver$wrap_resolver_with_error$fn__44472 invoke resolver.clj 16]
  [com.walmartlabs.lacinia.schema$wrap_resolver_to_ensure_resolver_result$fn__14023 invoke schema.clj 986]
  [com.walmartlabs.lacinia.executor$invoke_resolver_for_field invokeStatic executor.clj 86]
  [com.walmartlabs.lacinia.executor$invoke_resolver_for_field invoke executor.clj 68]
  [com.walmartlabs.lacinia.executor$resolve_and_select invokeStatic executor.clj 353]
  [com.walmartlabs.lacinia.executor$resolve_and_select invoke executor.clj 234]
  [com.walmartlabs.lacinia.executor$apply_field_selection invokeStatic executor.clj 140]
  [com.walmartlabs.lacinia.executor$apply_field_selection invoke executor.clj 135]
  [com.walmartlabs.lacinia.executor$apply_selection invokeStatic executor.clj 173]
  [com.walmartlabs.lacinia.executor$apply_selection invoke executor.clj 165]
  [com.walmartlabs.lacinia.executor$execute_nested_selections$fn__17481 invoke executor.clj 197]
  [com.walmartlabs.lacinia.internal_utils$keepv$fn__12187 invoke internal_utils.clj 46]
  [clojure.lang.ArrayChunk reduce ArrayChunk.java 58]
  [clojure.core.protocols$fn__8176 invokeStatic protocols.clj 136]
  [clojure.core.protocols$fn__8176 invoke protocols.clj 124]
  [clojure.core.protocols$fn__8136$G__8131__8145 invoke protocols.clj 19]
  [clojure.core.protocols$seq_reduce invokeStatic protocols.clj 31]
  [clojure.core.protocols$fn__8168 invokeStatic protocols.clj 75]
  [clojure.core.protocols$fn__8168 invoke protocols.clj 75]
  [clojure.core.protocols$fn__8110$G__8105__8123 invoke protocols.clj 13]
  [clojure.core$reduce invokeStatic core.clj 6830]
  [clojure.core$reduce invoke core.clj 6812]
  [com.walmartlabs.lacinia.internal_utils$keepv invokeStatic internal_utils.clj 45]
  [com.walmartlabs.lacinia.internal_utils$keepv invoke internal_utils.clj 41]
  [com.walmartlabs.lacinia.executor$execute_nested_selections invokeStatic executor.clj 197]
  [com.walmartlabs.lacinia.executor$execute_nested_selections invoke executor.clj 190]
  [com.walmartlabs.lacinia.executor$execute_query$fn__17519 invoke executor.clj 400]
  [clojure.lang.AFn applyToHelper AFn.java 152]
  [clojure.lang.AFn applyTo AFn.java 144]
  [clojure.core$apply invokeStatic core.clj 667]
  [clojure.core$with_bindings_STAR_ invokeStatic core.clj 1977]
  [clojure.core$with_bindings_STAR_ doInvoke core.clj 1977]
  [clojure.lang.RestFn invoke RestFn.java 425]
  [clojure.lang.AFn applyToHelper AFn.java 156]
  [clojure.lang.RestFn applyTo RestFn.java 132]
  [clojure.core$apply invokeStatic core.clj 671]
  [clojure.core$bound_fn_STAR_$fn__5767 doInvoke core.clj 2007]
  [clojure.lang.RestFn invoke RestFn.java 397]
  [com.walmartlabs.lacinia.executor$execute_query$fn__17524 invoke executor.clj 421]
  [clojure.core$binding_conveyor_fn$fn__5772 invoke core.clj 2034]
  [clojure.lang.AFn call AFn.java 18]
  [java.util.concurrent.FutureTask run FutureTask.java 264]
  [java.util.concurrent.ThreadPoolExecutor runWorker ThreadPoolExecutor.java 1128]
  [java.util.concurrent.ThreadPoolExecutor$Worker run ThreadPoolExecutor.java 628]
  [java.lang.Thread run Thread.java 829]]}

>oo>1pure-handler _> request {:leihs-user-language {:name Deutsch, :locale de-CH, :default true, :active true}, :authenticated-entity {:email urs.vanbinsbergen@zhdk.ch, :contracts_count 4, :lastname van Binsbergen, :org_id 244750, :scope_read true, :is_admin true, :authentication-method :session, :login uvanbins, :scope_system_admin_write true, :scope_write true, :firstname Urs, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role inventory_manager, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role inventory_manager, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role customer, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 8, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 6e1aae74-85d2-42a1-a803-d998943e2e69}, leihs-user-session {:value 883fc2af-3a55-41ff-b156-b0ce6d5ae1cc}}, :remote-addr 127.0.0.1, :start-time 218356355026208, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x2309707f HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6e4670ef next.jdbc.result_set$as_unqualified_lower_maps@6e4670ef]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type application/json, cookie leihs-anti-csrf-token=6e1aae74-85d2-42a1-a803-d998943e2e69; leihs-user-session=883fc2af-3a55-41ff-b156-b0ce6d5ae1cc, content-length 340, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/requests, connection keep-alive, pragma no-cache, x-csrf-token 6e1aae74-85d2-42a1-a803-d998943e2e69, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, postman-token 54d7ef93-86d9-4585-9955-a3309ccffb98, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x17019281 /127.0.0.1:3230<->/127.0.0.1:63745], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x5a68bf1d HikariDataSource (db-pool)]}, :content-length 340, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:query query RequestFilters ($id: [ID!]) {
    budget_periods (id: $id) {
      id
      cacheKey
      name
      inspection_start_date
      end_date
      total_price_cents


    }
    __typename
  }


, :operationName RequestsIndexFiltered, :variables {:id 8b8fe440-cae5-4bf9-8048-d0ec2399faa1}}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0x2f0ad127 leihs.procurement.graphql$handler@2f0ad127], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>o>2pure-handler _> query query RequestFilters ($id: [ID!]) {
    budget_periods (id: $id) {
      id
      cacheKey
      name
      inspection_start_date
      end_date
      total_price_cents


    }
    __typename
  }




>o>3pure-handler, result=> {:data #ordered/map ([:budget_periods nil] [:__typename :Query]), :errors ({:message ERROR: syntax error at or near "uuid"
  Position: 81, :locations [{:line 2, :column 5}], :path [:budget_periods], :extensions {:exception PSQLException, :arguments {:id $id}}})}
2023-12-01T18:37:24.984Z NX-41294 DEBUG [leihs.procurement.graphql:112] - result => {:data #ordered/map ([:budget_periods nil] [:__typename :Query]), :errors ({:message "ERROR: syntax error at or near \"uuid\"\n  Position: 81", :locations [{:line 2, :column 5}], :path [:budget_periods], :extensions {:exception "PSQLException", :arguments {:id $id}}})}
2023-12-01T18:37:24.984Z NX-41294 DEBUG [leihs.procurement.graphql:113] - {:data #ordered/map ([:budget_periods nil] [:__typename :Query]), :errors ({:message "ERROR: syntax error at or near \"uuid\"\n  Position: 81", :locations [{:line 2, :column 5}], :path [:budget_periods], :extensions {:exception "PSQLException", :arguments {:id $id}}})}

>o> ERROR 4pure-handler, result=> {:data #ordered/map ([:budget_periods nil] [:__typename :Query]), :errors ({:message ERROR: syntax error at or near "uuid"
  Position: 81, :locations [{:line 2, :column 5}], :path [:budget_periods], :extensions {:exception PSQLException, :arguments {:id $id}}})}
>>> authenticate::skip= nil  handler-key= :graphql
>>> authenticate::authenticated-entity {:email urs.vanbinsbergen@zhdk.ch, :contracts_count 4, :lastname van Binsbergen, :org_id 244750, :scope_read true, :is_admin true, :authentication-method :session, :login uvanbins, :scope_system_admin_write true, :scope_write true, :firstname Urs, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role inventory_manager, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role inventory_manager, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role customer, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 8, :scope_admin_read true}

>> authorize >

>> authorize::handler > #object[leihs.core.locale$wrap$fn__44352 0x1edc471e leihs.core.locale$wrap$fn__44352@1edc471e]

>> authorize::request > {:authenticated-entity {:email urs.vanbinsbergen@zhdk.ch, :contracts_count 4, :lastname van Binsbergen, :org_id 244750, :scope_read true, :is_admin true, :authentication-method :session, :login uvanbins, :scope_system_admin_write true, :scope_write true, :firstname Urs, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role inventory_manager, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role inventory_manager, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role customer, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 8, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 6e1aae74-85d2-42a1-a803-d998943e2e69}, leihs-user-session {:value 883fc2af-3a55-41ff-b156-b0ce6d5ae1cc}}, :remote-addr 127.0.0.1, :start-time 218368048047041, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x2309707f HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6e4670ef next.jdbc.result_set$as_unqualified_lower_maps@6e4670ef]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type application/json, cookie leihs-anti-csrf-token=6e1aae74-85d2-42a1-a803-d998943e2e69; leihs-user-session=883fc2af-3a55-41ff-b156-b0ce6d5ae1cc, content-length 340, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/requests, connection keep-alive, pragma no-cache, x-csrf-token 6e1aae74-85d2-42a1-a803-d998943e2e69, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, postman-token 89c8e8e5-7f45-4178-9803-f18e7f4d0575, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x72b74190 /127.0.0.1:3230<->/127.0.0.1:63745], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x5a68bf1d HikariDataSource (db-pool)]}, :content-length 340, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:query query RequestFilters ($id: [ID!]) {
    budget_periods (id: $id) {
      id
      cacheKey
      name
      inspection_start_date
      end_date
      total_price_cents


    }
    __typename
  }


, :operationName RequestsIndexFiltered, :variables {:ID 8b8fe440-cae5-4bf9-8048-d0ec2399faa1}}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0x2f0ad127 leihs.procurement.graphql$handler@2f0ad127], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>> authorize::handler-key >> :graphql
>myprint>  authEnt? {:email urs.vanbinsbergen@zhdk.ch, :contracts_count 4, :lastname van Binsbergen, :org_id 244750, :scope_read true, :is_admin true, :authentication-method :session, :login uvanbins, :scope_system_admin_write true, :scope_write true, :firstname Urs, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role inventory_manager, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role inventory_manager, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role customer, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 8, :scope_admin_read true}
>myprint>  txn {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x5a68bf1d HikariDataSource (db-pool)]}
2023-12-01T18:37:36.655Z NX-41294 DEBUG [leihs.procurement.permissions.user:24] - auth-entity => {:email "urs.vanbinsbergen@zhdk.ch", :contracts_count 4, :lastname "van Binsbergen", :org_id "244750", :scope_read true, :is_admin true, :authentication-method :session, :login "uvanbins", :scope_system_admin_write true, :scope_write true, :firstname "Urs", :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role "inventory_manager", :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role "customer", :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role "inventory_manager", :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role "customer", :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role "inventory_manager", :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role "customer", :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role "customer", :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role "customer", :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale "de-CH", :inventory_pool_roles_count 8, :scope_admin_read true}
2023-12-01T18:37:36.657Z NX-41294 DEBUG [leihs.procurement.permissions.user:25] - (-> (sql/select [true :has_entry]) (sql/from :procurement_admins) (sql/where [:= :user_id [:cast (:user_id auth-entity) :uuid]]) sql-format (->> (jdbc/execute-one! tx))) => {:has_entry true}
>myprint>  admin true
2023-12-01T18:37:36.659Z NX-41294 DEBUG [leihs.procurement.permissions.user:59] - query => ["SELECT TRUE AS has_entry FROM procurement_category_inspectors WHERE user_id IS NULL"]
>myprint>  inspector false
2023-12-01T18:37:36.660Z NX-41294 DEBUG [leihs.procurement.permissions.user:78] - query => ["SELECT TRUE AS has_entry FROM procurement_category_viewers WHERE user_id IS NULL"]
>myprint>  viewer false
2023-12-01T18:37:36.661Z NX-41294 DEBUG [leihs.procurement.permissions.user:86] - (-> (sql/select [true :has_entry]) (sql/from :procurement_requesters_organizations) (sql/where [:= :user_id [:cast (:user_id auth-entity) :uuid]]) sql-format) => ["SELECT TRUE AS has_entry FROM procurement_requesters_organizations WHERE user_id = CAST(? AS UUID)" #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7"]
>myprint>  requester false
2023-12-01T18:37:36.662Z NX-41294 DEBUG [leihs.procurement.permissions.user:24] - auth-entity => {:email "urs.vanbinsbergen@zhdk.ch", :contracts_count 4, :lastname "van Binsbergen", :org_id "244750", :scope_read true, :is_admin true, :authentication-method :session, :login "uvanbins", :scope_system_admin_write true, :scope_write true, :firstname "Urs", :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role "inventory_manager", :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role "customer", :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role "inventory_manager", :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role "customer", :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role "inventory_manager", :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role "customer", :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role "customer", :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role "customer", :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale "de-CH", :inventory_pool_roles_count 8, :scope_admin_read true}
2023-12-01T18:37:36.666Z NX-41294 DEBUG [leihs.procurement.permissions.user:25] - (-> (sql/select [true :has_entry]) (sql/from :procurement_admins) (sql/where [:= :user_id [:cast (:user_id auth-entity) :uuid]]) sql-format (->> (jdbc/execute-one! tx))) => {:has_entry true}
2023-12-01T18:37:36.667Z NX-41294 DEBUG [leihs.procurement.permissions.user:59] - query => ["SELECT TRUE AS has_entry FROM procurement_category_inspectors WHERE user_id IS NULL"]
2023-12-01T18:37:36.668Z NX-41294 DEBUG [leihs.procurement.permissions.user:78] - query => ["SELECT TRUE AS has_entry FROM procurement_category_viewers WHERE user_id IS NULL"]
2023-12-01T18:37:36.669Z NX-41294 DEBUG [leihs.procurement.permissions.user:86] - (-> (sql/select [true :has_entry]) (sql/from :procurement_requesters_organizations) (sql/where [:= :user_id [:cast (:user_id auth-entity) :uuid]]) sql-format) => ["SELECT TRUE AS has_entry FROM procurement_requesters_organizations WHERE user_id = CAST(? AS UUID)" #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7"]

> 1 anti-csrf-token >  6e1aae74-85d2-42a1-a803-d998943e2e69

> 1 anti-csrf-token class >  java.lang.String

> 2 anti-csrf-token-new >  nil
pure-handler >> 2
2023-12-01T18:37:36.673Z NX-41294 DEBUG [leihs.procurement.graphql:71] - graphql query query RequestFilters ($id: [ID!]) {
    budget_periods (id: $id) {
      id
      cacheKey
      name
      inspection_start_date
      end_date
      total_price_cents


    }
    __typename
  }


 with variables {:ID "8b8fe440-cae5-4bf9-8048-d0ec2399faa1"}
>oo> vars from graphQL-Requst nil nil nil {:ID 8b8fe440-cae5-4bf9-8048-d0ec2399faa1}

>oo>1pure-handler _> request {:leihs-user-language {:name Deutsch, :locale de-CH, :default true, :active true}, :authenticated-entity {:email urs.vanbinsbergen@zhdk.ch, :contracts_count 4, :lastname van Binsbergen, :org_id 244750, :scope_read true, :is_admin true, :authentication-method :session, :login uvanbins, :scope_system_admin_write true, :scope_write true, :firstname Urs, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role inventory_manager, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role inventory_manager, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role customer, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 8, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 6e1aae74-85d2-42a1-a803-d998943e2e69}, leihs-user-session {:value 883fc2af-3a55-41ff-b156-b0ce6d5ae1cc}}, :remote-addr 127.0.0.1, :start-time 218368048047041, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x2309707f HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6e4670ef next.jdbc.result_set$as_unqualified_lower_maps@6e4670ef]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type application/json, cookie leihs-anti-csrf-token=6e1aae74-85d2-42a1-a803-d998943e2e69; leihs-user-session=883fc2af-3a55-41ff-b156-b0ce6d5ae1cc, content-length 340, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/requests, connection keep-alive, pragma no-cache, x-csrf-token 6e1aae74-85d2-42a1-a803-d998943e2e69, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, postman-token 89c8e8e5-7f45-4178-9803-f18e7f4d0575, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x72b74190 /127.0.0.1:3230<->/127.0.0.1:63745], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x5a68bf1d HikariDataSource (db-pool)]}, :content-length 340, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:query query RequestFilters ($id: [ID!]) {
    budget_periods (id: $id) {
      id
      cacheKey
      name
      inspection_start_date
      end_date
      total_price_cents


    }
    __typename
  }


, :operationName RequestsIndexFiltered, :variables {:ID 8b8fe440-cae5-4bf9-8048-d0ec2399faa1}}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0x2f0ad127 leihs.procurement.graphql$handler@2f0ad127], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>o>2pure-handler _> query query RequestFilters ($id: [ID!]) {
    budget_periods (id: $id) {
      id
      cacheKey
      name
      inspection_start_date
      end_date
      total_price_cents


    }
    __typename
  }




>o>3pure-handler, result=> {:data #ordered/map ([:budget_periods [#ordered/map ([:id 1a1dab20-c661-4204-a913-28065d570f7c] [:cacheKey nil] [:name 2028] [:inspection_start_date 2027-11-01 01:00:00.0] [:end_date 2027-12-31 01:00:00.0] [:total_price_cents nil]) #ordered/map ([:id dfdd0798-6462-46fc-995f-a7d7233f30fd] [:cacheKey nil] [:name 2027] [:inspection_start_date 2026-11-02 01:00:00.0] [:end_date 2026-12-31 01:00:00.0] [:total_price_cents nil]) #ordered/map ([:id 6b689ed8-8148-485a-b1ca-86c1c739503e] [:cacheKey nil] [:name 2026] [:inspection_start_date 2025-11-03 01:00:00.0] [:end_date 2025-12-31 01:00:00.0] [:total_price_cents nil]) #ordered/map ([:id 1173b482-b9e6-46b4-a5e3-0b021c860e9b] [:cacheKey nil] [:name 2025] [:inspection_start_date 2024-11-04 01:00:00.0] [:end_date 2024-12-31 01:00:00.0] [:total_price_cents nil]) #ordered/map ([:id e5d2ae4b-566f-4d6d-aed9-d6a8353eda7f] [:cacheKey nil] [:name 2024] [:inspection_start_date 2023-10-01 12:00:00.0] [:end_date 2023-12-31 01:00:00.0] [:total_price_cents nil]) #ordered/map ([:id 951ac476-4f92-4ff9-9f64-26fc8f8b61c5] [:cacheKey nil] [:name 2023] [:inspection_start_date 2022-11-01 01:00:00.0] [:end_date 2022-12-31 12:00:00.0] [:total_price_cents nil]) #ordered/map ([:id 76b66d78-bfe0-4c54-8c92-edbf467af784] [:cacheKey nil] [:name 2022] [:inspection_start_date 2021-10-29 12:00:00.0] [:end_date 2021-12-31 12:00:00.0] [:total_price_cents nil]) #ordered/map ([:id 24171a61-aec6-428e-b7ed-7461b3795454] [:cacheKey nil] [:name 2021] [:inspection_start_date 2020-10-26 12:00:00.0] [:end_date 2020-12-31 12:00:00.0] [:total_price_cents nil]) #ordered/map ([:id 3b7eab1e-c8b5-512b-9146-91cc295be955] [:cacheKey nil] [:name 2020] [:inspection_start_date 2019-11-09 12:00:00.0] [:end_date 2019-12-31 01:00:00.0] [:total_price_cents nil]) #ordered/map ([:id 9fb023db-725d-5881-8838-bae3e970ffd0] [:cacheKey nil] [:name 2019] [:inspection_start_date 2018-11-10 01:00:00.0] [:end_date 2018-12-31 01:00:00.0] [:total_price_cents nil]) #ordered/map ([:id c2c5f618-7e05-5e43-a2b1-ec7f9172335d] [:cacheKey nil] [:name 2018] [:inspection_start_date 2017-11-04 01:00:00.0] [:end_date 2017-12-31 01:00:00.0] [:total_price_cents nil]) #ordered/map ([:id 4f367b79-76cf-5f12-ab7b-535a7430e6da] [:cacheKey nil] [:name 2016] [:inspection_start_date 2016-11-01 01:00:00.0] [:end_date 2017-01-30 01:00:00.0] [:total_price_cents nil]) #ordered/map ([:id aba0576e-d65f-5fe0-aa80-89ce226ec9b1] [:cacheKey nil] [:name 2017] [:inspection_start_date 2016-11-04 01:00:00.0] [:end_date 2017-01-22 01:00:00.0] [:total_price_cents nil])]] [:__typename :Query])}
2023-12-01T18:37:36.703Z NX-41294 DEBUG [leihs.procurement.graphql:112] - result => {:data #ordered/map ([:budget_periods [#ordered/map ([:id "1a1dab20-c661-4204-a913-28065d570f7c"] [:cacheKey nil] [:name "2028"] [:inspection_start_date "2027-11-01 01:00:00.0"] [:end_date "2027-12-31 01:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "dfdd0798-6462-46fc-995f-a7d7233f30fd"] [:cacheKey nil] [:name "2027"] [:inspection_start_date "2026-11-02 01:00:00.0"] [:end_date "2026-12-31 01:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "6b689ed8-8148-485a-b1ca-86c1c739503e"] [:cacheKey nil] [:name "2026"] [:inspection_start_date "2025-11-03 01:00:00.0"] [:end_date "2025-12-31 01:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "1173b482-b9e6-46b4-a5e3-0b021c860e9b"] [:cacheKey nil] [:name "2025"] [:inspection_start_date "2024-11-04 01:00:00.0"] [:end_date "2024-12-31 01:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "e5d2ae4b-566f-4d6d-aed9-d6a8353eda7f"] [:cacheKey nil] [:name "2024"] [:inspection_start_date "2023-10-01 12:00:00.0"] [:end_date "2023-12-31 01:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "951ac476-4f92-4ff9-9f64-26fc8f8b61c5"] [:cacheKey nil] [:name "2023"] [:inspection_start_date "2022-11-01 01:00:00.0"] [:end_date "2022-12-31 12:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "76b66d78-bfe0-4c54-8c92-edbf467af784"] [:cacheKey nil] [:name "2022"] [:inspection_start_date "2021-10-29 12:00:00.0"] [:end_date "2021-12-31 12:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "24171a61-aec6-428e-b7ed-7461b3795454"] [:cacheKey nil] [:name "2021"] [:inspection_start_date "2020-10-26 12:00:00.0"] [:end_date "2020-12-31 12:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "3b7eab1e-c8b5-512b-9146-91cc295be955"] [:cacheKey nil] [:name "2020"] [:inspection_start_date "2019-11-09 12:00:00.0"] [:end_date "2019-12-31 01:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "9fb023db-725d-5881-8838-bae3e970ffd0"] [:cacheKey nil] [:name "2019"] [:inspection_start_date "2018-11-10 01:00:00.0"] [:end_date "2018-12-31 01:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "c2c5f618-7e05-5e43-a2b1-ec7f9172335d"] [:cacheKey nil] [:name "2018"] [:inspection_start_date "2017-11-04 01:00:00.0"] [:end_date "2017-12-31 01:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "4f367b79-76cf-5f12-ab7b-535a7430e6da"] [:cacheKey nil] [:name "2016"] [:inspection_start_date "2016-11-01 01:00:00.0"] [:end_date "2017-01-30 01:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "aba0576e-d65f-5fe0-aa80-89ce226ec9b1"] [:cacheKey nil] [:name "2017"] [:inspection_start_date "2016-11-04 01:00:00.0"] [:end_date "2017-01-22 01:00:00.0"] [:total_price_cents nil])]] [:__typename :Query])}
2023-12-01T18:39:48.364Z NX-41294 WARN [leihs.core.graphql:31] - Failed to parse GraphQL query.
>>> authenticate::skip= nil  handler-key= :graphql
>>> authenticate::authenticated-entity {:email urs.vanbinsbergen@zhdk.ch, :contracts_count 4, :lastname van Binsbergen, :org_id 244750, :scope_read true, :is_admin true, :authentication-method :session, :login uvanbins, :scope_system_admin_write true, :scope_write true, :firstname Urs, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role inventory_manager, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role inventory_manager, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role customer, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 8, :scope_admin_read true}

>> authorize >

>> authorize::handler > #object[leihs.core.locale$wrap$fn__44352 0x1edc471e leihs.core.locale$wrap$fn__44352@1edc471e]

>> authorize::request > {:authenticated-entity {:email urs.vanbinsbergen@zhdk.ch, :contracts_count 4, :lastname van Binsbergen, :org_id 244750, :scope_read true, :is_admin true, :authentication-method :session, :login uvanbins, :scope_system_admin_write true, :scope_write true, :firstname Urs, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role inventory_manager, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role inventory_manager, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role customer, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 8, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 6e1aae74-85d2-42a1-a803-d998943e2e69}, leihs-user-session {:value 883fc2af-3a55-41ff-b156-b0ce6d5ae1cc}}, :remote-addr 127.0.0.1, :start-time 218499774415166, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x2309707f HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6e4670ef next.jdbc.result_set$as_unqualified_lower_maps@6e4670ef]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type application/json, cookie leihs-anti-csrf-token=6e1aae74-85d2-42a1-a803-d998943e2e69; leihs-user-session=883fc2af-3a55-41ff-b156-b0ce6d5ae1cc, content-length 320, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/requests, connection keep-alive, pragma no-cache, x-csrf-token 6e1aae74-85d2-42a1-a803-d998943e2e69, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, postman-token a56d17b6-1c08-4f16-b297-eda44d937486, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x20981ed4 /127.0.0.1:3230<->/127.0.0.1:63745], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x5a68bf1d HikariDataSource (db-pool)]}, :content-length 320, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:query query RequestFilters () {
    budget_periods () {
      id
      cacheKey
      name
      inspection_start_date
      end_date
      total_price_cents


    }
    __typename
  }


, :operationName RequestsIndexFiltered, :variables {:ID 8b8fe440-cae5-4bf9-8048-d0ec2399faa1}}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0x2f0ad127 leihs.procurement.graphql$handler@2f0ad127], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>> authorize::handler-key >> :graphql
>myprint>  authEnt? {:email urs.vanbinsbergen@zhdk.ch, :contracts_count 4, :lastname van Binsbergen, :org_id 244750, :scope_read true, :is_admin true, :authentication-method :session, :login uvanbins, :scope_system_admin_write true, :scope_write true, :firstname Urs, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role inventory_manager, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role inventory_manager, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role customer, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 8, :scope_admin_read true}
>myprint>  txn {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x5a68bf1d HikariDataSource (db-pool)]}
2023-12-01T18:39:48.391Z NX-41294 DEBUG [leihs.procurement.permissions.user:24] - auth-entity => {:email "urs.vanbinsbergen@zhdk.ch", :contracts_count 4, :lastname "van Binsbergen", :org_id "244750", :scope_read true, :is_admin true, :authentication-method :session, :login "uvanbins", :scope_system_admin_write true, :scope_write true, :firstname "Urs", :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role "inventory_manager", :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role "customer", :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role "inventory_manager", :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role "customer", :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role "inventory_manager", :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role "customer", :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role "customer", :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role "customer", :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale "de-CH", :inventory_pool_roles_count 8, :scope_admin_read true}
2023-12-01T18:39:48.392Z NX-41294 DEBUG [leihs.procurement.permissions.user:25] - (-> (sql/select [true :has_entry]) (sql/from :procurement_admins) (sql/where [:= :user_id [:cast (:user_id auth-entity) :uuid]]) sql-format (->> (jdbc/execute-one! tx))) => {:has_entry true}
>myprint>  admin true
2023-12-01T18:39:48.393Z NX-41294 DEBUG [leihs.procurement.permissions.user:59] - query => ["SELECT TRUE AS has_entry FROM procurement_category_inspectors WHERE user_id IS NULL"]
>myprint>  inspector false
2023-12-01T18:39:48.394Z NX-41294 DEBUG [leihs.procurement.permissions.user:78] - query => ["SELECT TRUE AS has_entry FROM procurement_category_viewers WHERE user_id IS NULL"]
>myprint>  viewer false
2023-12-01T18:39:48.394Z NX-41294 DEBUG [leihs.procurement.permissions.user:86] - (-> (sql/select [true :has_entry]) (sql/from :procurement_requesters_organizations) (sql/where [:= :user_id [:cast (:user_id auth-entity) :uuid]]) sql-format) => ["SELECT TRUE AS has_entry FROM procurement_requesters_organizations WHERE user_id = CAST(? AS UUID)" #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7"]
>myprint>  requester false
2023-12-01T18:39:48.395Z NX-41294 DEBUG [leihs.procurement.permissions.user:24] - auth-entity => {:email "urs.vanbinsbergen@zhdk.ch", :contracts_count 4, :lastname "van Binsbergen", :org_id "244750", :scope_read true, :is_admin true, :authentication-method :session, :login "uvanbins", :scope_system_admin_write true, :scope_write true, :firstname "Urs", :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role "inventory_manager", :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role "customer", :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role "inventory_manager", :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role "customer", :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role "inventory_manager", :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role "customer", :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role "customer", :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role "customer", :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale "de-CH", :inventory_pool_roles_count 8, :scope_admin_read true}
2023-12-01T18:39:48.396Z NX-41294 DEBUG [leihs.procurement.permissions.user:25] - (-> (sql/select [true :has_entry]) (sql/from :procurement_admins) (sql/where [:= :user_id [:cast (:user_id auth-entity) :uuid]]) sql-format (->> (jdbc/execute-one! tx))) => {:has_entry true}
2023-12-01T18:39:48.397Z NX-41294 DEBUG [leihs.procurement.permissions.user:59] - query => ["SELECT TRUE AS has_entry FROM procurement_category_inspectors WHERE user_id IS NULL"]
2023-12-01T18:39:48.398Z NX-41294 DEBUG [leihs.procurement.permissions.user:78] - query => ["SELECT TRUE AS has_entry FROM procurement_category_viewers WHERE user_id IS NULL"]
2023-12-01T18:39:48.398Z NX-41294 DEBUG [leihs.procurement.permissions.user:86] - (-> (sql/select [true :has_entry]) (sql/from :procurement_requesters_organizations) (sql/where [:= :user_id [:cast (:user_id auth-entity) :uuid]]) sql-format) => ["SELECT TRUE AS has_entry FROM procurement_requesters_organizations WHERE user_id = CAST(? AS UUID)" #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7"]

> 1 anti-csrf-token >  6e1aae74-85d2-42a1-a803-d998943e2e69

> 1 anti-csrf-token class >  java.lang.String

> 2 anti-csrf-token-new >  nil
2023-12-01T18:39:48.401Z NX-41294 WARN [leihs.procurement.graphql:148] - Failed to parse GraphQL query.
2023-12-01T18:39:48.401Z NX-41294 DEBUG [leihs.procurement.graphql:149] - 
                                            [37mjava.lang.Thread.run[m  [32m            Thread.java:  829[m
              [37mjava.util.concurrent.ThreadPoolExecutor$Worker.run[m  [32mThreadPoolExecutor.java:  628[m
               [37mjava.util.concurrent.ThreadPoolExecutor.runWorker[m  [32mThreadPoolExecutor.java: 1128[m
                             [37mjava.util.concurrent.FutureTask.run[m  [32m        FutureTask.java:  264[m
             [37mjava.util.concurrent.Executors$RunnableAdapter.call[m  [32m         Executors.java:  515[m
                              [37morg.httpkit.server.HttpHandler.run[m  [32m       RingHandler.java:  123[m
                  [33mleihs.procurement.utils.ring-exception/wrap/[1;33mfn[m  [32m     ring_exception.clj:   22[m
               [33mring.middleware.content-type/wrap-content-type/[1;33mfn[m  [32m       content_type.clj:   34[m
                           [33mring.middleware.accept/wrap-accept/[1;33mfn[m  [32m             accept.clj:  125[m
                [33mleihs.procurement.routes/wrap-resolve-handler/[1;33mfn[m  [32m             routes.clj:   85[m
                   [33mleihs.procurement.routes/[1;33mwrap-resolve-handler[m  [32m             routes.clj:   92[m
   [33mleihs.procurement.routes/wrap-rewrite-uri-for-static-paths/[1;33mfn[m  [32m             routes.clj:  118[m
                  [33mleihs.core.http-cache-buster2/wrap-resource/[1;33mfn[m  [32m http_cache_buster2.clj:  117[m
       [33mring.middleware.multipart-params/wrap-multipart-params/[1;33mfn[m  [32m   multipart_params.clj:  187[m
      [33mring.middleware.multipart-params/[1;33mhandle-request-and-errors[m  [32m   multipart_params.clj:  133[m
[33mring.middleware.multipart-params/handle-request-and-errors/fn/[1;33mfn[m  [32m   multipart_params.clj:  135[m
                           [33mring.middleware.params/wrap-params/[1;33mfn[m  [32m             params.clj:   75[m
        [33mleihs.core.routing.back/wrap-canonicalize-params-maps/[1;33mfn[m  [32m               back.clj:   74[m
                          [33mleihs.core.graphql/wrap-with-schema/[1;33mfn[m  [32m            graphql.clj:   80[m
                          [33mleihs.procurement.routes/wrap-empty/[1;33mfn[m  [32m             routes.clj:   99[m
                          [33mring.middleware.json/wrap-json-body/[1;33mfn[m  [32m               json.clj:   60[m
                      [33mring.middleware.json/wrap-json-response/[1;33mfn[m  [32m               json.clj:  143[m
                                        [33mleihs.core.db/wrap-tx/[1;33mfn[m  [32m                 db.clj:  208[m
                                       [33mleihs.core.status/wrap/[1;33mfn[m  [32m             status.clj:   78[m
                                     [33mleihs.core.settings/wrap/[1;33mfn[m  [32m           settings.clj:   45[m
                                        [33mleihs.core.settings/[1;33mwrap[m  [32m           settings.clj:   47[m
                         [33mring.middleware.cookies/wrap-cookies/[1;33mfn[m  [32m            cookies.clj:  214[m
                    [33mleihs.core.auth.session/wrap-authenticate/[1;33mfn[m  [32m            session.clj:   93[m
            [33mleihs.procurement.authorization/wrap-authenticate/[1;33mfn[m  [32m      authorization.clj:  111[m
                    [33mleihs.procurement.authorization/[1;33mauthenticate[m  [32m      authorization.clj:   92[m
               [33mleihs.procurement.authorization/wrap-authorize/[1;33mfn[m  [32m      authorization.clj:  157[m
                       [33mleihs.procurement.authorization/[1;33mauthorize[m  [32m      authorization.clj:  147[m
                                       [33mleihs.core.locale/wrap/[1;33mfn[m  [32m             locale.clj:  140[m
                               [33mleihs.core.anti-csrf.back/wrap/[1;33mfn[m  [32m               back.clj:   95[m
                    [33mleihs.procurement.routes/[1;33mdispatch-to-handler[m  [32m             routes.clj:   67[m
                               [33mleihs.procurement.graphql/[1;33mhandler[m  [32m            graphql.clj:  155[m
   [33mleihs.procurement.graphql/[1;33mparse-query-with-exception-handling[m  [32m            graphql.clj:  141[m
                      [33mcom.walmartlabs.lacinia.parser/[1;33mparse-query[m  [32m             parser.clj: 1355[m
                      [33mcom.walmartlabs.lacinia.parser/[1;33mparse-query[m  [32m             parser.clj: 1359[m
                      [33mcom.walmartlabs.lacinia.parser/[1;33mparse-query[m  [32m             parser.clj: 1370[m
                [33mcom.walmartlabs.lacinia.parser.query/[1;33mparse-query[m  [32m              query.clj:  258[m
             [33mcom.walmartlabs.lacinia.parser.query/parse-query/[1;33mfn[m  [32m              query.clj:  262[m
[1;31mclojure.lang.ExceptionInfo[m: [3mFailed to parse GraphQL query.[m
    [1merrors[m: ({:locations [{:line 1, :column nil}],
              :message "mismatched input ')' expecting '$'"}
             {:locations [{:line 2, :column nil}],
              :message
              "mismatched input ')' expecting {'query', 'mutation', 'subscription', NameId}"})

pure-handler >> 2
2023-12-01T18:39:48.438Z NX-41294 DEBUG [leihs.procurement.graphql:71] - graphql query query RequestFilters () {
    budget_periods () {
      id
      cacheKey
      name
      inspection_start_date
      end_date
      total_price_cents


    }
    __typename
  }


 with variables {:ID "8b8fe440-cae5-4bf9-8048-d0ec2399faa1"}
>oo> vars from graphQL-Requst nil nil nil {:ID 8b8fe440-cae5-4bf9-8048-d0ec2399faa1}

>oo>1pure-handler _> request {:leihs-user-language {:name Deutsch, :locale de-CH, :default true, :active true}, :authenticated-entity {:email urs.vanbinsbergen@zhdk.ch, :contracts_count 4, :lastname van Binsbergen, :org_id 244750, :scope_read true, :is_admin true, :authentication-method :session, :login uvanbins, :scope_system_admin_write true, :scope_write true, :firstname Urs, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role inventory_manager, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role inventory_manager, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role customer, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 8, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 6e1aae74-85d2-42a1-a803-d998943e2e69}, leihs-user-session {:value 883fc2af-3a55-41ff-b156-b0ce6d5ae1cc}}, :remote-addr 127.0.0.1, :start-time 218499774415166, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x2309707f HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6e4670ef next.jdbc.result_set$as_unqualified_lower_maps@6e4670ef]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type application/json, cookie leihs-anti-csrf-token=6e1aae74-85d2-42a1-a803-d998943e2e69; leihs-user-session=883fc2af-3a55-41ff-b156-b0ce6d5ae1cc, content-length 320, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/requests, connection keep-alive, pragma no-cache, x-csrf-token 6e1aae74-85d2-42a1-a803-d998943e2e69, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, postman-token a56d17b6-1c08-4f16-b297-eda44d937486, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x20981ed4 /127.0.0.1:3230<->/127.0.0.1:63745], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x5a68bf1d HikariDataSource (db-pool)]}, :content-length 320, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:query query RequestFilters () {
    budget_periods () {
      id
      cacheKey
      name
      inspection_start_date
      end_date
      total_price_cents


    }
    __typename
  }


, :operationName RequestsIndexFiltered, :variables {:ID 8b8fe440-cae5-4bf9-8048-d0ec2399faa1}}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0x2f0ad127 leihs.procurement.graphql$handler@2f0ad127], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>o>2pure-handler _> query query RequestFilters () {
    budget_periods () {
      id
      cacheKey
      name
      inspection_start_date
      end_date
      total_price_cents


    }
    __typename
  }




>o>3pure-handler, result=> {:errors [{:message Failed to parse GraphQL query., :extensions {:errors ({:locations [{:line 1, :column nil}], :message mismatched input ')' expecting '$'} {:locations [{:line 2, :column nil}], :message mismatched input ')' expecting {'query', 'mutation', 'subscription', NameId}})}}]}
2023-12-01T18:39:48.440Z NX-41294 DEBUG [leihs.procurement.graphql:112] - result => {:errors [{:message "Failed to parse GraphQL query.", :extensions {:errors ({:locations [{:line 1, :column nil}], :message "mismatched input ')' expecting '$'"} {:locations [{:line 2, :column nil}], :message "mismatched input ')' expecting {'query', 'mutation', 'subscription', NameId}"})}}]}
2023-12-01T18:39:48.440Z NX-41294 DEBUG [leihs.procurement.graphql:113] - {:errors [{:message "Failed to parse GraphQL query.", :extensions {:errors ({:locations [{:line 1, :column nil}], :message "mismatched input ')' expecting '$'"} {:locations [{:line 2, :column nil}], :message "mismatched input ')' expecting {'query', 'mutation', 'subscription', NameId}"})}}]}

>o> ERROR 4pure-handler, result=> {:errors [{:message Failed to parse GraphQL query., :extensions {:errors ({:locations [{:line 1, :column nil}], :message mismatched input ')' expecting '$'} {:locations [{:line 2, :column nil}], :message mismatched input ')' expecting {'query', 'mutation', 'subscription', NameId}})}}]}
>>> authenticate::skip= nil  handler-key= :graphql
>>> authenticate::authenticated-entity {:email urs.vanbinsbergen@zhdk.ch, :contracts_count 4, :lastname van Binsbergen, :org_id 244750, :scope_read true, :is_admin true, :authentication-method :session, :login uvanbins, :scope_system_admin_write true, :scope_write true, :firstname Urs, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role inventory_manager, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role inventory_manager, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role customer, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 8, :scope_admin_read true}

>> authorize >

>> authorize::handler > #object[leihs.core.locale$wrap$fn__44352 0x1edc471e leihs.core.locale$wrap$fn__44352@1edc471e]

>> authorize::request > {:authenticated-entity {:email urs.vanbinsbergen@zhdk.ch, :contracts_count 4, :lastname van Binsbergen, :org_id 244750, :scope_read true, :is_admin true, :authentication-method :session, :login uvanbins, :scope_system_admin_write true, :scope_write true, :firstname Urs, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role inventory_manager, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role inventory_manager, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role customer, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 8, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 6e1aae74-85d2-42a1-a803-d998943e2e69}, leihs-user-session {:value 883fc2af-3a55-41ff-b156-b0ce6d5ae1cc}}, :remote-addr 127.0.0.1, :start-time 218508599699250, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x2309707f HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6e4670ef next.jdbc.result_set$as_unqualified_lower_maps@6e4670ef]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type application/json, cookie leihs-anti-csrf-token=6e1aae74-85d2-42a1-a803-d998943e2e69; leihs-user-session=883fc2af-3a55-41ff-b156-b0ce6d5ae1cc, content-length 316, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/requests, connection keep-alive, pragma no-cache, x-csrf-token 6e1aae74-85d2-42a1-a803-d998943e2e69, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, postman-token dd13a96c-7c58-454d-bdc3-294f2f2b2949, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x1a8ee495 /127.0.0.1:3230<->/127.0.0.1:63745], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x5a68bf1d HikariDataSource (db-pool)]}, :content-length 316, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:query query RequestFilters  {
    budget_periods  {
      id
      cacheKey
      name
      inspection_start_date
      end_date
      total_price_cents


    }
    __typename
  }


, :operationName RequestsIndexFiltered, :variables {:ID 8b8fe440-cae5-4bf9-8048-d0ec2399faa1}}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0x2f0ad127 leihs.procurement.graphql$handler@2f0ad127], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>> authorize::handler-key >> :graphql
>myprint>  authEnt? {:email urs.vanbinsbergen@zhdk.ch, :contracts_count 4, :lastname van Binsbergen, :org_id 244750, :scope_read true, :is_admin true, :authentication-method :session, :login uvanbins, :scope_system_admin_write true, :scope_write true, :firstname Urs, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role inventory_manager, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role inventory_manager, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role customer, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 8, :scope_admin_read true}
>myprint>  txn {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x5a68bf1d HikariDataSource (db-pool)]}
2023-12-01T18:39:57.209Z NX-41294 DEBUG [leihs.procurement.permissions.user:24] - auth-entity => {:email "urs.vanbinsbergen@zhdk.ch", :contracts_count 4, :lastname "van Binsbergen", :org_id "244750", :scope_read true, :is_admin true, :authentication-method :session, :login "uvanbins", :scope_system_admin_write true, :scope_write true, :firstname "Urs", :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role "inventory_manager", :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role "customer", :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role "inventory_manager", :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role "customer", :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role "inventory_manager", :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role "customer", :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role "customer", :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role "customer", :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale "de-CH", :inventory_pool_roles_count 8, :scope_admin_read true}
2023-12-01T18:39:57.211Z NX-41294 DEBUG [leihs.procurement.permissions.user:25] - (-> (sql/select [true :has_entry]) (sql/from :procurement_admins) (sql/where [:= :user_id [:cast (:user_id auth-entity) :uuid]]) sql-format (->> (jdbc/execute-one! tx))) => {:has_entry true}
>myprint>  admin true
2023-12-01T18:39:57.211Z NX-41294 DEBUG [leihs.procurement.permissions.user:59] - query => ["SELECT TRUE AS has_entry FROM procurement_category_inspectors WHERE user_id IS NULL"]
>myprint>  inspector false
2023-12-01T18:39:57.212Z NX-41294 DEBUG [leihs.procurement.permissions.user:78] - query => ["SELECT TRUE AS has_entry FROM procurement_category_viewers WHERE user_id IS NULL"]
>myprint>  viewer false
2023-12-01T18:39:57.212Z NX-41294 DEBUG [leihs.procurement.permissions.user:86] - (-> (sql/select [true :has_entry]) (sql/from :procurement_requesters_organizations) (sql/where [:= :user_id [:cast (:user_id auth-entity) :uuid]]) sql-format) => ["SELECT TRUE AS has_entry FROM procurement_requesters_organizations WHERE user_id = CAST(? AS UUID)" #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7"]
>myprint>  requester false
2023-12-01T18:39:57.213Z NX-41294 DEBUG [leihs.procurement.permissions.user:24] - auth-entity => {:email "urs.vanbinsbergen@zhdk.ch", :contracts_count 4, :lastname "van Binsbergen", :org_id "244750", :scope_read true, :is_admin true, :authentication-method :session, :login "uvanbins", :scope_system_admin_write true, :scope_write true, :firstname "Urs", :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role "inventory_manager", :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role "customer", :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role "inventory_manager", :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role "customer", :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role "inventory_manager", :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role "customer", :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role "customer", :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role "customer", :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale "de-CH", :inventory_pool_roles_count 8, :scope_admin_read true}
2023-12-01T18:39:57.214Z NX-41294 DEBUG [leihs.procurement.permissions.user:25] - (-> (sql/select [true :has_entry]) (sql/from :procurement_admins) (sql/where [:= :user_id [:cast (:user_id auth-entity) :uuid]]) sql-format (->> (jdbc/execute-one! tx))) => {:has_entry true}
2023-12-01T18:39:57.215Z NX-41294 DEBUG [leihs.procurement.permissions.user:59] - query => ["SELECT TRUE AS has_entry FROM procurement_category_inspectors WHERE user_id IS NULL"]
2023-12-01T18:39:57.217Z NX-41294 DEBUG [leihs.procurement.permissions.user:78] - query => ["SELECT TRUE AS has_entry FROM procurement_category_viewers WHERE user_id IS NULL"]
2023-12-01T18:39:57.217Z NX-41294 DEBUG [leihs.procurement.permissions.user:86] - (-> (sql/select [true :has_entry]) (sql/from :procurement_requesters_organizations) (sql/where [:= :user_id [:cast (:user_id auth-entity) :uuid]]) sql-format) => ["SELECT TRUE AS has_entry FROM procurement_requesters_organizations WHERE user_id = CAST(? AS UUID)" #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7"]

> 1 anti-csrf-token >  6e1aae74-85d2-42a1-a803-d998943e2e69

> 1 anti-csrf-token class >  java.lang.String

> 2 anti-csrf-token-new >  nil
pure-handler >> 2
2023-12-01T18:39:57.219Z NX-41294 DEBUG [leihs.procurement.graphql:71] - graphql query query RequestFilters  {
    budget_periods  {
      id
      cacheKey
      name
      inspection_start_date
      end_date
      total_price_cents


    }
    __typename
  }


 with variables {:ID "8b8fe440-cae5-4bf9-8048-d0ec2399faa1"}
>oo> vars from graphQL-Requst nil nil nil {:ID 8b8fe440-cae5-4bf9-8048-d0ec2399faa1}

>oo>1pure-handler _> request {:leihs-user-language {:name Deutsch, :locale de-CH, :default true, :active true}, :authenticated-entity {:email urs.vanbinsbergen@zhdk.ch, :contracts_count 4, :lastname van Binsbergen, :org_id 244750, :scope_read true, :is_admin true, :authentication-method :session, :login uvanbins, :scope_system_admin_write true, :scope_write true, :firstname Urs, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role inventory_manager, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role inventory_manager, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role customer, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 8, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 6e1aae74-85d2-42a1-a803-d998943e2e69}, leihs-user-session {:value 883fc2af-3a55-41ff-b156-b0ce6d5ae1cc}}, :remote-addr 127.0.0.1, :start-time 218508599699250, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x2309707f HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6e4670ef next.jdbc.result_set$as_unqualified_lower_maps@6e4670ef]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type application/json, cookie leihs-anti-csrf-token=6e1aae74-85d2-42a1-a803-d998943e2e69; leihs-user-session=883fc2af-3a55-41ff-b156-b0ce6d5ae1cc, content-length 316, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/requests, connection keep-alive, pragma no-cache, x-csrf-token 6e1aae74-85d2-42a1-a803-d998943e2e69, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, postman-token dd13a96c-7c58-454d-bdc3-294f2f2b2949, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x1a8ee495 /127.0.0.1:3230<->/127.0.0.1:63745], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x5a68bf1d HikariDataSource (db-pool)]}, :content-length 316, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:query query RequestFilters  {
    budget_periods  {
      id
      cacheKey
      name
      inspection_start_date
      end_date
      total_price_cents


    }
    __typename
  }


, :operationName RequestsIndexFiltered, :variables {:ID 8b8fe440-cae5-4bf9-8048-d0ec2399faa1}}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0x2f0ad127 leihs.procurement.graphql$handler@2f0ad127], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>o>2pure-handler _> query query RequestFilters  {
    budget_periods  {
      id
      cacheKey
      name
      inspection_start_date
      end_date
      total_price_cents


    }
    __typename
  }




>o>3pure-handler, result=> {:data #ordered/map ([:budget_periods [#ordered/map ([:id 1a1dab20-c661-4204-a913-28065d570f7c] [:cacheKey nil] [:name 2028] [:inspection_start_date 2027-11-01 01:00:00.0] [:end_date 2027-12-31 01:00:00.0] [:total_price_cents nil]) #ordered/map ([:id dfdd0798-6462-46fc-995f-a7d7233f30fd] [:cacheKey nil] [:name 2027] [:inspection_start_date 2026-11-02 01:00:00.0] [:end_date 2026-12-31 01:00:00.0] [:total_price_cents nil]) #ordered/map ([:id 6b689ed8-8148-485a-b1ca-86c1c739503e] [:cacheKey nil] [:name 2026] [:inspection_start_date 2025-11-03 01:00:00.0] [:end_date 2025-12-31 01:00:00.0] [:total_price_cents nil]) #ordered/map ([:id 1173b482-b9e6-46b4-a5e3-0b021c860e9b] [:cacheKey nil] [:name 2025] [:inspection_start_date 2024-11-04 01:00:00.0] [:end_date 2024-12-31 01:00:00.0] [:total_price_cents nil]) #ordered/map ([:id e5d2ae4b-566f-4d6d-aed9-d6a8353eda7f] [:cacheKey nil] [:name 2024] [:inspection_start_date 2023-10-01 12:00:00.0] [:end_date 2023-12-31 01:00:00.0] [:total_price_cents nil]) #ordered/map ([:id 951ac476-4f92-4ff9-9f64-26fc8f8b61c5] [:cacheKey nil] [:name 2023] [:inspection_start_date 2022-11-01 01:00:00.0] [:end_date 2022-12-31 12:00:00.0] [:total_price_cents nil]) #ordered/map ([:id 76b66d78-bfe0-4c54-8c92-edbf467af784] [:cacheKey nil] [:name 2022] [:inspection_start_date 2021-10-29 12:00:00.0] [:end_date 2021-12-31 12:00:00.0] [:total_price_cents nil]) #ordered/map ([:id 24171a61-aec6-428e-b7ed-7461b3795454] [:cacheKey nil] [:name 2021] [:inspection_start_date 2020-10-26 12:00:00.0] [:end_date 2020-12-31 12:00:00.0] [:total_price_cents nil]) #ordered/map ([:id 3b7eab1e-c8b5-512b-9146-91cc295be955] [:cacheKey nil] [:name 2020] [:inspection_start_date 2019-11-09 12:00:00.0] [:end_date 2019-12-31 01:00:00.0] [:total_price_cents nil]) #ordered/map ([:id 9fb023db-725d-5881-8838-bae3e970ffd0] [:cacheKey nil] [:name 2019] [:inspection_start_date 2018-11-10 01:00:00.0] [:end_date 2018-12-31 01:00:00.0] [:total_price_cents nil]) #ordered/map ([:id c2c5f618-7e05-5e43-a2b1-ec7f9172335d] [:cacheKey nil] [:name 2018] [:inspection_start_date 2017-11-04 01:00:00.0] [:end_date 2017-12-31 01:00:00.0] [:total_price_cents nil]) #ordered/map ([:id 4f367b79-76cf-5f12-ab7b-535a7430e6da] [:cacheKey nil] [:name 2016] [:inspection_start_date 2016-11-01 01:00:00.0] [:end_date 2017-01-30 01:00:00.0] [:total_price_cents nil]) #ordered/map ([:id aba0576e-d65f-5fe0-aa80-89ce226ec9b1] [:cacheKey nil] [:name 2017] [:inspection_start_date 2016-11-04 01:00:00.0] [:end_date 2017-01-22 01:00:00.0] [:total_price_cents nil])]] [:__typename :Query])}
2023-12-01T18:39:57.225Z NX-41294 DEBUG [leihs.procurement.graphql:112] - result => {:data #ordered/map ([:budget_periods [#ordered/map ([:id "1a1dab20-c661-4204-a913-28065d570f7c"] [:cacheKey nil] [:name "2028"] [:inspection_start_date "2027-11-01 01:00:00.0"] [:end_date "2027-12-31 01:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "dfdd0798-6462-46fc-995f-a7d7233f30fd"] [:cacheKey nil] [:name "2027"] [:inspection_start_date "2026-11-02 01:00:00.0"] [:end_date "2026-12-31 01:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "6b689ed8-8148-485a-b1ca-86c1c739503e"] [:cacheKey nil] [:name "2026"] [:inspection_start_date "2025-11-03 01:00:00.0"] [:end_date "2025-12-31 01:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "1173b482-b9e6-46b4-a5e3-0b021c860e9b"] [:cacheKey nil] [:name "2025"] [:inspection_start_date "2024-11-04 01:00:00.0"] [:end_date "2024-12-31 01:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "e5d2ae4b-566f-4d6d-aed9-d6a8353eda7f"] [:cacheKey nil] [:name "2024"] [:inspection_start_date "2023-10-01 12:00:00.0"] [:end_date "2023-12-31 01:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "951ac476-4f92-4ff9-9f64-26fc8f8b61c5"] [:cacheKey nil] [:name "2023"] [:inspection_start_date "2022-11-01 01:00:00.0"] [:end_date "2022-12-31 12:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "76b66d78-bfe0-4c54-8c92-edbf467af784"] [:cacheKey nil] [:name "2022"] [:inspection_start_date "2021-10-29 12:00:00.0"] [:end_date "2021-12-31 12:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "24171a61-aec6-428e-b7ed-7461b3795454"] [:cacheKey nil] [:name "2021"] [:inspection_start_date "2020-10-26 12:00:00.0"] [:end_date "2020-12-31 12:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "3b7eab1e-c8b5-512b-9146-91cc295be955"] [:cacheKey nil] [:name "2020"] [:inspection_start_date "2019-11-09 12:00:00.0"] [:end_date "2019-12-31 01:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "9fb023db-725d-5881-8838-bae3e970ffd0"] [:cacheKey nil] [:name "2019"] [:inspection_start_date "2018-11-10 01:00:00.0"] [:end_date "2018-12-31 01:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "c2c5f618-7e05-5e43-a2b1-ec7f9172335d"] [:cacheKey nil] [:name "2018"] [:inspection_start_date "2017-11-04 01:00:00.0"] [:end_date "2017-12-31 01:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "4f367b79-76cf-5f12-ab7b-535a7430e6da"] [:cacheKey nil] [:name "2016"] [:inspection_start_date "2016-11-01 01:00:00.0"] [:end_date "2017-01-30 01:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "aba0576e-d65f-5fe0-aa80-89ce226ec9b1"] [:cacheKey nil] [:name "2017"] [:inspection_start_date "2016-11-04 01:00:00.0"] [:end_date "2017-01-22 01:00:00.0"] [:total_price_cents nil])]] [:__typename :Query])}
>>> authenticate::skip= nil  handler-key= :graphql
>>> authenticate::authenticated-entity {:email urs.vanbinsbergen@zhdk.ch, :contracts_count 4, :lastname van Binsbergen, :org_id 244750, :scope_read true, :is_admin true, :authentication-method :session, :login uvanbins, :scope_system_admin_write true, :scope_write true, :firstname Urs, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role inventory_manager, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role inventory_manager, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role customer, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 8, :scope_admin_read true}

>> authorize >

>> authorize::handler > #object[leihs.core.locale$wrap$fn__44352 0x1edc471e leihs.core.locale$wrap$fn__44352@1edc471e]

>> authorize::request > {:authenticated-entity {:email urs.vanbinsbergen@zhdk.ch, :contracts_count 4, :lastname van Binsbergen, :org_id 244750, :scope_read true, :is_admin true, :authentication-method :session, :login uvanbins, :scope_system_admin_write true, :scope_write true, :firstname Urs, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role inventory_manager, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role inventory_manager, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role customer, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 8, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 6e1aae74-85d2-42a1-a803-d998943e2e69}, leihs-user-session {:value 883fc2af-3a55-41ff-b156-b0ce6d5ae1cc}}, :remote-addr 127.0.0.1, :start-time 218534800743375, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x2309707f HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6e4670ef next.jdbc.result_set$as_unqualified_lower_maps@6e4670ef]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type application/json, cookie leihs-anti-csrf-token=6e1aae74-85d2-42a1-a803-d998943e2e69; leihs-user-session=883fc2af-3a55-41ff-b156-b0ce6d5ae1cc, content-length 244, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/requests, connection keep-alive, pragma no-cache, x-csrf-token 6e1aae74-85d2-42a1-a803-d998943e2e69, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, postman-token a68f4ba6-721e-456e-8ca3-2d0d89844ce8, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x1fdf85fd /127.0.0.1:3230<->/127.0.0.1:63745], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x5a68bf1d HikariDataSource (db-pool)]}, :content-length 244, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:query query RequestFilters  {
    budget_periods  {
      id
      cacheKey
      name
      inspection_start_date
      end_date
      total_price_cents


    }
    __typename
  }


, :operationName RequestsIndexFiltered}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0x2f0ad127 leihs.procurement.graphql$handler@2f0ad127], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>> authorize::handler-key >> :graphql
>myprint>  authEnt? {:email urs.vanbinsbergen@zhdk.ch, :contracts_count 4, :lastname van Binsbergen, :org_id 244750, :scope_read true, :is_admin true, :authentication-method :session, :login uvanbins, :scope_system_admin_write true, :scope_write true, :firstname Urs, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role inventory_manager, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role inventory_manager, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role customer, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 8, :scope_admin_read true}
>myprint>  txn {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x5a68bf1d HikariDataSource (db-pool)]}
2023-12-01T18:40:23.408Z NX-41294 DEBUG [leihs.procurement.permissions.user:24] - auth-entity => {:email "urs.vanbinsbergen@zhdk.ch", :contracts_count 4, :lastname "van Binsbergen", :org_id "244750", :scope_read true, :is_admin true, :authentication-method :session, :login "uvanbins", :scope_system_admin_write true, :scope_write true, :firstname "Urs", :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role "inventory_manager", :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role "customer", :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role "inventory_manager", :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role "customer", :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role "inventory_manager", :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role "customer", :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role "customer", :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role "customer", :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale "de-CH", :inventory_pool_roles_count 8, :scope_admin_read true}
2023-12-01T18:40:23.409Z NX-41294 DEBUG [leihs.procurement.permissions.user:25] - (-> (sql/select [true :has_entry]) (sql/from :procurement_admins) (sql/where [:= :user_id [:cast (:user_id auth-entity) :uuid]]) sql-format (->> (jdbc/execute-one! tx))) => {:has_entry true}
>myprint>  admin true
2023-12-01T18:40:23.411Z NX-41294 DEBUG [leihs.procurement.permissions.user:59] - query => ["SELECT TRUE AS has_entry FROM procurement_category_inspectors WHERE user_id IS NULL"]
>myprint>  inspector false
2023-12-01T18:40:23.411Z NX-41294 DEBUG [leihs.procurement.permissions.user:78] - query => ["SELECT TRUE AS has_entry FROM procurement_category_viewers WHERE user_id IS NULL"]
>myprint>  viewer false
2023-12-01T18:40:23.412Z NX-41294 DEBUG [leihs.procurement.permissions.user:86] - (-> (sql/select [true :has_entry]) (sql/from :procurement_requesters_organizations) (sql/where [:= :user_id [:cast (:user_id auth-entity) :uuid]]) sql-format) => ["SELECT TRUE AS has_entry FROM procurement_requesters_organizations WHERE user_id = CAST(? AS UUID)" #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7"]
>myprint>  requester false
2023-12-01T18:40:23.413Z NX-41294 DEBUG [leihs.procurement.permissions.user:24] - auth-entity => {:email "urs.vanbinsbergen@zhdk.ch", :contracts_count 4, :lastname "van Binsbergen", :org_id "244750", :scope_read true, :is_admin true, :authentication-method :session, :login "uvanbins", :scope_system_admin_write true, :scope_write true, :firstname "Urs", :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role "inventory_manager", :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role "customer", :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role "inventory_manager", :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role "customer", :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role "inventory_manager", :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role "customer", :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role "customer", :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role "customer", :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale "de-CH", :inventory_pool_roles_count 8, :scope_admin_read true}
2023-12-01T18:40:23.415Z NX-41294 DEBUG [leihs.procurement.permissions.user:25] - (-> (sql/select [true :has_entry]) (sql/from :procurement_admins) (sql/where [:= :user_id [:cast (:user_id auth-entity) :uuid]]) sql-format (->> (jdbc/execute-one! tx))) => {:has_entry true}
2023-12-01T18:40:23.416Z NX-41294 DEBUG [leihs.procurement.permissions.user:59] - query => ["SELECT TRUE AS has_entry FROM procurement_category_inspectors WHERE user_id IS NULL"]
2023-12-01T18:40:23.416Z NX-41294 DEBUG [leihs.procurement.permissions.user:78] - query => ["SELECT TRUE AS has_entry FROM procurement_category_viewers WHERE user_id IS NULL"]
2023-12-01T18:40:23.417Z NX-41294 DEBUG [leihs.procurement.permissions.user:86] - (-> (sql/select [true :has_entry]) (sql/from :procurement_requesters_organizations) (sql/where [:= :user_id [:cast (:user_id auth-entity) :uuid]]) sql-format) => ["SELECT TRUE AS has_entry FROM procurement_requesters_organizations WHERE user_id = CAST(? AS UUID)" #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7"]

> 1 anti-csrf-token >  6e1aae74-85d2-42a1-a803-d998943e2e69

> 1 anti-csrf-token class >  java.lang.String

> 2 anti-csrf-token-new >  nil
pure-handler >> 2
2023-12-01T18:40:23.419Z NX-41294 DEBUG [leihs.procurement.graphql:71] - graphql query query RequestFilters  {
    budget_periods  {
      id
      cacheKey
      name
      inspection_start_date
      end_date
      total_price_cents


    }
    __typename
  }


 with variables nil
>oo> vars from graphQL-Requst nil nil nil nil

>oo>1pure-handler _> request {:leihs-user-language {:name Deutsch, :locale de-CH, :default true, :active true}, :authenticated-entity {:email urs.vanbinsbergen@zhdk.ch, :contracts_count 4, :lastname van Binsbergen, :org_id 244750, :scope_read true, :is_admin true, :authentication-method :session, :login uvanbins, :scope_system_admin_write true, :scope_write true, :firstname Urs, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role inventory_manager, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role inventory_manager, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role customer, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 8, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 6e1aae74-85d2-42a1-a803-d998943e2e69}, leihs-user-session {:value 883fc2af-3a55-41ff-b156-b0ce6d5ae1cc}}, :remote-addr 127.0.0.1, :start-time 218534800743375, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x2309707f HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6e4670ef next.jdbc.result_set$as_unqualified_lower_maps@6e4670ef]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type application/json, cookie leihs-anti-csrf-token=6e1aae74-85d2-42a1-a803-d998943e2e69; leihs-user-session=883fc2af-3a55-41ff-b156-b0ce6d5ae1cc, content-length 244, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/requests, connection keep-alive, pragma no-cache, x-csrf-token 6e1aae74-85d2-42a1-a803-d998943e2e69, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, postman-token a68f4ba6-721e-456e-8ca3-2d0d89844ce8, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x1fdf85fd /127.0.0.1:3230<->/127.0.0.1:63745], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x5a68bf1d HikariDataSource (db-pool)]}, :content-length 244, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:query query RequestFilters  {
    budget_periods  {
      id
      cacheKey
      name
      inspection_start_date
      end_date
      total_price_cents


    }
    __typename
  }


, :operationName RequestsIndexFiltered}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0x2f0ad127 leihs.procurement.graphql$handler@2f0ad127], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>o>2pure-handler _> query query RequestFilters  {
    budget_periods  {
      id
      cacheKey
      name
      inspection_start_date
      end_date
      total_price_cents


    }
    __typename
  }




>o>3pure-handler, result=> {:data #ordered/map ([:budget_periods [#ordered/map ([:id 1a1dab20-c661-4204-a913-28065d570f7c] [:cacheKey nil] [:name 2028] [:inspection_start_date 2027-11-01 01:00:00.0] [:end_date 2027-12-31 01:00:00.0] [:total_price_cents nil]) #ordered/map ([:id dfdd0798-6462-46fc-995f-a7d7233f30fd] [:cacheKey nil] [:name 2027] [:inspection_start_date 2026-11-02 01:00:00.0] [:end_date 2026-12-31 01:00:00.0] [:total_price_cents nil]) #ordered/map ([:id 6b689ed8-8148-485a-b1ca-86c1c739503e] [:cacheKey nil] [:name 2026] [:inspection_start_date 2025-11-03 01:00:00.0] [:end_date 2025-12-31 01:00:00.0] [:total_price_cents nil]) #ordered/map ([:id 1173b482-b9e6-46b4-a5e3-0b021c860e9b] [:cacheKey nil] [:name 2025] [:inspection_start_date 2024-11-04 01:00:00.0] [:end_date 2024-12-31 01:00:00.0] [:total_price_cents nil]) #ordered/map ([:id e5d2ae4b-566f-4d6d-aed9-d6a8353eda7f] [:cacheKey nil] [:name 2024] [:inspection_start_date 2023-10-01 12:00:00.0] [:end_date 2023-12-31 01:00:00.0] [:total_price_cents nil]) #ordered/map ([:id 951ac476-4f92-4ff9-9f64-26fc8f8b61c5] [:cacheKey nil] [:name 2023] [:inspection_start_date 2022-11-01 01:00:00.0] [:end_date 2022-12-31 12:00:00.0] [:total_price_cents nil]) #ordered/map ([:id 76b66d78-bfe0-4c54-8c92-edbf467af784] [:cacheKey nil] [:name 2022] [:inspection_start_date 2021-10-29 12:00:00.0] [:end_date 2021-12-31 12:00:00.0] [:total_price_cents nil]) #ordered/map ([:id 24171a61-aec6-428e-b7ed-7461b3795454] [:cacheKey nil] [:name 2021] [:inspection_start_date 2020-10-26 12:00:00.0] [:end_date 2020-12-31 12:00:00.0] [:total_price_cents nil]) #ordered/map ([:id 3b7eab1e-c8b5-512b-9146-91cc295be955] [:cacheKey nil] [:name 2020] [:inspection_start_date 2019-11-09 12:00:00.0] [:end_date 2019-12-31 01:00:00.0] [:total_price_cents nil]) #ordered/map ([:id 9fb023db-725d-5881-8838-bae3e970ffd0] [:cacheKey nil] [:name 2019] [:inspection_start_date 2018-11-10 01:00:00.0] [:end_date 2018-12-31 01:00:00.0] [:total_price_cents nil]) #ordered/map ([:id c2c5f618-7e05-5e43-a2b1-ec7f9172335d] [:cacheKey nil] [:name 2018] [:inspection_start_date 2017-11-04 01:00:00.0] [:end_date 2017-12-31 01:00:00.0] [:total_price_cents nil]) #ordered/map ([:id 4f367b79-76cf-5f12-ab7b-535a7430e6da] [:cacheKey nil] [:name 2016] [:inspection_start_date 2016-11-01 01:00:00.0] [:end_date 2017-01-30 01:00:00.0] [:total_price_cents nil]) #ordered/map ([:id aba0576e-d65f-5fe0-aa80-89ce226ec9b1] [:cacheKey nil] [:name 2017] [:inspection_start_date 2016-11-04 01:00:00.0] [:end_date 2017-01-22 01:00:00.0] [:total_price_cents nil])]] [:__typename :Query])}
2023-12-01T18:40:23.422Z NX-41294 DEBUG [leihs.procurement.graphql:112] - result => {:data #ordered/map ([:budget_periods [#ordered/map ([:id "1a1dab20-c661-4204-a913-28065d570f7c"] [:cacheKey nil] [:name "2028"] [:inspection_start_date "2027-11-01 01:00:00.0"] [:end_date "2027-12-31 01:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "dfdd0798-6462-46fc-995f-a7d7233f30fd"] [:cacheKey nil] [:name "2027"] [:inspection_start_date "2026-11-02 01:00:00.0"] [:end_date "2026-12-31 01:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "6b689ed8-8148-485a-b1ca-86c1c739503e"] [:cacheKey nil] [:name "2026"] [:inspection_start_date "2025-11-03 01:00:00.0"] [:end_date "2025-12-31 01:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "1173b482-b9e6-46b4-a5e3-0b021c860e9b"] [:cacheKey nil] [:name "2025"] [:inspection_start_date "2024-11-04 01:00:00.0"] [:end_date "2024-12-31 01:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "e5d2ae4b-566f-4d6d-aed9-d6a8353eda7f"] [:cacheKey nil] [:name "2024"] [:inspection_start_date "2023-10-01 12:00:00.0"] [:end_date "2023-12-31 01:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "951ac476-4f92-4ff9-9f64-26fc8f8b61c5"] [:cacheKey nil] [:name "2023"] [:inspection_start_date "2022-11-01 01:00:00.0"] [:end_date "2022-12-31 12:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "76b66d78-bfe0-4c54-8c92-edbf467af784"] [:cacheKey nil] [:name "2022"] [:inspection_start_date "2021-10-29 12:00:00.0"] [:end_date "2021-12-31 12:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "24171a61-aec6-428e-b7ed-7461b3795454"] [:cacheKey nil] [:name "2021"] [:inspection_start_date "2020-10-26 12:00:00.0"] [:end_date "2020-12-31 12:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "3b7eab1e-c8b5-512b-9146-91cc295be955"] [:cacheKey nil] [:name "2020"] [:inspection_start_date "2019-11-09 12:00:00.0"] [:end_date "2019-12-31 01:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "9fb023db-725d-5881-8838-bae3e970ffd0"] [:cacheKey nil] [:name "2019"] [:inspection_start_date "2018-11-10 01:00:00.0"] [:end_date "2018-12-31 01:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "c2c5f618-7e05-5e43-a2b1-ec7f9172335d"] [:cacheKey nil] [:name "2018"] [:inspection_start_date "2017-11-04 01:00:00.0"] [:end_date "2017-12-31 01:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "4f367b79-76cf-5f12-ab7b-535a7430e6da"] [:cacheKey nil] [:name "2016"] [:inspection_start_date "2016-11-01 01:00:00.0"] [:end_date "2017-01-30 01:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "aba0576e-d65f-5fe0-aa80-89ce226ec9b1"] [:cacheKey nil] [:name "2017"] [:inspection_start_date "2016-11-04 01:00:00.0"] [:end_date "2017-01-22 01:00:00.0"] [:total_price_cents nil])]] [:__typename :Query])}
>>> authenticate::skip= nil  handler-key= :graphql
>>> authenticate::authenticated-entity {:email urs.vanbinsbergen@zhdk.ch, :contracts_count 4, :lastname van Binsbergen, :org_id 244750, :scope_read true, :is_admin true, :authentication-method :session, :login uvanbins, :scope_system_admin_write true, :scope_write true, :firstname Urs, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role inventory_manager, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role inventory_manager, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role customer, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 8, :scope_admin_read true}

>> authorize >

>> authorize::handler > #object[leihs.core.locale$wrap$fn__44352 0x1edc471e leihs.core.locale$wrap$fn__44352@1edc471e]

>> authorize::request > {:authenticated-entity {:email urs.vanbinsbergen@zhdk.ch, :contracts_count 4, :lastname van Binsbergen, :org_id 244750, :scope_read true, :is_admin true, :authentication-method :session, :login uvanbins, :scope_system_admin_write true, :scope_write true, :firstname Urs, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role inventory_manager, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role inventory_manager, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role customer, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 8, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 6e1aae74-85d2-42a1-a803-d998943e2e69}, leihs-user-session {:value 883fc2af-3a55-41ff-b156-b0ce6d5ae1cc}}, :remote-addr 127.0.0.1, :start-time 218551226245708, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x2309707f HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6e4670ef next.jdbc.result_set$as_unqualified_lower_maps@6e4670ef]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type application/json, cookie leihs-anti-csrf-token=6e1aae74-85d2-42a1-a803-d998943e2e69; leihs-user-session=883fc2af-3a55-41ff-b156-b0ce6d5ae1cc, content-length 244, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/requests, connection keep-alive, pragma no-cache, x-csrf-token 6e1aae74-85d2-42a1-a803-d998943e2e69, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, postman-token 16e6fc7d-f834-4be2-90cc-38ac05300088, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x23c82488 /127.0.0.1:3230<->/127.0.0.1:63745], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x5a68bf1d HikariDataSource (db-pool)]}, :content-length 244, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:query query RequestFilters  {
    budget_periods  {
      id
      cacheKey
      name
      inspection_start_date
      end_date
      total_price_cents


    }
    __typename
  }


, :operationName RequestsIndexFiltered}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0x2f0ad127 leihs.procurement.graphql$handler@2f0ad127], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>> authorize::handler-key >> :graphql
>myprint>  authEnt? {:email urs.vanbinsbergen@zhdk.ch, :contracts_count 4, :lastname van Binsbergen, :org_id 244750, :scope_read true, :is_admin true, :authentication-method :session, :login uvanbins, :scope_system_admin_write true, :scope_write true, :firstname Urs, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role inventory_manager, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role inventory_manager, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role customer, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 8, :scope_admin_read true}
>myprint>  txn {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x5a68bf1d HikariDataSource (db-pool)]}
2023-12-01T18:40:39.828Z NX-41294 DEBUG [leihs.procurement.permissions.user:24] - auth-entity => {:email "urs.vanbinsbergen@zhdk.ch", :contracts_count 4, :lastname "van Binsbergen", :org_id "244750", :scope_read true, :is_admin true, :authentication-method :session, :login "uvanbins", :scope_system_admin_write true, :scope_write true, :firstname "Urs", :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role "inventory_manager", :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role "customer", :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role "inventory_manager", :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role "customer", :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role "inventory_manager", :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role "customer", :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role "customer", :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role "customer", :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale "de-CH", :inventory_pool_roles_count 8, :scope_admin_read true}
2023-12-01T18:40:39.829Z NX-41294 DEBUG [leihs.procurement.permissions.user:25] - (-> (sql/select [true :has_entry]) (sql/from :procurement_admins) (sql/where [:= :user_id [:cast (:user_id auth-entity) :uuid]]) sql-format (->> (jdbc/execute-one! tx))) => {:has_entry true}
>myprint>  admin true
2023-12-01T18:40:39.830Z NX-41294 DEBUG [leihs.procurement.permissions.user:59] - query => ["SELECT TRUE AS has_entry FROM procurement_category_inspectors WHERE user_id IS NULL"]
>myprint>  inspector false
2023-12-01T18:40:39.830Z NX-41294 DEBUG [leihs.procurement.permissions.user:78] - query => ["SELECT TRUE AS has_entry FROM procurement_category_viewers WHERE user_id IS NULL"]
>myprint>  viewer false
2023-12-01T18:40:39.831Z NX-41294 DEBUG [leihs.procurement.permissions.user:86] - (-> (sql/select [true :has_entry]) (sql/from :procurement_requesters_organizations) (sql/where [:= :user_id [:cast (:user_id auth-entity) :uuid]]) sql-format) => ["SELECT TRUE AS has_entry FROM procurement_requesters_organizations WHERE user_id = CAST(? AS UUID)" #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7"]
>myprint>  requester false
2023-12-01T18:40:39.831Z NX-41294 DEBUG [leihs.procurement.permissions.user:24] - auth-entity => {:email "urs.vanbinsbergen@zhdk.ch", :contracts_count 4, :lastname "van Binsbergen", :org_id "244750", :scope_read true, :is_admin true, :authentication-method :session, :login "uvanbins", :scope_system_admin_write true, :scope_write true, :firstname "Urs", :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role "inventory_manager", :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role "customer", :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role "inventory_manager", :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role "customer", :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role "inventory_manager", :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role "customer", :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role "customer", :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role "customer", :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale "de-CH", :inventory_pool_roles_count 8, :scope_admin_read true}
2023-12-01T18:40:39.836Z NX-41294 DEBUG [leihs.procurement.permissions.user:25] - (-> (sql/select [true :has_entry]) (sql/from :procurement_admins) (sql/where [:= :user_id [:cast (:user_id auth-entity) :uuid]]) sql-format (->> (jdbc/execute-one! tx))) => {:has_entry true}
2023-12-01T18:40:39.837Z NX-41294 DEBUG [leihs.procurement.permissions.user:59] - query => ["SELECT TRUE AS has_entry FROM procurement_category_inspectors WHERE user_id IS NULL"]
2023-12-01T18:40:39.837Z NX-41294 DEBUG [leihs.procurement.permissions.user:78] - query => ["SELECT TRUE AS has_entry FROM procurement_category_viewers WHERE user_id IS NULL"]
2023-12-01T18:40:39.838Z NX-41294 DEBUG [leihs.procurement.permissions.user:86] - (-> (sql/select [true :has_entry]) (sql/from :procurement_requesters_organizations) (sql/where [:= :user_id [:cast (:user_id auth-entity) :uuid]]) sql-format) => ["SELECT TRUE AS has_entry FROM procurement_requesters_organizations WHERE user_id = CAST(? AS UUID)" #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7"]

> 1 anti-csrf-token >  6e1aae74-85d2-42a1-a803-d998943e2e69

> 1 anti-csrf-token class >  java.lang.String

> 2 anti-csrf-token-new >  nil
pure-handler >> 2
2023-12-01T18:40:39.840Z NX-41294 DEBUG [leihs.procurement.graphql:71] - graphql query query RequestFilters  {
    budget_periods  {
      id
      cacheKey
      name
      inspection_start_date
      end_date
      total_price_cents


    }
    __typename
  }


 with variables nil
>oo> vars from graphQL-Requst nil nil nil nil

>oo>1pure-handler _> request {:leihs-user-language {:name Deutsch, :locale de-CH, :default true, :active true}, :authenticated-entity {:email urs.vanbinsbergen@zhdk.ch, :contracts_count 4, :lastname van Binsbergen, :org_id 244750, :scope_read true, :is_admin true, :authentication-method :session, :login uvanbins, :scope_system_admin_write true, :scope_write true, :firstname Urs, :scope_admin_write true, :user_session_created_at #time/instant "2023-12-01T15:27:00.957215Z", :id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :user_session_id #uuid "19f44e3b-805b-451e-8ed2-1969faedc3e1", :scope_system_admin_read true, :access-rights ({:role inventory_manager, :inventory_pool_id #uuid "3977012c-ce0e-501f-889b-8715fdb5d83b"} {:role customer, :inventory_pool_id #uuid "5863967f-9804-4909-a9b7-92254616d6b2"} {:role inventory_manager, :inventory_pool_id #uuid "5dd25b58-fa56-5095-bd97-2696d92c2fb1"} {:role customer, :inventory_pool_id #uuid "77e88ec8-9ff6-5435-818e-dc902fc631a6"} {:role inventory_manager, :inventory_pool_id #uuid "8bd16d45-056d-5590-bc7f-12849f034351"} {:role customer, :inventory_pool_id #uuid "a02b8163-9a16-5066-b48e-9eb74cf8b791"} {:role customer, :inventory_pool_id #uuid "fc5a841e-36c6-5dc3-8207-1306c1fb89bf"} {:role customer, :inventory_pool_id #uuid "ffaa3aea-2a1f-4d6a-bdfc-f3be93699750"}), :user_id #uuid "23a3d006-581e-4dee-a717-4ac7d0fd7ab7", :is_system_admin true, :external_sign_out_url nil, :language_locale de-CH, :inventory_pool_roles_count 8, :scope_admin_read true}, :cookies {leihs-anti-csrf-token {:value 6e1aae74-85d2-42a1-a803-d998943e2e69}, leihs-user-session {:value 883fc2af-3a55-41ff-b156-b0ce6d5ae1cc}}, :remote-addr 127.0.0.1, :start-time 218551226245708, :params {}, :settings {:email_sending_enabled false, :sessions_max_lifetime_secs 432000, :smtp_default_from_address noreply@zhdk.ch, :public_image_caching_enabled true, :sessions_force_secure false, :deliver_received_order_notifications false, :external_base_url http://localhost:3200, :sessions_force_uniqueness false, :email_signature Das ZHdK-Ausleihe-Team}, :tx-next #next.jdbc.default_options.DefaultOptions{:connectable #object[com.zaxxer.hikari.HikariDataSource 0x2309707f HikariDataSource (HikariPool-1)], :options {:builder-fn #object[next.jdbc.result_set$as_unqualified_lower_maps 0x6e4670ef next.jdbc.result_set$as_unqualified_lower_maps@6e4670ef]}}, :query-params-raw {}, :route-params nil, :headers {origin http://localhost:3230, sec-fetch-site same-origin, sec-ch-ua-mobile ?0, host localhost:3230, user-agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36, content-type application/json, cookie leihs-anti-csrf-token=6e1aae74-85d2-42a1-a803-d998943e2e69; leihs-user-session=883fc2af-3a55-41ff-b156-b0ce6d5ae1cc, content-length 244, sec-ch-ua "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24", sec-ch-ua-platform "macOS", referer http://localhost:3230/procure/requests, connection keep-alive, pragma no-cache, x-csrf-token 6e1aae74-85d2-42a1-a803-d998943e2e69, accept application/json, accept-language de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7, sec-fetch-dest empty, accept-encoding gzip, deflate, br, sec-fetch-mode cors, postman-token 16e6fc7d-f834-4be2-90cc-38ac05300088, cache-control no-cache}, :async-channel #object[org.httpkit.server.AsyncChannel 0x23c82488 /127.0.0.1:3230<->/127.0.0.1:63745], :server-port 3230, :params-raw {}, :tx {:datasource #object[com.zaxxer.hikari.HikariDataSource 0x5a68bf1d HikariDataSource (db-pool)]}, :content-length 244, :form-params {}, :websocket? false, :query-params {}, :content-type application/json, :form-params-raw {}, :character-encoding utf8, :uri /procure/graphql, :server-name localhost, :handler-key :graphql, :query-string nil, :body {:query query RequestFilters  {
    budget_periods  {
      id
      cacheKey
      name
      inspection_start_date
      end_date
      total_price_cents


    }
    __typename
  }


, :operationName RequestsIndexFiltered}, :graphql-schema #CompiledSchema<>, :handler #object[leihs.procurement.graphql$handler 0x2f0ad127 leihs.procurement.graphql$handler@2f0ad127], :multipart-params {}, :scheme :http, :request-method :post, :accept {:mime :json, :charset nil, :encoding nil, :language nil}}

>o>2pure-handler _> query query RequestFilters  {
    budget_periods  {
      id
      cacheKey
      name
      inspection_start_date
      end_date
      total_price_cents


    }
    __typename
  }




>o>3pure-handler, result=> {:data #ordered/map ([:budget_periods [#ordered/map ([:id 1a1dab20-c661-4204-a913-28065d570f7c] [:cacheKey nil] [:name 2028] [:inspection_start_date 2027-11-01 01:00:00.0] [:end_date 2027-12-31 01:00:00.0] [:total_price_cents nil]) #ordered/map ([:id dfdd0798-6462-46fc-995f-a7d7233f30fd] [:cacheKey nil] [:name 2027] [:inspection_start_date 2026-11-02 01:00:00.0] [:end_date 2026-12-31 01:00:00.0] [:total_price_cents nil]) #ordered/map ([:id 6b689ed8-8148-485a-b1ca-86c1c739503e] [:cacheKey nil] [:name 2026] [:inspection_start_date 2025-11-03 01:00:00.0] [:end_date 2025-12-31 01:00:00.0] [:total_price_cents nil]) #ordered/map ([:id 1173b482-b9e6-46b4-a5e3-0b021c860e9b] [:cacheKey nil] [:name 2025] [:inspection_start_date 2024-11-04 01:00:00.0] [:end_date 2024-12-31 01:00:00.0] [:total_price_cents nil]) #ordered/map ([:id e5d2ae4b-566f-4d6d-aed9-d6a8353eda7f] [:cacheKey nil] [:name 2024] [:inspection_start_date 2023-10-01 12:00:00.0] [:end_date 2023-12-31 01:00:00.0] [:total_price_cents nil]) #ordered/map ([:id 951ac476-4f92-4ff9-9f64-26fc8f8b61c5] [:cacheKey nil] [:name 2023] [:inspection_start_date 2022-11-01 01:00:00.0] [:end_date 2022-12-31 12:00:00.0] [:total_price_cents nil]) #ordered/map ([:id 76b66d78-bfe0-4c54-8c92-edbf467af784] [:cacheKey nil] [:name 2022] [:inspection_start_date 2021-10-29 12:00:00.0] [:end_date 2021-12-31 12:00:00.0] [:total_price_cents nil]) #ordered/map ([:id 24171a61-aec6-428e-b7ed-7461b3795454] [:cacheKey nil] [:name 2021] [:inspection_start_date 2020-10-26 12:00:00.0] [:end_date 2020-12-31 12:00:00.0] [:total_price_cents nil]) #ordered/map ([:id 3b7eab1e-c8b5-512b-9146-91cc295be955] [:cacheKey nil] [:name 2020] [:inspection_start_date 2019-11-09 12:00:00.0] [:end_date 2019-12-31 01:00:00.0] [:total_price_cents nil]) #ordered/map ([:id 9fb023db-725d-5881-8838-bae3e970ffd0] [:cacheKey nil] [:name 2019] [:inspection_start_date 2018-11-10 01:00:00.0] [:end_date 2018-12-31 01:00:00.0] [:total_price_cents nil]) #ordered/map ([:id c2c5f618-7e05-5e43-a2b1-ec7f9172335d] [:cacheKey nil] [:name 2018] [:inspection_start_date 2017-11-04 01:00:00.0] [:end_date 2017-12-31 01:00:00.0] [:total_price_cents nil]) #ordered/map ([:id 4f367b79-76cf-5f12-ab7b-535a7430e6da] [:cacheKey nil] [:name 2016] [:inspection_start_date 2016-11-01 01:00:00.0] [:end_date 2017-01-30 01:00:00.0] [:total_price_cents nil]) #ordered/map ([:id aba0576e-d65f-5fe0-aa80-89ce226ec9b1] [:cacheKey nil] [:name 2017] [:inspection_start_date 2016-11-04 01:00:00.0] [:end_date 2017-01-22 01:00:00.0] [:total_price_cents nil])]] [:__typename :Query])}
2023-12-01T18:40:39.845Z NX-41294 DEBUG [leihs.procurement.graphql:112] - result => {:data #ordered/map ([:budget_periods [#ordered/map ([:id "1a1dab20-c661-4204-a913-28065d570f7c"] [:cacheKey nil] [:name "2028"] [:inspection_start_date "2027-11-01 01:00:00.0"] [:end_date "2027-12-31 01:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "dfdd0798-6462-46fc-995f-a7d7233f30fd"] [:cacheKey nil] [:name "2027"] [:inspection_start_date "2026-11-02 01:00:00.0"] [:end_date "2026-12-31 01:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "6b689ed8-8148-485a-b1ca-86c1c739503e"] [:cacheKey nil] [:name "2026"] [:inspection_start_date "2025-11-03 01:00:00.0"] [:end_date "2025-12-31 01:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "1173b482-b9e6-46b4-a5e3-0b021c860e9b"] [:cacheKey nil] [:name "2025"] [:inspection_start_date "2024-11-04 01:00:00.0"] [:end_date "2024-12-31 01:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "e5d2ae4b-566f-4d6d-aed9-d6a8353eda7f"] [:cacheKey nil] [:name "2024"] [:inspection_start_date "2023-10-01 12:00:00.0"] [:end_date "2023-12-31 01:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "951ac476-4f92-4ff9-9f64-26fc8f8b61c5"] [:cacheKey nil] [:name "2023"] [:inspection_start_date "2022-11-01 01:00:00.0"] [:end_date "2022-12-31 12:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "76b66d78-bfe0-4c54-8c92-edbf467af784"] [:cacheKey nil] [:name "2022"] [:inspection_start_date "2021-10-29 12:00:00.0"] [:end_date "2021-12-31 12:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "24171a61-aec6-428e-b7ed-7461b3795454"] [:cacheKey nil] [:name "2021"] [:inspection_start_date "2020-10-26 12:00:00.0"] [:end_date "2020-12-31 12:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "3b7eab1e-c8b5-512b-9146-91cc295be955"] [:cacheKey nil] [:name "2020"] [:inspection_start_date "2019-11-09 12:00:00.0"] [:end_date "2019-12-31 01:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "9fb023db-725d-5881-8838-bae3e970ffd0"] [:cacheKey nil] [:name "2019"] [:inspection_start_date "2018-11-10 01:00:00.0"] [:end_date "2018-12-31 01:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "c2c5f618-7e05-5e43-a2b1-ec7f9172335d"] [:cacheKey nil] [:name "2018"] [:inspection_start_date "2017-11-04 01:00:00.0"] [:end_date "2017-12-31 01:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "4f367b79-76cf-5f12-ab7b-535a7430e6da"] [:cacheKey nil] [:name "2016"] [:inspection_start_date "2016-11-01 01:00:00.0"] [:end_date "2017-01-30 01:00:00.0"] [:total_price_cents nil]) #ordered/map ([:id "aba0576e-d65f-5fe0-aa80-89ce226ec9b1"] [:cacheKey nil] [:name "2017"] [:inspection_start_date "2016-11-04 01:00:00.0"] [:end_date "2017-01-22 01:00:00.0"] [:total_price_cents nil])]] [:__typename :Query])}
